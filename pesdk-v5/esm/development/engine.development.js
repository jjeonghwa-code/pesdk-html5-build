/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __values(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

var RectTransform = /** @class */ (function () {
    function RectTransform(position, scale, rotation) {
        if (scale === void 0) { scale = { x: 1, y: 1 }; }
        if (rotation === void 0) { rotation = 0; }
        this.position = position;
        this.scale = scale;
        this.rotation = rotation;
    }
    Object.defineProperty(RectTransform, "IDENTITY", {
        get: function () { return new RectTransform({ x: 0, y: 0 }); },
        enumerable: true,
        configurable: true
    });
    return RectTransform;
}());

var Vector2 = /** @class */ (function () {
    function Vector2(x, y) {
        if (typeof x === 'number') {
            this.x = x;
            this.y = y;
        }
        else {
            this.x = x.x;
            this.y = x.y;
        }
    }
    Vector2.fromSize = function (size) {
        return new Vector2(size.width, size.height);
    };
    /**
     * @returns The distance between two vectors.
     */
    Vector2.distance = function (lhs, rhs) {
        var dX = rhs.x - lhs.x;
        var dY = rhs.y - lhs.y;
        return Math.sqrt(dX * dX + dY * dY);
    };
    /**
     * @returns The dot product of two vectors.
     */
    Vector2.dot = function (lhs, rhs) {
        return lhs.x * rhs.x + lhs.y * rhs.y;
    };
    /**
     * Linearly interpolates between two vectors by t. t gets clamped to [0, 1].
     * When t === 0, returns lhs.
     * When t === 1, returns rhs.
     * @param t The interpolation weight
     */
    Vector2.lerp = function (lhs, rhs, t) {
        var w = Math.min(Math.max(t, 0), 1);
        return new Vector2(lhs.x * w + rhs.x * (1 - w), lhs.y * w + rhs.y * (1 - w));
    };
    /**
     * Linearly interpolates between two vectors by t.
     * When t === 0, returns lhs.
     * When t === 1, returns rhs.
     * @param t The interpolation weight
     */
    Vector2.lerpUnclamped = function (lhs, rhs, t) {
        return new Vector2(lhs.x * t + rhs.x * (1 - t), lhs.y * t + rhs.y * (1 - t));
    };
    /**
     * Calculates a proportionally scaled version of `toFit`, whose axis-aligned bounding
     * box (AABB) fits within the AABB spanned by `bounds`.
     * @param bounds A vector spanning a reference AABB, which the result should fit into.
     * @param toFit A vector that should be scaled to fit the AABB defined by `bounds`.
     */
    Vector2.proportionalFit = function (bounds, toFit) {
        var boundsAspect = bounds.x / bounds.y;
        var toFitAspect = toFit.x / toFit.y;
        if (boundsAspect > toFitAspect) {
            return toFit.multiply(bounds.y / toFit.y);
        }
        else {
            return toFit.multiply(bounds.x / toFit.x);
        }
    };
    Object.defineProperty(Vector2.prototype, "magnitude", {
        /**
         * @returns The euclidean length of this vector.
         */
        get: function () {
            return Math.sqrt(this.x * this.x + this.y * this.y);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Vector2.prototype, "normalized", {
        /**
         * @returns A unit-length vector which points in the same direction as this vector.
         */
        get: function () {
            var magn = this.magnitude;
            return new Vector2(this.x / magn, this.y / magn);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Vector2.prototype, "floored", {
        /**
         * @returns Both components of this vector floored.
         */
        get: function () {
            return new Vector2(Math.floor(this.x), Math.floor(this.y));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Vector2.prototype, "min", {
        /**
         * @returns The smaller of the two components.
         */
        get: function () {
            return Math.min(this.x, this.y);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Vector2.prototype, "max", {
        /**
         * @returns The larger of the two components.
         */
        get: function () {
            return Math.max(this.x, this.y);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Vector2.prototype, "abs", {
        /**
         * @returns A vector with absolute values of this vector's components.
         */
        get: function () {
            return new Vector2(Math.abs(this.x), Math.abs(this.y));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Vector2.prototype, "swapped", {
        /**
         * @returns A vector with swapped values of this vector's components.
         */
        get: function () {
            return new Vector2(this.y, this.x);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @returns A new copy of this vector.
     */
    Vector2.prototype.clone = function () {
        return new Vector2(this.x, this.y);
    };
    Vector2.prototype.add = function (x, y) {
        if (typeof x === 'number') {
            return new Vector2(this.x + x, this.y + y);
        }
        else {
            return new Vector2(this.x + x.x, this.y + x.y);
        }
    };
    Vector2.prototype.subtract = function (x, y) {
        if (typeof x === 'number') {
            return new Vector2(this.x - x, this.y - y);
        }
        else {
            return new Vector2(this.x - x.x, this.y - x.y);
        }
    };
    Vector2.prototype.multiply = function (x, y) {
        if (typeof x === 'number') {
            return new Vector2(this.x * x, this.y * (y === undefined ? x : y));
        }
        else {
            return new Vector2(this.x * x.x, this.y * x.y);
        }
    };
    Vector2.prototype.divide = function (x, y) {
        if (typeof x === 'number') {
            return new Vector2(this.x / x, this.y / (y === undefined ? x : y));
        }
        else {
            return new Vector2(this.x / x.x, this.y / x.y);
        }
    };
    /**
     * Checks whether the vector component are the same.
     * @param other The vector that this vector should be compared to.
     */
    Vector2.prototype.equals = function (other) {
        return this.x === other.x && this.y === other.y;
    };
    Vector2.ZERO = new Vector2(0, 0);
    Vector2.ONE = new Vector2(1, 1);
    Vector2.UP = new Vector2(0, 1);
    Vector2.DOWN = new Vector2(0, -1);
    Vector2.RIGHT = new Vector2(1, 0);
    Vector2.LEFT = new Vector2(-1, 0);
    return Vector2;
}());

var Rect = /** @class */ (function () {
    function Rect(origin, size, width, height) {
        if (typeof origin === 'number') {
            if (typeof size === 'number' && width !== undefined && height !== undefined) {
                this.origin = { x: origin, y: size };
                this.size = { width: width || 0, height: height || 0 };
            }
            else {
                throw new Error('Invalid arguments passed to Rect. Expected (number, number, number, number)');
            }
        }
        else {
            this.origin = origin;
            if (typeof size === 'number') {
                throw new Error('Invalid arguments passed to Rect. Expected (Float2, Size)');
            }
            this.size = size;
        }
    }
    /**
     * Checks whether the given point is within the rect.
     * @returns - True if `point` is within the bounds of `rect`
     */
    Rect.contains = function (rect, point) {
        return point.x >= rect.minX && point.x <= rect.maxX && point.y >= rect.minY && point.y <= rect.maxY;
    };
    Object.defineProperty(Rect.prototype, "minX", {
        get: function () {
            return this.origin.x;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Rect.prototype, "minY", {
        get: function () {
            return this.origin.y;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Rect.prototype, "midX", {
        get: function () {
            return this.origin.x + 0.5 * this.size.width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Rect.prototype, "midY", {
        get: function () {
            return this.origin.y + 0.5 * this.size.height;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Rect.prototype, "maxX", {
        get: function () {
            return this.origin.x + this.size.width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Rect.prototype, "maxY", {
        get: function () {
            return this.origin.y + this.size.height;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Rect.prototype, "width", {
        get: function () {
            return this.size.width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Rect.prototype, "height", {
        get: function () {
            return this.size.height;
        },
        enumerable: true,
        configurable: true
    });
    Rect.ZERO = new Rect({ x: 0, y: 0 }, { width: 0, height: 0 });
    return Rect;
}());

/**
 * A transformation matrix which can be used to rotate, scale,
 * translate or skew objects in 2D space.
 *
 * The transform is represented by a 3x3 matrix as follows:
 *
 *    a   b   tx
 *    c   d   ty
 *    0   0   1
 *
 * The last row is always [0 0 1], so it is not explicitly stored
 * by the AffineTransform.
 *
 * In order to transform a point p = (x, y, 1) with an
 * AffineTransform M it needs to be multiplied as follows:
 *
 *    p' = M * p
 */
var AffineTransform = /** @class */ (function () {
    function AffineTransform(a, b, c, d, tx, ty) {
        this.a = a;
        this.b = b;
        this.c = c;
        this.d = d;
        this.tx = tx;
        this.ty = ty;
    }
    /**
     * Creates an AffineTransform from the given scale factors
     * @param scaleX - The scale component on the x-axis
     * @param scaleY - The scale component on the y-axis
     */
    AffineTransform.fromScale = function (scaleX, scaleY) {
        return new AffineTransform(scaleX, 0, 0, scaleY, 0, 0);
    };
    /**
     * Creates an AffineTransform from the given rotation in radians
     * @param rotation - The rotation in radians
     */
    AffineTransform.fromRotation = function (rotation) {
        var cosPhi = Math.cos(rotation);
        var sinPhi = Math.sin(rotation);
        return new AffineTransform(cosPhi, -sinPhi, sinPhi, cosPhi, 0, 0);
    };
    /**
     * Creates an AffineTransform from the given rotation in degrees
     * @param rotation - The rotation in degrees
     */
    AffineTransform.fromRotationDeg = function (rotation) {
        var rad = Math.PI * rotation / 180;
        return this.fromRotation(rad);
    };
    /**
     * Creates an AffineTransform from the given translation
     * @param tx - The translation component on the x-axis
     * @param ty - The translation component on the y-axis
     */
    AffineTransform.fromTranslation = function (tx, ty) {
        return new AffineTransform(1, 0, 0, 1, tx, ty);
    };
    /**
     * Creates an AffineTransform from the given translation,
     * rotation and scale. Applying this matrix will first
     * scale, then rotate and then translate.
     * @param tx - The translation component on the x-axis
     * @param ty - The translation component on the y-axis
     * @param rotation - The rotation in radians
     * @param sX - The scale component on the x-axis
     * @param sY - The scale component on the y-axis
     */
    AffineTransform.fromTRS = function (tx, ty, rotation, sx, sy) {
        var cosPhi = Math.cos(rotation);
        var sinPhi = Math.sin(rotation);
        return new AffineTransform(sx * cosPhi, -sy * sinPhi, sx * sinPhi, sy * cosPhi, tx, ty);
    };
    AffineTransform.multiply = function (lhs, rhs) {
        var a = lhs.a * rhs.a + lhs.b * rhs.c;
        var b = lhs.a * rhs.b + lhs.b * rhs.d;
        var c = lhs.c * rhs.a + lhs.d * rhs.c;
        var d = lhs.c * rhs.b + lhs.d * rhs.d;
        var tx = lhs.a * rhs.tx + lhs.b * rhs.ty + lhs.tx;
        var ty = lhs.c * rhs.tx + lhs.d * rhs.ty + lhs.ty;
        return new AffineTransform(a, b, c, d, tx, ty);
    };
    /**
     * Returns lhs * point
     * @param lhs - The transformation to be applied to the point
     * @param point - The 2D point to be transformed
     */
    AffineTransform.transformPoint = function (lhs, point) {
        return {
            x: lhs.a * point.x + lhs.b * point.y + lhs.tx,
            y: lhs.c * point.x + lhs.d * point.y + lhs.ty,
        };
    };
    /**
     * Returns an affine transformation matrix constructed by inverting
     * an existing affine transform.
     * @param transform - The existing affine transform
     * @returns - A new affine transform. If the specified affine transform
     * cannot be inverted, the original transform is returned
     */
    AffineTransform.getInverted = function (transform) {
        var determinant = transform.a * transform.d - transform.b * transform.c;
        // If the determinant is 0, then an inverted transform doesn't exist
        // and we just return the original transform
        if (determinant === 0) {
            return transform;
        }
        var invDet = 1 / determinant;
        var a = invDet * transform.d;
        var b = -invDet * transform.b;
        var c = -invDet * transform.c;
        var d = invDet * transform.a;
        var tx = invDet * (transform.b * transform.ty - transform.d * transform.tx);
        var ty = invDet * (transform.c * transform.tx - transform.a * transform.ty);
        return new AffineTransform(a, b, c, d, tx, ty);
    };
    /**
     * The identitiy transform
     */
    AffineTransform.IDENTITY = AffineTransform.fromScale(1, 1);
    return AffineTransform;
}());

/**
 * @returns A generated UUID string
 */
function uuid() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = Math.random() * 16 | 0;
        var v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
    });
}

var now = window.performance.now.bind(window.performance);

// Based on FontFaceObserver by Bram Stein
// Copyright (c) 2014 - Bram Stein
// All rights reserved.
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions
// are met:
//  1. Redistributions of source code must retain the above copyright
//     notice, this list of conditions and the following disclaimer.
//  2. Redistributions in binary form must reproduce the above copyright
//     notice, this list of conditions and the following disclaimer in the
//     documentation and/or other materials provided with the distribution.
// THIS SOFTWARE IS PROVIDED BY THE AUTHOR "AS IS" AND ANY EXPRESS OR IMPLIED
// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
// EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
// INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
// BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
// EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
var FontFaceRuler = /** @class */ (function () {
    function FontFaceRuler(text) {
        this.text = text;
        this.lastOffsetWidth = -1;
        var style = 'max-width:none;' +
            'display:inline-block;' +
            'position:absolute;' +
            'height:100%;' +
            'width:100%;' +
            'overflow:scroll;' +
            'font-size:16px;';
        this.element = document.createElement('div');
        this.element.setAttribute('aria-hidden', 'true');
        this.element.appendChild(document.createTextNode(text));
        this.collapsible = document.createElement('span');
        this.expandable = document.createElement('span');
        this.collapsibleInner = document.createElement('span');
        this.expandableInner = document.createElement('span');
        this.collapsible.style.cssText = style;
        this.expandable.style.cssText = style;
        this.expandableInner.style.cssText = style;
        this.collapsibleInner.style.cssText = 'display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;';
        this.collapsible.appendChild(this.collapsibleInner);
        this.expandable.appendChild(this.expandableInner);
        this.element.appendChild(this.collapsible);
        this.element.appendChild(this.expandable);
    }
    FontFaceRuler.prototype.getElement = function () {
        return this.element;
    };
    FontFaceRuler.prototype.setFont = function (font) {
        this.element.style.cssText = 'max-width:none;' +
            'min-width:20px;' +
            'min-height:20px;' +
            'display:inline-block;' +
            'overflow:hidden;' +
            'position:absolute;' +
            'width:auto;' +
            'margin:0;' +
            'padding:0;' +
            'top:-999px;' +
            'white-space:nowrap;' +
            'font-synthesis:none;' +
            'font:' + font + ';';
    };
    FontFaceRuler.prototype.getWidth = function () {
        return this.element.offsetWidth;
    };
    FontFaceRuler.prototype.setWidth = function (width) {
        this.element.style.width = width + 'px';
    };
    FontFaceRuler.prototype.onResize = function (callback) {
        var _this = this;
        var onScroll = function () {
            _this.onScroll(callback);
        };
        this.collapsible.addEventListener('scroll', onScroll);
        this.expandable.addEventListener('scroll', onScroll);
        this.reset();
    };
    FontFaceRuler.prototype.reset = function () {
        var offsetWidth = this.getWidth();
        var width = offsetWidth + 100;
        this.expandableInner.style.width = width + 'px';
        this.expandable.scrollLeft = width;
        this.collapsible.scrollLeft = this.collapsible.scrollWidth + 100;
        if (this.lastOffsetWidth !== offsetWidth) {
            this.lastOffsetWidth = offsetWidth;
            return true;
        }
        else {
            return false;
        }
    };
    FontFaceRuler.prototype.onScroll = function (callback) {
        if (this.reset() && this.element.parentNode !== null) {
            callback(this.lastOffsetWidth);
        }
    };
    return FontFaceRuler;
}());

/* eslint-disable */
// Based on FontFaceObserver by Bram Stein
// Copyright (c) 2014 - Bram Stein
// All rights reserved.
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions
// are met:
//  1. Redistributions of source code must retain the above copyright
//     notice, this list of conditions and the following disclaimer.
//  2. Redistributions in binary form must reproduce the above copyright
//     notice, this list of conditions and the following disclaimer in the
//     documentation and/or other materials provided with the distribution.
// THIS SOFTWARE IS PROVIDED BY THE AUTHOR "AS IS" AND ANY EXPRESS OR IMPLIED
// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
// EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
// INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
// BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
// EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
var FontFaceObserver = /** @class */ (function () {
    function FontFaceObserver(font) {
        this.font = __assign({ fontFamily: 'normal', fontStyle: 'normal', fontWeight: 'normal', fontStretch: 'normal' }, font);
    }
    FontFaceObserver.getUserAgent = function () {
        return window.navigator.userAgent;
    };
    FontFaceObserver.getNavigatorVendor = function () {
        return window.navigator.vendor;
    };
    /**
     * Returns true if this browser is WebKit and it has the fallback bug
     * which is present in WebKit 536.11 and earlier.
     */
    FontFaceObserver.hasWebKitFallbackBug = function () {
        if (FontFaceObserver.HAS_WEBKIT_FALLBACK_BUG === null) {
            var match = /AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(FontFaceObserver.getUserAgent());
            FontFaceObserver.HAS_WEBKIT_FALLBACK_BUG = !!match &&
                (parseInt(match[1], 10) < 536 ||
                    (parseInt(match[1], 10) === 536 &&
                        parseInt(match[2], 10) <= 11));
        }
        return FontFaceObserver.HAS_WEBKIT_FALLBACK_BUG;
    };
    /**
     * Returns true if the browser has the Safari 10 bugs. The
     * native font load API in Safari 10 has two bugs that cause
     * the document.fonts.load and FontFace.prototype.load methods
     * to return promises that don't reliably get settled.
     *
     * The bugs are described in more detail here:
     *  - https://bugs.webkit.org/show_bug.cgi?id=165037
     *  - https://bugs.webkit.org/show_bug.cgi?id=164902
     *
     * If the browser is made by Apple, and has native font
     * loading support, it is potentially affected. But the API
     * was fixed around AppleWebKit version 603, so any newer
     * versions that that does not contain the bug.
     */
    FontFaceObserver.hasSafari10Bug = function () {
        if (FontFaceObserver.HAS_SAFARI_10_BUG === null) {
            if (FontFaceObserver.supportsNativeFontLoading() && /Apple/.test(FontFaceObserver.getNavigatorVendor())) {
                var match = /AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(FontFaceObserver.getUserAgent());
                FontFaceObserver.HAS_SAFARI_10_BUG = !!match && parseInt(match[1], 10) < 603;
            }
            else {
                FontFaceObserver.HAS_SAFARI_10_BUG = false;
            }
        }
        return FontFaceObserver.HAS_SAFARI_10_BUG;
    };
    /**
     * Returns true if the browser supports the native font loading
     * API.
     */
    FontFaceObserver.supportsNativeFontLoading = function () {
        if (FontFaceObserver.SUPPORTS_NATIVE_FONT_LOADING === null) {
            FontFaceObserver.SUPPORTS_NATIVE_FONT_LOADING = !!document["fonts"];
        }
        return FontFaceObserver.SUPPORTS_NATIVE_FONT_LOADING;
    };
    /**
     * Returns true if the browser supports font-style in the font
     * short-hand syntax.
     */
    FontFaceObserver.supportsStretch = function () {
        if (FontFaceObserver.SUPPORTS_STRETCH === null) {
            var div = document.createElement('div');
            try {
                div.style.font = 'condensend 100px sans-serif';
            }
            catch (e) {
                FontFaceObserver.SUPPORTS_STRETCH = false;
            }
            FontFaceObserver.SUPPORTS_STRETCH = div.style.font !== '';
        }
        return FontFaceObserver.SUPPORTS_STRETCH;
    };
    FontFaceObserver.prototype.load = function (text, timeout) {
        var _this = this;
        var testString = 'BESbswy';
        var timeoutID = null;
        var timeoutValue = timeout || FontFaceObserver.DEFAULT_TIMEOUT;
        var start = this.getTime();
        return new Promise(function (resolve, reject) {
            if (FontFaceObserver.supportsNativeFontLoading() && !FontFaceObserver.hasSafari10Bug()) {
                var loader = new Promise(function (resolve2, reject2) {
                    var check = function () {
                        var now = _this.getTime();
                        if (now - start >= timeoutValue) {
                            reject2(new Error('' + timeoutValue + 'ms timeout exceeded'));
                        }
                        else {
                            document["fonts"].load(_this.getStyle("\"" + _this.font.fontFamily + "\""), testString).then(function (fonts) {
                                if (fonts.length >= 1) {
                                    resolve2();
                                }
                                else {
                                    setTimeout(check, 25);
                                }
                            }, reject);
                        }
                    };
                    check();
                });
                var timer = new Promise(function (resolve2, reject2) {
                    timeoutID = setTimeout(function () {
                        reject2(new Error(timeoutValue + " ms timeout exceeded"));
                    }, timeoutValue);
                });
                Promise.race([timer, loader]).then(function () {
                    clearTimeout(timeoutID);
                    resolve(_this);
                }, reject);
            }
            else {
                var rulerA_1 = new FontFaceRuler(testString);
                var rulerB_1 = new FontFaceRuler(testString);
                var rulerC_1 = new FontFaceRuler(testString);
                var widthA_1 = -1;
                var widthB_1 = -1;
                var widthC_1 = -1;
                var fallbackWidthA_1 = -1;
                var fallbackWidthB_1 = -1;
                var fallbackWidthC_1 = -1;
                var container_1 = document.createElement('div');
                var removeContainer_1 = function () {
                    if (container_1.parentNode !== null) {
                        container_1.parentNode.removeChild(container_1);
                    }
                };
                /**
                 * If metric compatible fonts are detected, one of the widths will be -1. This is
                 * because a metric compatible font won't trigger a scroll event. We work around
                 * this by considering a font loaded if at least two of the widths are the same.
                 * Because we have three widths, this still prevents false positives.
                 *
                 * Cases:
                 * 1) Font loads: both a, b and c are called and have the same value.
                 * 2) Font fails to load: resize callback is never called and timeout happens.
                 * 3) WebKit bug: both a, b and c are called and have the same value, but the
                 *    values are equal to one of the last resort fonts, we ignore this and
                 *    continue waiting until we get new values (or a timeout).
                 */
                var check_1 = function () {
                    if ((widthA_1 !== -1 && widthB_1 !== -1) || (widthA_1 !== -1 && widthC_1 !== -1) || (widthB_1 !== -1 && widthC_1 !== -1)) {
                        if (widthA_1 === widthB_1 || widthA_1 === widthC_1 || widthB_1 === widthC_1) {
                            // All values are the same, so the browser has most likely loaded the web font
                            if (FontFaceObserver.hasWebKitFallbackBug()) {
                                // Except if the browser has the WebKIT fallback bug, in which case we check to see
                                // if all values are set to one of the last resort fonts.
                                if (((widthA_1 === fallbackWidthA_1 && widthB_1 === fallbackWidthA_1 && widthC_1 === fallbackWidthA_1) ||
                                    (widthA_1 === fallbackWidthB_1 && widthB_1 === fallbackWidthB_1 && widthC_1 === fallbackWidthB_1) ||
                                    (widthA_1 === fallbackWidthC_1 && widthB_1 === fallbackWidthC_1 && widthC_1 === fallbackWidthC_1))) {
                                    // The width we got matches some of the known last resort fonts, so let's assume we're dealing with
                                    // the last resort font.
                                    return;
                                }
                            }
                            removeContainer_1();
                            clearTimeout(timeoutID);
                            resolve(_this);
                        }
                    }
                };
                // This ensures the scroll direction is correct
                container_1.dir = 'ltr';
                rulerA_1.setFont(_this.getStyle('sans-serif'));
                rulerB_1.setFont(_this.getStyle('serif'));
                rulerC_1.setFont(_this.getStyle('monospace'));
                container_1.appendChild(rulerA_1.getElement());
                container_1.appendChild(rulerB_1.getElement());
                container_1.appendChild(rulerC_1.getElement());
                document.body.appendChild(container_1);
                fallbackWidthA_1 = rulerA_1.getWidth();
                fallbackWidthB_1 = rulerB_1.getWidth();
                fallbackWidthC_1 = rulerC_1.getWidth();
                var checkForTimeout_1 = function () {
                    var now = _this.getTime();
                    if (now - start >= timeoutValue) {
                        removeContainer_1();
                        reject(new Error(timeoutValue + " ms timeout exceeded"));
                    }
                    else {
                        var hidden = document.hidden;
                        if (hidden === true || hidden === undefined) {
                            widthA_1 = rulerA_1.getWidth();
                            widthB_1 = rulerB_1.getWidth();
                            widthC_1 = rulerC_1.getWidth();
                            check_1();
                        }
                        timeoutID = setTimeout(checkForTimeout_1, 50);
                    }
                };
                checkForTimeout_1();
                rulerA_1.onResize(function (width) {
                    widthA_1 = width;
                    check_1();
                });
                rulerA_1.setFont(_this.getStyle("\"" + _this.font.fontFamily + "\",sans-serif"));
                rulerB_1.onResize(function (width) {
                    widthB_1 = width;
                    check_1();
                });
                rulerB_1.setFont(_this.getStyle("\"" + _this.font.fontFamily + "\",serif"));
                rulerC_1.onResize(function (width) {
                    widthC_1 = width;
                    check_1();
                });
                rulerC_1.setFont(_this.getStyle("\"" + _this.font.fontFamily + "\",monospace"));
            }
        });
    };
    FontFaceObserver.prototype.getStyle = function (family) {
        return [
            this.font.fontStyle,
            this.font.fontWeight,
            FontFaceObserver.supportsStretch() ? this.font.fontStretch : '',
            '100px',
            family,
        ].join(' ');
    };
    /**
     * Returns the current time in milliseconds
     */
    FontFaceObserver.prototype.getTime = function () {
        return new Date().getTime();
    };
    FontFaceObserver.HAS_WEBKIT_FALLBACK_BUG = null;
    FontFaceObserver.HAS_SAFARI_10_BUG = null;
    FontFaceObserver.SUPPORTS_STRETCH = null;
    FontFaceObserver.SUPPORTS_NATIVE_FONT_LOADING = null;
    FontFaceObserver.DEFAULT_TIMEOUT = 3000;
    return FontFaceObserver;
}());

var CanvasAction;
(function (CanvasAction) {
    CanvasAction["UNDO"] = "undo";
    CanvasAction["REDO"] = "redo";
    CanvasAction["DELETE"] = "delete";
    CanvasAction["BRING_TO_FRONT"] = "bringtofront";
    CanvasAction["EDIT"] = "edit";
    CanvasAction["DUPLICATE"] = "duplicate";
    CanvasAction["ADD"] = "add";
    CanvasAction["FLIP"] = "flip";
    CanvasAction["INVERT"] = "invert";
    CanvasAction["CLOSE"] = "close";
    CanvasAction["EXPORT"] = "export";
})(CanvasAction || (CanvasAction = {}));

/** List of Image editing tools. */
var Tool;
(function (Tool) {
    /** A tool to add a default list of input images. */
    Tool["LIBRARY"] = "library";
    Tool["ART_FILTER"] = "artFilter";
    /** A tool to apply an transformation, such as cropping or rotation. */
    Tool["TRANSFORM"] = "transform";
    /** A tool to apply an image filter effect. */
    Tool["FILTER"] = "filter";
    /** A tool to apply an image filter effect. */
    Tool["ADJUSTMENT"] = "adjustment";
    /** A tool to add blur. */
    Tool["FOCUS"] = "focus";
    /** A tool to add stickers. */
    Tool["STICKER"] = "sticker";
    /** A tool to add texts. */
    Tool["TEXT"] = "text";
    /** A tool to add text designs. */
    Tool["TEXT_DESIGN"] = "textdesign";
    /** A tool to add an overlay. */
    Tool["OVERLAY"] = "overlay";
    /** A tool to add a frame. */
    Tool["FRAME"] = "frame";
    /** A tool to add a frame. */
    Tool["BRUSH"] = "brush";
})(Tool || (Tool = {}));

/** A video format. */
var VideoFormat;
(function (VideoFormat) {
    VideoFormat["MP4"] = "video/mp4";
    VideoFormat["MOV"] = "video/quicktime";
})(VideoFormat || (VideoFormat = {}));
/** A video codec. */
var VideoCodec;
(function (VideoCodec) {
    VideoCodec["H264"] = "h264";
    VideoCodec["HEVC"] = "hevc";
})(VideoCodec || (VideoCodec = {}));
/** A serialization export type. */
var SerializationExportType;
(function (SerializationExportType) {
    /** The exported serialization is saved to a file and the corresponding file URL is returned. */
    // FILE_URL = 'file-url',
    /** The exported serialization is returned as an object. */
    SerializationExportType["OBJECT"] = "object";
})(SerializationExportType || (SerializationExportType = {}));

var ExportFormat;
(function (ExportFormat) {
    ExportFormat["IMAGE"] = "image";
    ExportFormat["DATA_URL"] = "data-url";
    ExportFormat["BLOB"] = "blob";
    ExportFormat["MSBLOB"] = "ms-blob";
})(ExportFormat || (ExportFormat = {}));

var ImageFormat;
(function (ImageFormat) {
    ImageFormat["PNG"] = "image/png";
    ImageFormat["JPEG"] = "image/jpeg";
    // @ifndef WEBPACK
    ImageFormat["RAW"] = "raw";
    // @endif
})(ImageFormat || (ImageFormat = {}));

Tool.FILTER, Tool.FOCUS, Tool.ADJUSTMENT, Tool.LIBRARY, Tool.OVERLAY, Tool.STICKER, Tool.TEXT, Tool.TEXT_DESIGN, Tool.FRAME, Tool.BRUSH, Tool.TRANSFORM;

var AdjustmentIdentifier;
(function (AdjustmentIdentifier) {
    AdjustmentIdentifier["BRIGHTNESS"] = "brightness";
    AdjustmentIdentifier["CONTRAST"] = "contrast";
    AdjustmentIdentifier["SATURATION"] = "saturation";
    AdjustmentIdentifier["CLARITY"] = "clarity";
    AdjustmentIdentifier["SHADOWS"] = "shadows";
    AdjustmentIdentifier["HIGHLIGHTS"] = "highlights";
    AdjustmentIdentifier["EXPOSURE"] = "exposure";
    AdjustmentIdentifier["GAMMA"] = "gamma";
    AdjustmentIdentifier["BLACKS"] = "blacks";
    AdjustmentIdentifier["WHITES"] = "whites";
    AdjustmentIdentifier["TEMPERATURE"] = "temperature";
    AdjustmentIdentifier["SHARPNESS"] = "sharpness";
})(AdjustmentIdentifier || (AdjustmentIdentifier = {}));

function isDuoToneFilterAsset(asset) {
    return asset.lightColor !== undefined;
}
function isLUTFilterAsset(asset) {
    return asset.lutURI !== undefined;
}

var FocusIdentifier;
(function (FocusIdentifier) {
    FocusIdentifier["RADIAL"] = "radial";
    FocusIdentifier["LINEAR"] = "linear";
    FocusIdentifier["MIRRORED"] = "mirrored";
    FocusIdentifier["GAUSSIAN"] = "gaussian";
})(FocusIdentifier || (FocusIdentifier = {}));

var BlendMode;
(function (BlendMode) {
    BlendMode["NORMAL"] = "normal";
    BlendMode["OVERLAY"] = "overlay";
    BlendMode["SOFT_LIGHT"] = "softLight";
    BlendMode["HARD_LIGHT"] = "hardLight";
    BlendMode["MULTIPLY"] = "multiply";
    BlendMode["DARKEN"] = "darken";
    BlendMode["COLOR_BURN"] = "colorBurn";
    BlendMode["SCREEN"] = "screen";
    BlendMode["LIGHTEN"] = "lighten";
})(BlendMode || (BlendMode = {}));

function isStickerAssetDynamic(sticker) {
    return sticker.sticker !== undefined;
}
function isStickerCategoryDynamic(sticker) {
    return sticker.thumbnail !== undefined;
}

function isWebFontAsset(asset) {
    return asset.provider === undefined || asset.provider === 'file';
}
function isGoogleFontAsset(asset) {
    return asset.provider === 'google';
}

var TransformIdentifier;
(function (TransformIdentifier) {
    TransformIdentifier["CommonCategory"] = "imgly_transforms_common";
    TransformIdentifier["FacebookCategory"] = "imgly_transforms_facebook";
    TransformIdentifier["TwitterCategory"] = "imgly_transforms_twitter";
    TransformIdentifier["InstagramCategory"] = "imgly_transforms_instagram";
    TransformIdentifier["Custom"] = "imgly_transform_common_custom";
    TransformIdentifier["Square"] = "imgly_transform_common_square";
    TransformIdentifier["ThreeByFour"] = "imgly_transform_common_3";
    TransformIdentifier["FourByThree"] = "imgly_transform_common_4";
    TransformIdentifier["NineBySixteen"] = "imgly_transform_common_9";
    TransformIdentifier["SixteenByNine"] = "imgly_transform_common_16";
    TransformIdentifier["FacebookPost"] = "imgly_transform_facebook_post";
    TransformIdentifier["FacebookProfile"] = "imgly_transform_facebook_profile";
    TransformIdentifier["FacebookTitle"] = "imgly_transform_facebook_title";
    TransformIdentifier["InstagramLandscape"] = "imgly_transform_instagram_landscape";
    TransformIdentifier["InstagramPortrait"] = "imgly_transform_instagram_portrait";
    TransformIdentifier["InstagramSquare"] = "imgly_transform_instagram_square";
    TransformIdentifier["InstagramStory"] = "imgly_transform_instagram_story";
    TransformIdentifier["TwitterPost"] = "imgly_transform_twitter_post";
    TransformIdentifier["TwitterProfile"] = "imgly_transform_twitter_profile";
    TransformIdentifier["TwitterTitle"] = "imgly_transform_twitter_title";
})(TransformIdentifier || (TransformIdentifier = {}));

var UIEvent;
(function (UIEvent) {
    UIEvent["EXPORT"] = "export";
    UIEvent["CLOSE"] = "close";
    UIEvent["HISTORY_CHANGE"] = "historyChange";
    UIEvent["EDITOR_READY"] = "editorReady";
})(UIEvent || (UIEvent = {}));

/**
 * A class used to receive and emit events.
 */
var EventEmitter = /** @class */ (function () {
    function EventEmitter() {
        this.events = {};
    }
    /**
     * Adds the `listener` function to the end of the list of listeners for the specified `event`.
     * No checks are made to see if `listener` has already been added. Multiple calls passing the
     * same combination of `event` and `listener` will result in the `listener` being added, and
     * called, multiple times.
     * @param event The name of the event.
     * @param listener The callback function.
     */
    EventEmitter.prototype.addListener = function (event, listener) {
        var listeners = (this.events[event] || (this.events[event] = []));
        listeners.push(listener);
        return this;
    };
    /**
     * Removes the most recently added instance of `listener` from the list of listeners for the
     * specified `event`.
     *
     * Once an event has been emitted, all listeners attached to it at the time of emitting will
     * be called in order. This implies that any `removeListener` or `removeAllListeners` calls
     * after emitting and before the last listener finishes execution will not remove them from
     * `emit()` in progress. Subsequent events will behave as expected.
     * @param event The name of the event.
     * @param listener The callback function to be removed.
     */
    EventEmitter.prototype.removeListener = function (event, listener) {
        var listeners = this.events[event];
        if (!listeners) {
            return this;
        }
        var index = listeners.lastIndexOf(listener);
        if (index === -1) {
            return this;
        }
        listeners.splice(index, 1);
        return this;
    };
    /**
     * Removes all previously registered listeners for the specified `event`.
     * @param event The name of the event.
     */
    EventEmitter.prototype.removeAllListeners = function (event) {
        this.events[event] = undefined;
        return this;
    };
    /**
     * @see {@link addListener}
     */
    EventEmitter.prototype.on = function (event, listener) {
        return this.addListener(event, listener);
    };
    /**
     * @see {@link removeListener}
     */
    EventEmitter.prototype.off = function (event, listener) {
        return this.removeListener(event, listener);
    };
    /**
     * Emits the event to all of its registered listeners.
     * @param event The event to be emitted to its listeners.
     * @param args The arguments to be passed along with the event.
     * @returns `false` if there were no listeners for the emitted event.
     */
    EventEmitter.prototype.emit = function (event) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        var listeners = this.events[event];
        if (!listeners || !listeners.length) {
            return false;
        }
        // eslint-disable-next-line prefer-spread
        listeners.slice(0).forEach(function (fn) { return fn.apply(null, args); });
        return true;
    };
    return EventEmitter;
}());

function isMobile() {
    if (typeof navigator === 'undefined') {
        return false;
    }
    var a = navigator.userAgent || navigator.vendor || window.opera;
    /* eslint-disable */
    return (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4)));
    /* eslint-enable */
}

var ImageResizerEvent;
(function (ImageResizerEvent) {
    ImageResizerEvent["BEGAN_IMAGE_DOWNSCALING"] = "beganImageDownscaling";
    ImageResizerEvent["IMAGE_DOWNSCALED"] = "imageDownscaled";
})(ImageResizerEvent || (ImageResizerEvent = {}));
/**
 * This class uses Canvas2D in order to downscale an image if it exceeds the
 * limits.
 *
 * This ignores EXIF orientation data and directly uses
 * the input dimensions for checking the downscaling conditions, so
 * EXIF checks and orientation adjustments should happen before using
 * this image resizer.
 */
var ImageResizer = /** @class */ (function (_super) {
    __extends(ImageResizer, _super);
    function ImageResizer(image, options) {
        var _this = _super.call(this) || this;
        _this.image = image;
        _this.options = options;
        return _this;
    }
    /**
     * @returns Whether or not the image should be downscaled.
     */
    ImageResizer.prototype.needsResize = function () {
        var resizedDimensions = this.resizedDimensions();
        return resizedDimensions.x < this.image.width || resizedDimensions.y < this.image.height;
    };
    /**
     * The dimensions of the optionally resized output.
     */
    ImageResizer.prototype.resizedDimensions = function () {
        var options = this.options;
        var sourceDimensions = { width: this.image.width, height: this.image.height };
        // There can be two bounding boxes which describe dimension limits:
        // One given by the megapixel limit - this one has the same aspect
        // ratio as the image.
        // Another bounding box is given by the maxDimensions limit. The
        // intersection of both bounding boxes defines the final bounding box
        // which the input should be downscaled into.
        // We don't want to upscale the input, so we have the input dimensions as
        // the upper bound.
        var maxMegaPixelBounds = Vector2.fromSize(sourceDimensions);
        var maxDimensionBounds = Vector2.fromSize(sourceDimensions);
        var maxMegaPixels = options.maxMegaPixels;
        if (maxMegaPixels) {
            var maxPixels = (isMobile() ? maxMegaPixels.mobile : maxMegaPixels.desktop) * 1000000;
            var ratioHV = sourceDimensions.width / sourceDimensions.height;
            var ratioVH = sourceDimensions.height / sourceDimensions.width;
            var maxPixelBounds = new Vector2(Math.floor(Math.sqrt(maxPixels * ratioHV)), Math.floor(Math.sqrt(maxPixels * ratioVH)));
            if (maxPixelBounds.x <= sourceDimensions.width && maxPixelBounds.y <= sourceDimensions.height) {
                maxMegaPixelBounds = maxPixelBounds;
            }
        }
        var maxOutputDimensions = options.maxDimensions;
        if (maxOutputDimensions) {
            if (maxOutputDimensions.height < sourceDimensions.height || maxOutputDimensions.width < sourceDimensions.width) {
                maxDimensionBounds = new Vector2(maxOutputDimensions.width, maxOutputDimensions.height);
            }
        }
        var intersectionAABB = new Vector2(Math.min(maxMegaPixelBounds.x, maxDimensionBounds.x), Math.min(maxMegaPixelBounds.y, maxDimensionBounds.y));
        return Vector2.proportionalFit(intersectionAABB, Vector2.fromSize(sourceDimensions)).floored;
    };
    /**
     * If the conditions for downscaling are met, the source image is
     * resized and a canvas element is returned, otherwise, the source
     * is returned without modifications.
     */
    ImageResizer.prototype.downscaleIfNecessary = function () {
        var resizedDimensions = this.resizedDimensions();
        var needsResize = resizedDimensions.x < this.image.width || resizedDimensions.y < this.image.height;
        if (!needsResize) {
            return this.image;
        }
        this.emit(ImageResizerEvent.BEGAN_IMAGE_DOWNSCALING, this.image);
        var canvas = document.createElement('canvas');
        canvas.width = resizedDimensions.x;
        canvas.height = resizedDimensions.y;
        var context = canvas.getContext('2d');
        var image = this.image;
        context.drawImage(image, 0, 0, image.width, image.height, 0, 0, resizedDimensions.x, resizedDimensions.y);
        this.emit(ImageResizerEvent.IMAGE_DOWNSCALED);
        return canvas;
    };
    ImageResizer.prototype.downscaleImageIfNecessary = function () {
        var thisImage = this.image;
        var resizedDimensions = this.resizedDimensions();
        var needsResize = resizedDimensions.x < this.image.width || resizedDimensions.y < this.image.height;
        if (!needsResize) {
            return thisImage;
        }
        this.emit(ImageResizerEvent.BEGAN_IMAGE_DOWNSCALING, thisImage);
        var image = new Image();
        image.width = resizedDimensions.x;
        image.height = resizedDimensions.y;
        image.src = thisImage.src;
        this.emit(ImageResizerEvent.IMAGE_DOWNSCALED);
        return image;
    };
    return ImageResizer;
}(EventEmitter));

// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

// resolves . and .. elements in a path array with directory names there
// must be no slashes, empty elements, or device names (c:\) in the array
// (so also no leading and trailing slashes - it does not distinguish
// relative and absolute paths)
function normalizeArray(parts, allowAboveRoot) {
  // if the path tries to go above the root, `up` ends up > 0
  var up = 0;
  for (var i = parts.length - 1; i >= 0; i--) {
    var last = parts[i];
    if (last === '.') {
      parts.splice(i, 1);
    } else if (last === '..') {
      parts.splice(i, 1);
      up++;
    } else if (up) {
      parts.splice(i, 1);
      up--;
    }
  }

  // if the path is allowed to go above the root, restore leading ..s
  if (allowAboveRoot) {
    for (; up--; up) {
      parts.unshift('..');
    }
  }

  return parts;
}

// Split a filename into [root, dir, basename, ext], unix version
// 'root' is just a slash, or nothing.
var splitPathRe =
    /^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;
var splitPath = function(filename) {
  return splitPathRe.exec(filename).slice(1);
};

// path.resolve([from ...], to)
// posix version
function resolve() {
  var resolvedPath = '',
      resolvedAbsolute = false;

  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {
    var path = (i >= 0) ? arguments[i] : '/';

    // Skip empty and invalid entries
    if (typeof path !== 'string') {
      throw new TypeError('Arguments to path.resolve must be strings');
    } else if (!path) {
      continue;
    }

    resolvedPath = path + '/' + resolvedPath;
    resolvedAbsolute = path.charAt(0) === '/';
  }

  // At this point the path should be resolved to a full absolute path, but
  // handle relative paths to be safe (might happen when process.cwd() fails)

  // Normalize the path
  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {
    return !!p;
  }), !resolvedAbsolute).join('/');

  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';
}
// path.normalize(path)
// posix version
function normalize(path) {
  var isPathAbsolute = isAbsolute(path),
      trailingSlash = substr(path, -1) === '/';

  // Normalize the path
  path = normalizeArray(filter(path.split('/'), function(p) {
    return !!p;
  }), !isPathAbsolute).join('/');

  if (!path && !isPathAbsolute) {
    path = '.';
  }
  if (path && trailingSlash) {
    path += '/';
  }

  return (isPathAbsolute ? '/' : '') + path;
}
// posix version
function isAbsolute(path) {
  return path.charAt(0) === '/';
}

// posix version
function join() {
  var paths = Array.prototype.slice.call(arguments, 0);
  return normalize(filter(paths, function(p, index) {
    if (typeof p !== 'string') {
      throw new TypeError('Arguments to path.join must be strings');
    }
    return p;
  }).join('/'));
}


// path.relative(from, to)
// posix version
function relative(from, to) {
  from = resolve(from).substr(1);
  to = resolve(to).substr(1);

  function trim(arr) {
    var start = 0;
    for (; start < arr.length; start++) {
      if (arr[start] !== '') break;
    }

    var end = arr.length - 1;
    for (; end >= 0; end--) {
      if (arr[end] !== '') break;
    }

    if (start > end) return [];
    return arr.slice(start, end - start + 1);
  }

  var fromParts = trim(from.split('/'));
  var toParts = trim(to.split('/'));

  var length = Math.min(fromParts.length, toParts.length);
  var samePartsLength = length;
  for (var i = 0; i < length; i++) {
    if (fromParts[i] !== toParts[i]) {
      samePartsLength = i;
      break;
    }
  }

  var outputParts = [];
  for (var i = samePartsLength; i < fromParts.length; i++) {
    outputParts.push('..');
  }

  outputParts = outputParts.concat(toParts.slice(samePartsLength));

  return outputParts.join('/');
}

var sep = '/';
var delimiter = ':';

function dirname(path) {
  var result = splitPath(path),
      root = result[0],
      dir = result[1];

  if (!root && !dir) {
    // No dirname whatsoever
    return '.';
  }

  if (dir) {
    // It has a dirname, strip trailing slash
    dir = dir.substr(0, dir.length - 1);
  }

  return root + dir;
}

function basename(path, ext) {
  var f = splitPath(path)[2];
  // TODO: make this comparison case-insensitive on windows?
  if (ext && f.substr(-1 * ext.length) === ext) {
    f = f.substr(0, f.length - ext.length);
  }
  return f;
}


function extname(path) {
  return splitPath(path)[3];
}
var path = {
  extname: extname,
  basename: basename,
  dirname: dirname,
  sep: sep,
  delimiter: delimiter,
  relative: relative,
  join: join,
  isAbsolute: isAbsolute,
  normalize: normalize,
  resolve: resolve
};
function filter (xs, f) {
    if (xs.filter) return xs.filter(f);
    var res = [];
    for (var i = 0; i < xs.length; i++) {
        if (f(xs[i], i, xs)) res.push(xs[i]);
    }
    return res;
}

// String.prototype.substr - negative index don't work in IE8
var substr = 'ab'.substr(-1) === 'b' ?
    function (str, start, len) { return str.substr(start, len) } :
    function (str, start, len) {
        if (start < 0) start = str.length + start;
        return str.substr(start, len);
    }
;

var metadata = [
    {
        identifier: 'imgly_overlay_golden',
        name: 'Golden',
        defaultBlendMode: BlendMode.LIGHTEN,
        overlayURI: './items/imgly_overlay_golden.jpg',
        thumbnailURI: './items/imgly_overlay_golden_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_lightleak1',
        name: 'Lightleak',
        defaultBlendMode: BlendMode.SCREEN,
        overlayURI: './items/imgly_overlay_lightleak1.jpg',
        thumbnailURI: './items/imgly_overlay_lightleak1_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_rain',
        name: 'Rain',
        defaultBlendMode: BlendMode.OVERLAY,
        overlayURI: './items/imgly_overlay_rain.jpg',
        thumbnailURI: './items/imgly_overlay_rain_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_mosaic',
        name: 'Mosaic',
        defaultBlendMode: BlendMode.MULTIPLY,
        overlayURI: './items/imgly_overlay_mosaic.jpg',
        thumbnailURI: './items/imgly_overlay_mosaic_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_vintage',
        name: 'Vintage',
        defaultBlendMode: BlendMode.DARKEN,
        overlayURI: './items/imgly_overlay_vintage.jpg',
        thumbnailURI: './items/imgly_overlay_vintage_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_paper',
        name: 'Paper',
        defaultBlendMode: BlendMode.MULTIPLY,
        overlayURI: './items/imgly_overlay_paper.jpg',
        thumbnailURI: './items/imgly_overlay_paper_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_bokeh',
        name: 'Bokeh',
        defaultBlendMode: BlendMode.LIGHTEN,
        overlayURI: './items/imgly_overlay_bokeh.jpg',
        thumbnailURI: './items/imgly_overlay_bokeh_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_hearts',
        name: 'Hearts',
        defaultBlendMode: BlendMode.SCREEN,
        overlayURI: './items/imgly_overlay_hearts.jpg',
        thumbnailURI: './items/imgly_overlay_hearts_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_lightleak2',
        name: 'Lightleak 2',
        defaultBlendMode: BlendMode.LIGHTEN,
        overlayURI: './items/imgly_overlay_lightleak2.jpg',
        thumbnailURI: './items/imgly_overlay_lightleak2_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_wood',
        name: 'Wood',
        defaultBlendMode: BlendMode.MULTIPLY,
        overlayURI: './items/imgly_overlay_wood.jpg',
        thumbnailURI: './items/imgly_overlay_wood_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_chop',
        name: 'Chop',
        defaultBlendMode: BlendMode.MULTIPLY,
        overlayURI: './items/imgly_overlay_chop.jpg',
        thumbnailURI: './items/imgly_overlay_chop_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_metal',
        name: 'Metal',
        defaultBlendMode: BlendMode.OVERLAY,
        overlayURI: './items/imgly_overlay_metal.jpg',
        thumbnailURI: './items/imgly_overlay_metal_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_painting',
        name: 'Painting',
        defaultBlendMode: BlendMode.OVERLAY,
        overlayURI: './items/imgly_overlay_painting.jpg',
        thumbnailURI: './items/imgly_overlay_painting_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_grain',
        name: 'Grain',
        defaultBlendMode: BlendMode.OVERLAY,
        overlayURI: './items/imgly_overlay_grain.jpg',
        thumbnailURI: './items/imgly_overlay_grain_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_clouds',
        name: 'Clouds',
        defaultBlendMode: BlendMode.SOFT_LIGHT,
        overlayURI: './items/imgly_overlay_clouds.jpg',
        thumbnailURI: './items/imgly_overlay_clouds_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_wall1',
        name: 'Wall',
        defaultBlendMode: BlendMode.LIGHTEN,
        overlayURI: './items/imgly_overlay_wall1.jpg',
        thumbnailURI: './items/imgly_overlay_wall1_thumb.jpg',
    },
    {
        identifier: 'imgly_overlay_wall2',
        name: 'Wall 2',
        defaultBlendMode: BlendMode.OVERLAY,
        overlayURI: './items/imgly_overlay_wall2.jpg',
        thumbnailURI: './items/imgly_overlay_wall2_thumb.jpg',
    },
];

var metadata$1 = [
    {
        identifier: 'imgly_filter_category_duotone',
        name: 'DuoTone',
        thumbnailURI: './categories/duotone.jpg',
        items: [
            {
                identifier: 'imgly_duotone_desert',
                name: 'Desert',
                thumbnailURI: './items/imgly_duotone_desert.jpg',
                lightColor: '#e1de9a',
                darkColor: '#cb2129',
                defaultIntensity: 0.5,
            },
            {
                identifier: 'imgly_duotone_peach',
                name: 'Peach',
                thumbnailURI: './items/imgly_duotone_peach.jpg',
                lightColor: '#e9abb8',
                darkColor: '#0040ff',
                defaultIntensity: 0.5,
            },
            {
                identifier: 'imgly_duotone_clash',
                name: 'Clash',
                thumbnailURI: './items/imgly_duotone_clash.jpg',
                lightColor: '#f41a0f',
                darkColor: '#23007c',
                defaultIntensity: 0.5,
            },
            {
                identifier: 'imgly_duotone_plum',
                name: 'Plum',
                thumbnailURI: './items/imgly_duotone_plum.jpg',
                lightColor: '#74d7ff',
                darkColor: '#23007c',
                defaultIntensity: 0.5,
            },
            {
                identifier: 'imgly_duotone_breezy',
                name: 'Breezy',
                thumbnailURI: './items/imgly_duotone_breezy.jpg',
                lightColor: '#68fdff',
                darkColor: '#c20000',
                defaultIntensity: 0.5,
            },
            {
                identifier: 'imgly_duotone_deepblue',
                name: 'Deep Blue',
                thumbnailURI: './items/imgly_duotone_deepblue.jpg',
                lightColor: '#2de9eb',
                darkColor: '#58007c',
                defaultIntensity: 0.5,
            },
            {
                identifier: 'imgly_duotone_frog',
                name: 'Frog',
                thumbnailURI: './items/imgly_duotone_frog.jpg',
                lightColor: '#5bff60',
                darkColor: '#7f23a9',
                defaultIntensity: 0.5,
            },
            {
                identifier: 'imgly_duotone_sunset',
                name: 'Sunset',
                thumbnailURI: './items/imgly_duotone_sunset.jpg',
                lightColor: '#f8ea46',
                darkColor: '#c400be',
                defaultIntensity: 0.5,
            },
        ],
    },
    {
        identifier: 'imgly_filter_category_bw',
        name: 'B & W',
        thumbnailURI: './categories/b&w.jpg',
        items: [
            {
                identifier: 'imgly_lut_ad1920',
                name: '1920 A.D.',
                thumbnailURI: './items/imgly_lut_ad1920.jpg',
                lutURI: './items/imgly_lut_ad1920_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_bw',
                name: 'Greyed',
                thumbnailURI: './items/imgly_lut_bw.jpg',
                lutURI: './items/imgly_lut_bw_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_x400',
                name: 'Dusty',
                thumbnailURI: './items/imgly_lut_x400.jpg',
                lutURI: './items/imgly_lut_dusty_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_litho',
                name: 'Litho',
                thumbnailURI: './items/imgly_lut_litho.jpg',
                lutURI: './items/imgly_lut_litho_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_sepiahigh',
                name: 'Sepia',
                thumbnailURI: './items/imgly_lut_sepiahigh.jpg',
                lutURI: './items/imgly_lut_sepia_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_plate',
                name: 'Weathered',
                thumbnailURI: './items/imgly_lut_plate.jpg',
                lutURI: './items/imgly_lut_weathered_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_sin',
                name: 'Hard Stuff',
                thumbnailURI: './items/imgly_lut_sin.jpg',
                lutURI: './items/imgly_lut_hard_stuff_8_8_512.png',
                defaultIntensity: 1,
                horizontalTileCount: 8,
                verticalTileCount: 8,
            },
        ],
    },
    {
        identifier: 'imgly_filter_category_vintage',
        name: 'Vintage',
        thumbnailURI: './categories/vintage.jpg',
        items: [
            {
                identifier: 'imgly_lut_blues',
                name: 'Polaroid',
                thumbnailURI: './items/imgly_lut_blues.jpg',
                lutURI: './items/imgly_lut_polaroid_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_front',
                name: 'Sunny 70s',
                thumbnailURI: './items/imgly_lut_front.jpg',
                lutURI: './items/imgly_lut_sunny_70s_8_8_512.png',
                defaultIntensity: 1,
                horizontalTileCount: 8,
                verticalTileCount: 8,
            },
            {
                identifier: 'imgly_lut_texas',
                name: 'Oldtimer',
                thumbnailURI: './items/imgly_lut_texas.jpg',
                lutURI: './items/imgly_lut_oldtimer_8_8_512.png',
                defaultIntensity: 1,
                horizontalTileCount: 8,
                verticalTileCount: 8,
            },
            {
                identifier: 'imgly_lut_celsius',
                name: 'Inferno',
                thumbnailURI: './items/imgly_lut_celsius.jpg',
                lutURI: './items/imgly_lut_inferno_8_8_512.png',
                defaultIntensity: 1,
                horizontalTileCount: 8,
                verticalTileCount: 8,
            },
            {
                identifier: 'imgly_lut_cool',
                name: 'Snappy',
                thumbnailURI: './items/imgly_lut_cool.jpg',
                lutURI: './items/imgly_lut_snappy_5_5_128.png',
                defaultIntensity: 1,
            },
        ],
    },
    {
        identifier: 'imgly_filter_category_smooth',
        name: 'Smooth',
        thumbnailURI: './categories/smooth.jpg',
        items: [
            {
                identifier: 'imgly_lut_chest',
                name: 'Chestnut',
                thumbnailURI: './items/imgly_lut_chest.jpg',
                lutURI: './items/imgly_lut_chestnut_8_8_512.png',
                defaultIntensity: 1,
                horizontalTileCount: 8,
                verticalTileCount: 8,
            },
            {
                identifier: 'imgly_lut_winter',
                name: 'Softy',
                thumbnailURI: './items/imgly_lut_winter.jpg',
                lutURI: './items/imgly_lut_softly_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_kdynamic',
                name: 'Pebble',
                thumbnailURI: './items/imgly_lut_kdynamic.jpg',
                lutURI: './items/imgly_lut_pebble_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_fall',
                name: 'Moss',
                thumbnailURI: './items/imgly_lut_fall.jpg',
                lutURI: './items/imgly_lut_moss_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_lenin',
                name: 'Lemon',
                thumbnailURI: './items/imgly_lut_lenin.jpg',
                lutURI: './items/imgly_lut_lemon_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_pola669',
                name: 'Green Gap',
                thumbnailURI: './items/imgly_lut_pola669.jpg',
                lutURI: './items/imgly_lut_green_gap_5_5_128.png',
                defaultIntensity: 1,
            },
        ],
    },
    {
        identifier: 'imgly_filter_category_cold',
        name: 'Cold',
        thumbnailURI: './categories/cold.jpg',
        items: [
            {
                identifier: 'imgly_lut_elder',
                name: 'Colla',
                thumbnailURI: './items/imgly_lut_elder.jpg',
                lutURI: './items/imgly_lut_colla_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_orchid',
                name: 'Solanus',
                thumbnailURI: './items/imgly_lut_orchid.jpg',
                lutURI: './items/imgly_lut_solanus_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_bleached',
                name: 'Kalmen',
                thumbnailURI: './items/imgly_lut_bleached.jpg',
                lutURI: './items/imgly_lut_kalmen_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_bleachedblue',
                name: 'Joran',
                thumbnailURI: './items/imgly_lut_bleachedblue.jpg',
                lutURI: './items/imgly_lut_joran_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_breeze',
                name: 'Levante',
                thumbnailURI: './items/imgly_lut_breeze.jpg',
                lutURI: './items/imgly_lut_levante_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_blueshadows',
                name: 'Zephyr',
                thumbnailURI: './items/imgly_lut_blueshadows.jpg',
                lutURI: './items/imgly_lut_zephyr_5_5_128.png',
                defaultIntensity: 1,
            },
        ],
    },
    {
        identifier: 'imgly_filter_category_warm',
        name: 'Warm',
        thumbnailURI: './categories/warm.jpg',
        items: [
            {
                identifier: 'imgly_lut_sunset',
                name: 'Golden',
                thumbnailURI: './items/imgly_lut_sunset.jpg',
                lutURI: './items/imgly_lut_golden_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_eighties',
                name: 'Low Fire',
                thumbnailURI: './items/imgly_lut_eighties.jpg',
                lutURI: './items/imgly_lut_low_fire_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_evening',
                name: 'Sunrise',
                thumbnailURI: './items/imgly_lut_evening.jpg',
                lutURI: './items/imgly_lut_sunrise_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_k2',
                name: 'Flat Black',
                thumbnailURI: './items/imgly_lut_k2.jpg',
                lutURI: './items/imgly_lut_flat_black_8_8_512.png',
                defaultIntensity: 1,
                horizontalTileCount: 8,
                verticalTileCount: 8,
            },
            {
                identifier: 'imgly_lut_nogreen',
                name: 'Pumpkin',
                thumbnailURI: './items/imgly_lut_nogreen.jpg',
                lutURI: './items/imgly_lut_pumpkin_5_5_128.png',
                defaultIntensity: 1,
            },
        ],
    },
    {
        identifier: 'imgly_filter_category_legacy',
        name: 'Legacy',
        thumbnailURI: './categories/legacy.jpg',
        items: [
            {
                identifier: 'imgly_lut_ancient',
                name: 'Ancient',
                thumbnailURI: './items/imgly_lut_ancient.jpg',
                lutURI: './items/imgly_lut_ancient_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_cottoncandy',
                name: 'Candy',
                thumbnailURI: './items/imgly_lut_cottoncandy.jpg',
                lutURI: './items/imgly_lut_cottoncandy_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_classic',
                name: 'Classic',
                thumbnailURI: './items/imgly_lut_classic.jpg',
                lutURI: './items/imgly_lut_classic_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_colorful',
                name: 'Colorful',
                thumbnailURI: './items/imgly_lut_colorful.jpg',
                lutURI: './items/imgly_lut_colorful_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_creamy',
                name: 'Creamy',
                thumbnailURI: './items/imgly_lut_creamy.jpg',
                lutURI: './items/imgly_lut_creamy_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_fixie',
                name: 'Fixie',
                thumbnailURI: './items/imgly_lut_fixie.jpg',
                lutURI: './items/imgly_lut_fixie_8_8_512.png',
                defaultIntensity: 1,
                horizontalTileCount: 8,
                verticalTileCount: 8,
            },
            {
                identifier: 'imgly_lut_food',
                name: 'Food',
                thumbnailURI: './items/imgly_lut_food.jpg',
                lutURI: './items/imgly_lut_food_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_fridge',
                name: 'Fridge',
                thumbnailURI: './items/imgly_lut_fridge.jpg',
                lutURI: './items/imgly_lut_fridge_8_8_512.png',
                defaultIntensity: 1,
                horizontalTileCount: 8,
                verticalTileCount: 8,
            },
            {
                identifier: 'imgly_lut_glam',
                name: 'Glam',
                thumbnailURI: './items/imgly_lut_glam.jpg',
                lutURI: './items/imgly_lut_glam_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_gobblin',
                name: 'Gobblin',
                thumbnailURI: './items/imgly_lut_gobblin.jpg',
                lutURI: './items/imgly_lut_gobblin_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_highcontrast',
                name: 'Hicon',
                thumbnailURI: './items/imgly_lut_highcontrast.jpg',
                lutURI: './items/imgly_lut_highcontrast_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_highcarb',
                name: 'High Carb',
                thumbnailURI: './items/imgly_lut_highcarb.jpg',
                lutURI: './items/imgly_lut_highcarb_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_k1',
                name: 'K1',
                thumbnailURI: './items/imgly_lut_k1.jpg',
                lutURI: './items/imgly_lut_k1_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_k6',
                name: 'K6',
                thumbnailURI: './items/imgly_lut_k6.jpg',
                lutURI: './items/imgly_lut_k6_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_keen',
                name: 'Keen',
                thumbnailURI: './items/imgly_lut_keen.jpg',
                lutURI: './items/imgly_lut_keen_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_lomo',
                name: 'Lomo',
                thumbnailURI: './items/imgly_lut_lomo.jpg',
                lutURI: './items/imgly_lut_lomo_8_8_512.png',
                defaultIntensity: 1,
                horizontalTileCount: 8,
                verticalTileCount: 8,
            },
            {
                identifier: 'imgly_lut_lomo100',
                name: 'Lomo 100',
                thumbnailURI: './items/imgly_lut_lomo100.jpg',
                lutURI: './items/imgly_lut_lomo100_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_lucid',
                name: 'Lucid',
                thumbnailURI: './items/imgly_lut_lucid.jpg',
                lutURI: './items/imgly_lut_lucid_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_mellow',
                name: 'Mellow',
                thumbnailURI: './items/imgly_lut_mellow.jpg',
                lutURI: './items/imgly_lut_mellow_8_8_512.png',
                defaultIntensity: 1,
                horizontalTileCount: 8,
                verticalTileCount: 8,
            },
            {
                identifier: 'imgly_lut_neat',
                name: 'Neat',
                thumbnailURI: './items/imgly_lut_neat.jpg',
                lutURI: './items/imgly_lut_neat_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_pale',
                name: 'Pale',
                thumbnailURI: './items/imgly_lut_pale.jpg',
                lutURI: './items/imgly_lut_pale_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_pitched',
                name: 'Pitched',
                thumbnailURI: './items/imgly_lut_pitched.jpg',
                lutURI: './items/imgly_lut_pitched_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_polasx',
                name: 'Pola SX',
                thumbnailURI: './items/imgly_lut_polasx.jpg',
                lutURI: './items/imgly_lut_polasx_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_pro400',
                name: 'Pro 400',
                thumbnailURI: './items/imgly_lut_pro400.jpg',
                lutURI: './items/imgly_lut_pro400_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_quozi',
                name: 'Quozi',
                thumbnailURI: './items/imgly_lut_quozi.jpg',
                lutURI: './items/imgly_lut_quozi_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_settled',
                name: 'Settled',
                thumbnailURI: './items/imgly_lut_settled.jpg',
                lutURI: './items/imgly_lut_settled_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_seventies',
                name: 'Seventies',
                thumbnailURI: './items/imgly_lut_seventies.jpg',
                lutURI: './items/imgly_lut_seventies_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_soft',
                name: 'Soft',
                thumbnailURI: './items/imgly_lut_soft.jpg',
                lutURI: './items/imgly_lut_soft_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_steel',
                name: 'Steel',
                thumbnailURI: './items/imgly_lut_steel.jpg',
                lutURI: './items/imgly_lut_steel_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_summer',
                name: 'Summer',
                thumbnailURI: './items/imgly_lut_summer.jpg',
                lutURI: './items/imgly_lut_summer_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_tender',
                name: 'Tender',
                thumbnailURI: './items/imgly_lut_tender.jpg',
                lutURI: './items/imgly_lut_tender_5_5_128.png',
                defaultIntensity: 1,
            },
            {
                identifier: 'imgly_lut_twilight',
                name: 'Twilight',
                thumbnailURI: './items/imgly_lut_twilight.jpg',
                lutURI: './items/imgly_lut_twilight_5_5_128.png',
                defaultIntensity: 1,
            },
        ],
    },
];

var metadata$2 = [
    {
        identifier: 'imgly_font_open_sans_bold',
        fontFamily: 'Open Sans',
        fontWeight: 'bold',
        fontURI: './fonts/imgly_font_open_sans_bold.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 2189,
            descender: -640,
        },
    },
    {
        identifier: 'imgly_font_aleo_bold',
        fontFamily: 'Aleo',
        fontWeight: 'bold',
        fontURI: './fonts/imgly_font_aleo_bold.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 1919,
            descender: -409,
        },
    },
    {
        identifier: 'imgly_font_amaticsc',
        fontFamily: 'Amaticsc',
        fontWeight: 'normal',
        fontURI: './fonts/imgly_font_amaticsc.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 2332,
            descender: -583,
        },
    },
    {
        identifier: 'imgly_font_bernier_regular',
        fontFamily: 'Bernier',
        fontWeight: 'normal',
        fontURI: './fonts/imgly_font_bernier_regular.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 2007,
            descender: -552,
        },
    },
    {
        identifier: 'imgly_font_cheque_regular',
        fontFamily: 'Cheque',
        fontWeight: 'normal',
        fontURI: './fonts/imgly_font_cheque_regular.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 2007,
            descender: -552,
        },
    },
    {
        identifier: 'imgly_font_gagalin_regular',
        fontFamily: 'Gagalin',
        fontWeight: 'normal',
        fontURI: './fonts/imgly_font_gagalin_regular.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 1987,
            descender: -628,
        },
    },
    {
        identifier: 'imgly_font_hagin_caps_thin',
        fontFamily: 'Hagin Caps',
        fontWeight: 200,
        fontURI: './fonts/imgly_font_hagin_caps_thin.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 1964,
            descender: -482,
        },
    },
    {
        identifier: 'imgly_font_intro_inline',
        fontFamily: 'Intro Inline',
        fontWeight: 'normal',
        fontURI: './fonts/imgly_font_intro_inline.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 1944,
            descender: -548,
        },
    },
    {
        identifier: 'imgly_font_lobster',
        fontFamily: 'Lobster',
        fontWeight: 'normal',
        fontURI: './fonts/imgly_font_lobster.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 2048,
            descender: -552,
        },
    },
    {
        identifier: 'imgly_font_nexa_script',
        fontFamily: 'Nexa Script',
        fontWeight: 'normal',
        fontURI: './fonts/imgly_font_nexa_script.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 1835,
            descender: -663,
        },
    },
    {
        identifier: 'imgly_font_panton_blackitalic_caps',
        fontFamily: 'Panton',
        fontWeight: 800,
        fontStyle: 'italic',
        fontURI: './fonts/imgly_font_panton_blackitalic_caps.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 2033,
            descender: -572,
        },
    },
    {
        identifier: 'imgly_font_panton_lightitalic_caps',
        fontFamily: 'Panton',
        fontWeight: 200,
        fontStyle: 'italic',
        fontURI: './fonts/imgly_font_panton_lightitalic_caps.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 1961,
            descender: -556,
        },
    },
    {
        identifier: 'imgly_font_perfograma',
        fontFamily: 'Perfograma',
        fontWeight: 'normal',
        fontURI: './fonts/imgly_font_perfograma.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 1982,
            descender: -842,
        },
    },
    {
        identifier: 'imgly_font_trash_hand',
        fontFamily: 'Trash Hand',
        fontWeight: 'normal',
        fontURI: './fonts/imgly_font_trash_hand.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 1554,
            descender: -663,
        },
    },
    {
        identifier: 'imgly_font_abril_fatface_regular',
        fontFamily: 'Abril Fatface',
        fontWeight: 'normal',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_abril_fatface_regular.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 1000,
            ascender: 1058,
            descender: -291,
        },
    },
    {
        identifier: 'imgly_font_montserrat_light',
        fontFamily: 'Montserrat Light',
        fontWeight: 'normal',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_montserrat_light.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 1000,
            ascender: 968,
            descender: -251,
        },
    },
    {
        identifier: 'imgly_font_wolesbro',
        fontFamily: 'Wolesbro',
        fontWeight: 'normal',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_wolesbro.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 1849,
            descender: -1123,
        },
    },
    {
        identifier: 'imgly_font_permanent_marker',
        fontFamily: 'Permanent Marker',
        fontWeight: 'normal',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_permanent_marker.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 2272,
            descender: -686,
        },
    },
    {
        identifier: 'imgly_font_panton_light_italic_caps',
        fontFamily: 'Panton Caps',
        fontWeight: 'lighter',
        fontStyle: 'italic',
        fontURI: './fonts/imgly_font_panton_light_italic_caps.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 1000,
            ascender: 940,
            descender: -260,
        },
    },
    {
        identifier: 'imgly_font_panton_black_italic_caps',
        fontFamily: 'Panton Caps',
        fontWeight: 800,
        fontStyle: 'italic',
        fontURI: './fonts/imgly_font_panton_black_italic_caps.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 1000,
            ascender: 940,
            descender: -260,
        },
    },
    {
        identifier: 'imgly_font_panton_light_caps',
        fontFamily: 'Panton Caps',
        fontWeight: 'lighter',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_panton_light_caps.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 1000,
            ascender: 940,
            descender: -260,
        },
    },
    {
        identifier: 'imgly_font_panton_black_caps',
        fontFamily: 'Panton Caps',
        fontWeight: 800,
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_panton_black_caps.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 1000,
            ascender: 940,
            descender: -260,
        },
    },
    {
        identifier: 'imgly_font_amberlight',
        fontFamily: 'Amberlight',
        fontWeight: 'normal',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_amberlight.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 1000,
            ascender: 750,
            descender: -250,
        },
    },
    {
        identifier: 'imgly_font_ultra',
        fontFamily: 'Ultra',
        fontWeight: 'normal',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_ultra.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 2066,
            descender: -561,
        },
    },
    {
        identifier: 'imgly_font_galano_grotesque_bold',
        fontFamily: 'Galano Grotesque',
        fontWeight: 'bold',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_galano_grotesque_bold.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 1000,
            ascender: 800,
            descender: -200,
        },
    },
    {
        identifier: 'imgly_font_bungee_inline',
        fontFamily: 'Bungee Inline',
        fontWeight: 'normal',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_bungee_inline.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 1000,
            ascender: 860,
            descender: -140,
        },
    },
    {
        identifier: 'imgly_font_petit_formal_script',
        fontFamily: 'Petit Formal Script',
        fontWeight: 'normal',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_petit_formal_script.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 2033,
            descender: -527,
        },
    },
    {
        identifier: 'imgly_font_summer_font_light',
        fontFamily: 'Summer Font',
        fontWeight: 'normal',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_summer_font_light.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 2189,
            descender: -600,
        },
    },
    {
        identifier: 'imgly_font_handycheera_regular',
        fontFamily: 'Handycheera',
        fontWeight: 'normal',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_handycheera_regular.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 2199,
            descender: -808,
        },
    },
    {
        identifier: 'imgly_font_rasa_regular',
        fontFamily: 'Rasa',
        fontWeight: 'normal',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_rasa_regular.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2750,
            ascender: 2300,
            descender: -1050,
        },
    },
    {
        identifier: 'imgly_font_rasa_500',
        fontFamily: 'Rasa',
        fontWeight: 500,
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_rasa_500.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2750,
            ascender: 2300,
            descender: -1050,
        },
    },
    {
        identifier: 'imgly_font_campton_bold',
        fontFamily: 'Campton Book',
        fontWeight: 'bold',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_campton_bold.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 1000,
            ascender: 770,
            descender: -294,
        },
    },
    {
        identifier: 'imgly_font_ostrich_sans_black',
        fontFamily: 'Ostrich',
        fontWeight: 800,
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_ostrich_sans_black.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 1513,
            descender: -235,
        },
    },
    {
        identifier: 'imgly_font_ostrich_sans_bold',
        fontFamily: 'Ostrich',
        fontWeight: 'bold',
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_ostrich_sans_bold.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 2048,
            ascender: 1513,
            descender: -235,
        },
    },
    {
        identifier: 'imgly_font_ostrich_sans_heavy',
        fontFamily: 'Ostrich',
        fontWeight: 900,
        fontStyle: 'normal',
        fontURI: './fonts/imgly_font_ostrich_sans_heavy.woff',
        format: 'woff',
        textMetrics: {
            unitsPerEm: 1000,
            ascender: 674,
            descender: 0,
        },
    },
];

var metadata$3 = [
    {
        identifier: FocusIdentifier.RADIAL,
        thumbnailURI: './items/radial.png',
    },
    {
        identifier: FocusIdentifier.MIRRORED,
        thumbnailURI: './items/mirrored.png',
    },
    {
        identifier: FocusIdentifier.LINEAR,
        thumbnailURI: './items/linear.png',
    },
    {
        identifier: FocusIdentifier.GAUSSIAN,
        thumbnailURI: './items/gaussian.png',
    },
];

var metadata$4 = [
    {
        identifier: 'basics',
        name: 'Basics',
        items: [
            {
                identifier: AdjustmentIdentifier.BRIGHTNESS,
            },
            {
                identifier: AdjustmentIdentifier.CONTRAST,
            },
            {
                identifier: AdjustmentIdentifier.SATURATION,
            },
            {
                identifier: AdjustmentIdentifier.GAMMA,
            },
        ],
    },
    {
        identifier: 'refinements',
        name: 'Refinements',
        items: [
            {
                identifier: AdjustmentIdentifier.CLARITY,
            },
            {
                identifier: AdjustmentIdentifier.SHADOWS,
            },
            {
                identifier: AdjustmentIdentifier.HIGHLIGHTS,
            },
            {
                identifier: AdjustmentIdentifier.EXPOSURE,
            },
            {
                identifier: AdjustmentIdentifier.BLACKS,
            },
            {
                identifier: AdjustmentIdentifier.WHITES,
            },
            {
                identifier: AdjustmentIdentifier.TEMPERATURE,
            },
            {
                identifier: AdjustmentIdentifier.SHARPNESS,
            },
        ],
    },
];

var metadata$5 = [
    {
        identifier: 'imgly_sticker_emoticons',
        name: 'Emoticons',
        thumbnailURI: './categories/emoticons.png',
        items: [
            {
                identifier: 'imgly_sticker_emoticons_grin',
                stickerURI: './emoticons/imgly_sticker_emoticons_grin.svg',
                tintMode: 'none',
                name: 'Grin',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_laugh',
                stickerURI: './emoticons/imgly_sticker_emoticons_laugh.svg',
                tintMode: 'none',
                name: 'Laugh',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_smile',
                stickerURI: './emoticons/imgly_sticker_emoticons_smile.svg',
                tintMode: 'none',
                name: 'Smile',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_wink',
                stickerURI: './emoticons/imgly_sticker_emoticons_wink.svg',
                tintMode: 'none',
                name: 'Wink',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_tongue_out_wink',
                stickerURI: './emoticons/imgly_sticker_emoticons_tongue_out_wink.svg',
                tintMode: 'none',
                name: 'Tongue out wink',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_angel',
                stickerURI: './emoticons/imgly_sticker_emoticons_angel.svg',
                tintMode: 'none',
                name: 'Angel',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_kisses',
                stickerURI: './emoticons/imgly_sticker_emoticons_kisses.svg',
                tintMode: 'none',
                name: 'Kisses',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_loving',
                stickerURI: './emoticons/imgly_sticker_emoticons_loving.svg',
                tintMode: 'none',
                name: 'Loving',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_kiss',
                stickerURI: './emoticons/imgly_sticker_emoticons_kiss.svg',
                tintMode: 'none',
                name: 'Kiss',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_wave',
                stickerURI: './emoticons/imgly_sticker_emoticons_wave.svg',
                tintMode: 'none',
                name: 'Wave',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_nerd',
                stickerURI: './emoticons/imgly_sticker_emoticons_nerd.svg',
                tintMode: 'none',
                name: 'Nerd',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_cool',
                stickerURI: './emoticons/imgly_sticker_emoticons_cool.svg',
                tintMode: 'none',
                name: 'Cool',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_blush',
                stickerURI: './emoticons/imgly_sticker_emoticons_blush.svg',
                tintMode: 'none',
                name: 'Blush',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_duckface',
                stickerURI: './emoticons/imgly_sticker_emoticons_duckface.svg',
                tintMode: 'none',
                name: 'Duckface',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_furious',
                stickerURI: './emoticons/imgly_sticker_emoticons_furious.svg',
                tintMode: 'none',
                name: 'Furious',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_angry',
                stickerURI: './emoticons/imgly_sticker_emoticons_angry.svg',
                tintMode: 'none',
                name: 'Angry',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_steaming_furious',
                stickerURI: './emoticons/imgly_sticker_emoticons_steaming_furious.svg',
                tintMode: 'none',
                name: 'Steaming Furious',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_sad',
                stickerURI: './emoticons/imgly_sticker_emoticons_sad.svg',
                tintMode: 'none',
                name: 'Sad',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_anxious',
                stickerURI: './emoticons/imgly_sticker_emoticons_anxious.svg',
                tintMode: 'none',
                name: 'Anxious',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_cry',
                stickerURI: './emoticons/imgly_sticker_emoticons_cry.svg',
                tintMode: 'none',
                name: 'Cry',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_sobbing',
                stickerURI: './emoticons/imgly_sticker_emoticons_sobbing.svg',
                tintMode: 'none',
                name: 'Sobbing',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_loud_cry',
                stickerURI: './emoticons/imgly_sticker_emoticons_loud_cry.svg',
                tintMode: 'none',
                name: 'Loud Cry',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_wide_grin',
                stickerURI: './emoticons/imgly_sticker_emoticons_wide_grin.svg',
                tintMode: 'none',
                name: 'Wide grin',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_impatient',
                stickerURI: './emoticons/imgly_sticker_emoticons_impatient.svg',
                tintMode: 'none',
                name: 'Impatient',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_tired',
                stickerURI: './emoticons/imgly_sticker_emoticons_tired.svg',
                tintMode: 'none',
                name: 'Tired',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_asleep',
                stickerURI: './emoticons/imgly_sticker_emoticons_asleep.svg',
                tintMode: 'none',
                name: 'Asleep',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_sleepy',
                stickerURI: './emoticons/imgly_sticker_emoticons_sleepy.svg',
                tintMode: 'none',
                name: 'Sleepy',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_deceased',
                stickerURI: './emoticons/imgly_sticker_emoticons_deceased.svg',
                tintMode: 'none',
                name: 'Deceased',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_attention',
                stickerURI: './emoticons/imgly_sticker_emoticons_attention.svg',
                tintMode: 'none',
                name: 'Attention',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_question',
                stickerURI: './emoticons/imgly_sticker_emoticons_question.svg',
                tintMode: 'none',
                name: 'Question',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_not_speaking_to_you',
                stickerURI: './emoticons/imgly_sticker_emoticons_not_speaking_to_you.svg',
                tintMode: 'none',
                name: 'Not speaking to you',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_sick',
                stickerURI: './emoticons/imgly_sticker_emoticons_sick.svg',
                tintMode: 'none',
                name: 'Sick',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_pumpkin',
                stickerURI: './emoticons/imgly_sticker_emoticons_pumpkin.svg',
                tintMode: 'none',
                name: 'Pumpkin',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_boxer',
                stickerURI: './emoticons/imgly_sticker_emoticons_boxer.svg',
                tintMode: 'none',
                name: 'Boxer',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_idea',
                stickerURI: './emoticons/imgly_sticker_emoticons_idea.svg',
                tintMode: 'none',
                name: 'Idea',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_smoking',
                stickerURI: './emoticons/imgly_sticker_emoticons_smoking.svg',
                tintMode: 'none',
                name: 'Smoking',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_beer',
                stickerURI: './emoticons/imgly_sticker_emoticons_beer.svg',
                tintMode: 'none',
                name: 'Beer',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_skateboard',
                stickerURI: './emoticons/imgly_sticker_emoticons_skateboard.svg',
                tintMode: 'none',
                name: 'Skateboard',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_guitar',
                stickerURI: './emoticons/imgly_sticker_emoticons_guitar.svg',
                tintMode: 'none',
                name: 'Guitar',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_music',
                stickerURI: './emoticons/imgly_sticker_emoticons_music.svg',
                tintMode: 'none',
                name: 'Music',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_sunbathing',
                stickerURI: './emoticons/imgly_sticker_emoticons_sunbathing.svg',
                tintMode: 'none',
                name: 'Sunbathing',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_hippie',
                stickerURI: './emoticons/imgly_sticker_emoticons_hippie.svg',
                tintMode: 'none',
                name: 'Hippie',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_humourous',
                stickerURI: './emoticons/imgly_sticker_emoticons_humourous.svg',
                tintMode: 'none',
                name: 'Humourous',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_hitman',
                stickerURI: './emoticons/imgly_sticker_emoticons_hitman.svg',
                tintMode: 'none',
                name: 'Hitman',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_harry_potter',
                stickerURI: './emoticons/imgly_sticker_emoticons_harry_potter.svg',
                tintMode: 'none',
                name: 'Harry Potter',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_business',
                stickerURI: './emoticons/imgly_sticker_emoticons_business.svg',
                tintMode: 'none',
                name: 'Business',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_batman',
                stickerURI: './emoticons/imgly_sticker_emoticons_batman.svg',
                tintMode: 'none',
                name: 'Batman',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_skull',
                stickerURI: './emoticons/imgly_sticker_emoticons_skull.svg',
                tintMode: 'none',
                name: 'Skull',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_ninja',
                stickerURI: './emoticons/imgly_sticker_emoticons_ninja.svg',
                tintMode: 'none',
                name: 'Ninja',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_masked',
                stickerURI: './emoticons/imgly_sticker_emoticons_masked.svg',
                tintMode: 'none',
                name: 'Masked',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_alien',
                stickerURI: './emoticons/imgly_sticker_emoticons_alien.svg',
                tintMode: 'none',
                name: 'Alien',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_wrestler',
                stickerURI: './emoticons/imgly_sticker_emoticons_wrestler.svg',
                tintMode: 'none',
                name: 'Wrestler',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_devil',
                stickerURI: './emoticons/imgly_sticker_emoticons_devil.svg',
                tintMode: 'none',
                name: 'Devil',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_star',
                stickerURI: './emoticons/imgly_sticker_emoticons_star.svg',
                tintMode: 'none',
                name: 'Star',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_baby_chicken',
                stickerURI: './emoticons/imgly_sticker_emoticons_baby_chicken.svg',
                tintMode: 'none',
                name: 'Baby Chicken',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_rabbit',
                stickerURI: './emoticons/imgly_sticker_emoticons_rabbit.svg',
                tintMode: 'none',
                name: 'Rabbit',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_pig',
                stickerURI: './emoticons/imgly_sticker_emoticons_pig.svg',
                tintMode: 'none',
                name: 'Pig',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_emoticons_chicken',
                stickerURI: './emoticons/imgly_sticker_emoticons_chicken.svg',
                tintMode: 'none',
                name: 'Chicken',
                resizeMode: 'keepAspect',
            },
        ],
    },
    {
        identifier: 'imgly_sticker_shapes',
        name: 'Shapes',
        thumbnailURI: './categories/shapes.png',
        items: [
            {
                identifier: 'imgly_sticker_shapes_badge_01',
                stickerURI: './shapes/imgly_sticker_shapes_badge_01.svg',
                tintMode: 'solid',
                name: 'Shape Badge 01',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_04',
                stickerURI: './shapes/imgly_sticker_shapes_badge_04.svg',
                tintMode: 'solid',
                name: 'Shape Badge 04',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_12',
                stickerURI: './shapes/imgly_sticker_shapes_badge_12.svg',
                tintMode: 'solid',
                name: 'Shape Badge 12',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_06',
                stickerURI: './shapes/imgly_sticker_shapes_badge_06.svg',
                tintMode: 'solid',
                name: 'Shape Badge 06',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_13',
                stickerURI: './shapes/imgly_sticker_shapes_badge_13.svg',
                tintMode: 'solid',
                name: 'Shape Badge 13',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_36',
                stickerURI: './shapes/imgly_sticker_shapes_badge_36.svg',
                tintMode: 'solid',
                name: 'Shape Badge 36',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_08',
                stickerURI: './shapes/imgly_sticker_shapes_badge_08.svg',
                tintMode: 'solid',
                name: 'Shape Badge 08',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_11',
                stickerURI: './shapes/imgly_sticker_shapes_badge_11.svg',
                tintMode: 'solid',
                name: 'Shape Badge 11',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_35',
                stickerURI: './shapes/imgly_sticker_shapes_badge_35.svg',
                tintMode: 'solid',
                name: 'Shape Badge 35',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_28',
                stickerURI: './shapes/imgly_sticker_shapes_badge_28.svg',
                tintMode: 'solid',
                name: 'Shape Badge 28',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_32',
                stickerURI: './shapes/imgly_sticker_shapes_badge_32.svg',
                tintMode: 'solid',
                name: 'Shape Badge 32',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_15',
                stickerURI: './shapes/imgly_sticker_shapes_badge_15.svg',
                tintMode: 'solid',
                name: 'Shape Badge 15',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_20',
                stickerURI: './shapes/imgly_sticker_shapes_badge_20.svg',
                tintMode: 'solid',
                name: 'Shape Badge 20',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_18',
                stickerURI: './shapes/imgly_sticker_shapes_badge_18.svg',
                tintMode: 'solid',
                name: 'Shape Badge 18',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_badge_19',
                stickerURI: './shapes/imgly_sticker_shapes_badge_19.svg',
                tintMode: 'solid',
                name: 'Shape Badge 19',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_arrow_02',
                stickerURI: './shapes/imgly_sticker_shapes_arrow_02.svg',
                tintMode: 'solid',
                name: 'Shape Arrow 02',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_arrow_03',
                stickerURI: './shapes/imgly_sticker_shapes_arrow_03.svg',
                tintMode: 'solid',
                name: 'Shape Arrow 03',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_spray_01',
                stickerURI: './shapes/imgly_sticker_shapes_spray_01.svg',
                tintMode: 'solid',
                name: 'Shape Spray 01',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_spray_04',
                stickerURI: './shapes/imgly_sticker_shapes_spray_04.svg',
                tintMode: 'solid',
                name: 'Shape Spray 04',
                resizeMode: 'keepAspect',
            },
            {
                identifier: 'imgly_sticker_shapes_spray_03',
                stickerURI: './shapes/imgly_sticker_shapes_spray_03.svg',
                tintMode: 'solid',
                name: 'Shape Spray 03',
                resizeMode: 'keepAspect',
            },
        ],
    },
];

var metadata$6 = [
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_thislayoutisgreat.png',
        identifier: 'imgly_text_design_blocks',
        name: 'Blocks',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_fatandfast.png',
        identifier: 'imgly_text_design_rotated',
        name: 'Rotated',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_summerfeeling.png',
        identifier: 'imgly_text_design_blocks_light',
        name: 'Blocks Light',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_typewithstyle.png',
        identifier: 'imgly_text_design_equal_width',
        name: 'Equal Width',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_inthebox.png',
        identifier: 'imgly_text_design_masked',
        name: 'Masked',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_bluefriday.png',
        identifier: 'imgly_text_design_celebrate',
        name: 'Celebrate',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_decorative.png',
        identifier: 'imgly_text_design_sunshine',
        name: 'Sunshine',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_specialdeals.png',
        identifier: 'imgly_text_design_masked_badge',
        name: 'Masked Badge',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_doublelines.png',
        identifier: 'imgly_text_design_blocks_condensed',
        name: 'Blocks Condensed',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_celebrate.png',
        identifier: 'imgly_text_design_celebrate_simple',
        name: 'Celebrate Simple',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_beerandburger.png',
        identifier: 'imgly_text_design_equal_width_fat',
        name: 'Equal Width Fat',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_watercolor.png',
        identifier: 'imgly_text_design_watercolor',
        name: 'Watercolor',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_particle.png',
        identifier: 'imgly_text_design_particles',
        name: 'Particles',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_yeah.png',
        identifier: 'imgly_text_design_masked_speech_bubble',
        name: 'Masked Speech Bubble',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_thisisadream.png',
        identifier: 'imgly_text_design_masked_speech_bubble_comic',
        name: 'Masked Speech Bubble Comic',
    },
    {
        thumbnailURI: './items/dark/imgly_text_design_icon_fatface.png',
        identifier: 'imgly_text_design_multiline',
        name: 'Multiline',
    },
];

var metadata$7 = [
    {
        thumbnailURI: './items/light/imgly_text_design_icon_thislayoutisgreat.png',
        identifier: 'imgly_text_design_blocks',
        name: 'Blocks',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_fatandfast.png',
        identifier: 'imgly_text_design_rotated',
        name: 'Rotated',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_summerfeeling.png',
        identifier: 'imgly_text_design_blocks_light',
        name: 'Blocks Light',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_typewithstyle.png',
        identifier: 'imgly_text_design_equal_width',
        name: 'Equal Width',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_inthebox.png',
        identifier: 'imgly_text_design_masked',
        name: 'Masked',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_bluefriday.png',
        identifier: 'imgly_text_design_celebrate',
        name: 'Celebrate',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_decorative.png',
        identifier: 'imgly_text_design_sunshine',
        name: 'Sunshine',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_specialdeals.png',
        identifier: 'imgly_text_design_masked_badge',
        name: 'Masked Badge',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_doublelines.png',
        identifier: 'imgly_text_design_blocks_condensed',
        name: 'Blocks Condensed',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_celebrate.png',
        identifier: 'imgly_text_design_celebrate_simple',
        name: 'Celebrate Simple',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_beerandburger.png',
        identifier: 'imgly_text_design_equal_width_fat',
        name: 'Equal Width Fat',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_watercolor.png',
        identifier: 'imgly_text_design_watercolor',
        name: 'Watercolor',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_particle.png',
        identifier: 'imgly_text_design_particles',
        name: 'Particles',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_yeah.png',
        identifier: 'imgly_text_design_masked_speech_bubble',
        name: 'Masked Speech Bubble',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_thisisadream.png',
        identifier: 'imgly_text_design_masked_speech_bubble_comic',
        name: 'Masked Speech Bubble Comic',
    },
    {
        thumbnailURI: './items/light/imgly_text_design_icon_fatface.png',
        identifier: 'imgly_text_design_multiline',
        name: 'Multiline',
    },
];

var metadata$8 = [
    {
        identifier: 'imgly_frame_dia',
        name: 'Dia',
        layoutMode: 'horizontal-inside',
        thumbnailURI: './items/imgly_frame_dia/imgly_frame_dia_thumb.png',
        imageGroups: {
            top: {
                mid: {
                    image: './items/imgly_frame_dia/imgly_frame_dia_top.png',
                    mode: 'repeat',
                },
            },
            left: {
                start: './items/imgly_frame_dia/imgly_frame_dia_top_corner_left.png',
                mid: './items/imgly_frame_dia/imgly_frame_dia_left.png',
                end: './items/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png',
            },
            right: {
                start: './items/imgly_frame_dia/imgly_frame_dia_top_corner_right.png',
                mid: './items/imgly_frame_dia/imgly_frame_dia_right.png',
                end: './items/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png',
            },
            bottom: {
                mid: {
                    image: './items/imgly_frame_dia/imgly_frame_dia_bottom.png',
                    mode: 'repeat',
                },
            },
        },
    },
    {
        identifier: 'imgly_frame_art_decor',
        name: 'Art Decor',
        tintable: true,
        layoutMode: 'horizontal-inside',
        thumbnailURI: './items/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png',
        imageGroups: {
            top: {
                start: './items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png',
                mid: {
                    image: './items/imgly_frame_art_decor/imgly_frame_art_decor_top.png',
                    mode: 'stretch',
                },
                end: './items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png',
            },
            left: {
                mid: {
                    image: './items/imgly_frame_art_decor/imgly_frame_art_decor_left.png',
                    mode: 'stretch',
                },
            },
            right: {
                mid: {
                    image: './items/imgly_frame_art_decor/imgly_frame_art_decor_right.png',
                    mode: 'stretch',
                },
            },
            bottom: {
                start: './items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png',
                mid: {
                    image: './items/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png',
                    mode: 'stretch',
                },
                end: './items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png',
            },
        },
    },
    {
        identifier: 'imgly_frame_black_passepartout',
        name: 'Black Passepartout',
        layoutMode: 'horizontal-inside',
        thumbnailURI: './items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png',
        imageGroups: {
            top: {
                start: './items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png',
                mid: {
                    image: './items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png',
                    mode: 'stretch',
                },
                end: './items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png',
            },
            left: {
                mid: {
                    image: './items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png',
                    mode: 'stretch',
                },
            },
            right: {
                mid: {
                    image: './items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png',
                    mode: 'stretch',
                },
            },
            bottom: {
                start: './items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png',
                mid: {
                    image: './items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png',
                    mode: 'stretch',
                },
                end: './items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png',
            },
        },
    },
    {
        identifier: 'imgly_frame_wood_passepartout',
        name: 'Wood Passepartout',
        layoutMode: 'horizontal-inside',
        thumbnailURI: './items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png',
        imageGroups: {
            top: {
                start: './items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png',
                mid: {
                    image: './items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png',
                    mode: 'stretch',
                },
                end: './items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png',
            },
            left: {
                mid: {
                    image: './items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png',
                    mode: 'stretch',
                },
            },
            right: {
                mid: {
                    image: './items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png',
                    mode: 'stretch',
                },
            },
            bottom: {
                start: './items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png',
                mid: {
                    image: './items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png',
                    mode: 'stretch',
                },
                end: './items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png',
            },
        },
    },
    {
        identifier: 'imgly_frame_lowpoly_shadow',
        name: 'Low Poly',
        layoutMode: 'horizontal-inside',
        thumbnailURI: './items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png',
        imageGroups: {
            top: {
                start: './items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png',
                mid: {
                    image: './items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png',
                    mode: 'stretch',
                },
                end: './items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png',
            },
            left: {
                mid: {
                    image: './items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png',
                    mode: 'stretch',
                },
            },
            right: {
                mid: {
                    image: './items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png',
                    mode: 'stretch',
                },
            },
            bottom: {
                start: './items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png',
                mid: {
                    image: './items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png',
                    mode: 'stretch',
                },
                end: './items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png',
            },
        },
    },
];

var metadata$9 = [
    {
        identifier: 'imgly_transforms_common',
        name: 'Common',
        items: [
            {
                identifier: 'imgly_transform_common_custom',
                name: 'Custom',
                thumbnailURI: '',
                ratio: '*',
            },
            {
                identifier: 'imgly_transform_common_square',
                name: 'Square',
                thumbnailURI: '',
                ratio: 1,
            },
            {
                identifier: 'imgly_transform_common_4',
                name: '4:3',
                thumbnailURI: '',
                ratio: 1.33,
            },
            {
                identifier: 'imgly_transform_common_16',
                name: '16:9',
                thumbnailURI: '',
                ratio: 1.77,
            },
            {
                identifier: 'imgly_transform_common_3',
                name: '3:4',
                thumbnailURI: '',
                ratio: 0.75,
            },
            {
                identifier: 'imgly_transform_common_9',
                name: '9:16',
                thumbnailURI: '',
                ratio: 0.56,
            },
        ],
    },
    {
        identifier: 'imgly_transforms_facebook',
        name: 'Facebook',
        items: [
            {
                identifier: 'imgly_transform_facebook_profile',
                name: 'Profile',
                thumbnailURI: '',
                dimensions: {
                    x: 300,
                    y: 300,
                },
                forceDimensions: true,
                lockDimensions: true,
            },
            {
                identifier: 'imgly_transform_facebook_title',
                name: 'Title',
                thumbnailURI: '',
                dimensions: {
                    x: 1200,
                    y: 627,
                },
                forceDimensions: true,
                lockDimensions: true,
            },
            {
                identifier: 'imgly_transform_facebook_post',
                name: 'Post',
                thumbnailURI: '',
                dimensions: {
                    x: 940,
                    y: 788,
                },
                forceDimensions: true,
                lockDimensions: true,
            },
        ],
    },
    {
        identifier: 'imgly_transforms_instagram',
        name: 'Instagram',
        items: [
            {
                identifier: 'imgly_transform_instagram_landscape',
                name: 'Landscape',
                thumbnailURI: '',
                dimensions: {
                    x: 1080,
                    y: 566,
                },
                forceDimensions: true,
                lockDimensions: true,
            },
            {
                identifier: 'imgly_transform_instagram_portrait',
                name: 'Portrait',
                thumbnailURI: '',
                dimensions: {
                    x: 1080,
                    y: 1350,
                },
                forceDimensions: true,
                lockDimensions: true,
            },
            {
                identifier: 'imgly_transform_instagram_square',
                name: 'Square',
                thumbnailURI: '',
                dimensions: {
                    x: 1080,
                    y: 1080,
                },
                forceDimensions: true,
                lockDimensions: true,
            },
            {
                identifier: 'imgly_transform_instagram_story',
                name: 'Story',
                thumbnailURI: '',
                dimensions: {
                    x: 1080,
                    y: 1920,
                },
                forceDimensions: true,
                lockDimensions: true,
            },
        ],
    },
    {
        identifier: 'imgly_transforms_twitter',
        name: 'Twitter',
        items: [
            {
                identifier: 'imgly_transform_twitter_post',
                name: 'Post',
                thumbnailURI: '',
                dimensions: {
                    x: 1024,
                    y: 512,
                },
                forceDimensions: true,
                lockDimensions: true,
            },
            {
                identifier: 'imgly_transform_twitter_profile',
                name: 'Profile',
                thumbnailURI: '',
                dimensions: {
                    x: 400,
                    y: 400,
                },
                forceDimensions: true,
                lockDimensions: true,
            },
            {
                identifier: 'imgly_transform_twitter_title',
                name: 'Title',
                thumbnailURI: '',
                dimensions: {
                    x: 1500,
                    y: 500,
                },
                forceDimensions: true,
                lockDimensions: true,
            },
        ],
    },
];

/**
 *  The font identifiers of the fonts supported by the text tool
 */
var textFontIDs = [
    'imgly_font_open_sans_bold',
    'imgly_font_aleo_bold',
    'imgly_font_amaticsc',
    'imgly_font_bernier_regular',
    'imgly_font_cheque_regular',
    'imgly_font_gagalin_regular',
    'imgly_font_hagin_caps_thin',
    'imgly_font_intro_inline',
    'imgly_font_lobster',
    'imgly_font_nexa_script',
    'imgly_font_ostrich_sans_black',
    'imgly_font_ostrich_sans_bold',
    'imgly_font_panton_blackitalic_caps',
    'imgly_font_panton_lightitalic_caps',
    'imgly_font_perfograma',
    'imgly_font_trash_hand',
];
var textDesignFontIds = [
    'imgly_font_abril_fatface_regular',
    'imgly_font_montserrat_light',
    'imgly_font_wolesbro',
    'imgly_font_permanent_marker',
    'imgly_font_panton_light_italic_caps',
    'imgly_font_panton_black_italic_caps',
    'imgly_font_panton_light_caps',
    'imgly_font_panton_black_caps',
    'imgly_font_amberlight',
    'imgly_font_ultra',
    'imgly_font_galano_grotesque_bold',
    'imgly_font_bungee_inline',
    'imgly_font_petit_formal_script',
    'imgly_font_summer_font_light',
    'imgly_font_handycheera_regular',
    'imgly_font_rasa_regular',
    'imgly_font_rasa_500',
    'imgly_font_campton_bold',
    'imgly_font_ostrich_sans_bold',
    'imgly_font_ostrich_sans_heavy',
];

var FontManager = /** @class */ (function () {
    function FontManager(assetManager) {
        this.assetManager = assetManager;
        /**
         * A map of all fonts that have already been injected into the head as link or style tags.
         * Not all of these fonts have necessarily been issued to load yet.
         */
        this.injectedFonts = {};
        /**
         * A map of all fonts that have been confirmed to be loaded by the browser.
         */
        this.loadedFonts = {};
    }
    /** For Web fonts, woff format */
    /**
     * Creates the font-face CSS declarations for all given fonts.
     * @param allFonts The Web fonts.
     * @param getAbsolutePath A function that resolves the absolute path for each font asset.
     */
    FontManager.createFontFacesCSS = function (allFonts, getAbsolutePath) {
        return allFonts.map(function (font) {
            var fontPath = getAbsolutePath(font.fontURI);
            return ("@font-face {\n        font-family: \"" + font.fontFamily + "\";\n        src: url('" + fontPath + "') format('" + (font.format || 'woff') + "');\n        font-weight: " + (font.fontWeight || 'normal') + ";\n        font-style: " + (font.fontStyle || 'normal') + ";\n      }");
        });
    };
    /**
     * Returns the font variation with the given identifier.
     * Throws an error if the such a font does not exist.
     * @param identifier The identifier of the font variation
     */
    FontManager.prototype.getFontWithId = function (identifier) {
        var font = this.assetManager.getFontAsset(identifier);
        if (!font) {
            throw new Error('The requested font does not exist as an asset.');
        }
        return font;
    };
    /**
     * Returns whether or not the specified font is currently loaded.
     * @param identifier The font identifier.
     */
    FontManager.prototype.isFontLoaded = function (identifier) {
        return this.loadedFonts[identifier] !== undefined;
    };
    /**
     * Injects declarations for all fonts of the AssetManager into the page.
     * This does not automatically load the fonts. Use {@link loadAllFonts} instead
     * to both inject and immediately start loading the fonts.
     */
    FontManager.prototype.injectAllFonts = function () {
        var allFonts = this.assetManager.getFontAssets();
        this.injectFonts(allFonts);
    };
    /**
     * Injects and loads all fonts of the AssetManager into the page.
     * The promise resolves once all fonts have finished loading.
     */
    FontManager.prototype.loadAllFonts = function () {
        return __awaiter(this, void 0, void 0, function () {
            var allFonts;
            return __generator(this, function (_a) {
                allFonts = this.assetManager.getFontAssets();
                return [2 /*return*/, this.loadFonts(allFonts)];
            });
        });
    };
    /**
     * Loads all fonts with the given identifiers.
     * The promise resolves once all fonts have finished loading.
     * @param identifiers The font identifiers.
     */
    FontManager.prototype.loadFontsWithIdentifiers = function (identifiers) {
        return __awaiter(this, void 0, void 0, function () {
            var fonts;
            var _this = this;
            return __generator(this, function (_a) {
                fonts = identifiers.map(function (id) { return _this.getFontWithId(id); });
                return [2 /*return*/, this.loadFonts(fonts)];
            });
        });
    };
    /**
     * Loads all of the specified fonts.
     * The promise resolves once all fonts have finished loading.
     * @param fonts The fonts to be loaded.
     */
    FontManager.prototype.loadFonts = function (fonts) {
        return __awaiter(this, void 0, void 0, function () {
            var promises;
            var _this = this;
            return __generator(this, function (_a) {
                this.injectFonts(fonts);
                promises = new Array();
                fonts.forEach(function (f) {
                    promises.push(_this.loadFont(f, false));
                });
                return [2 /*return*/, new Promise(function (resolve, reject) {
                        Promise.all(promises).then(function () { return resolve(); }).catch(function (e) { return reject(e); });
                    })];
            });
        });
    };
    /**
     * Loads the specified font.
     * The promise resolves once the font has finished loading and is ready to be used
     * for rendering operations.
     * @param font The font to be loaded
     * @param inject Whether the font should be attempted to be injected.
     * Set to false if you know that the font has already been injected into the page.
     */
    FontManager.prototype.loadFont = function (font, inject) {
        if (inject === void 0) { inject = true; }
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                return [2 /*return*/, new Promise(function (resolve, reject) {
                        if (_this.isFontLoaded(font.identifier)) {
                            resolve();
                        }
                        if (inject) {
                            _this.injectFonts([font]);
                        }
                        // Try to figure out when the font is actually loaded by the browser
                        // and ready to be used
                        var observer = new FontFaceObserver(font);
                        observer.load().then(function () {
                            _this.loadedFonts[font.identifier] = font;
                            resolve();
                        }).catch(function (e) {
                            reject(e);
                        });
                    })];
            });
        });
    };
    /**
     * Loads the font with the specified identifier. Throws an error if no such font exists.
     * @param identifier The identifier of the font to be loaded.
     * @param inject Whether the font should be attempted to be injected.
     * Set to false if you know that the font has already been injected into the page.
     */
    FontManager.prototype.loadFontWithIdentifier = function (identifier, inject) {
        if (inject === void 0) { inject = true; }
        return __awaiter(this, void 0, void 0, function () {
            var font;
            return __generator(this, function (_a) {
                font = this.assetManager.getFontAsset(identifier);
                if (!font) {
                    throw new Error("The requested font asset with identifier " + identifier + " does not exist!");
                }
                return [2 /*return*/, this.loadFont(font, inject)];
            });
        });
    };
    /**
     * Injects the specified fonts into the page without loading them.
     * @param fonts The fonts to be injected.
     */
    FontManager.prototype.injectFonts = function (fonts, getAbsolutePath) {
        if (getAbsolutePath === void 0) { getAbsolutePath = this.assetManager.getAbsolutePathForCategory('font'); }
        var googleFonts = fonts.filter(isGoogleFontAsset);
        var webFonts = fonts.filter(isWebFontAsset);
        if (googleFonts.length > 0) {
            this.addGoogleFontLinks(googleFonts);
        }
        if (webFonts.length > 0) {
            this.addWebFontCSS(webFonts, getAbsolutePath);
        }
    };
    /**
     * Adds a single link element that references all of the given Google fonts
     * to the head of the page.
     * @param allFonts The Google fonts to be injected into the page.
     */
    FontManager.prototype.addGoogleFontLinks = function (allFonts) {
        var _this = this;
        // Make sure we are not adding the same link multiple times
        var fonts = allFonts.filter(function (f) { return !_this.injectedFonts[f.identifier]; });
        if (fonts.length === 0) {
            return;
        }
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = "https://fonts.googleapis.com/css?family=" + fonts.map(function (f) { return f.fontFamily; }).join(',');
        var head = document.getElementsByTagName('head')[0];
        head.appendChild(link);
        allFonts.forEach(function (f) {
            _this.injectedFonts[f.identifier] = f;
        });
    };
    /**
     * Adds a style element that declares all of the specified Web fonts to the head
     * of the page.
     * @param allFonts The fonts to be injected.
     * @param getAbsolutePath A function that resolves the absolute path to each font asset.
     */
    FontManager.prototype.addWebFontCSS = function (allFonts, getAbsolutePath) {
        var _this = this;
        // Make sure we are not adding the same link multiple times
        var fonts = allFonts.filter(function (f) { return !_this.injectedFonts[f.identifier]; });
        if (fonts.length === 0) {
            return;
        }
        var fontFaces = FontManager.createFontFacesCSS(fonts, getAbsolutePath);
        var css = "\n      /* Injected by PhotoEditorSDK */\n      " + fontFaces.join('\n') + "\n    ";
        var styleTag = document.createElement('style');
        styleTag.innerHTML = css;
        document.head.appendChild(styleTag);
        allFonts.forEach(function (f) {
            _this.injectedFonts[f.identifier] = f;
        });
    };
    return FontManager;
}());

var AssetManager = /** @class */ (function () {
    function AssetManager(config) {
        var _this = this;
        this.basePath = 'assets/';
        /** For Editor / UI */
        this.getAssets = function (category) {
            switch (category) {
                case 'overlay':
                    return _this.overlayAssets;
                case 'filter':
                    return _this.filterCategories;
                case 'font':
                    return _this.fontAssets;
                case 'focus':
                    return _this.focusAssets;
                case 'adjustment':
                    return _this.adjustmentCategories;
                case 'sticker':
                    return _this.stickerCategories;
                case 'textdesign':
                    return _this.textDesignAssets;
                case 'frame':
                    return _this.frameAssets;
                case 'transform':
                    return _this.transformCategories;
            }
            return [];
        };
        this.getAbsolutePath = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            return path.join.apply(path, __spread([_this.basePath], args));
        };
        this.getAbsolutePathForCategory = function (assetCategory) {
            return function () {
                var path1 = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    path1[_i] = arguments[_i];
                }
                return _this.getAbsolutePath.apply(_this, __spread([assetCategory], path1));
            };
        };
        this.addCustomStickerAsset = function (stickerAssets, customStickerCategoryIdentifier, customStickerLabel) {
            stickerAssets.forEach(function (stickerAsset) {
                var thumbnailURI = stickerAsset.thumbnailURI, name = stickerAsset.name, image = stickerAsset.sticker, identifier = stickerAsset.identifier, tintMode = stickerAsset.tintMode, resizeMode = stickerAsset.resizeMode;
                var custom = _this.stickerCategories.find(function (s) { return s.identifier === customStickerCategoryIdentifier; });
                var newAsset = {
                    identifier: identifier,
                    name: name,
                    thumbnailURI: thumbnailURI,
                    sticker: image,
                    tintMode: tintMode,
                    resizeMode: resizeMode,
                };
                if (custom && isStickerCategoryDynamic(custom)) {
                    custom.items.push(newAsset);
                }
                else {
                    /**
                     * There's no specified thumbnail for custom stickers,
                     * so first uploaded image gets to be the thumbnail
                     */
                    var newCategory = {
                        identifier: customStickerCategoryIdentifier,
                        name: customStickerLabel,
                        thumbnail: thumbnailURI,
                        items: [newAsset],
                    };
                    _this.stickerCategories = __spread([newCategory], _this.stickerCategories);
                }
            });
            _this.stickerAssets = _this.stickerCategories.reduce(_this.allOptions, []);
        };
        this.getPath = function (source, identifier, key) {
            var item = source.find(function (option) { return option.identifier === identifier; });
            return item ? item[key] || item.path || '' : '';
        };
        this.isNonExistingFont = function (configuredFont) { return !metadata$2.find(function (f) { return f.identifier === configuredFont.identifier; }); };
        if (config && config.basePath) {
            this.basePath = config.basePath;
        }
        /** Filters */
        var allFilters = metadata$1.reduce(this.allOptions, []);
        if (config && config.filter) {
            this.filterCategories = this.configuredCategory(metadata$1, config.filter, allFilters);
        }
        else {
            this.filterCategories = metadata$1;
        }
        this.lutFilterAssets = this.filterCategories
            .reduce(this.allOptions, [])
            .filter(function (f) { return isLUTFilterAsset(f); });
        this.duoToneFilterAssets = this.filterCategories
            .reduce(this.allOptions, [])
            .filter(function (f) { return isDuoToneFilterAsset(f); });
        // /** Adjustments */
        var allAdjustments = metadata$4.reduce(this.allOptions, []);
        if (config && config.adjustment) {
            this.adjustmentCategories = this.configuredCategory(metadata$4, config.adjustment, allAdjustments);
        }
        else {
            this.adjustmentCategories = metadata$4;
        }
        /** Text */
        this.fontAssets = metadata$2.reduce(this.allOptions, []);
        var textToolFontAssets = textFontIDs.map(function (identifier) { return _this.getFontAsset(identifier); });
        if (config && config.text && config.text.fonts) {
            var nonDefaultFonts = config.text.fonts.filter(this.isNonExistingFont);
            textToolFontAssets = config.text.fonts ? __spread(textToolFontAssets, nonDefaultFonts) : textToolFontAssets;
            this.fontAssets = config.text.fonts ? __spread(this.fontAssets, nonDefaultFonts) : this.fontAssets;
        }
        this.textToolFontAssets = textToolFontAssets;
        /** Focus */
        var configuredFocus = config && config.focus && config.focus.items && config.focus.items.length
            ? config.focus.items.map(function (f) { return metadata$3.find(function (i) { return i.identifier === f.identifier; }); })
            : metadata$3;
        this.focusAssets = configuredFocus;
        /** Overlay */
        if (config && config.overlay && config.overlay.items) {
            this.overlayAssets = this.configuredItem(config.overlay.items, metadata, metadata);
        }
        else {
            this.overlayAssets = metadata;
        }
        /** Frame */
        if (config && config.frame && config.frame.items) {
            this.frameAssets = this.configuredItem(config.frame.items, metadata$8, metadata$8);
        }
        else {
            this.frameAssets = metadata$8;
        }
        /** Stickers */
        var allStickers = metadata$5.reduce(this.allOptions, []);
        if (config && config.sticker) {
            this.stickerCategories = this.configuredCategory(metadata$5, config.sticker, allStickers);
        }
        else {
            this.stickerCategories = metadata$5;
        }
        this.stickerAssets = this.stickerCategories.reduce(this.allOptions, []);
        var textdesignConfig = metadata$6;
        if (config && config.theme === 'light') {
            textdesignConfig = metadata$7;
        }
        /** TextDesign */
        this.textDesignAssets =
            config && config.textdesign && config.textdesign.items && config.textdesign.items.length
                ? config.textdesign.items.map(function (f) { return textdesignConfig.find(function (i) { return i.identifier === f.identifier; }); })
                : textdesignConfig;
        this.textDesignToolFontAssets = textDesignFontIds.map(function (identifier) { return _this.getFontAsset(identifier); });
        /** Transform */
        var allRatios = metadata$9.reduce(this.allOptions, []);
        if (config && config.transform) {
            this.transformCategories = this.configuredCategory(metadata$9, config.transform, allRatios);
        }
        else {
            this.transformCategories = metadata$9;
        }
        this.transformAssets = this.transformCategories.reduce(this.allOptions, []);
        this.fontManager = new FontManager(this);
    }
    AssetManager.prototype.getFontManager = function () {
        return this.fontManager;
    };
    /**
     * For Engine
     * TODO: Filter identifier comes with a resolution postfix
     */
    AssetManager.prototype.getAssetSource = function (category, identifier) {
        switch (category) {
            case 'filter':
                var lutFilter = this.getLUTFilterAsset(identifier);
                if (lutFilter) {
                    return this.getAbsolutePath(category, this.getPath(this.lutFilterAssets, identifier, 'lutURI'));
                }
                break;
            case 'overlay':
                return this.getAbsolutePath(category, this.getPath(this.overlayAssets, identifier, 'overlayURI'));
            case 'font':
                return this.getAbsolutePath(category, this.getPath(this.fontAssets, identifier, 'fontURI'));
            case 'sticker':
                var stickerAsset = this.stickerAssets.find(function (s) { return s.identifier === identifier; });
                if (stickerAsset) {
                    if (isStickerAssetDynamic(stickerAsset)) {
                        return stickerAsset.sticker;
                    }
                    else {
                        return this.getAbsolutePath(category, this.getPath(this.stickerAssets, identifier, 'stickerURI'));
                    }
                }
                throw new Error('Cannot resolve this type of sticker asset yet');
            case 'textdesign':
                return this.getAbsolutePath(category, 'engine', identifier);
            case 'frame':
                // Here, identifier is the combination of frame + patch
                return this.getAbsolutePath(category, identifier);
        }
        throw new Error('Cannot resolve this type of asset yet');
    };
    AssetManager.prototype.getDuotoneFilterAsset = function (identifier) {
        return this.duoToneFilterAssets.filter(function (f) { return f.identifier === identifier; })[0];
    };
    AssetManager.prototype.getLUTFilterAsset = function (identifier) {
        return this.lutFilterAssets.filter(function (f) { return f.identifier === identifier; })[0];
    };
    AssetManager.prototype.getOverlayAsset = function (identifier) {
        return this.overlayAssets.filter(function (o) { return o.identifier === identifier; })[0];
    };
    AssetManager.prototype.getStickerAsset = function (identifier) {
        return this.stickerAssets.filter(function (s) { return s.identifier === identifier; })[0];
    };
    AssetManager.prototype.getFontAsset = function (identifier) {
        return this.fontAssets.filter(function (f) { return f.identifier === identifier; })[0];
    };
    AssetManager.prototype.getTextDesignAssets = function (identifier) {
        return this.textDesignAssets.filter(function (t) { return t.identifier === identifier; })[0];
    };
    AssetManager.prototype.getFrameAsset = function (identifier) {
        return this.frameAssets.filter(function (f) { return f.identifier === identifier; })[0];
    };
    AssetManager.prototype.getFontAssets = function () {
        return this.fontAssets;
    };
    AssetManager.prototype.getFontAssetsForText = function () {
        return this.textToolFontAssets;
    };
    AssetManager.prototype.getFontAssetsForTextDesign = function () {
        return this.textDesignToolFontAssets;
    };
    AssetManager.prototype.getFrameAssets = function () {
        return this.frameAssets;
    };
    AssetManager.prototype.allOptions = function (acc, category) {
        if (category.hasOwnProperty('items')) {
            return __spread(acc, category.items);
        }
        return __spread(acc, [category]);
    };
    AssetManager.prototype.configuredCategory = function (categories, configured, allItems) {
        var _this = this;
        if (configured.categories && configured.categories.length) {
            return configured.categories.map(function (configuredCategory) {
                var existing = categories.find(function (c) { return c.identifier === configuredCategory.identifier; });
                if (existing) {
                    /** If the category is existing, ie, the identifier exists, merge it with the current category */
                    return __assign({}, existing, configuredCategory, { items: _this.configuredItem(configuredCategory.items, allItems, existing.items).filter(Boolean) });
                }
                return __assign({}, configuredCategory, { items: _this.configuredItem(configuredCategory.items, allItems, configuredCategory.items).filter(Boolean) });
            });
        }
        return categories;
    };
    AssetManager.prototype.configuredItem = function (items, allItems, defaultItems) {
        if (items && items.length) {
            return items
                .map(function (item) {
                var existing = allItems.find(function (i) { return i.identifier === item.identifier; });
                if (existing) {
                    /** If the item is existing, ie, the identifier exists, merge it with the current item */
                    return __assign({}, existing, item);
                }
                return item;
            })
                .filter(Boolean);
        }
        return defaultItems;
    };
    return AssetManager;
}());

var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

function unwrapExports (x) {
	return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;
}

function createCommonjsModule(fn, module) {
	return module = { exports: {} }, fn(module, module.exports), module.exports;
}

var PhotoEditorSDK_Engine = createCommonjsModule(function (module, exports) {
(function webpackUniversalModuleDefinition(root, factory) {
	module.exports = factory();
})(typeof self !== 'undefined' ? self : commonjsGlobal, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 222);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(224), __esModule: true };

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(234), __esModule: true };

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(226), __esModule: true };

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(229), __esModule: true };

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

module.exports = __webpack_require__(237).default;

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(274), __esModule: true };

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(261), __esModule: true };

/***/ }),
/* 7 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__primitives_stack__ = __webpack_require__(332);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* jshint unused: false */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Base class for filters. Extendable via {@link PhotoEditorSDK.Operations.FilterOperation.Filter#extend}
 * @class
 * @memberof PhotoEditorSDK.Operations.FilterOperation
 */

var Filter = function (_Configurable) {
  _inherits(Filter, _Configurable);

  function Filter() {
    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var additionalOptions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, Filter);

    var _this = _possibleConstructorReturn(this, (Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Filter)).call(this, options, _extends({
      intensity: {
        type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER,
        default: 1.0,
        setter: function setter(intensity) {
          this._stack && this._stack.setIntensity(intensity);
          return intensity;
        }
      },
      dirty: {
        type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN,
        default: true
      }
    }, additionalOptions)));

    _this._stack = new __WEBPACK_IMPORTED_MODULE_6__primitives_stack__["a" /* default */](_this._options.intensity);
    return _this;
  }

  /**
   * Renders the filter
   * @param  {PhotoEditorSDK} sdk
   * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
   * @param  {PhotoEditorSDK.Engine.RenderTexture} outputTexture
   * @return {Promise}
   */


  _createClass(Filter, [{
    key: 'render',
    value: function render(sdk, inputTexture, outputTexture) {
      var _this2 = this;

      return this._stack.render(sdk, inputTexture, outputTexture).then(function (response) {
        _this2.setDirty(false);
        return response;
      });
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {
      this._stack.setDirtyForRenderer(dirty, renderer);
    }

    /**
     * Frees the memory
     */

  }, {
    key: 'disposeRenderTextures',
    value: function disposeRenderTextures() {
      this._stack.disposeRenderTextures();
    }

    /**
     * Cleans this instance up
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._stack.dispose();
    }
  }]);

  return Filter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Configurable"]);

/**
 * A unique string that identifies this filter
 * @type {String}
 */


Filter.identifier = null;

/**
 * If `isIdentity` is true, this filter does not do anything and can be seen as
 * the default filter.
 * @type {Boolean}
 */
Filter.isIdentity = false;

/**
 * This string is used by the UI
 * @type {String}
 */
Filter.displayName = null;

// Exposed classes
Filter.PrimitivesStack = __WEBPACK_IMPORTED_MODULE_6__primitives_stack__["a" /* default */];

/* harmony default export */ __webpack_exports__["a"] = (Filter);

/***/ }),
/* 8 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__brightness__ = __webpack_require__(334);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Brightness", function() { return __WEBPACK_IMPORTED_MODULE_0__brightness__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__contrast__ = __webpack_require__(336);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Contrast", function() { return __WEBPACK_IMPORTED_MODULE_1__contrast__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__color_matrix__ = __webpack_require__(338);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ColorMatrixPrimitive", function() { return __WEBPACK_IMPORTED_MODULE_2__color_matrix__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__desaturation__ = __webpack_require__(340);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Desaturation", function() { return __WEBPACK_IMPORTED_MODULE_3__desaturation__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__duotone__ = __webpack_require__(342);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "DuoTone", function() { return __WEBPACK_IMPORTED_MODULE_4__duotone__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__gamma__ = __webpack_require__(344);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Gamma", function() { return __WEBPACK_IMPORTED_MODULE_5__gamma__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__glow__ = __webpack_require__(346);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Glow", function() { return __WEBPACK_IMPORTED_MODULE_6__glow__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__gobblin__ = __webpack_require__(348);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Gobblin", function() { return __WEBPACK_IMPORTED_MODULE_7__gobblin__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__grayscale__ = __webpack_require__(350);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Grayscale", function() { return __WEBPACK_IMPORTED_MODULE_8__grayscale__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__lookup_table__ = __webpack_require__(174);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LookupTable", function() { return __WEBPACK_IMPORTED_MODULE_9__lookup_table__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__lookup_table_image__ = __webpack_require__(353);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LookupTableImage", function() { return __WEBPACK_IMPORTED_MODULE_10__lookup_table_image__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__saturation__ = __webpack_require__(355);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Saturation", function() { return __WEBPACK_IMPORTED_MODULE_11__saturation__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__soft_color_overlay__ = __webpack_require__(357);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "SoftColorOverlay", function() { return __WEBPACK_IMPORTED_MODULE_12__soft_color_overlay__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__tone_curve__ = __webpack_require__(359);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ToneCurve", function() { return __WEBPACK_IMPORTED_MODULE_13__tone_curve__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__x400__ = __webpack_require__(360);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "X400", function() { return __WEBPACK_IMPORTED_MODULE_14__x400__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__3d_lookup_table_image__ = __webpack_require__(362);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ThreeDLookupTableImage", function() { return __WEBPACK_IMPORTED_MODULE_15__3d_lookup_table_image__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Filter primitives are the core of filters. One filter consists of multiple filter primitives.
 * For an example, look at the implementation of a filter, e.g. {@link PhotoEditorSDK.Operations.FilterOperation.Filters.A15Filter}
 * or see our documentation at {@link https://www.photoeditorsdk.com/documentation}.
 * @namespace PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
 */

















/***/ }),
/* 9 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return Promise; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "n", function() { return Vector2; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "k", function() { return SDKUtils; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return EventEmitter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return Color; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Base64; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "i", function() { return RenderType; });
/* unused harmony export OptionType */
/* unused harmony export UniformType */
/* unused harmony export EXIF */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "j", function() { return SDK; });
/* unused harmony export now */
/* unused harmony export ColorMatrix */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return ImageFormat; });
/* unused harmony export Rectangle */
/* unused harmony export Range */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__ui_desktop_ui_core_lib_utils__ = __webpack_require__(236);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__ui_desktop_ui_core_lib_constants__ = __webpack_require__(479);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_log__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_constants__ = __webpack_require__(90);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_loaders_image_loader__ = __webpack_require__(72);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk__ = __webpack_require__(31);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk__);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "m", function() { return __WEBPACK_IMPORTED_MODULE_0__ui_desktop_ui_core_lib_utils__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return __WEBPACK_IMPORTED_MODULE_1__ui_desktop_ui_core_lib_constants__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return __WEBPACK_IMPORTED_MODULE_2__shared_log__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "l", function() { return __WEBPACK_IMPORTED_MODULE_3__shared_constants__["b"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return __WEBPACK_IMPORTED_MODULE_4__shared_loaders_image_loader__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



// import Constants from './lib/constants'





var Base64 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Base64;
var Color = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Color;
var ColorMatrix = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Math.ColorMatrix;
var EventEmitter = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.EventEmitter;
var EXIF = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.EXIF;
var OptionType = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.OptionType;
var Promise = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Promise;
var SDKUtils = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Utils;
var RenderType = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.RenderType;
var ImageFormat = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.ImageFormat;
var SDK = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a;
var UniformType = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.UniformType;
var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Math.Vector2;
var Rectangle = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Math.Rectangle;
var Range = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default.a.Math.Range;

var now = typeof window !== 'undefined' && window.performance && window.performance.now ? window.performance.now.bind(window.performance) : __webpack_require__(86);



/***/ }),
/* 10 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(249), __esModule: true };

/***/ }),
/* 11 */
/***/ (function(module, exports) {

var core = module.exports = { version: '2.6.11' };
if (typeof __e == 'number') __e = core; // eslint-disable-line no-undef


/***/ }),
/* 12 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return BATCH_SIZE; });
/* unused harmony export VERTEX_SIZE */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "j", function() { return VERTEX_BYTE_SIZE; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__shared_log__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib_color__ = __webpack_require__(66);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__lib_math_matrix__ = __webpack_require__(154);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__lib_math_rectangle__ = __webpack_require__(155);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__lib_math_vector2__ = __webpack_require__(45);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__lib_event_emitter__ = __webpack_require__(67);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_utils__ = __webpack_require__(32);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__lib_gl_utils__ = __webpack_require__(156);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__constants__ = __webpack_require__(40);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return __WEBPACK_IMPORTED_MODULE_1__lib_color__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return __WEBPACK_IMPORTED_MODULE_2__lib_math_matrix__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "k", function() { return __WEBPACK_IMPORTED_MODULE_4__lib_math_vector2__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return __WEBPACK_IMPORTED_MODULE_3__lib_math_rectangle__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return __WEBPACK_IMPORTED_MODULE_5__lib_event_emitter__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return __WEBPACK_IMPORTED_MODULE_0__shared_log__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "i", function() { return __WEBPACK_IMPORTED_MODULE_6__lib_utils__["a"]; });
/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, "c", function() { return __WEBPACK_IMPORTED_MODULE_8__constants__; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return __WEBPACK_IMPORTED_MODULE_7__lib_gl_utils__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */











var BATCH_SIZE = 2000;
var VERTEX_SIZE = 5;
var VERTEX_BYTE_SIZE = VERTEX_SIZE * 4;



/***/ }),
/* 13 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return InputType; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__core_sdk__ = __webpack_require__(140);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * A TensorFilter and it's subclasses perform operations on logical
 * 4D and 2D tensors. These are either simple mathematical operations, but
 * might also be more complex operations like 2D convolutions. To do
 * so, the TensorFilter provides an interface to access the textures
 * values in a 2D ([height, width]) or 4D fashion ([batch, height, width, channels])
 * and allows uploads of additional data (e.g. filters and kernels) in separate
 * textures. The actual management of render targets and supplementary
 * textures is done within the graph.
 *
 * @class
 * @extends PhotoEditorSDK.Engine.Filter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var TensorFilter = function (_Engine$Filter) {
  _inherits(TensorFilter, _Engine$Filter);

  function TensorFilter() {
    var _ref;

    _classCallCheck(this, TensorFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TensorFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TensorFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = null;


    _this._inputTextureSizeMap = {};
    _this._inputLogicalSizeMap = {};
    _this._inputShapeMap = {};
    return _this;
  }

  /**
   * Used to determine the required target texture type.
   * @returns {Boolean}
   */


  _createClass(TensorFilter, [{
    key: 'requiresFloatTextures',
    value: function requiresFloatTextures() {
      return true;
    }

    /**
     * Before rendering the filter, we need to populate all of the uniforms.
     */

  }, {
    key: 'setTargetTextureSize',
    value: function setTargetTextureSize(size) {
      this._targetTextureSize = size;
    }
  }, {
    key: 'setTargetLogicalSize',
    value: function setTargetLogicalSize(size) {
      this._targetSize = size;
    }
  }, {
    key: 'setTextureSizeForInputWithName',
    value: function setTextureSizeForInputWithName(size, name) {
      this._inputTextureSizeMap[name] = size;
    }
  }, {
    key: 'setLogicalSizeForInputWithName',
    value: function setLogicalSizeForInputWithName(size, name) {
      this._inputLogicalSizeMap[name] = size;
    }

    /**
     * Overwritten parent method to ensure compiled fragment shaders upon
     * execution of filter.
     * @param {PhotoEditorSDK.Engine.Renderer} renderer
     */

  }, {
    key: 'getShaderForRenderer',
    value: function getShaderForRenderer(renderer) {
      if (!this._fragmentSource) {
        this._fragmentSource = this._buildFragmentShader();
      }

      return _get(TensorFilter.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TensorFilter.prototype), 'getShaderForRenderer', this).call(this, renderer);
    }

    /**
     * This filters output shape.
     * @returns {Number[]}
     */

  }, {
    key: 'outputLogicalShape',
    value: function outputLogicalShape() {
      if (!this._options.outputLogicalShape) {
        // Calculate the required output shape and texture
        var outputShape = this._calculateOutputShape();
        this._options.outputLogicalShape = outputShape;
      }

      return this._options.outputLogicalShape;
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the WebGLRenderer
     * @param  {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     * @param  {PhotoEditorSDK.Engine.WebGLRenderTarget} inputTarget
     * @param  {PhotoEditorSDK.Engine.WebGLRenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_applyWebGL',
    value: function _applyWebGL(renderer, inputTarget, outputTarget) {
      var _this2 = this;

      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
      var cachedShader = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;

      var shader = cachedShader;
      if (!shader) {
        shader = this.getShaderForRenderer(renderer);
      }

      // Populate the different dimension uniforms
      var gl = renderer.getContext();
      var uniformValues = {};
      var projectionMatrix = renderer.getCurrentRenderTarget().getProjectionMatrix().toArray();
      uniformValues['u_projMatrix'] = projectionMatrix;
      uniformValues['output_texRC'] = this._targetTextureSize;
      uniformValues['output_sizeRC'] = this._targetSize;
      uniformValues['output_shape'] = this.outputLogicalShape();
      this._options.inputs.forEach(function (input) {
        try {
          uniformValues[input.name + '_texRC'] = _this2._inputTextureSizeMap[input.name];
          uniformValues[input.name + '_sizeRC'] = _this2._inputLogicalSizeMap[input.name];
          uniformValues[input.name + '_shape'] = input.logicalShape;
        } catch (error) {
          throw new Error('Missing texture or logical size for input ' + input.name + ' in filter ' + _this2.constructor.name + '.');
        }
      }, this);
      this._updateAdditionalUniforms(shader);
      shader.setUniforms(uniformValues);

      shader.syncUniforms();

      // Bind previous input texture to unit 0
      var pingBaseTexture = inputTarget.getBaseTexture();
      var pingGLTexture = renderer.getOrCreateGLTexture(pingBaseTexture);
      gl.activeTexture(gl.TEXTURE0);
      gl.bindTexture(gl.TEXTURE_2D, pingGLTexture);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, pingBaseTexture.getGLRepeat(gl, 'x'));
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, pingBaseTexture.getGLRepeat(gl, 'y'));
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, pingBaseTexture.getGLFilter(gl, 'min'));
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, pingBaseTexture.getGLFilter(gl, 'mag'));

      // Bind and clear target
      gl.bindFramebuffer(gl.FRAMEBUFFER, outputTarget._framebuffer);
      if (clear) {
        gl.clear(gl.COLOR_BUFFER_BIT);
      }

      // Render
      gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);
    }

    /**
     * Returns a unique identifier which might be used to cache the underlying WebGLProgram.
     */

  }, {
    key: 'getShaderIdentifier',
    value: function getShaderIdentifier() {
      var outputRank = this.outputLogicalShape().length;
      var inputsString = this.getInputs().map(function (input) {
        return input.name + '_' + input.logicalShape.length;
      }).join('');

      return this.constructor.name + '_' + outputRank + '_' + inputsString + '_' + this._getTensorOperationSource();
    }

    /**
     * Allows setting any additional required uniforms for the given shader.
     * @param {PhotoEditorSDK.Engine.Shader} shader - This filters shader program
     * @private
     */

  }, {
    key: '_updateAdditionalUniforms',
    value: function _updateAdditionalUniforms(shader) {}
    // Set any additional uniforms in the given shader


    /**
     * Calculate this filters output shape.
     * @private
     */

  }, {
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      return this.getInputs()[0].logicalShape;
    }

    /**
     * Populate this filters uniforms with all required values.
     */

  }, {
    key: 'prepareUniforms',
    value: function prepareUniforms() {
      var _this3 = this;

      // Add uniform for output tex dimensions and size
      this._uniforms['output_texRC'] = {
        type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2,
        value: [0, 0]
      };
      this._uniforms['output_sizeRC'] = {
        type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2,
        value: [0, 0]
      };

      var outputShape = this._calculateOutputShape();
      this._uniforms['output_shape'] = {
        type: outputShape.length === 2 ? __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].INT2 : __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].INT4,
        value: outputShape

        // Populate sampler2d and dimension uniforms for previous and supplementary textures
      };var textureUnitOffset = 1; // Previous texture is always bound at 0
      var inputNames = [];
      this.getInputs().forEach(function (input) {
        if (inputNames.indexOf(input.name) !== -1) {
          throw new Error('Input names must be unique.');
        }

        var texRCuniformKey = input.name + '_texRC';
        var sizeRCuniformKey = input.name + '_sizeRC';
        var shapeUniformKey = input.name + '_shape';
        _this3._uniforms[texRCuniformKey] = {
          type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2,
          value: [0, 0]
        };
        _this3._uniforms[sizeRCuniformKey] = {
          type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2,
          value: [0, 0]
        };
        _this3._uniforms[shapeUniformKey] = {
          type: input.logicalShape.length === 2 ? __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].INT2 : __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].INT4,
          value: input.logicalShape
        };

        switch (input.type) {
          case InputType.PREVIOUS:
            _this3._uniforms[input.name] = {
              type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].SAMPLER2D,
              value: 0
            };
            break;
          case InputType.DATA:
            _this3._uniforms[input.name] = {
              type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].SAMPLER2D,
              value: textureUnitOffset++ // Supplementary textures are bound behind previous texture
            };
            break;
        }
      });

      // Populate previous texture uniforms after populating all supplementary textures
      this.getInputs().forEach(function (input) {
        if (input.type === InputType.INDEX) {
          _this3._uniforms[input.name] = {
            type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].SAMPLER2D,
            value: textureUnitOffset++
          };
        }
      });

      delete this._availableUniforms['u_image'];
      delete this._uniforms['u_image'];
    }

    /**
     * Return this filters fragment source.
     * @private
     */

  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      return '\n      void main () {\n        setOutput(0.0);\n      }\n    ';
    }

    /**
     * Build the fragment shader from multiple components.
     * @private
     */

  }, {
    key: '_buildFragmentShader',
    value: function _buildFragmentShader() {
      var _this4 = this;

      var source = __webpack_require__(468);

      // Add function to convert output coordinates to 4D coordinates
      var outputLogicalShape = this.outputLogicalShape();
      if (outputLogicalShape.length === 2) {
        source += this._create2DOutputInterfaceSnippet();
      } else if (outputLogicalShape.length === 4) {
        source += this._create4DOutputInterfaceSnippet();
      }

      // Add input specific access interfaces
      this._options.inputs.forEach(function (input) {
        source += _this4._createInputInterfaceSnippet(input);
      });

      // Adds an output snippet
      source += this._createOutputSnippet();

      // Add actual user code
      source += this._getTensorOperationSource();

      return source;
    }
  }, {
    key: '_createOutputSnippet',
    value: function _createOutputSnippet() {
      return '\n      void setOutput(float val) {\n        gl_FragColor = vec4(val, 0, 0, 0);\n      }\n    ';
    }
  }, {
    key: '_create2DOutputInterfaceSnippet',
    value: function _create2DOutputInterfaceSnippet() {
      return '\n      uniform ivec2 output_shape;\n      ivec2 getOutputCoords() {\n        vec2 adjustedFragCoord = gl_FragCoord.xy - halfCR;\n        int index = int(adjustedFragCoord.y * output_sizeRC.y + adjustedFragCoord.x);\n        int r = index / output_shape[1];\n        int c = index - r * output_shape[1];\n\n        return ivec2(r, c);\n      }\n    ';
    }
  }, {
    key: '_create4DOutputInterfaceSnippet',
    value: function _create4DOutputInterfaceSnippet() {
      // batch[height[width[channels[]]]]
      return '\n      uniform ivec4 output_shape;\n      ivec4 getOutputCoords() {\n        vec2 adjustedFragCoord = gl_FragCoord.xy - halfCR;\n        int index = int(adjustedFragCoord.y * output_sizeRC.y + adjustedFragCoord.x);\n\n        int stride2 = output_shape[3];\n        int stride1 = output_shape[2] * stride2;\n        int stride0 = output_shape[1] * stride1;\n\n        int r = index / stride0;\n        index -= r * stride0;\n\n        int c = index / stride1;\n        index -= c * stride1;\n\n        int d = index / stride2;\n        int d2 = index - d * stride2;\n\n        return ivec4(r, c, d, d2);\n      }\n    ';
    }
  }, {
    key: '_createInputInterfaceSnippet',
    value: function _createInputInterfaceSnippet(input) {
      var result = '';

      var name = input.name;
      var logicalShape = input.logicalShape;

      // Create sampler and tex dimension declarations
      var texRCUniform = name + '_texRC';
      var sizeRCUniform = name + '_sizeRC';
      var shapeUniform = name + '_shape';
      var shapeUniformType = logicalShape.length === 2 ? 'ivec2' : 'ivec4';
      result += '\n      uniform sampler2D ' + name + ';\n      uniform vec2 ' + texRCUniform + ';\n      uniform vec2 ' + sizeRCUniform + ';\n      uniform ' + shapeUniformType + ' ' + shapeUniform + ';\n    ';

      // Add 1D access interface
      var funcName = 'get' + this._capitalize(name) + 'Flat';
      result += '\n      float ' + funcName + '(int index) {\n        vec2 uv = UVfrom1D(' + texRCUniform + ', ' + sizeRCUniform + ', index);\n        return sampleTexture(' + name + ', uv);\n      }\n    ';

      // Add 2D or 4D access interface
      if (logicalShape.length === 2) {
        result += '\n        float get' + this._capitalize(name) + '(int row, int col) {\n          vec2 uv = UVfrom2D(' + texRCUniform + ', ' + sizeRCUniform + ', ' + shapeUniform + '[1], row, col);\n          return sampleTexture(' + name + ', uv);\n        }\n      ';
      } else if (logicalShape.length === 4) {
        result += '\n      float get' + this._capitalize(name) + '(int row, int col, int depth, int depth2) {\n        int stride2 = ' + shapeUniform + '[3];\n        int stride1 = ' + shapeUniform + '[2] * stride2;\n        int stride0 = ' + shapeUniform + '[1] * stride1;\n\n        vec2 uv = UVfrom4D(' + texRCUniform + ', ' + sizeRCUniform + ', stride0, stride1, stride2, row, col, depth, depth2);\n        return sampleTexture(' + name + ', uv);\n      }\n\n      float get' + this._capitalize(name) + '(ivec4 coords) {\n        return get' + this._capitalize(name) + '(coords.x, coords.y, coords.z, coords.w);\n      }\n    ';
      }

      return result;
    }
  }, {
    key: '_capitalize',
    value: function _capitalize(string) {
      return string.charAt(0).toUpperCase() + string.slice(1);
    }
  }, {
    key: '_getInputWithName',
    value: function _getInputWithName(name) {
      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].Array.find(this._options.inputs, function (input) {
        return input.name === name;
      });
    }
  }]);

  return TensorFilter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filter);

var InputType = {
  PREVIOUS: 'previous',
  INDEX: 'index',
  DATA: 'data'
};

TensorFilter.prototype.availableOptions = {
  // A list of input informations (name, logical shape, type and eventual data) for all inputs
  inputs: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY },

  // The output textures logical shape and dimensions, used for coordinate mapping and size validation
  outputLogicalShape: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY },
  outputTextureDimensions: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY }
};

/* harmony default export */ __webpack_exports__["b"] = (TensorFilter);

/***/ }),
/* 14 */
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__(16);
var core = __webpack_require__(11);
var ctx = __webpack_require__(30);
var hide = __webpack_require__(34);
var has = __webpack_require__(43);
var PROTOTYPE = 'prototype';

var $export = function (type, name, source) {
  var IS_FORCED = type & $export.F;
  var IS_GLOBAL = type & $export.G;
  var IS_STATIC = type & $export.S;
  var IS_PROTO = type & $export.P;
  var IS_BIND = type & $export.B;
  var IS_WRAP = type & $export.W;
  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});
  var expProto = exports[PROTOTYPE];
  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];
  var key, own, out;
  if (IS_GLOBAL) source = name;
  for (key in source) {
    // contains in native
    own = !IS_FORCED && target && target[key] !== undefined;
    if (own && has(exports, key)) continue;
    // export native or passed
    out = own ? target[key] : source[key];
    // prevent global pollution for namespaces
    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]
    // bind timers to global for call from export context
    : IS_BIND && own ? ctx(out, global)
    // wrap global constructors for prevent change them in library
    : IS_WRAP && target[key] == out ? (function (C) {
      var F = function (a, b, c) {
        if (this instanceof C) {
          switch (arguments.length) {
            case 0: return new C();
            case 1: return new C(a);
            case 2: return new C(a, b);
          } return new C(a, b, c);
        } return C.apply(this, arguments);
      };
      F[PROTOTYPE] = C[PROTOTYPE];
      return F;
    // make static versions for prototype methods
    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;
    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%
    if (IS_PROTO) {
      (exports.virtual || (exports.virtual = {}))[key] = out;
      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%
      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);
    }
  }
};
// type bitmap
$export.F = 1;   // forced
$export.G = 2;   // global
$export.S = 4;   // static
$export.P = 8;   // proto
$export.B = 16;  // bind
$export.W = 32;  // wrap
$export.U = 64;  // safe
$export.R = 128; // real proto method for `library`
module.exports = $export;


/***/ }),
/* 15 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(257), __esModule: true };

/***/ }),
/* 16 */
/***/ (function(module, exports) {

// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028
var global = module.exports = typeof window != 'undefined' && window.Math == Math
  ? window : typeof self != 'undefined' && self.Math == Math ? self
  // eslint-disable-next-line no-new-func
  : Function('return this')();
if (typeof __g == 'number') __g = global; // eslint-disable-line no-undef


/***/ }),
/* 17 */
/***/ (function(module, exports, __webpack_require__) {

var store = __webpack_require__(101)('wks');
var uid = __webpack_require__(83);
var Symbol = __webpack_require__(16).Symbol;
var USE_SYMBOL = typeof Symbol == 'function';

var $exports = module.exports = function (name) {
  return store[name] || (store[name] =
    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));
};

$exports.store = store;


/***/ }),
/* 18 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* jshint unused: false */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Base class for filter primitives.
 * @class
 * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
 */

var Primitive = function (_Configurable) {
  _inherits(Primitive, _Configurable);

  function Primitive() {
    _classCallCheck(this, Primitive);

    return _possibleConstructorReturn(this, (Primitive.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Primitive)).apply(this, arguments));
  }

  _createClass(Primitive, [{
    key: 'update',

    /**
     * Gets called before this primitive's filter is being applied
     */
    value: function update() {}

    /**
     * Returns this primitive's filter
     * @return {PhotoEditorSDK.Engine.Filter}
     */

  }, {
    key: 'getFilter',
    value: function getFilter() {
      return this._filter;
    }

    /**
     * Cleans up this instance
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      if (this._filter) {
        this._filter.dispose();
        this._filter = null;
      }
    }
  }]);

  return Primitive;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Configurable"]);

/* harmony default export */ __webpack_exports__["a"] = (Primitive);

/***/ }),
/* 19 */
/***/ (function(module, exports, __webpack_require__) {

// Thank's IE8 for his funny defineProperty
module.exports = !__webpack_require__(42)(function () {
  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;
});


/***/ }),
/* 20 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Randomizer; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */
/* global Date */

var Randomizer = function () {
  function Randomizer(seed) {
    _classCallCheck(this, Randomizer);

    this._seed = seed === undefined ? Randomizer.TimeSeed() : seed;
  }

  _createClass(Randomizer, [{
    key: "seed",
    value: function seed(value) {
      this._seed = value === undefined ? Randomizer.TimeSeed() : value;
    }
  }, {
    key: "next",
    value: function next() {
      var seed = this._seed | 0;
      var highPass = seed / Randomizer.SEED_DIVIDER | 0;
      var lowPass = seed % Randomizer.SEED_DIVIDER | 0;

      seed = Randomizer.SEED_LOW_MULTIPLY * lowPass - Randomizer.SEED_HIGH_MULTIPLY * highPass;

      if (seed <= 0) {
        seed += Randomizer.MAX;
      }

      if (seed === -1) {
        seed = Randomizer.MAX - 1;
      }

      this._seed = seed;

      return seed;
    }
  }, {
    key: "nextInRange",
    value: function nextInRange(min, max) {
      if (max === undefined) {
        max = min;
        min = 0;
      }

      return min + this.next() % (max - min + 1);
    }
  }, {
    key: "nextBool",
    value: function nextBool() {
      var falseChance = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var trueChance = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

      return this.nextInRange(falseChance + trueChance - 1) >= falseChance;
    }
  }, {
    key: "pickNext",
    value: function pickNext(array) {
      if (!Array.isArray(array)) {
        return null;
      }

      return array[this.next() % array.length];
    }
  }], [{
    key: "TimeSeed",
    value: function TimeSeed() {
      return Date.now();
    }
  }]);

  return Randomizer;
}();
Randomizer.MAX = 2147483647;
Randomizer.SEED_DIVIDER = 127773;
Randomizer.SEED_LOW_MULTIPLY = 16807;
Randomizer.SEED_HIGH_MULTIPLY = 2836;

/***/ }),
/* 21 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RectangleInsets; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__);



var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Rectangle = __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__["Math"].Rectangle;


var RectangleInsets = function () {
  function RectangleInsets() {
    var top = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
    var left = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    var bottom = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
    var right = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;

    _classCallCheck(this, RectangleInsets);

    this.top = top;
    this.left = left;
    this.bottom = bottom;
    this.right = right;
  }

  _createClass(RectangleInsets, [{
    key: 'multiply',
    value: function multiply(a) {
      this.top *= a;
      this.left *= a;
      this.bottom *= a;
      this.right *= a;
    }
  }, {
    key: 'toObject',
    value: function toObject() {
      return _extends({}, this);
    }
  }, {
    key: 'equals',
    value: function equals(r) {
      var eps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

      return Math.abs(r.top - this.top) <= eps && Math.abs(r.left - this.left) <= eps && Math.abs(r.bottom - this.bottom) <= eps && Math.abs(r.right - this.right) <= eps;
    }
  }, {
    key: 'scale',
    value: function scale() {
      var sx = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var sy = arguments[1];

      if (sy === undefined) {
        sy = sx;
      }

      this.top *= sy;
      this.bottom *= sy;
      this.left *= sx;
      this.right *= sx;

      return this;
    }
  }, {
    key: 'clone',
    value: function clone() {
      return new RectangleInsets(this.top, this.left, this.bottom, this.right);
    }
  }, {
    key: 'applyToRectangle',
    value: function applyToRectangle(rect) {
      return new Rectangle(rect.x + this.left, rect.y + this.top, rect.width - this.left - this.right, rect.height - this.top - this.bottom);
    }
  }], [{
    key: 'ZERO',
    get: function get() {
      return new RectangleInsets(0, 0, 0, 0);
    }
  }]);

  return RectangleInsets;
}();

/***/ }),
/* 22 */
/***/ (function(module, exports, __webpack_require__) {

var anObject = __webpack_require__(28);
var IE8_DOM_DEFINE = __webpack_require__(136);
var toPrimitive = __webpack_require__(95);
var dP = Object.defineProperty;

exports.f = __webpack_require__(19) ? Object.defineProperty : function defineProperty(O, P, Attributes) {
  anObject(O);
  P = toPrimitive(P, true);
  anObject(Attributes);
  if (IE8_DOM_DEFINE) try {
    return dP(O, P, Attributes);
  } catch (e) { /* empty */ }
  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');
  if ('value' in Attributes) O[P] = Attributes.value;
  return O;
};


/***/ }),
/* 23 */
/***/ (function(module, exports) {

module.exports = function (it) {
  return typeof it === 'object' ? it !== null : typeof it === 'function';
};


/***/ }),
/* 24 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* WEBPACK VAR INJECTION */(function(process) {/* unused harmony export Logger */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify__ = __webpack_require__(153);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__sdk_core_lib_utils__ = __webpack_require__(32);




var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var defaultLevels = [{ name: 'trace', type: 'trace', background: '#EEEEEE', color: '#AAAAAA' }, { name: 'info', type: 'log', background: '#BDE5F8', color: '#00529B' }, { name: 'warn', type: 'warn', background: '#FEEFB3', color: '#9F6000' }, { name: 'error', type: 'error', background: '#FFBABA', color: '#D8000C' }, { name: 'log', type: 'log', background: '#EEEEEE', color: '#1f4f6b' }];

var hasConsoleGroups = function hasConsoleGroups() {
  return console && console.group && console.groupCollapsed && console.groupEnd;
};

var hasColorOutput = function hasColorOutput() {
  return (!process || process && process.browser) && typeof navigator !== 'undefined' && navigator.userAgent.match(/Gecko|WebKit/i) && !navigator.userAgent.match(/Trident/);
};

/* eslint-disable */
var getLogStyles = function getLogStyles(background, color) {
  return ['background: #2D7BFF; line-height: 20px; padding: 4px 0', 'background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0', 'background: #2D7BFF; line-height: 20px; padding: 4px 0', 'background: ' + background + '; color: ' + color + '; line-height: 20px; padding: 4px 0; font-weight: bold', 'background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0', 'background: #2D7BFF; line-height: 20px; padding: 4px 0'];
};
/* eslint-enable */

var Logger = function () {
  function Logger() {
    var _this = this;

    var maxLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'warn';
    var levels = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultLevels;

    _classCallCheck(this, Logger);

    this._levels = [].concat(_toConsumableArray(levels));
    this._maxLevel = this.getLevelIndexByName(maxLevel);

    this._consoleFuncs = {
      trace: function trace() {
        if (hasConsoleGroups()) {
          var _console;

          (_console = console).groupCollapsed.apply(_console, arguments);
          console.trace();
          console.groupEnd();
        } else {
          var _console2;

          (_console2 = console).trace.apply(_console2, arguments);
        }
      }
    };

    this._levels.forEach(function (_ref) {
      var name = _ref.name;

      _this[name] = function (tag) {
        for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
          args[_key - 1] = arguments[_key];
        }

        _this._log.apply(_this, [name, tag].concat(args));
      };
    });
  }

  _createClass(Logger, [{
    key: 'getLevelIndexByName',
    value: function getLevelIndexByName(levelName) {
      return __WEBPACK_IMPORTED_MODULE_3__sdk_core_lib_utils__["a" /* default */].Array.findIndex(this._levels, function (l) {
        return l.name === levelName;
      });
    }
  }, {
    key: 'getLevelObjectByName',
    value: function getLevelObjectByName(levelName) {
      return __WEBPACK_IMPORTED_MODULE_3__sdk_core_lib_utils__["a" /* default */].Array.find(this._levels, function (l) {
        return l.name === levelName;
      });
    }

    /**
     * Checks if the given log level is currently enabled or not.
     *
     * @param {string} levelName
     */

  }, {
    key: 'canLog',
    value: function canLog(levelName) {
      var level = this.getLevelIndexByName(levelName);

      if (level < 0) {
        return false;
      }

      return level >= this._maxLevel;
    }

    /**
     * Sets the current log level.
     *
     * @param {string} levelName
     * @memberof Logger
     */

  }, {
    key: 'setLevel',
    value: function setLevel(levelName) {
      var level = this.getLevelIndexByName(levelName);

      if (level < 0) {
        return;
      }

      this._maxLevel = level;
    }

    /**
     * Create an entry in the console. The specific console method is determined
     * by the level `levelName`. If color is available, use colorized output. If
     * more than one argument is supplied in `args`, a console group is created.
     *
     * @param {Number} levelName
     * @param {String} tag
     * @param {Array<string>} args
     *
     */

  }, {
    key: '_log',
    value: function _log(levelName, tag) {
      for (var _len2 = arguments.length, args = Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {
        args[_key2 - 2] = arguments[_key2];
      }

      var level = this.getLevelObjectByName(levelName);

      if (!level || !this.canLog(levelName)) {
        return;
      }

      var name = level.name,
          type = level.type,
          background = level.background,
          color = level.color;


      var outputs = args.filter(function (arg) {
        return arg !== undefined;
      }).map(function (arg) {
        if (arg.toObject) {
          return JSON.parse(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default()(arg.toObject()));
        }

        return arg;
      });

      var consoleFunc = this._consoleFuncs[type] || console[type] ? function () {
        var _console3;

        return (_console3 = console)[type].apply(_console3, arguments);
      } : function () {
        var _console4;

        return (_console4 = console).log.apply(_console4, arguments);
      };
      var outputsLen = outputs.length;
      var styles = getLogStyles(background, color);

      if (!hasColorOutput()) {
        var _outputsLen = outputs.length;
        if (_outputsLen <= 0) {
          consoleFunc('PhotoEditorSDK | ' + tag + ' ');
          return;
        }

        if (_outputsLen === 1 && typeof outputs[0] === 'string') {
          consoleFunc('PhotoEditorSDK | ' + tag + ' | ' + outputs[0]);
          return;
        }

        consoleFunc.apply(undefined, ['PhotoEditorSDK | ' + tag + ' | '].concat(_toConsumableArray(outputs)));
        return;
      }

      if (outputsLen <= 0) {
        consoleFunc.apply(undefined, ['%c  %c PhotoEditorSDK %c  %c ' + tag + ' %c %c  '].concat(_toConsumableArray(styles)));
        return;
      }

      if (outputsLen === 1 && typeof outputs[0] === 'string') {
        consoleFunc.apply(undefined, ['%c  %c PhotoEditorSDK %c  %c ' + tag + ' %c  ' + outputs[0] + '  %c  '].concat(_toConsumableArray(styles)));
        return;
      }

      // If there is more than one argument, try to group the log
      if (hasConsoleGroups()) {
        var _console5;

        (_console5 = console).groupCollapsed.apply(_console5, ['%c  %c PhotoEditorSDK %c  %c ' + tag + ' %c'].concat(_toConsumableArray(__WEBPACK_IMPORTED_MODULE_3__sdk_core_lib_utils__["a" /* default */].Array.init(styles))));
        consoleFunc.apply(undefined, _toConsumableArray(outputs));
        console.groupEnd();
      } else {
        consoleFunc.apply(undefined, ['%c  %c PhotoEditorSDK %c  %c ' + tag + ' %c'].concat(_toConsumableArray(__WEBPACK_IMPORTED_MODULE_3__sdk_core_lib_utils__["a" /* default */].Array.init(styles)), _toConsumableArray(outputs)));
      }
    }

    /**
     * Logs an image into the browser's console. Does
     * nothing in a node environment.
     *
     * @param {Canvas|string} source
     * @param {string} tag
     */

  }, {
    key: 'image',
    value: function image() {
      var tag = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
      var source = arguments[1];

      var image = new window.Image();

      var onload = function onload() {
        var width = image.width;
        var height = image.height;
        tag && console.log(tag);
        console.log('%c+', '\n        font-size: 1px;\n        padding: 0px ' + Math.floor(width / 2) + 'px;\n        line-height: ' + height + 'px;\n        background: url(' + image.src + ');\n        color: transparent;\n        background-repeat: no-repeat;\n        background-size: ' + width + 'px ' + height + 'px;');
      };

      image.onload = onload;

      if (source instanceof window.HTMLCanvasElement) {
        image.src = source.toDataURL();
      } else if (source instanceof window.Image) {
        image = source;
        onload();
      } else if (typeof source === 'string') {
        image.src = source;
      } else {
        this.log(tag, source);
      }
      return image;
    }

    /**
     * Logs a `PhotoEditorSDK.Engine.Texture` into the browser's console. Does
     * nothing in a node environment.
     *
     * @param {PhotoEditorSDK.Engine.Texture`} texture
     * @param {string} tag
     *
     */

  }, {
    key: 'texture',
    value: function texture() {
      var tag = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
      var _texture = arguments[1];

      if (!_texture) {
        this.log(tag, 'texture: null or undefined');
        return;
      }

      var baseTexture = _texture.getBaseTexture();
      var renderers = baseTexture.getRenderers();

      var glRenderer = __WEBPACK_IMPORTED_MODULE_3__sdk_core_lib_utils__["a" /* default */].Array.find(renderers, function (r) {
        return r && r.constructor.type === 'WebGL';
      });

      var _baseTexture$getFrame = baseTexture.getFrame(),
          width = _baseTexture$getFrame.width,
          height = _baseTexture$getFrame.height;

      if (glRenderer) {
        var gl = glRenderer.getContext();
        var glTexture = baseTexture.getGLTextureForRenderer(glRenderer);
        this.logGlTexture(gl, glTexture, width, height, tag);
      } else {
        Log.image(tag, baseTexture.getSource());
      }
    }

    /**
     * Logs a WebGLTexture into the browser's console. Does
     * nothing in a node environment.
     *
     * @param {WebGLRenderingContext} gl
     * @param {WebGLTexture} texture
     * @param {number} [width=150]
     * @param {number} [height=150]
     * @param {string} tag
     */

  }, {
    key: 'logGlTexture',
    value: function logGlTexture(gl, texture) {
      var width = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 150;
      var height = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 150;
      var tag = arguments[4];

      gl.bindTexture(gl.TEXTURE_2D, texture);
      var framebuffer = gl.createFramebuffer();
      gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);
      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);

      // Read the contents of the framebuffer
      var data = new Uint8Array(width * height * 4);
      gl.readPixels(0, 0, width, height, gl.RGBA, gl.UNSIGNED_BYTE, data);

      gl.deleteFramebuffer(framebuffer);

      var canvas = document.createElement('canvas');
      canvas.width = width;
      canvas.height = height;

      var context = canvas.getContext('2d');

      // Copy the pixels to a 2D canvas
      var imageData = context.createImageData(width, height);
      imageData.data.set(data);
      context.putImageData(imageData, 0, 0);

      return Log.image(tag, canvas);
    }
  }]);

  return Logger;
}();




var Log = new Logger('warn');

/* harmony default export */ __webpack_exports__["a"] = (Log);
/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(152)));

/***/ }),
/* 25 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(269), __esModule: true };

/***/ }),
/* 26 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignRowSingle; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_row__ = __webpack_require__(92);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__rectangle_insets__ = __webpack_require__(21);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_text_design_font__ = __webpack_require__(78);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__text_design_element__ = __webpack_require__(52);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







var TextDesignRowSingle = function (_TextDesignRow) {
  _inherits(TextDesignRowSingle, _TextDesignRow);

  function TextDesignRowSingle() {
    _classCallCheck(this, TextDesignRowSingle);

    return _possibleConstructorReturn(this, (TextDesignRowSingle.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRowSingle)).apply(this, arguments));
  }

  _createClass(TextDesignRowSingle, [{
    key: '_calculateLayoutElements',
    value: function _calculateLayoutElements() {
      var _serializeOptions = this.serializeOptions(),
          attributes = _serializeOptions.attributes,
          imageInsets = _serializeOptions.imageInsets,
          size = _serializeOptions.size,
          width = _serializeOptions.width;
      // Get the line as a single string


      var text = this.getWords().joined(1)[0] || '';

      // Create a TextDesignFont and calculate dimensions to fit the text in the
      // row width
      var fontIdentifier = attributes.fontIdentifier;
      var font = new __WEBPACK_IMPORTED_MODULE_8__text_text_design_font__["a" /* TextDesignFont */]({ text: text, fontIdentifier: fontIdentifier });
      font.fitWidth(this._getTextFrame().width);

      // Update the row's height in _size
      var height = font.getTextMetrics().height + imageInsets.top + imageInsets.bottom;
      size.height = height;

      // Offset the text frame
      var frame = this._getTextFrame();

      var layoutElement = new __WEBPACK_IMPORTED_MODULE_9__text_design_element__["a" /* TextDesignElement */]({ text: text, frame: frame, font: font });

      return [layoutElement];
    }
  }]);

  return TextDesignRowSingle;
}(__WEBPACK_IMPORTED_MODULE_6__text_design_row__["a" /* TextDesignRow */]);

TextDesignRowSingle.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_6__text_design_row__["a" /* TextDesignRow */].prototype.availableOptions, {
  imageInsets: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].OBJECT, default: new __WEBPACK_IMPORTED_MODULE_7__rectangle_insets__["a" /* RectangleInsets */]() }
});

/***/ }),
/* 27 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AssetManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_regenerator__ = __webpack_require__(79);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_regenerator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve(value).then(function (value) { step("next", value); }, function (err) { step("throw", err); }); } } return step("next"); }); }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* global HTMLImageElement, WEBPACK */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var TextDesignAssetManager = function (_Configurable) {
  _inherits(TextDesignAssetManager, _Configurable);

  function TextDesignAssetManager() {
    _classCallCheck(this, TextDesignAssetManager);

    return _possibleConstructorReturn(this, (TextDesignAssetManager.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignAssetManager)).apply(this, arguments));
  }

  _createClass(TextDesignAssetManager, [{
    key: 'loadImages',
    value: function () {
      var _ref = _asyncToGenerator( /*#__PURE__*/__WEBPACK_IMPORTED_MODULE_4_babel_runtime_regenerator___default.a.mark(function _callee(images) {
        var loaded, i, image;
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_regenerator___default.a.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                loaded = [];
                i = 0;

              case 2:
                if (!(i < images.length)) {
                  _context.next = 10;
                  break;
                }

                image = images[i];
                _context.next = 6;
                return this.addImage(image.path, image.fullPath, image.image);

              case 6:
                loaded.push(image);

              case 7:
                i++;
                _context.next = 2;
                break;

              case 10:
                return _context.abrupt('return', loaded);

              case 11:
              case 'end':
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function loadImages(_x) {
        return _ref.apply(this, arguments);
      }

      return loadImages;
    }()
  }, {
    key: 'addImage',
    value: function addImage(path, fullPath, image) {
      var crossOrigin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'anonymous';

      var images = this.getImages();

      if (!image) {
        return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
          image = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Image"]();
          image.onload = function () {
            images[path] = { fullPath: fullPath, image: image };
            resolve({ fullPath: fullPath, image: image });
          };
          image.crossOrigin = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].getCrossOriginValue(crossOrigin);
          image.onerror = reject;
          image.src = fullPath;
        });
      } else {
        images[path] = { fullPath: fullPath, image: image };
        return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve({ fullPath: fullPath, image: image });
      }
    }
  }, {
    key: 'getImage',
    value: function getImage(path) {
      var images = this.getImages();
      var image = images[path];
      return image ? image.image : null;
    }
  }, {
    key: 'getVariation',
    value: function getVariation(identifier) {
      return this.getFonts()[identifier];
    }
  }, {
    key: 'addFont',
    value: function addFont(identifier, fontVariation) {
      var fonts = this.getFonts();
      fonts[identifier] = fontVariation;

      return fontVariation;
    }
  }]);

  return TextDesignAssetManager;
}(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Configurable"]);

TextDesignAssetManager.prototype.availableOptions = {
  images: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].OBJECT, default: {} },
  fonts: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].OBJECT, default: {} }
};

var AssetManager = new TextDesignAssetManager();

/***/ }),
/* 28 */
/***/ (function(module, exports, __webpack_require__) {

var isObject = __webpack_require__(23);
module.exports = function (it) {
  if (!isObject(it)) throw TypeError(it + ' is not an object!');
  return it;
};


/***/ }),
/* 29 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(267), __esModule: true };

/***/ }),
/* 30 */
/***/ (function(module, exports, __webpack_require__) {

// optional / simple context binding
var aFunction = __webpack_require__(56);
module.exports = function (fn, that, length) {
  aFunction(fn);
  if (that === undefined) return fn;
  switch (length) {
    case 1: return function (a) {
      return fn.call(that, a);
    };
    case 2: return function (a, b) {
      return fn.call(that, a, b);
    };
    case 3: return function (a, b, c) {
      return fn.call(that, a, b, c);
    };
  }
  return function (/* ...args */) {
    return fn.apply(that, arguments);
  };
};


/***/ }),
/* 31 */
/***/ (function(module, exports, __webpack_require__) {

/* @module */
/*!
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * @namespace PhotoEditorSDK.UI
 */
module.exports = __webpack_require__(4);
__webpack_require__(320);

/***/ }),
/* 32 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* WEBPACK VAR INJECTION */(function(global) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_symbol__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_keys__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__base64__ = __webpack_require__(65);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__array_utils__ = __webpack_require__(266);









var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _typeof = typeof __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* global HTMLElement, WEBPACK */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Provides utility functions for internal use
 * @class
 * @memberof PhotoEditorSDK
 * @private
 */

var Utils = function () {
  function Utils() {
    _classCallCheck(this, Utils);
  }

  _createClass(Utils, null, [{
    key: 'isArray',

    /**
     * Checks if the given object is an Array
     * @param  {Object}  object
     * @return {Boolean}
     */
    value: function isArray(object) {
      return Object.prototype.toString.call(object) === '[object Array]';
    }

    /**
     * Maps a value from a given source range to another target range
     * @param  {number} value - The value that should be mapped
     * @param  {Range} fromRange - The source range
     * @param  {Range} toRange - The target range
     * @return {number}
     */

  }, {
    key: 'mapRange',
    value: function mapRange(value, fromRange, toRange) {
      return (value - fromRange.getMin()) * toRange.getLength() / fromRange.getLength() + toRange.getMin();
    }

    /**
     * Checks if a given object is a plain object (i.e., a literal object) or not.
     * @param {any} object
     * @returns Boolean
     */

  }, {
    key: 'isPlainObject',
    value: function isPlainObject(object) {
      if ((typeof object === 'undefined' ? 'undefined' : _typeof(object)) !== 'object' || !object) {
        return false;
      }

      if (typeof __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of___default.a === 'function') {
        var proto = __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of___default()(object);
        return proto === Object.prototype || proto === null;
      }

      return Object.prototype.toString.call(object) === '[object Object]';
    }

    /**
     * Checks whether the user agent represents a mobile device
     * @return {Boolean}
     */

  }, {
    key: 'isMobile',
    value: function isMobile() {
      if (typeof navigator === 'undefined') return false;

      var a = navigator.userAgent || navigator.vendor || window.opera;
      /* eslint-disable */
      return (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))
      );
      /* eslint-enable */
    }

    /**
     * Checks wether the platform target is a browser
     * @return {Boolean}
     */

  }, {
    key: 'isBrowser',
    value: function isBrowser() {
      return typeof window !== 'undefined';
    }

    /**
     * Checks wether the platform target is Nodejs
     * @return {Boolean}
     */

  }, {
    key: 'isNode',
    value: function isNode() {
      return typeof window === 'undefined' && typeof global !== 'undefined';
    }

    /**
     * Returns the given object's values as an array
     * @param {Object} object
     * @returns {Array<*>}
     */

  }, {
    key: 'values',
    value: function values(object) {
      var values = [];
      for (var key in object) {
        values.push(object[key]);
      }
      return values;
    }

    /**
     * Generates and returns a UUID string
     * Based on https://stackoverflow.com/a/8809472/6214222 (Public Domain / MIT)
     * @returns {String}
     */

  }, {
    key: 'generateUUID',
    value: function generateUUID() {
      var d = new Date().getTime();
      if (typeof window.performance !== 'undefined' && typeof window.performance.now === 'function') {
        d += window.performance.now(); // use high-precision timer if available
      }
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = (d + Math.random() * 16) % 16 | 0;
        d = Math.floor(d / 16);
        return (c === 'x' ? r : r & 0x3 | 0x8).toString(16);
      });
    }

    /**
     * Checks if the given object is a DOM element
     * @param  {Object}  o
     * @return {Boolean}
     */
    /* istanbul ignore next */

  }, {
    key: 'isDOMElement',
    value: function isDOMElement(o) {
      return (typeof HTMLElement === 'undefined' ? 'undefined' : _typeof(HTMLElement)) === 'object' ? o instanceof HTMLElement : o && (typeof o === 'undefined' ? 'undefined' : _typeof(o)) === 'object' && o !== null && o.nodeType === 1 && typeof o.nodeName === 'string';
    }

    /**
     * Checks if th given event is a touch event
     * @param  {Event}  e
     * @return {Boolean}
     */

  }, {
    key: 'isTouchEvent',
    value: function isTouchEvent(e) {
      return e.type.indexOf('touch') !== -1;
    }

    /**
     * Resizes the given vector to fit inside the given max size while maintaining
     * the aspect ratio
     * @param  {Vector2} vector
     * @param  {Vector2} max
     * @return {Vector2}
     */

  }, {
    key: 'resizeVectorToFit',
    value: function resizeVectorToFit(vector, max) {
      var scale = Math.min(max.x / vector.x, max.y / vector.y);
      var newSize = vector.clone().multiply(scale);
      return newSize;
    }
  }, {
    key: 'resizeVectorToFill',
    value: function resizeVectorToFill(vector, container) {
      var vectorRatio = vector.x / vector.y;
      var containerRatio = container.x / container.y;
      if (vectorRatio > containerRatio) {
        return container.clone().set(container.y * vectorRatio, container.y);
      } else {
        return container.clone().set(container.x, container.x / vectorRatio);
      }
    }

    /**
     * Checks if this value is extendable / can have keys
     * @param  {*}  val
     * @return {Boolean}
     */

  }, {
    key: 'isExtendable',
    value: function isExtendable(val) {
      return typeof val !== 'undefined' && val !== null && ((typeof val === 'undefined' ? 'undefined' : _typeof(val)) === 'object' || typeof val === 'function');
    }

    /**
     * Assigns own enumerable properties of source object(s) to the destination
     * object for all destination properties that resolve to undefined. Once a
     * property is set, additional values of the same property are ignored.
     * @param  {Object} object
     * @param  {Object} ...sources
     * @return {Object}
     */

  }, {
    key: 'defaults',
    value: function defaults(object) {
      // Shallow clone
      var newObject = {};
      for (var key in object) {
        newObject[key] = object[key];
      }

      // Clone sources

      for (var _len = arguments.length, sources = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        sources[_key - 1] = arguments[_key];
      }

      for (var i = 0; i < sources.length; i++) {
        var source = sources[i];
        for (var _key2 in source) {
          if (typeof newObject[_key2] === 'undefined') {
            newObject[_key2] = source[_key2];
          }
        }
      }

      return newObject;
    }

    /**
     * Does a deep merge between a set of objects, from left to right. The merge is
     * deep in the sense that it goes recurseviley trough the objects own
     * properties. When it encounters an array, it only does a shallow copy of it.
     *
     * @param {Object} dest
     * @param {Object[]} sources
     * @returns {Object}
     */

  }, {
    key: 'deepMerge',
    value: function deepMerge(dest) {
      // deep merge between two objects only
      var _deepMerge = function _deepMerge(dest, source) {
        // If the source is undefined, return a copy of dest
        if (source === undefined) {
          return _deepMerge(null, dest);
        }

        // If the source is an array, return a shallow copy
        if (Array.isArray(source)) {
          return [].concat(_toConsumableArray(source));
        }

        // If the source is not a plain object, just return it
        if (!Utils.isPlainObject(source)) {
          return source;
        }

        // If dest is an not a plain object, return a shallow copy of the source
        if (!Utils.isPlainObject(dest)) {
          return _extends({}, source);
        }

        // Shallow-copy the original object
        var result = _extends({}, dest);

        // Go trough each source key
        __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_keys___default()(source).forEach(function (key) {
          var value = source[key];
          if (value === undefined) {
            return;
          }
          result[key] = _deepMerge(dest[key], value);
        });
        return result;
      };

      for (var _len2 = arguments.length, sources = Array(_len2 > 1 ? _len2 - 1 : 0), _key3 = 1; _key3 < _len2; _key3++) {
        sources[_key3 - 1] = arguments[_key3];
      }

      return sources.reduce(_deepMerge, dest);
    }

    /**
     * Assigns own enumerable properties of source object(s) to the destination
     * object for all destination properties and their properties that resolve to
     * undefined. Once a property is set, additional value sof the same property
     * are ignored.
     * @param  {Object} object
     * @param  {Object} ...sources
     * @return {Object}
     */

  }, {
    key: 'deepDefaults',
    value: function deepDefaults(object) {
      for (var _len3 = arguments.length, sources = Array(_len3 > 1 ? _len3 - 1 : 0), _key4 = 1; _key4 < _len3; _key4++) {
        sources[_key4 - 1] = arguments[_key4];
      }

      var reversedSources = [].concat(sources).reverse();
      return Utils.deepMerge.apply(Utils, _toConsumableArray(reversedSources).concat([object]));
    }

    /**
     * Creates a deep clone of the given object
     * @param  {Object}    object
     * @return {Object}
     */

  }, {
    key: 'deepClone',
    value: function deepClone(object) {
      var newObject = {};
      for (var key in object) {
        if (Utils.isExtendable(object[key])) {
          newObject[key] = Utils.deepClone(object[key]);
        } else {
          newObject[key] = object[key];
        }
      }
      return newObject;
    }

    /**
     * Get a deep property inside an object.
     *
     * @param {Object} object - the object
     * @param {String[]} path - Either a string with the prop's
     *  name, or an array of prop names and/or functions describing a path in a
     *  nested object. Any function passed in the array should function as a getter
     *  for a prop.
     *
     * @returns {(any|undefined)} - The prop's value, or undefined if the prop is
     * not found
     */

  }, {
    key: 'getDeepProperty',
    value: function getDeepProperty(object, path) {
      if (typeof path === 'string') {
        return object[path];
      }

      if (!Array.isArray(path)) {
        return undefined;
      }

      // When we have a getter function inside the array, call it as a getter,
      // ignoring any type errors thrown by it (just return undefined.)
      var callPropName = function callPropName(object, propName) {
        var value = void 0;
        try {
          value = propName(object);
        } catch (e) {
          if (!(e instanceof TypeError)) {
            throw e;
          }
        }

        return value;
      };

      return path.reduce(function (object, propName) {
        return object ? typeof propName === 'function' ? callPropName(object, propName) : object[propName] : null;
      }, object);
    }

    /**
     * Assigns own enumerable properties of source object(s) to the destination
     * object. Subsequent sources overwrite property assignments of previous
     * sources.
     * @param {Object} object
     * @param {Object} ...sources
     * @return {Object}
     */

  }, {
    key: 'extend',
    value: function extend(object) {
      // Shallow clone
      var newObject = {};
      for (var key in object) {
        newObject[key] = object[key];
      }

      // Extend sources

      for (var _len4 = arguments.length, sources = Array(_len4 > 1 ? _len4 - 1 : 0), _key5 = 1; _key5 < _len4; _key5++) {
        sources[_key5 - 1] = arguments[_key5];
      }

      for (var i = 0; i < sources.length; i++) {
        var source = sources[i];
        for (var _key6 in source) {
          newObject[_key6] = source[_key6];
        }
      }

      return newObject;
    }

    /**
     * Creates a shallow clone of the given object
     * @param {Object} object
     * @returns {Object}
     */

  }, {
    key: 'clone',
    value: function clone(object) {
      return this.extend({}, object);
    }

    /**
     * Creates a Blob URI from the given Data URI
     * @param {String} data
     */

  }, {
    key: 'createBlobURIFromDataURI',
    value: function createBlobURIFromDataURI(data) {
      var root = typeof window === 'undefined' ? global : window;
      if (!root.Blob || !root.URL || !ArrayBuffer || !Uint8Array) {
        return data;
      }

      var rawData = __WEBPACK_IMPORTED_MODULE_8__base64__["a" /* default */].decode(data.split(',')[1]);
      var mimeString = data.split(',')[0].split(':')[1].split(';')[0];

      // write the bytes of the string to an ArrayBuffer
      var arrayBuffer = new ArrayBuffer(rawData.length);
      var intArray = new Uint8Array(arrayBuffer);
      for (var i = 0; i < rawData.length; i++) {
        intArray[i] = rawData[i];
      }

      // write the ArrayBuffer to a blob, and you're done
      var blob = new root.Blob([arrayBuffer], {
        type: mimeString
      });
      return root.URL.createObjectURL(blob);
    }

    /**
     * Generates a UUID
     * @return {String}
     */

  }, {
    key: 'getUUID',
    value: function getUUID() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = Math.random() * 16 | 0;
        var v = c === 'x' ? r : r & 0x3 | 0x8;
        return v.toString(16);
      });
    }

    /**
     * Creates a canvas DOM element (browser) or a node-canvas canvas (node)
     * @return {Canvas}
     */

  }, {
    key: 'createCanvas',
    value: function createCanvas() {
      return document.createElement('canvas');
    }
  }, {
    key: 'convertHtmlImageToRGBACanvas',
    value: function convertHtmlImageToRGBACanvas(htmlImage, existingCanvas) {
      // Workaround fro non-RGB images
      var canvas = existingCanvas || Utils.createCanvas();
      canvas.width = htmlImage.width;
      canvas.height = htmlImage.height;
      var context = canvas.getContext('2d');
      context.clearRect(0, 0, canvas.width, canvas.height);
      context.drawImage(htmlImage, 0, 0, htmlImage.width, htmlImage.height);

      return canvas;
    }

    /**
     * Checks if the given dimensions are POT
     * @param  {PhotoEditorSDK.Math.Vector2}  dimensions
     * @return {Boolean}
     */

  }, {
    key: 'isPowerOfTwo',
    value: function isPowerOfTwo(dimensions) {
      return (dimensions.x & dimensions.x - 1) === 0 && (dimensions.y & dimensions.y - 1) === 0;
    }

    /**
     * Returns the next lowest power of two of the given number
     * @param  {Number} x
     * @return {Number}
     */

  }, {
    key: 'nextLowestPOT',
    value: function nextLowestPOT(x) {
      for (var i = 1; i < 32; i <<= 1) {
        x = x | x >> i;
      }
      return x - (x >> 1);
    }

    /**
     * Returns the next highest power of two of the given number
     * @param  {Number} x
     * @return {Number}
     */

  }, {
    key: 'nextHighestPOT',
    value: function nextHighestPOT(x) {
      x--;
      for (var i = 1; i < 32; i <<= 1) {
        x = x | x >> i;
      }
      return x + 1;
    }

    /**
     * Moves the array item at `oldIndex` to `newIndex`
     * @param  {Array} arr
     * @param  {Number} oldIndex
     * @param  {Number} newIndex
     */

  }, {
    key: 'moveArrayItem',
    value: function moveArrayItem(arr, oldIndex, newIndex) {
      if (newIndex >= arr.length) {
        var k = newIndex - arr.length;
        while (k-- + 1) {
          arr.push(undefined);
        }
      }
      arr.splice(newIndex, 0, arr.splice(oldIndex, 1)[0]);
    }

    /**
     * Makes sure the given canvas has the given dimensions. If not, it does not change the
     * canvas dimensions.
     * @param  {Canvas} canvas
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     */

  }, {
    key: 'ensureCanvasDimensions',
    value: function ensureCanvasDimensions(canvas, dimensions) {
      if (canvas.width !== dimensions.x || canvas.height !== dimensions.y) {
        canvas.width = dimensions.x;
        canvas.height = dimensions.y;
      }
    }

    /**
     * Converts the given array of bytes to a string
     * @param  {Number[]} byteArray
     * @return {String}
     */

  }, {
    key: 'byteArrayToString',
    value: function byteArrayToString(byteArray) {
      return byteArray.map(function (byte) {
        return String.fromCharCode(byte);
      }).join('');
    }

    /**
     * Clamps the given `number` into `min` and `max`
     * @param  {Number} number
     * @param  {Number} min
     * @param  {Number} max
     * @return {Number}
     */

  }, {
    key: 'clamp',
    value: function clamp(number, min, max) {
      return Math.max(min, Math.min(number, max));
    }

    /**
     * Checks if the given string matches the given wildcard
     * @param  {String} str
     * @param  {String} rule
     * @return {Boolean}
     */

  }, {
    key: 'wildCardMatch',
    value: function wildCardMatch(str, rule) {
      return new RegExp('^' + rule.split('*').join('.*') + '$').test(str);
    }

    /**
     * Returns a new object with flipped values and keys
     * @param  {Object} obj
     * @return {Object}
     */

  }, {
    key: 'flipObject',
    value: function flipObject(obj) {
      var newObj = {};
      for (var key in obj) {
        newObj[obj[key]] = key;
      }
      return newObj;
    }

    /**
     * Returns a clone of the given options object
     * @param  {Object} options
     * @return {Object}
     */

  }, {
    key: 'cloneOptions',
    value: function cloneOptions(options) {
      var newOptions = {};
      for (var key in options) {
        var value = options[key];
        if (Array.isArray(value)) {
          value = value.slice();
        } else if (value.clone) {
          value = value.clone();
        }
        newOptions[key] = value;
      }
      return newOptions;
    }

    /**
     * Returns the given date as RFC 3339
     * @param {Date} date
     * @return {String}
     */

  }, {
    key: 'ISODateString',
    value: function ISODateString(date) {
      function pad(n) {
        return n < 10 ? '0' + n : n;
      }
      return date.getUTCFullYear() + '-' + pad(date.getUTCMonth() + 1) + '-' + pad(date.getUTCDate()) + 'T' + pad(date.getUTCHours()) + ':' + pad(date.getUTCMinutes()) + ':' + pad(date.getUTCSeconds()) + 'Z';
    }
  }, {
    key: 'getCrossOriginValue',
    value: function getCrossOriginValue(crossOrigin) {
      if (!crossOrigin) {
        return 'anonymous';
      }

      if (crossOrigin === 'none') {
        return undefined;
      }

      return crossOrigin;
    }

    /**
     * Shallow equal compare two objects
     * @param {*} objA
     * @param {*} objB
     * @returns {Boolean}
     */

  }, {
    key: 'shallowEqual',
    value: function shallowEqual(objA, objB) {
      if (objA === objB) {
        return true;
      }

      if ((typeof objA === 'undefined' ? 'undefined' : _typeof(objA)) !== 'object' || objA === null || (typeof objB === 'undefined' ? 'undefined' : _typeof(objB)) !== 'object' || objB === null) {
        return false;
      }

      var keysA = __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_keys___default()(objA);
      var keysB = __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_keys___default()(objB);

      if (keysA.length !== keysB.length) {
        return false;
      }
      // Test for A's keys different from B.
      var bHasOwnProperty = hasOwnProperty.bind(objB);
      for (var i = 0; i < keysA.length; i++) {
        if (!bHasOwnProperty(keysA[i]) || objA[keysA[i]] !== objB[keysA[i]]) {
          return false;
        }
      }
      return true;
    }

    /**
     * Returns 'value' if condition is met else returns 'undefined'
     * @param {Boolean} condition
     * @param {*} value
     * @returns {*}
     */

  }, {
    key: 'enableIf',
    value: function enableIf(condition, value) {
      return condition ? value : undefined;
    }

    /**
      Throws an error if condition is not met
      @param {Boolean} condition
     */

  }, {
    key: 'invariant',
    value: function invariant(condition, message) {
      if (!condition) {
        var error = new Error(message);
        throw error;
      }
    }

    /**
     * Exectues all Promises in an array, returning a new Promise which
     * will fulfill with an array of the values returned by all promises in
     * the case all of them are resolved, or, with one or more are rejected,
     * rejects with an array containing all the error values.
     *
     * @param {Array<Promise>} promises
     * @returns {Promise<Array>}
     */

  }, {
    key: 'executePromises',
    // eslint-disable-line
    value: function executePromises(promises) {
      var count = promises.length;
      var counter = 0;

      var values = [];
      var errors = [];

      return new __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var onFinnish = function onFinnish() {
          counter++;
          if (counter >= count) {
            if (errors.length <= 0) {
              resolve(values);
            } else {
              reject(errors);
            }
          }
        };

        var onSuccess = function onSuccess(value) {
          values.push(value);
          onFinnish();
        };

        var onError = function onError(value) {
          errors.push(value);
          onFinnish();
        };

        promises.forEach(function (promise) {
          promise.then(onSuccess).catch(onError);
        });
      });
    }
  }]);

  return Utils;
}();

Utils.Array = __WEBPACK_IMPORTED_MODULE_9__array_utils__["a" /* default */];


/* harmony default export */ __webpack_exports__["a"] = (Utils);
/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(64)));

/***/ }),
/* 33 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SizeValue; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Rectangle = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].Rectangle;


var SizeValue = function () {
  function SizeValue() {
    var width = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
    var height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

    _classCallCheck(this, SizeValue);

    this.width = width;
    this.height = height;
  }

  _createClass(SizeValue, [{
    key: 'set',
    value: function set(width, height) {
      this.width = width;
      this.height = height;
    }
  }, {
    key: 'aspect',
    value: function aspect() {
      return this.width / this.height;
    }
  }, {
    key: 'rectangle',
    value: function rectangle(x, y) {
      return new Rectangle(x, y, this.width, this.height);
    }
  }, {
    key: 'clone',
    value: function clone() {
      return new SizeValue(this.width, this.height);
    }
  }, {
    key: 'scale',
    value: function scale(sx, sy) {
      if (sy === undefined) {
        sy = sx;
      }

      this.width *= sx;
      this.height *= sy;

      return this;
    }
  }, {
    key: 'copy',
    value: function copy(size) {
      this.width = size.width;
      this.height = size.height;

      return this;
    }
  }, {
    key: 'fitInWidthWithOther',
    value: function fitInWidthWithOther(width) {
      var otherSizeValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new SizeValue();

      this.copy(SizeValue.fitTwoInWidth(width, this, otherSizeValue)[0]);
      return this;
    }
  }], [{
    key: 'fitTwoInWidth',
    value: function fitTwoInWidth(width, size1, size2) {
      var crossRatio = size1.width * size2.height + size1.height * size2.width;
      var a = size2.height * width / crossRatio;

      var newWidth1 = size1.width * a;
      var newHeight = size1.height * a;

      return [new SizeValue(newWidth1, newHeight), new SizeValue(width - newWidth1, newHeight)];
    }
  }]);

  return SizeValue;
}();

/***/ }),
/* 34 */
/***/ (function(module, exports, __webpack_require__) {

var dP = __webpack_require__(22);
var createDesc = __webpack_require__(57);
module.exports = __webpack_require__(19) ? function (object, key, value) {
  return dP.f(object, key, createDesc(1, value));
} : function (object, key, value) {
  object[key] = value;
  return object;
};


/***/ }),
/* 35 */
/***/ (function(module, exports, __webpack_require__) {

// to indexed object, toObject with fallback for non-array-like ES3 strings
var IObject = __webpack_require__(97);
var defined = __webpack_require__(98);
module.exports = function (it) {
  return IObject(defined(it));
};


/***/ }),
/* 36 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(238), __esModule: true };

/***/ }),
/* 37 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(243), __esModule: true };

/***/ }),
/* 38 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__engine__ = __webpack_require__(85);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__constants__ = __webpack_require__(40);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__lib_base64__ = __webpack_require__(65);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__lib_event_emitter__ = __webpack_require__(67);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_constants_index__ = __webpack_require__(90);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_utils__ = __webpack_require__(32);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__lib_configurable__ = __webpack_require__(70);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__lib_color__ = __webpack_require__(66);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__shared_log__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__shared_vendor_promise__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__lib_gl_utils__ = __webpack_require__(156);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__lib_license_checker__ = __webpack_require__(299);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__shared_async_animation_frame__ = __webpack_require__(310);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "requestAnimationFrame", function() { return __WEBPACK_IMPORTED_MODULE_13__shared_async_animation_frame__["b"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "cancelAnimationFrame", function() { return __WEBPACK_IMPORTED_MODULE_13__shared_async_animation_frame__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Engine", function() { return __WEBPACK_IMPORTED_MODULE_1__engine__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "EventEmitter", function() { return __WEBPACK_IMPORTED_MODULE_4__lib_event_emitter__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Events", function() { return __WEBPACK_IMPORTED_MODULE_5__shared_constants_index__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Utils", function() { return __WEBPACK_IMPORTED_MODULE_6__lib_utils__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Configurable", function() { return __WEBPACK_IMPORTED_MODULE_7__lib_configurable__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Color", function() { return __WEBPACK_IMPORTED_MODULE_8__lib_color__["a"]; });
/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, "Constants", function() { return __WEBPACK_IMPORTED_MODULE_2__constants__; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Log", function() { return __WEBPACK_IMPORTED_MODULE_9__shared_log__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Promise", function() { return __WEBPACK_IMPORTED_MODULE_10__shared_vendor_promise__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "GLUtils", function() { return __WEBPACK_IMPORTED_MODULE_11__lib_gl_utils__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Base64", function() { return __WEBPACK_IMPORTED_MODULE_3__lib_base64__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LicenseChecker", function() { return __WEBPACK_IMPORTED_MODULE_12__lib_license_checker__["b"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "FreeLicenseChecker", function() { return __WEBPACK_IMPORTED_MODULE_12__lib_license_checker__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__lib_math___ = __webpack_require__(165);
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Vector2", function() { return __WEBPACK_IMPORTED_MODULE_14__lib_math___["Vector2"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Vector3", function() { return __WEBPACK_IMPORTED_MODULE_14__lib_math___["Vector3"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Range", function() { return __WEBPACK_IMPORTED_MODULE_14__lib_math___["Range"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Rectangle", function() { return __WEBPACK_IMPORTED_MODULE_14__lib_math___["Rectangle"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Matrix", function() { return __WEBPACK_IMPORTED_MODULE_14__lib_math___["Matrix"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "ColorMatrix", function() { return __WEBPACK_IMPORTED_MODULE_14__lib_math___["ColorMatrix"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "CubicBezierCurve", function() { return __WEBPACK_IMPORTED_MODULE_14__lib_math___["CubicBezierCurve"]; });

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/* eslint-disable import/first */

if (Function.prototype.name === undefined && __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default.a !== undefined) {
  /* eslint-disable no-extend-native */
  Object.defineProperty(Function.prototype, 'name', {
    get: function get() {
      var funcNameRegex = /function\s([^(]{1,})\(/;
      var results = funcNameRegex.exec(this.toString());
      return results && results.length > 1 ? results[1].trim() : '';
    },
    set: function set(value) {}
  });
  /* eslint-enable no-extend-native */
}






















/***/ }),
/* 39 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(264), __esModule: true };

/***/ }),
/* 40 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RenderType", function() { return RenderType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageFormat", function() { return ImageFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OptionType", function() { return OptionType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UniformType", function() { return UniformType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RendererType", function() { return RendererType; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
* The available render types
* @enum {String} RenderType
* @property {string} IMAGE image
* @property {string} DATAURL data-url
* @property {string} BUFFER buffer (Only supported by the Server SDK)
* @property {string} BLOB blob
* @property {string} MSBLOB ms-blob
* @memberof PhotoEditorSDK
*/
var RenderType = {
  IMAGE: 'image',
  DATAURL: 'data-url',
  BUFFER: 'buffer',
  BLOB: 'blob',
  MSBLOB: 'ms-blob'

  /**
   * The available image types
   * @enum {String} ImageFormat
   * @property {string} PNG  image/png
   * @property {string} JPEG image/jpeg
   * @property {string} RAW raw
   * @memberof PhotoEditorSDK
   */
};var ImageFormat = {
  PNG: 'image/png',
  JPEG: 'image/jpeg',
  RAW: 'raw'

  /**
   * The available option types for classes inheriting {@link PhotoEditorSDK.Configurable}
   * @enum {String}
   * @alias OptionType
   * @property {string} NUMBER
   * @property {string} VECTOR2
   * @property {string} COLOR_MATRIX
   * @property {string} COLOR
   * @property {string} ARRAY
   * @property {string} OBJECT
   * @property {string} STRING
   * @property {string} BOOLEAN
   * @property {string} CONFIGURABLE
   * @property {string} IMAGE
   * @property {string} FUNCTION
   * @property {string} TEXTURE
   * @property {string} ALL
   * @memberof PhotoEditorSDK
   */
};var OptionType = {
  NUMBER: 'number',
  VECTOR2: 'vector2',
  COLOR_MATRIX: 'color-matrix',
  COLOR: 'color',
  ARRAY: 'array',
  OBJECT: 'object',
  STRING: 'string',
  BOOLEAN: 'boolean',
  CONFIGURABLE: 'configurable',
  IMAGE: 'image',
  FUNCTION: 'function',
  TEXTURE: 'texture',
  ALL: '*'

  /**
   * The available uniform types for WebGL shaders
   * @enum {String}
   * @alias UniformType
   * @property {string} SAMPLER2D
   * @property {string} INT
   * @property {string} INT1
   * @property {string} FLOAT
   * @property {string} FLOAT1
   * @property {string} FLOAT2
   * @property {string} FLOAT_VECTOR2
   * @property {string} FLOAT3
   * @property {string} FLOAT4
   * @property {string} MAT3
   * @property {string} MAT3FV
   * @property {string} MAT4
   * @memberof PhotoEditorSDK
   */
};var UniformType = {
  SAMPLER2D: 'sampler2d',
  INT: 'i',
  INT1: '1i',
  INT2: '2i',
  INT3: '3i',
  INT4: '4i',
  FLOAT: 'f',
  FLOAT1: '1f',
  FLOAT2: '2f',
  FLOAT_VECTOR2: '2fv',
  FLOAT3: '3f',
  FLOAT4: '4f',
  MAT3: 'mat3',
  MAT3FV: 'mat3fv',
  MAT4: 'mat4'

  /**
   * The available renderer types
   * @enum {String}
   * @alias RendererType
   * @property {string} WEBGL
   * @property {string} CANVAS
   * @memberOf PhotoEditorSDK
   */
};var RendererType = {
  WEBGL: 'webgl',
  CANVAS: 'canvas'
};

/***/ }),
/* 41 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__assets_font__ = __webpack_require__(487);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__log__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__assets_font_variation__ = __webpack_require__(199);



var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var FontManager = function () {
  function FontManager(ui, options) {
    _classCallCheck(this, FontManager);

    this._ui = ui;
    this._options = options;
    this._fonts = [];
    this._variationsByIdentifier = {};
    this._fontsByFontFamily = {};

    this._initFonts();
  }

  /**
   * Initializes the fonts
   * @private
   */


  _createClass(FontManager, [{
    key: '_initFonts',
    value: function _initFonts() {
      var _this = this;

      var _options = this._options,
          additionalFonts = _options.fonts,
          replaceFonts = _options.replaceFonts,
          availableVariations = _options.availableVariations;

      // On server the font manager is created before the editor has finished
      // constructing, so we can't check whether custom assets are allowed or not

      var customAssetsAllowed = true;
      customAssetsAllowed = this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed();

      // Replace or append fonts
      var fonts = __WEBPACK_IMPORTED_MODULE_2_globals__["c" /* Constants */].DEFAULTS.FONTS;
      if (customAssetsAllowed) {
        if (replaceFonts) {
          fonts = additionalFonts;
        } else {
          fonts = fonts.concat(additionalFonts || []);
        }
      }

      // Turn fonts into actual Font objects with FontVariation objects
      var defaultVariation = void 0;
      fonts = fonts.map(function (font) {
        var fontFamily = font.fontFamily;

        var variations = font.variations;

        if (customAssetsAllowed && availableVariations) {
          variations = variations.filter(function (variation) {
            return availableVariations.indexOf(variation.identifier) !== -1;
          });
        }

        if (variations.length === 0) return null;

        var fontInstance = new __WEBPACK_IMPORTED_MODULE_3__assets_font__["a" /* default */]({
          fontFamily: fontFamily
        });
        variations = variations.map(function (variation) {
          var variationInstance = new __WEBPACK_IMPORTED_MODULE_5__assets_font_variation__["a" /* default */](variation);
          variationInstance.setFontFamily(fontFamily);
          variationInstance.setFont(fontInstance);
          if (variation.default && !defaultVariation) {
            defaultVariation = variationInstance;
          }

          if (variationInstance.getTextMetrics() == null) {
            __WEBPACK_IMPORTED_MODULE_4__log__["a" /* default */].warn('Missing font metrics for ' + variationInstance.getIdentifier() + '. The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details.');
          }

          _this._variationsByIdentifier[variationInstance.getIdentifier()] = variationInstance;
          return variationInstance;
        });
        fontInstance.setVariations(variations);
        _this._fontsByFontFamily[fontFamily] = fontInstance;
        return fontInstance;
      }).filter(function (f) {
        return f;
      });

      if (!defaultVariation) {
        defaultVariation = fonts[0].getVariations()[0];
      }

      this._defaultVariation = defaultVariation;
      this._fonts = fonts;
    }

    /**
     * Returns all available fonts
     * @return {PhotoEditorSDK.UI.DesktopUI.Font[]}
     */

  }, {
    key: 'getFonts',
    value: function getFonts() {
      return this._fonts;
    }

    /**
     * Returns the font for the given font family
     * @param  {String} fontFamily
     * @return {PhotoEditorSDK.UI.DesktopUI.Font}
     */

  }, {
    key: 'getFontByFontFamily',
    value: function getFontByFontFamily(fontFamily) {
      return this._fontsByFontFamily[fontFamily];
    }

    /**
     * Returns the font variation for the given identifier
     * @param  {String} identifier
     * @return {PhotoEditorSDK.UI.DesktopUI.FontVariation}
     */

  }, {
    key: 'getVariationByIdentifier',
    value: function getVariationByIdentifier(identifier) {
      return this._variationsByIdentifier[identifier];
    }
  }, {
    key: 'getVariationsByIdentifier',
    value: function getVariationsByIdentifier() {
      return _extends({}, this._variationsByIdentifier);
    }

    /**
     * Returns the default variation
     * @return {PhotoEditorSDK.UI.DesktopUI.FontVariation}
     */

  }, {
    key: 'getDefaultVariation',
    value: function getDefaultVariation() {
      return this._defaultVariation;
    }
  }]);

  return FontManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (FontManager);

/***/ }),
/* 42 */
/***/ (function(module, exports) {

module.exports = function (exec) {
  try {
    return !!exec();
  } catch (e) {
    return true;
  }
};


/***/ }),
/* 43 */
/***/ (function(module, exports) {

var hasOwnProperty = {}.hasOwnProperty;
module.exports = function (it, key) {
  return hasOwnProperty.call(it, key);
};


/***/ }),
/* 44 */
/***/ (function(module, exports, __webpack_require__) {

// 7.1.13 ToObject(argument)
var defined = __webpack_require__(98);
module.exports = function (it) {
  return Object(defined(it));
};


/***/ }),
/* 45 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Represents a 2-dimensional vector while providing math functions to
 * modify / clone the vector. Fully chainable.
 * @class
 * @memberof PhotoEditorSDK.Math
 */
var Vector2 = function () {
  /**
   * Creates a Vector2
   * @param  {Number} x
   * @param  {Number} y
   */
  function Vector2(x, y) {
    _classCallCheck(this, Vector2);

    this.x = x;
    this.y = y;
    if (typeof this.x === 'undefined') {
      this.x = 0;
    }
    if (typeof this.y === 'undefined') {
      this.y = 0;
    }
  }

  /**
   * Sets the given values
   * @param {Number} x
   * @param {Number} y
   * @return {PhotoEditorSDK.Math.Vector2}
   */


  _createClass(Vector2, [{
    key: 'set',
    value: function set(x, y) {
      this.x = x;
      this.y = y;
      return this;
    }

    /**
     * Creates a clone of this vector
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'clone',
    value: function clone() {
      return new Vector2(this.x, this.y);
    }

    /**
     * Copies the values of the given vector
     * @param  {PhotoEditorSDK.Math.Vector2} other
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'copy',
    value: function copy(other) {
      this.x = other.x;
      this.y = other.y;
      return this;
    }

    /**
     * Clamps this vector with the given Vector2 / Number
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} minimum
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} maximum
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'clamp',
    value: function clamp(minimum, maximum) {
      var minimumSet = minimum !== null && typeof minimum !== 'undefined';
      var maximumSet = maximum !== null && typeof maximum !== 'undefined';

      /* istanbul ignore else  */
      if (!(minimum instanceof Vector2) && minimumSet) {
        minimum = new Vector2(minimum, minimum);
      }
      /* istanbul ignore else  */
      if (!(maximum instanceof Vector2) && maximumSet) {
        maximum = new Vector2(maximum, maximum);
      }

      if (minimumSet) {
        this.x = Math.max(minimum.x, this.x);
        this.y = Math.max(minimum.y, this.y);
      }

      if (maximumSet) {
        this.x = Math.min(maximum.x, this.x);
        this.y = Math.min(maximum.y, this.y);
      }
      return this;
    }

    /**
     * Divides this vector by the given Vector2 / Number
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} divisor
     * @param  {Number} [y]
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'divide',
    value: function divide(divisor, y) {
      if (divisor instanceof Vector2) {
        this.x /= divisor.x;
        this.y /= divisor.y;
      } else {
        this.x /= divisor;
        this.y /= typeof y === 'undefined' ? divisor : y;
      }
      return this;
    }

    /**
     * Subtracts the given Vector2 / Number from this vector
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} subtrahend
     * @param  {Number} [y]
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'subtract',
    value: function subtract(subtrahend, y) {
      if (subtrahend instanceof Vector2) {
        this.x -= subtrahend.x;
        this.y -= subtrahend.y;
      } else {
        this.x -= subtrahend;
        this.y -= typeof y === 'undefined' ? subtrahend : y;
      }
      return this;
    }

    /**
     * Multiplies the given Vector2 / Number with this vector
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} subtrahend
     * @param  {Number} [y]
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'multiply',
    value: function multiply(factor, y) {
      if (factor instanceof Vector2) {
        this.x *= factor.x;
        this.y *= factor.y;
      } else {
        this.x *= factor;
        this.y *= typeof y === 'undefined' ? factor : y;
      }
      return this;
    }

    /**
     * Adds the given Vector2 / Numbers to this vector
     * @param {(Number|PhotoEditorSDK.Math.Vector2)} addend
     * @param {Number} [y]
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'add',
    value: function add(addend, y) {
      if (addend instanceof Vector2) {
        this.x += addend.x;
        this.y += addend.y;
      } else {
        this.x += addend;
        this.y += typeof y === 'undefined' ? addend : y;
      }
      return this;
    }

    /**
     * Computes the dot product of this vector and the
     * given Vector2 / Numbers
     * @param {(Number|PhotoEditorSDK.Math.Vector2)} vec
     * @param {Number} [y]
     * @returns {Number}
     */

  }, {
    key: 'dot',
    value: function dot(vec, y) {
      if (vec instanceof Vector2) {
        return this.x * vec.x + this.y * vec.y;
      } else {
        return this.x * vec + this.y * (typeof y === 'undefined' ? vec : y);
      }
    }

    /**
     * Checks whether the x and y value are the same as the given ones
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} vec
     * @param  {Number} y
     * @return {Boolean}
     */

  }, {
    key: 'equals',
    value: function equals(vec, y) {
      if (vec instanceof Vector2) {
        return vec.x === this.x && vec.y === this.y;
      } else {
        return vec === this.x && y === this.y;
      }
    }

    /**
     * Flips the x and y values of this vector
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'flip',
    value: function flip() {
      var tempX = this.x;
      this.x = this.y;
      this.y = tempX;
      return this;
    }

    /**
     * Rounds the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'round',
    value: function round() {
      this.x = Math.round(this.x);
      this.y = Math.round(this.y);
      return this;
    }

    /**
     * Rounds up the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'ceil',
    value: function ceil() {
      this.x = Math.ceil(this.x);
      this.y = Math.ceil(this.y);
      return this;
    }

    /**
     * Rounds down the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'floor',
    value: function floor() {
      this.x = this.x | 0;
      this.y = this.y | 0;
      return this;
    }

    /**
     * Makes both numbers of this vector positive
     * @returns {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'abs',
    value: function abs() {
      this.x = Math.abs(this.x);
      this.y = Math.abs(this.y);
      return this;
    }

    /**
     * Returns the euclidean length of this vector
     * @return {Number}
     */

  }, {
    key: 'len',
    value: function len() {
      return Math.sqrt(this.x * this.x + this.y * this.y);
    }

    /**
     * Returns the smallest number in this vector
     * @return {Number}
     */

  }, {
    key: 'min',
    value: function min() {
      return Math.min(this.x, this.y);
    }

    /**
     * Returns the largest number in this vector
     * @return {Number}
     */

  }, {
    key: 'max',
    value: function max() {
      return Math.max(this.x, this.y);
    }

    /**
     * Returns a POJO of this Vector2
     * @return {Object}
     */

  }, {
    key: 'toObject',
    value: function toObject() {
      return { x: this.x, y: this.y };
    }

    /**
     * Returns a string representation of this vector
     * @return {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'Vector2({ x: ' + this.x + ', y: ' + this.y + ' })';
    }

    /**
     * Rounds this vector's values to the given number of decimals
     * @param  {Number} decimals
     * @return {Number}
     */

  }, {
    key: 'roundDecimal',
    value: function roundDecimal(decimals) {
      this.x = parseFloat(this.x.toFixed(decimals));
      this.y = parseFloat(this.y.toFixed(decimals));
      return this;
    }

    /**
     * Returns the values in an array
     * @param {Bool} reverse
     * @return {Number[]}
     */

  }, {
    key: 'asArray',
    value: function asArray() {
      var reverse = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      if (reverse) {
        return [this.y, this.x];
      }

      return [this.x, this.y];
    }

    /**
     * Creates a new Vector2 instance from the given Object
     * @param  {Object} object
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }], [{
    key: 'fromObject',
    value: function fromObject(object) {
      return new Vector2(object.x, object.y);
    }

    /**
     * Returns a null vector
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'NULL',
    get: function get() {
      return new Vector2(0, 0);
    }
  }]);

  return Vector2;
}();

/* harmony default export */ __webpack_exports__["a"] = (Vector2);

/***/ }),
/* 46 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* WEBPACK VAR INJECTION */(function(global) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_set_immediate__ = __webpack_require__(286);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_set_immediate___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_set_immediate__);






var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

/* eslint-disable */

/*!
 * Native Promise Only
 * v0.8.0-a (c) Kyle Simpson
 * MIT License: http://getify.mit-license.org
 */

/* istanbul ignore next */
var promiseFactory = function DEF() {

  var builtInProp,
      cycle,
      scheduling_queue,
      ToString = Object.prototype.toString,
      timer = typeof __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_set_immediate___default.a != "undefined" ? function timer(fn) {
    return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_set_immediate___default()(fn);
  } : setTimeout;

  // dammit, IE8.
  try {
    Object.defineProperty({}, "x", {});
    builtInProp = function builtInProp(obj, name, val, config) {
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default()(obj, name, {
        value: val,
        writable: true,
        configurable: config !== false
      });
    };
  } catch (err) {
    builtInProp = function builtInProp(obj, name, val) {
      obj[name] = val;
      return obj;
    };
  }

  // Note: using a queue instead of array for efficiency
  scheduling_queue = function Queue() {
    var first, last, item;

    function Item(fn, self) {
      this.fn = fn;
      this.self = self;
      this.next = void 0;
    }

    return {
      add: function add(fn, self) {
        item = new Item(fn, self);
        if (last) {
          last.next = item;
        } else {
          first = item;
        }
        last = item;
        item = void 0;
      },
      drain: function drain() {
        var f = first;
        first = last = cycle = void 0;

        while (f) {
          f.fn.call(f.self);
          f = f.next;
        }
      }
    };
  }();

  function schedule(fn, self) {
    scheduling_queue.add(fn, self);
    if (!cycle) {
      cycle = timer(scheduling_queue.drain);
    }
  }

  // promise duck typing
  function isThenable(o) {
    var _then,
        o_type = typeof o === "undefined" ? "undefined" : _typeof(o);

    if (o != null && (o_type == "object" || o_type == "function")) {
      _then = o.then;
    }
    return typeof _then == "function" ? _then : false;
  }

  function notify() {
    for (var i = 0; i < this.chain.length; i++) {
      notifyIsolated(this, this.state === 1 ? this.chain[i].success : this.chain[i].failure, this.chain[i]);
    }
    this.chain.length = 0;
  }

  // NOTE: This is a separate function to isolate
  // the `try..catch` so that other code can be
  // optimized better
  function notifyIsolated(self, cb, chain) {
    var ret, _then;
    try {
      if (cb === false) {
        chain.reject(self.msg);
      } else {
        if (cb === true) {
          ret = self.msg;
        } else {
          ret = cb.call(void 0, self.msg);
        }

        if (ret === chain.promise) {
          chain.reject(TypeError("Promise-chain cycle"));
        } else if (_then = isThenable(ret)) {
          _then.call(ret, chain.resolve, chain.reject);
        } else {
          chain.resolve(ret);
        }
      }
    } catch (err) {
      chain.reject(err);
    }
  }

  function resolve(msg) {
    var _then,
        self = this;

    // already triggered?
    if (self.triggered) {
      return;
    }

    self.triggered = true;

    // unwrap
    if (self.def) {
      self = self.def;
    }

    try {
      if (_then = isThenable(msg)) {
        schedule(function () {
          var def_wrapper = new MakeDefWrapper(self);
          try {
            _then.call(msg, function $resolve$() {
              resolve.apply(def_wrapper, arguments);
            }, function $reject$() {
              reject.apply(def_wrapper, arguments);
            });
          } catch (err) {
            reject.call(def_wrapper, err);
          }
        });
      } else {
        self.msg = msg;
        self.state = 1;
        if (self.chain.length > 0) {
          schedule(notify, self);
        }
      }
    } catch (err) {
      reject.call(new MakeDefWrapper(self), err);
    }
  }

  function reject(msg) {
    var self = this;

    // already triggered?
    if (self.triggered) {
      return;
    }

    self.triggered = true;

    // unwrap
    if (self.def) {
      self = self.def;
    }

    self.msg = msg;
    self.state = 2;
    if (self.chain.length > 0) {
      schedule(notify, self);
    }
  }

  function iteratePromises(Constructor, arr, resolver, rejecter) {
    for (var idx = 0; idx < arr.length; idx++) {
      (function IIFE(idx) {
        Constructor.resolve(arr[idx]).then(function $resolver$(msg) {
          resolver(idx, msg);
        }, rejecter);
      })(idx);
    }
  }

  function MakeDefWrapper(self) {
    this.def = self;
    this.triggered = false;
  }

  function MakeDef(self) {
    this.promise = self;
    this.state = 0;
    this.triggered = false;
    this.chain = [];
    this.msg = void 0;
  }

  function Promise(executor) {
    if (typeof executor != "function") {
      throw TypeError("Not a function");
    }

    if (this.__NPO__ !== 0) {
      throw TypeError("Not a promise");
    }

    // instance shadowing the inherited "brand"
    // to signal an already "initialized" promise
    this.__NPO__ = 1;

    var def = new MakeDef(this);

    this["then"] = function then(success, failure) {
      var o = {
        success: typeof success == "function" ? success : true,
        failure: typeof failure == "function" ? failure : false
      };
      // Note: `then(..)` itself can be borrowed to be used against
      // a different promise constructor for making the chained promise,
      // by substituting a different `this` binding.
      o.promise = new this.constructor(function extractChain(resolve, reject) {
        if (typeof resolve != "function" || typeof reject != "function") {
          throw TypeError("Not a function");
        }

        o.resolve = resolve;
        o.reject = reject;
      });
      def.chain.push(o);

      if (def.state !== 0) {
        schedule(notify, def);
      }

      return o.promise;
    };
    this["catch"] = function $catch$(failure) {
      return this.then(void 0, failure);
    };

    try {
      executor.call(void 0, function publicResolve(msg) {
        resolve.call(def, msg);
      }, function publicReject(msg) {
        reject.call(def, msg);
      });
    } catch (err) {
      reject.call(def, err);
    }
  }

  var PromisePrototype = builtInProp({}, "constructor", Promise,
  /*configurable=*/false);

  // Note: Android 4 cannot use `Object.defineProperty(..)` here
  Promise.prototype = PromisePrototype;

  // built-in "brand" to signal an "uninitialized" promise
  builtInProp(PromisePrototype, "__NPO__", 0,
  /*configurable=*/false);

  builtInProp(Promise, "resolve", function Promise$resolve(msg) {
    var Constructor = this;

    // spec mandated checks
    // note: best "isPromise" check that's practical for now
    if (msg && (typeof msg === "undefined" ? "undefined" : _typeof(msg)) == "object" && msg.__NPO__ === 1) {
      return msg;
    }

    return new Constructor(function executor(resolve, reject) {
      if (typeof resolve != "function" || typeof reject != "function") {
        throw TypeError("Not a function");
      }

      resolve(msg);
    });
  });

  builtInProp(Promise, "reject", function Promise$reject(msg) {
    return new this(function executor(resolve, reject) {
      if (typeof resolve != "function" || typeof reject != "function") {
        throw TypeError("Not a function");
      }

      reject(msg);
    });
  });

  builtInProp(Promise, "all", function Promise$all(arr) {
    var Constructor = this;

    // spec mandated checks
    if (ToString.call(arr) != "[object Array]") {
      return Constructor.reject(TypeError("Not an array"));
    }
    if (arr.length === 0) {
      return Constructor.resolve([]);
    }

    return new Constructor(function executor(resolve, reject) {
      if (typeof resolve != "function" || typeof reject != "function") {
        throw TypeError("Not a function");
      }

      var len = arr.length,
          msgs = Array(len),
          count = 0;

      iteratePromises(Constructor, arr, function resolver(idx, msg) {
        msgs[idx] = msg;
        if (++count === len) {
          resolve(msgs);
        }
      }, reject);
    });
  });

  builtInProp(Promise, "race", function Promise$race(arr) {
    var Constructor = this;

    // spec mandated checks
    if (ToString.call(arr) != "[object Array]") {
      return Constructor.reject(TypeError("Not an array"));
    }

    return new Constructor(function executor(resolve, reject) {
      if (typeof resolve != "function" || typeof reject != "function") {
        throw TypeError("Not a function");
      }

      iteratePromises(Constructor, arr, function resolver(idx, msg) {
        resolve(msg);
      }, reject);
    });
  });

  return Promise;
};

var root = typeof global === 'undefined' ? window : global;
var _Promise = typeof __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a !== 'undefined' ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a : promiseFactory();
root.Promise = root.Promise || _Promise;
/* harmony default export */ __webpack_exports__["a"] = (_Promise);
/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(64)));

/***/ }),
/* 47 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Words; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__);



var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Words = function () {
  function Words(text) {
    _classCallCheck(this, Words);

    this.words = [];

    if (text) {
      this.splitIntoWords(text);
    }
  }

  /**
   * Splits the given text into words, which are stores in the `words` array,
   * and returned a copy.
   *
   * @param {String} text
   * @returns {Array<String>}
   */


  _createClass(Words, [{
    key: 'splitIntoWords',
    value: function splitIntoWords(text) {
      this.words = text.match(/\S+/g) || [];

      return [].concat(_toConsumableArray(this.words));
    }

    /**
     * Gets the list of words.
     *
     * @returns {Array<String>}
     */

  }, {
    key: 'get',
    value: function get() {
      return [].concat(_toConsumableArray(this.words));
    }
  }, {
    key: 'getWord',
    value: function getWord(index) {
      return this.words[index];
    }
  }, {
    key: 'set',
    value: function set(words) {
      this.words = [].concat(_toConsumableArray(words));

      return this;
    }

    /**
     * Returns a new Words instance, initialized with the sliced words of the
     * current instance, from `start` (including) to `end` (excluding).
     *
     * @param {Number} start
     * @param {Number} end
     * @returns Words
     * @memberof Words
     */

  }, {
    key: 'slice',
    value: function slice(start, end) {
      return Words.fromWords(this.words.slice(start, end));
    }

    /**
     * Gets the list of words converted to lower case characters.
     *
     * @returns {Array<String>}
     * @memberof Words
     */

  }, {
    key: 'getLowerCase',
    value: function getLowerCase() {
      return this.words.map(function (w) {
        return w.toLowerCase();
      });
    }

    /**
     * Gets the list of words converted to upper case characters.
     *
     * @returns {Array<String>}
     * @memberof Words
     */

  }, {
    key: 'getUpperCase',
    value: function getUpperCase() {
      return this.words.map(function (w) {
        return w.toUpperCase();
      });
    }

    /**
     * Returns the number of words.
     *
     * @returns {Number}
     */

  }, {
    key: 'size',
    value: function size() {
      return this.words.length;
    }

    /**
     * Returns the number of characters contained in all the words.
     *
     * @returns {Number}
     * @memberof Words
     */

  }, {
    key: 'countNumberOfCharacters',
    value: function countNumberOfCharacters() {
      return this.words.reduce(function (acc, s) {
        return acc + s.length;
      }, 0);
    }

    /**
     *  Divides the list of words into a list of a given number of lines.
     *
     * @param {Number} numberOfLines
     * @returns {Array<String>}
     * @memberof Words
     */

  }, {
    key: 'joined',
    value: function joined(numberOfLines) {
      var _this = this;

      var numberOfWords = this.size();
      var wordsPerLine = Math.floor(numberOfWords / numberOfLines);
      var extraWords = numberOfWords % numberOfLines;

      var lineStartPos = 0;
      var lineEndPos = 0;
      return __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__["Utils"].Array.range(0, numberOfLines).map(function (i) {
        lineStartPos = lineEndPos;
        var numOfWordsInLine = wordsPerLine + (i < extraWords ? 1 : 0);
        lineEndPos = Math.min(lineStartPos + numOfWordsInLine, numberOfWords);

        return __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__["Utils"].Array.range(lineStartPos, lineEndPos).reduce(function (line, j) {
          return line + (j === lineStartPos ? '' : ' ') + _this.words[j];
        }, '');
      });
    }

    /**
     * Returns a Words instance with the given words.∑
     *
     * @static
     * @param {Array<String>} words
     * @returns Words
     */

  }], [{
    key: 'fromWords',
    value: function fromWords(words) {
      var result = new Words();
      result.words = [].concat(_toConsumableArray(words));

      return result;
    }
  }]);

  return Words;
}();

/***/ }),
/* 48 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* unused harmony export drawImageRect */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return fillRect; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return drawRoundedRect; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return strokeRect; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return fillRectPunctuated; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return drawImageWithCapInsets; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return drawImageFrame; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__);



var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Rectangle = __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__["Math"].Rectangle,
    Vector2 = __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__["Math"].Vector2;


var drawImageRect = function drawImageRect(context, image, srcRect, destRect) {
  context.drawImage(image, srcRect.x, srcRect.y, srcRect.width, srcRect.height, destRect.x, destRect.y, destRect.width, destRect.height);
};

var fillRect = function fillRect(context, rect, color) {
  var compositeOperation = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'source-over';
  var stroke = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;

  context.save();
  context.fillStyle = color.toRGBA();
  context.globalCompositeOperation = compositeOperation;
  context.fillRect(rect.x, rect.y, rect.width, rect.height);

  if (stroke) {
    context.strokeStyle = color.toRGBA();
    context.strokeWith = 1;
    context.strokeRect(rect.x, rect.y, rect.width, rect.height);
  }

  context.restore();
};

var drawRoundedRect = function drawRoundedRect(context, rect, radius, color) {
  var compositeOperation = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 'source-over';
  var stroke = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;

  context.save();
  context.fillStyle = color.toRGBA();
  context.globalCompositeOperation = compositeOperation;

  radius = Math.min(Math.max(radius, 0), Math.min(rect.height, rect.width) * 0.5);

  var left = rect.x;
  var right = rect.x + rect.width;
  var top = rect.y;
  var bottom = rect.y + rect.height;

  context.beginPath();
  context.moveTo(left + radius, top);
  context.arcTo(right, top, right, bottom, radius);
  context.arcTo(right, bottom, left, bottom, radius);
  context.arcTo(left, bottom, left, top, radius);
  context.arcTo(left, top, right, top, radius);

  context.closePath();

  context.fill();
  if (stroke) {
    context.stroke();
  }

  context.restore();
};

var strokeRect = function strokeRect(context, rect, color) {
  var lineWidth = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 4;

  context.save();
  context.strokeStyle = color.toRGBA();
  context.lineWidth = lineWidth;
  context.strokeRect(rect.x, rect.y, rect.width, rect.height);
  context.restore();
};

var fillRectPunctuated = function fillRectPunctuated(context, rect, color) {
  var compositeOperation = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'source-over';

  context.save();

  var radius = rect.height / 2;

  var centerY = rect.y + radius;
  var centerX = rect.x + radius;
  var endX = rect.x + rect.width;

  context.fillStyle = color.toRGBA();
  context.globalCompositeOperation = compositeOperation;

  while (centerX < endX) {
    context.beginPath();
    context.arc(centerX, centerY, radius, 0, 2 * Math.PI);
    context.fill();

    centerX += radius * 4;
  }

  context.restore();
};

var buildCapRectangle = function buildCapRectangle(rectangle, capInsets) {
  var center = capInsets.applyToRectangle(rectangle);
  var x = rectangle.x,
      y = rectangle.y,
      width = rectangle.width,
      height = rectangle.height;


  var corners = [Rectangle.FromDiagonalPoints(new Vector2(0, 0), new Vector2(center.x, center.y)), Rectangle.FromDiagonalPoints(new Vector2(0, center.y + center.height), new Vector2(center.x, height)), Rectangle.FromDiagonalPoints(new Vector2(center.x + center.width, center.y + center.height), new Vector2(width, height)), Rectangle.FromDiagonalPoints(new Vector2(center.x + center.width, 0), new Vector2(width, center.y))].map(function (r) {
    return r.translate(x, y);
  });

  var bars = [Rectangle.FromDiagonalPoints(new Vector2(center.x, 0), new Vector2(center.x + center.width, center.y)), Rectangle.FromDiagonalPoints(new Vector2(0, center.y), new Vector2(center.x, center.y + center.height)), Rectangle.FromDiagonalPoints(new Vector2(center.x, center.y + center.height), new Vector2(center.x + center.width, height)), Rectangle.FromDiagonalPoints(new Vector2(center.x + center.width, center.y), new Vector2(width, center.y + center.height))].map(function (r) {
    return r.translate(x, y);
  });

  return { corners: corners, bars: bars, center: center };
};

var drawImageWithCapInsets = function drawImageWithCapInsets(context, image, destRect, capInsets) {
  var imageWidth = image.naturalWidth || image.width;
  var imageHeight = image.naturalHeight || image.height;

  // Divide the source rectangle into cap sections
  var capSource = buildCapRectangle(new Rectangle(0, 0, imageWidth, imageHeight), capInsets);

  // Divide the destination rect into cap sections
  var capDest = buildCapRectangle(destRect, capInsets);

  drawImageRect(context, image, capSource.center, capDest.center);
  __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__["Utils"].Array.zip(capSource.corners, capDest.corners).forEach(function (_ref) {
    var _ref2 = _slicedToArray(_ref, 2),
        src = _ref2[0],
        dst = _ref2[1];

    return drawImageRect(context, image, src, dst);
  });
  __WEBPACK_IMPORTED_MODULE_2_photoeditorsdk_core__["Utils"].Array.zip(capSource.bars, capDest.bars).forEach(function (_ref3) {
    var _ref4 = _slicedToArray(_ref3, 2),
        src = _ref4[0],
        dst = _ref4[1];

    return drawImageRect(context, image, src, dst);
  });
};

var drawImageFrame = function drawImageFrame(context, image, frame, color) {
  var compositeMode = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 'source-atop';

  context.save();

  if (color) {
    context.globalAlpha = color.a;
  }

  context.drawImage(image, frame.x, frame.y, frame.width, frame.height);

  if (color) {
    context.globalAlpha = 1;
  }

  if (color) {
    var c = color.clone();
    c.a = 1;
    fillRect(context, frame, c, compositeMode);
  }

  context.restore();
};

/***/ }),
/* 49 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.14 / 15.2.3.14 Object.keys(O)
var $keys = __webpack_require__(137);
var enumBugKeys = __webpack_require__(102);

module.exports = Object.keys || function keys(O) {
  return $keys(O, enumBugKeys);
};


/***/ }),
/* 50 */
/***/ (function(module, exports, __webpack_require__) {

var $at = __webpack_require__(239)(true);

// 21.1.3.27 String.prototype[@@iterator]()
__webpack_require__(104)(String, 'String', function (iterated) {
  this._t = String(iterated); // target
  this._i = 0;                // next index
// 21.1.5.2.1 %StringIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var index = this._i;
  var point;
  if (index >= O.length) return { value: undefined, done: true };
  point = $at(O, index);
  this._i += point.length;
  return { value: point, done: false };
});


/***/ }),
/* 51 */
/***/ (function(module, exports) {

module.exports = {};


/***/ }),
/* 52 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignElement; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var TextDesignElement = function (_Configurable) {
  _inherits(TextDesignElement, _Configurable);

  function TextDesignElement() {
    _classCallCheck(this, TextDesignElement);

    return _possibleConstructorReturn(this, (TextDesignElement.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignElement)).apply(this, arguments));
  }

  return TextDesignElement;
}(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Configurable"]);

TextDesignElement.prototype.availableOptions = {
  text: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].STRING, default: '' },
  frame: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].OBJECT, default: null },
  font: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].OBJECT, default: null }
};

/***/ }),
/* 53 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignMasked; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design__ = __webpack_require__(76);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_words__ = __webpack_require__(47);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__models_masked_row_type__ = __webpack_require__(80);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__models_rows_masked_text_design_row_multiline__ = __webpack_require__(127);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__text_design_asset_manager__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__models_randomizer__ = __webpack_require__(20);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */









// TODO: TextDesignRowMultiline

var TextDesignMasked = function (_TextDesign) {
  _inherits(TextDesignMasked, _TextDesign);

  function TextDesignMasked() {
    var _ref;

    _classCallCheck(this, TextDesignMasked);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignMasked.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignMasked)).call.apply(_ref, [this].concat(args)));

    _this._rowType = __WEBPACK_IMPORTED_MODULE_9__models_masked_row_type__["a" /* RowType */].Box;

    _this._alignmentRandomizer = new __WEBPACK_IMPORTED_MODULE_12__models_randomizer__["a" /* Randomizer */](0);
    _this._isMaskedRandomizer = new __WEBPACK_IMPORTED_MODULE_12__models_randomizer__["a" /* Randomizer */](0);

    _this._seedPool.push(_this._alignmentRandomizer);
    _this._seedPool.push(_this._isMaskedRandomizer);
    return _this;
  }

  _createClass(TextDesignMasked, [{
    key: 'getImagePaths',
    value: function getImagePaths() {
      return [__WEBPACK_IMPORTED_MODULE_9__models_masked_row_type__["a" /* RowType */].Box.getImagePath()];
    }
  }, {
    key: '_modifiedText',
    value: function _modifiedText(text) {
      return _get(TextDesignMasked.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignMasked.prototype), '_modifiedText', this).call(this, text).toLowerCase();
    }
  }, {
    key: '_modifiedLines',
    value: function _modifiedLines(lines) {
      var words = new __WEBPACK_IMPORTED_MODULE_8__text_words__["a" /* Words */]();
      words.set([lines.reduce(function (acc, line) {
        return '' + acc + (acc === '' ? '' : '\n') + line.joined(1)[0];
      }, '')]);
      return [words];
    }
  }, {
    key: '_layoutRows',
    value: function _layoutRows(lines, width) {
      var rows = _get(TextDesignMasked.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignMasked.prototype), '_layoutRows', this).call(this, lines, width);
      var firstRow = rows[0];

      if (firstRow && this.getSquareLayout()) {
        var size = firstRow.getSize();
        size.height = size.width;
      }

      return rows;
    }
  }, {
    key: 'getAlignment',
    value: function getAlignment() {
      return this._alignmentRandomizer.pickNext(this.constructor.ValidAlignments || TextDesignMasked.ValidAlignments);
    }
  }, {
    key: '_randomLayoutRow',
    value: function _randomLayoutRow(words, index, width, attributes) {
      var alignment = this.getAlignment();
      var rowType = this._rowType;
      var image = __WEBPACK_IMPORTED_MODULE_11__text_design_asset_manager__["a" /* AssetManager */].getImage(rowType.getImagePath());

      attributes.setAlignment(alignment);

      var row = new __WEBPACK_IMPORTED_MODULE_10__models_rows_masked_text_design_row_multiline__["a" /* TextDesignRowMultiline */]({
        words: words,
        width: width,
        attributes: attributes,
        image: image,
        imageInsets: rowType.insetsForWidth(width),
        capInsets: rowType.getCapInsets(),
        backgroundColor: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Color"].WHITE,
        centerOffset: 0,
        textScaleFactor: 0.7,
        isMasked: this._isMaskedRandomizer.nextBool()
      });

      if (this._rowType === __WEBPACK_IMPORTED_MODULE_9__models_masked_row_type__["a" /* RowType */].Box) {
        row.serverImageSmoothingFix = true;
      }

      var rowSize = row.getSize();

      if (this.getSquareLayout()) {
        rowSize.height = rowSize.width;
      } else {
        rowSize.height = Math.max(rowSize.height, rowSize.width * rowType.getMinimumHeightRatio());
      }

      return row;
    }
  }]);

  return TextDesignMasked;
}(__WEBPACK_IMPORTED_MODULE_7__text_design__["a" /* TextDesign */]);

TextDesignMasked.defaultFontIdentifiers = ['imgly_font_galano_grotesque_bold'];
TextDesignMasked.Alignment = {
  Left: 'left',
  Center: 'center',
  Right: 'right'
};
TextDesignMasked.ValidAlignments = [TextDesignMasked.Alignment.Left, TextDesignMasked.Alignment.Center, TextDesignMasked.Alignment.Right];
TextDesignMasked.identifier = 'imgly_text_design_masked';
TextDesignMasked.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_7__text_design__["a" /* TextDesign */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignMasked.defaultFontIdentifiers },
  squareLayout: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].BOOLEAN, default: true }
});

/***/ }),
/* 54 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * @class
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation
 */
var TensorUtils = function () {
  function TensorUtils() {
    _classCallCheck(this, TensorUtils);
  }

  _createClass(TensorUtils, null, [{
    key: "getSizeOfLogicalShape",
    value: function getSizeOfLogicalShape(logShape) {
      var size = logShape[0];
      for (var i = 1; i < logShape.length; i++) {
        size *= logShape[i];
      }

      return size;
    }

    /**
     *
     * @param {number[]} logShape - The logical shape to find a texture size for
     * @param {*} maxTexSize - The maximum edge length of a WebGL texture. Defaults to the WebGL minimum of 4096.
     * @return {number[]} textureDimensions - The required texture dimensions in a [height, width] array
     */

  }, {
    key: "getTextureDimensionsForLogicalShape",
    value: function getTextureDimensionsForLogicalShape(logShape) {
      var maxTexSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2048;

      var size = TensorUtils.getSizeOfLogicalShape(logShape);
      if (logShape.length <= 1 && size <= maxTexSize) {
        return [size, 1];
      } else if (logShape.length === 2 && logShape[0] <= maxTexSize && logShape[1] <= maxTexSize) {
        return logShape;
      } else if (logShape.length === 3 && logShape[0] * logShape[1] <= maxTexSize && logShape[2] <= maxTexSize) {
        return [logShape[0] * logShape[1], logShape[2]];
      } else if (logShape.length === 3 && logShape[0] <= maxTexSize && logShape[1] * logShape[2] <= maxTexSize) {
        return [logShape[0], logShape[1] * logShape[2]];
      } else if (logShape.length === 4 && logShape[0] * logShape[1] * logShape[2] <= maxTexSize && logShape[3] <= maxTexSize) {
        return [logShape[0] * logShape[1] * logShape[2], logShape[3]];
      } else if (logShape.length === 4 && logShape[0] <= maxTexSize && logShape[1] * logShape[2] * logShape[3] <= maxTexSize) {
        return [logShape[0], logShape[1] * logShape[2] * logShape[3]];
      } else {
        // If all 'optimizations' fail, return the most squarish size we can find
        for (var a = Math.floor(Math.sqrt(size)); a > 1; --a) {
          if (size % a === 0) {
            return [a, size / a];
          }
        }
        return [1, size];
      }
    }

    /**
     * @param {number[]} shapeA
     * @param {number[]} shapeB
     * @return {bool}
     */

  }, {
    key: "isSameShape",
    value: function isSameShape(shapeA, shapeB) {
      if (shapeA.length !== shapeB.length) {
        return false;
      }

      for (var index = 0; index < shapeA.length; index++) {
        if (shapeA[index] !== shapeB[index]) {
          return false;
        }
      }

      return true;
    }
  }]);

  return TensorUtils;
}();

/* harmony default export */ __webpack_exports__["a"] = (TensorUtils);

/***/ }),
/* 55 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_values__ = __webpack_require__(504);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_values___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_values__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_keys__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_globals__ = __webpack_require__(9);






var _extends = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var TextDesignManager = function () {
  function TextDesignManager(ui) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, TextDesignManager);

    this._ui = ui;
    this._options = options;

    this._defaultLayouts = __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.Layouts;
    this._legacyLayouts = __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.LegacyLayouts;
    this._layouts = [];
    this._init();
  }

  _createClass(TextDesignManager, [{
    key: '_init',
    value: function _init() {
      var availableLayouts = this._options.availableLayouts;


      var allLayouts = _extends({}, this._defaultLayouts, this._legacyLayouts);

      this._layouts = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_keys___default()(allLayouts).map(function (k) {
        return {
          identifier: allLayouts[k].identifier,
          layout: allLayouts[k]
        };
      });

      if (availableLayouts) {
        availableLayouts.push.apply(availableLayouts, _toConsumableArray(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_values___default()(this._legacyLayouts).map(function (i) {
          return i.identifier;
        })));
        this._layouts = this._layouts.filter(function (item) {
          return availableLayouts.indexOf(item.identifier) >= 0;
        });
      }
    }
  }, {
    key: 'getLayoutByIdentifier',
    value: function getLayoutByIdentifier(identifier) {
      var item = __WEBPACK_IMPORTED_MODULE_5_globals__["k" /* SDKUtils */].Array.find(this._layouts, function (l) {
        return l.identifier === identifier;
      });
      return item && item.layout;
    }
  }, {
    key: 'getLayouts',
    value: function getLayouts() {
      return [].concat(_toConsumableArray(this._layouts));
    }
  }, {
    key: 'getDefaultLayout',
    value: function getDefaultLayout() {
      return this.getLayouts()[0];
    }
  }]);

  return TextDesignManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (TextDesignManager);

/***/ }),
/* 56 */
/***/ (function(module, exports) {

module.exports = function (it) {
  if (typeof it != 'function') throw TypeError(it + ' is not a function!');
  return it;
};


/***/ }),
/* 57 */
/***/ (function(module, exports) {

module.exports = function (bitmap, value) {
  return {
    enumerable: !(bitmap & 1),
    configurable: !(bitmap & 2),
    writable: !(bitmap & 4),
    value: value
  };
};


/***/ }),
/* 58 */
/***/ (function(module, exports) {

exports.f = {}.propertyIsEnumerable;


/***/ }),
/* 59 */
/***/ (function(module, exports) {

var toString = {}.toString;

module.exports = function (it) {
  return toString.call(it).slice(8, -1);
};


/***/ }),
/* 60 */
/***/ (function(module, exports) {

module.exports = true;


/***/ }),
/* 61 */
/***/ (function(module, exports, __webpack_require__) {

var def = __webpack_require__(22).f;
var has = __webpack_require__(43);
var TAG = __webpack_require__(17)('toStringTag');

module.exports = function (it, tag, stat) {
  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });
};


/***/ }),
/* 62 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(241);
var global = __webpack_require__(16);
var hide = __webpack_require__(34);
var Iterators = __webpack_require__(51);
var TO_STRING_TAG = __webpack_require__(17)('toStringTag');

var DOMIterables = ('CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,' +
  'DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,' +
  'MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,' +
  'SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,' +
  'TextTrackList,TouchList').split(',');

for (var i = 0; i < DOMIterables.length; i++) {
  var NAME = DOMIterables[i];
  var Collection = global[NAME];
  var proto = Collection && Collection.prototype;
  if (proto && !proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);
  Iterators[NAME] = Iterators.Array;
}


/***/ }),
/* 63 */
/***/ (function(module, exports, __webpack_require__) {

var ctx = __webpack_require__(30);
var call = __webpack_require__(145);
var isArrayIter = __webpack_require__(146);
var anObject = __webpack_require__(28);
var toLength = __webpack_require__(82);
var getIterFn = __webpack_require__(111);
var BREAK = {};
var RETURN = {};
var exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {
  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);
  var f = ctx(fn, that, entries ? 2 : 1);
  var index = 0;
  var length, step, iterator, result;
  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');
  // fast case for arrays with default iterator
  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {
    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);
    if (result === BREAK || result === RETURN) return result;
  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {
    result = call(iterator, f, step.value, entries);
    if (result === BREAK || result === RETURN) return result;
  }
};
exports.BREAK = BREAK;
exports.RETURN = RETURN;


/***/ }),
/* 64 */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || Function("return this")() || (1,eval)("this");
} catch(e) {
	// This works if the window reference is available
	if(typeof window === "object")
		g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),
/* 65 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/*
 * Extracted from MinifyJpeg (Copyright (c) 2014 Hiroaki Matoba, MIT License):
 * https://github.com/hMatoba/MinifyJpeg
 * @license
 */

var KEY_STR = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';

/**
 * Provides Base64 encode and decode methods
 * @type {Object}
 * @ignore
 */
/* istanbul ignore next */
var Base64 = {
  /**
   * Encodes the given input into a Base64 string
   * @param  {String} input
   * @return {String}
   */
  encode: function encode(input) {
    var output = '';
    var chr1 = void 0,
        chr2 = void 0,
        chr3 = void 0;
    var enc1 = void 0,
        enc2 = void 0,
        enc3 = void 0,
        enc4 = void 0;
    var i = 0;

    do {
      chr1 = input[i++];
      chr2 = input[i++];
      chr3 = input[i++];

      enc1 = chr1 >> 2;
      enc2 = (chr1 & 3) << 4 | chr2 >> 4;
      enc3 = (chr2 & 15) << 2 | chr3 >> 6;
      enc4 = chr3 & 63;

      if (isNaN(chr2)) {
        enc3 = enc4 = 64;
      } else if (isNaN(chr3)) {
        enc4 = 64;
      }

      output = output + KEY_STR.charAt(enc1) + KEY_STR.charAt(enc2) + KEY_STR.charAt(enc3) + KEY_STR.charAt(enc4);
      chr1 = chr2 = chr3 = '';
      enc1 = enc2 = enc3 = enc4 = '';
    } while (i < input.length);

    return output;
  },


  /**
   * Decodes the given Base64 string
   * @param  {String} input
   * @return {String}
   */
  decode: function decode(input) {
    var chr1 = void 0,
        chr2 = void 0,
        chr3 = void 0;
    var enc1 = void 0,
        enc2 = void 0,
        enc3 = void 0,
        enc4 = void 0;
    var i = 0;
    var buf = [];

    // remove all characters that are not A-Z, a-z, 0-9, +, /, or =
    var base64test = /[^A-Za-z0-9+/=]/g;
    if (base64test.exec(input)) {
      throw new Error('There were invalid base64 characters in the input text.\n' + 'Valid base64 characters are A-Z, a-z, 0-9, \'+\', \'/\',and \'=\'\n' + 'Expect errors in decoding.');
    }
    input = input.replace(/[^A-Za-z0-9+/=]/g, '');

    do {
      enc1 = KEY_STR.indexOf(input.charAt(i++));
      enc2 = KEY_STR.indexOf(input.charAt(i++));
      enc3 = KEY_STR.indexOf(input.charAt(i++));
      enc4 = KEY_STR.indexOf(input.charAt(i++));

      chr1 = enc1 << 2 | enc2 >> 4;
      chr2 = (enc2 & 15) << 4 | enc3 >> 2;
      chr3 = (enc3 & 3) << 6 | enc4;

      buf.push(chr1);

      if (enc3 !== 64) {
        buf.push(chr2);
      }
      if (enc4 !== 64) {
        buf.push(chr3);
      }

      chr1 = chr2 = chr3 = '';
      enc1 = enc2 = enc3 = enc4 = '';
    } while (i < input.length);

    return buf;
  }
};

/* harmony default export */ __webpack_exports__["a"] = (Base64);

/***/ }),
/* 66 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);




var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Represents a color
 * @class
 * @memberof PhotoEditorSDK
 */
var Color = function () {
  /**
   * Creates a color
   * @param  {Number} r
   * @param  {Number} g
   * @param  {Number} b
   * @param  {Number} [a = 1]
   */
  function Color(r, g, b) {
    var a = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1.0;

    _classCallCheck(this, Color);

    this.r = r;
    this.g = g;
    this.b = b;
    this.a = a;
  }

  /**
   * Returns an rgba() representation of this color
   * @return {String}
   */


  _createClass(Color, [{
    key: 'toRGBA',
    value: function toRGBA() {
      var colors = [Math.round(this.r * 255), Math.round(this.g * 255), Math.round(this.b * 255), this.a.toFixed(2)];
      return 'rgba(' + colors.join(',') + ')';
    }

    /**
     * Sets this color's values to the given RGBA values
     * @param {Number} r
     * @param {Number} g
     * @param {Number} b
     * @param {Number} [a]
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'set',
    value: function set(r, g, b) {
      var a = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : this.a;

      this.r = r;
      this.g = g;
      this.b = b;
      this.a = a;
      return this;
    }

    /**
     * Returns an array with 3 values (0...255)
     * @return {Number[]}
     */

  }, {
    key: 'toRGB',
    value: function toRGB() {
      return [Math.round(this.r * 255), Math.round(this.g * 255), Math.round(this.b * 255)];
    }

    /**
     * Returns a hex representation of this color
     * @return {String}
     */

  }, {
    key: 'toHex',
    value: function toHex() {
      var components = [this._componentToHex(Math.round(this.r * 255)), this._componentToHex(Math.round(this.g * 255)), this._componentToHex(Math.round(this.b * 255))];
      return '#' + components.join('');
    }

    /**
     * Returns an array with 4 values (0...1)
     * @return {Number[]}
     */

  }, {
    key: 'toGLColor',
    value: function toGLColor() {
      return [this.r, this.g, this.b, this.a];
    }

    /**
     * Returns an array with 4 values (0...1)
     * @return {Number[]}
     */

  }, {
    key: 'toArray',
    value: function toArray() {
      return this.toGLColor();
    }

    /**
     * Returns an array with 3 values (0...1)
     * @return {Number[]}
     */

  }, {
    key: 'toRGBGLColor',
    value: function toRGBGLColor() {
      return [this.r, this.g, this.b];
    }

    /**
     * Converts the RGB value to HSV
     * @return {Number[]}
     */

  }, {
    key: 'toHSV',
    value: function toHSV() {
      var max = Math.max(this.r, this.g, this.b);
      var min = Math.min(this.r, this.g, this.b);
      var h = void 0;
      var s = void 0;
      var v = max;
      var d = max - min;
      s = max === 0 ? 0 : d / max;

      if (max === min) {
        h = 0; // achromatic
      } else {
        switch (max) {
          case this.r:
            h = (this.g - this.b) / d;
            if (this.g < this.b) {
              h += 6;
            }
            break;
          case this.g:
            h = (this.b - this.r) / d + 2;
            break;
          case this.b:
            h = (this.r - this.g) / d + 4;
            break;
        }
        h /= 6;
      }

      return [h, s, v];
    }

    /**
     * Sets the RGB values according to the given HSV values
     * @param  {Number} h
     * @param  {Number} s
     * @param  {Number} v
     */

  }, {
    key: 'fromHSV',
    value: function fromHSV(h, s, v) {
      this.copy(Color.fromHSV(h, s, v));
      return this;
    }

    /**
     * Creates an RGBA color from the given HSV and alpha values
     * @param {Number} h
     * @param {Number} s
     * @param {Number} v
     * @param {Number} [a = 1]
     */

  }, {
    key: 'clone',


    /**
     * Returns a clone of the current color
     * @return {PhotoEditorSDK.Color}
     */
    value: function clone() {
      return new Color(this.r, this.g, this.b, this.a);
    }

    /**
     * Adds another color
     * @param {PhotoEditorSDK.Color} color
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'add',
    value: function add(color) {
      this.r += color.r;
      this.g += color.g;
      this.b += color.b;
      this.a += color.a;
      return this;
    }

    /**
     * Subtract another color
     * @param {PhotoEditorSDK.Color} color
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'minus',
    value: function minus(color) {
      this.r -= color.r;
      this.g -= color.g;
      this.b -= color.b;
      this.a -= color.a;
      return this;
    }

    /**
     * Multiply with a scalar
     * @param {Number} val
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'multiplyScalar',
    value: function multiplyScalar(val) {
      this.r *= val;
      this.g *= val;
      this.b *= val;
      this.a *= val;
      return this;
    }

    /**
     * Divide with a scalar
     * @param {Number} val
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'divideScalar',
    value: function divideScalar(val) {
      this.r /= val;
      this.g /= val;
      this.b /= val;
      this.a /= val;
      return this;
    }

    /**
     * clamp
     * @param {Number} minVal
     * @param {Number} maxVal
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'clamp',
    value: function clamp(minVal, maxVal) {
      this.r = Math.min(Math.max(this.r, minVal), maxVal);
      this.g = Math.min(Math.max(this.g, minVal), maxVal);
      this.b = Math.min(Math.max(this.b, minVal), maxVal);
      this.a = Math.min(Math.max(this.a, minVal), maxVal);
      return this;
    }

    /**
     * Interpolate between this color and the supplied by the amount
     * determined by the parameter `a`.
     *
     * @param {PhotoEditorSDK.Color} c
     * @param {Number} a
     */

  }, {
    key: 'mix',
    value: function mix(c, a) {
      this.r = (1 - a) * this.r + a * c.r;
      this.g = (1 - a) * this.g + a * c.g;
      this.b = (1 - a) * this.b + a * c.b;
      this.a = (1 - a) * this.a + a * c.a;

      return this;
    }

    /**
     * Copies the values from the given color
     * @param  {PhotoEditorSDK.Color} color
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'copy',
    value: function copy(color) {
      this.r = color.r;
      this.g = color.g;
      this.b = color.b;
      this.a = color.a;
      return this;
    }

    /**
     * Checks if this color equals the given one
     * @param  {PhotoEditorSDK.Color} color
     * @return {Boolean}
     */

  }, {
    key: 'equals',
    value: function equals(color) {
      return this.r === color.r && this.g === color.g && this.b === color.b && this.a === color.a;
    }

    /**
     * Returns the given number as hex
     * @param  {Number} component
     * @return {String}
     * @private
     */

  }, {
    key: '_componentToHex',
    value: function _componentToHex(component) {
      var hex = component.toString(16);
      return hex.length === 1 ? '0' + hex : hex;
    }

    /**
     * Returns the string representation of this color
     * @returns {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'Color(' + this.r + ', ' + this.g + ', ' + this.b + ', ' + this.a + ')';
    }

    /**
     * @type {PhotoEditorSDK.Color}
     */

  }], [{
    key: 'fromHSV',
    value: function fromHSV(h, s, v) {
      var a = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
      var _ref = [],
          r = _ref[0],
          g = _ref[1],
          b = _ref[2];


      var i = Math.floor(h * 6);
      var f = h * 6 - i;
      var p = v * (1 - s);
      var q = v * (1 - f * s);
      var t = v * (1 - (1 - f) * s);

      switch (i % 6) {
        case 0:
          r = v;
          g = t;
          b = p;
          break;
        case 1:
          r = q;
          g = v;
          b = p;
          break;
        case 2:
          r = p;
          g = v;
          b = t;
          break;
        case 3:
          r = p;
          g = q;
          b = v;
          break;
        case 4:
          r = t;
          g = p;
          b = v;
          break;
        case 5:
          r = v;
          g = p;
          b = q;
          break;
      }

      return new Color(r, g, b, a);
    }

    /**
     * Creates a new Color object from the given array of numbers
     * @param  {Number[]} arr
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'fromArray',
    value: function fromArray(arr) {
      return new Color(arr[0], arr[1], arr[2], arr[3]);
    }

    /**
     * Creates a new color object from the given hex string
     * @param  {String} hex
     * @return {PhotoEditorSDK.Color}
     */

  }, {
    key: 'fromHex',
    value: function fromHex(hex) {
      var _hex$match = hex.match(/[0-9A-fa-f]{1,2}/g),
          _hex$match2 = _slicedToArray(_hex$match, 3),
          r = _hex$match2[0],
          g = _hex$match2[1],
          b = _hex$match2[2];

      return new Color(parseInt(r, 16) / 255, parseInt(g, 16) / 255, parseInt(b, 16) / 255, 1.0);
    }
  }, {
    key: 'TRANSPARENT',
    get: function get() {
      return new Color(0, 0, 0, 0);
    }

    /**
     * @type {PhotoEditorSDK.Color}
     */

  }, {
    key: 'WHITE',
    get: function get() {
      return new Color(1, 1, 1, 1);
    }

    /**
     * @type {PhotoEditorSDK.Color}
     */

  }, {
    key: 'BLACK',
    get: function get() {
      return new Color(0, 0, 0, 1);
    }

    /**
     * @type {PhotoEditorSDK.Color}
     */

  }, {
    key: 'RED',
    get: function get() {
      return new Color(1, 0, 0, 1);
    }

    /**
     * @type {PhotoEditorSDK.Color}
     */

  }, {
    key: 'BLUE',
    get: function get() {
      return new Color(0, 0, 1, 1);
    }

    /**
     * @type {PhotoEditorSDK.Color}
     */

  }, {
    key: 'GREEN',
    get: function get() {
      return new Color(0, 1, 0, 1);
    }
  }]);

  return Color;
}();

/* harmony default export */ __webpack_exports__["a"] = (Color);

/***/ }),
/* 67 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_log__ = __webpack_require__(24);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * EventEmitter (ES6) from:
 * https://gist.github.com/bloodyowl/41b1de3388c626796eca
 */


var DEFAULT_MAX_LISTENERS = 12;

/**
 * Receives and emits events
 * @class
 * @memberof PhotoEditorSDK
 */

var EventEmitter = function () {
  /**
   * Creates an EventEmitter
   */
  function EventEmitter() {
    _classCallCheck(this, EventEmitter);

    this._maxListeners = DEFAULT_MAX_LISTENERS;
    this._events = {};
    this._pipeDestinations = [];
  }

  /**
   * Pipes all events to the given EventEmitter
   * @param  {EventEmitter} destination
   */


  _createClass(EventEmitter, [{
    key: 'pipeEvents',
    value: function pipeEvents(destination) {
      this._pipeDestinations.push(destination);
    }

    /**
     * Stops piping events to the given EventEmitter
     * @param  {EventEmitter} destination
     */

  }, {
    key: 'unpipeEvents',
    value: function unpipeEvents(destination) {
      var i = this._pipeDestinations.indexOf(destination);
      if (i === -1) {
        return;
      }
      this._pipeDestinations.splice(i, 1);
    }

    /**
     * Adds the given listener to the given type of events
     * @param  {String} type
     * @param  {Function} listener
     */

  }, {
    key: 'on',
    value: function on(type, listener) {
      if (typeof type === 'undefined') {
        throw new Error('Invalid event type: `' + type + '`');
      }

      if (typeof listener !== 'function') {
        throw new TypeError();
      }

      var listeners = this._events[type] || (this._events[type] = []);
      if (listeners.indexOf(listener) !== -1) {
        return this;
      }
      listeners.push(listener);

      if (this._maxListeners && listeners.length > this._maxListeners) {
        __WEBPACK_IMPORTED_MODULE_1__shared_log__["a" /* default */].warn('EventEmitter', 'Possible memory leak detected, added ' + listeners.length + ' `' + type + '` listeners (current limit is ' + this._maxListeners + ')');
        if (typeof console !== 'undefined') {
          console.trace();
        }
      }
      return this;
    }

    /**
     * Adds the given listener to the given type of events and removes it
     * once it has been triggered
     * @param  {String} type
     * @param  {Function} listener
     */

  }, {
    key: 'once',
    value: function once(type, listener) {
      if (typeof type === 'undefined') {
        throw new Error('Invalid event type: `' + type + '`');
      }

      var eventsInstance = this;
      function onceCallback() {
        eventsInstance.off(type, onceCallback);
        listener.apply(null, arguments);
      }
      return this.on(type, onceCallback);
    }

    /**
     * Removes the given listener from the given type of events
     * @param  {String} type
     * @param  {*} ...args
     */

  }, {
    key: 'off',
    value: function off(type) {
      if (typeof type === 'undefined') {
        throw new Error('Invalid event type: `' + type + '`');
      }

      if ((arguments.length <= 1 ? 0 : arguments.length - 1) === 0) {
        this._events[type] = null;
        return this;
      }

      var listener = arguments.length <= 1 ? undefined : arguments[1];
      if (typeof listener !== 'function') {
        throw new TypeError();
      }

      var listeners = this._events[type];
      if (!listeners || !listeners.length) {
        return this;
      }

      var indexOfListener = listeners.indexOf(listener);
      if (indexOfListener === -1) {
        return this;
      }

      listeners.splice(indexOfListener, 1);
      return this;
    }

    /**
     * Emits an event with the given type and arguments
     * @param  {String} type
     * @param  {*} ...args
     */

  }, {
    key: 'emit',
    value: function emit(type) {
      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        args[_key - 1] = arguments[_key];
      }

      if (typeof type === 'undefined') {
        throw new Error('Invalid event type: `' + type + '`');
      }

      this._pipeDestinations.forEach(function (dest) {
        dest.emit.apply(dest, [type].concat(args));
      });

      var listeners = this._events[type];
      if (!listeners || !listeners.length) {
        return false;
      }

      listeners.slice(0).forEach(function (fn) {
        return fn.apply(null, args);
      });

      return true;
    }

    /**
     * Sets the maximum amonut of listeners before a warning is printed
     * @param {Number} newMaxListeners
     */

  }, {
    key: 'setMaxListeners',
    value: function setMaxListeners(newMaxListeners) {
      if (parseInt(newMaxListeners, 10) !== newMaxListeners) {
        throw new TypeError();
      }

      this._maxListeners = newMaxListeners;
    }
  }]);

  return EventEmitter;
}();

/* harmony default export */ __webpack_exports__["a"] = (EventEmitter);

/***/ }),
/* 68 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(12);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * A BaseTexture holds and handles the raw source of a texture
 * @class
 * @extends EventEmitter
 * @memberof PhotoEditorSDK.Engine
 */

var BaseTexture = function (_EventEmitter) {
  _inherits(BaseTexture, _EventEmitter);

  /**
   * Creates a BaseTexture
   * @param  {*} source
   */
  function BaseTexture(source) {
    _classCallCheck(this, BaseTexture);

    var _this = _possibleConstructorReturn(this, (BaseTexture.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BaseTexture)).call(this));

    _this.id = BaseTexture.id++;
    _this._onSourceLoaded = _this._onSourceLoaded.bind(_this);

    _this._renderers = [];
    _this._glTextures = {};
    _this._source = source;
    _this._dirty = true;

    _this._glUnit = 0;
    _this._mipMapping = false;
    _this._magFilter = BaseTexture.DefaultMagFilter;
    _this._minFilter = BaseTexture.DefaultMinFilter;
    _this._repeatX = BaseTexture.ClampToEdge;
    _this._repeatY = BaseTexture.ClampToEdge;

    _this._pixelRatio = 1;
    _this._loaded = false;
    _this._frame = new __WEBPACK_IMPORTED_MODULE_5__globals__["h" /* Rectangle */](0, 0, 100, 100);

    if (source) {
      _this._loadSource();
    }
    return _this;
  }

  /**
   * Resizes this BaseTexture to the given dimensions
   * @param  {PhotoEditorSDK.Math.Vector2} dimensions
   */


  _createClass(BaseTexture, [{
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      if (this._frame.width === dimensions.x && this._frame.height === dimensions.y) {
        return;
      }

      this._frame.width = dimensions.x;
      this._frame.height = dimensions.y;
      this._dirty = true;
    }

    /**
     * Loads the source
     * @private
     */

  }, {
    key: '_loadSource',
    value: function _loadSource() {
      var source = this._source;

      var sourceLoaded = source.complete;
      var sourceIsCanvas = source.constructor.name === 'Canvas' || source.tagName && source.tagName.toUpperCase() === 'CANVAS';
      if (sourceLoaded || sourceIsCanvas) {
        return this._onSourceLoaded();
      }

      source.addEventListener && source.addEventListener('load', this._onSourceLoaded);
    }

    /**
     * Gets called when the source of this BaseTexture has been loaded
     * @private
     */

  }, {
    key: '_onSourceLoaded',
    value: function _onSourceLoaded() {
      this._loaded = true;
      this.emit('loaded');
      this.update();
    }

    /**
     * If mip-mapping is available, update GL filters accordingly
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_updateGLFilters',
    value: function _updateGLFilters() {
      var sourceDimensions = new __WEBPACK_IMPORTED_MODULE_5__globals__["k" /* Vector2 */](this._source.width, this._source.height);
      if (__WEBPACK_IMPORTED_MODULE_5__globals__["i" /* Utils */].isPowerOfTwo(sourceDimensions)) {
        __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].info(this.constructor.name, 'Mip-mapping enabled');
        this._minFilter = BaseTexture.TrilinearFilter;
        this._mipMapping = true;
      } else {
        this._minFilter = BaseTexture.LinearFilter;
        this._mipMapping = false;
      }
    }

    /**
     * Updates the cached dimensions of this BaseTexture's source
     */

  }, {
    key: 'update',
    value: function update() {
      if (this._frame.width !== this._source.width || this._frame.height !== this._source.height) {
        this._frame = new __WEBPACK_IMPORTED_MODULE_5__globals__["h" /* Rectangle */](0, 0, this._source.width, this._source.height);
        this._dirty = true;
      }

      this._updateGLFilters();
      this.emit('update');
    }
  }, {
    key: 'getRenderers',
    value: function getRenderers() {
      return [].concat(_toConsumableArray(this._renderers));
    }

    /**
     * Returns the filter for the given direction from the given WebGL context
     * @param  {WebGLRenderingContext} gl
     * @param  {String} minOrMag
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'getGLFilter',
    value: function getGLFilter(gl, minOrMag) {
      switch (minOrMag) {
        case 'min':
          return this.constructor.getGLFilter(gl, this._minFilter);
        case 'mag':
          return this.constructor.getGLFilter(gl, this._magFilter);
      }
    }

    /**
     * Returns the filter for the given enum value from the given WebGL context
     * @param  {WebGLRenderingContext} gl
     * @param  {Number} filterEnum
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'isLoaded',


    /**
     * Checks if this BaseTexture has been loaded
     * @return {Boolean}
     */
    value: function isLoaded() {
      return this._loaded;
    }

    /**
     * Sets the loaded state
     * @param {Boolean} loaded
     */

  }, {
    key: 'setLoaded',
    value: function setLoaded(loaded) {
      this._loaded = loaded;
    }

    /**
     * Returns the source
     * @return {*} s
     */

  }, {
    key: 'getSource',
    value: function getSource() {
      return this._source;
    }

    /**
     * Sets the source
     * @param {*} source
     */

  }, {
    key: 'setSource',
    value: function setSource(source) {
      this._source = source;
    }

    /**
     * Returns the WebGL texture for the given renderer ID
     * @param  {PhotoEditorSDK.Engine.Renderer} renderer
     * @return {WebGLTexture}
     */
    /* istanbul ignore next */

  }, {
    key: 'getGLTextureForRenderer',
    value: function getGLTextureForRenderer(renderer) {
      return this._glTextures[renderer.id];
    }

    /**
     * Sets the WebGLTexture for the given renderer ID
     * @param {WebGLTexture} texture
     * @param {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     */
    /* istanbul ignore next */

  }, {
    key: 'setGLTextureForRenderer',
    value: function setGLTextureForRenderer(texture, renderer) {
      this._renderers[renderer.id] = renderer;
      this._glTextures[renderer.id] = texture;
    }

    /**
     * Returns the frame
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getFrame',
    value: function getFrame() {
      return this._frame;
    }

    /**
     * Sets the frame
     * @param {PhotoEditorSDK.Math.Rectangle} frame
     */

  }, {
    key: 'setFrame',
    value: function setFrame(frame) {
      this._frame = frame;
    }

    /**
     * Returns the dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions() {
      return new __WEBPACK_IMPORTED_MODULE_5__globals__["k" /* Vector2 */](this._frame.width, this._frame.height);
    }

    /**
     * Returns the pixel ratio
     * @return {Number}
     */

  }, {
    key: 'getPixelRatio',
    value: function getPixelRatio() {
      return this._pixelRatio;
    }

    /**
     * Sets the pixel ratio
     * @param {Number} pixelRatio
     */

  }, {
    key: 'setPixelRatio',
    value: function setPixelRatio(pixelRatio) {
      this._pixelRatio = pixelRatio;
    }

    /**
     * Returns the WebGL texture unit
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'getGLUnit',
    value: function getGLUnit() {
      return this._glUnit;
    }

    /**
     * Sets the WebGL texture unit
     * @param {Number} glUnit
     */
    /* istanbul ignore next */

  }, {
    key: 'setGLUnit',
    value: function setGLUnit(glUnit) {
      this._glUnit = glUnit;
    }

    /**
     * Sets the min filter to the given one
     * @param {Number} minFilter
     */
    /* istanbul ignore next */

  }, {
    key: 'setMinFilter',
    value: function setMinFilter(minFilter) {
      this._minFilter = minFilter;
    }

    /**
     * Returns this texture's min filter
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'getMinFilter',
    value: function getMinFilter() {
      return this._minFilter;
    }

    /**
     * Sets the mag filter to the given one
     * @param {Number} magFilter
     */
    /* istanbul ignore next */

  }, {
    key: 'setMagFilter',
    value: function setMagFilter(magFilter) {
      this._magFilter = magFilter;
    }

    /**
     * Returns this texture's mag filter
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'getMagFilter',
    value: function getMagFilter() {
      return this._magFilter;
    }

    /**
     * Sets the way the texture is repeated on the X axis
     * @param {Number} repeat
     */

  }, {
    key: 'setRepeatX',
    value: function setRepeatX(repeat) {
      this._repeatX = repeat;
    }

    /**
     * Returns the way the texture is repeated on the X axis
     * @return {Number}
     */

  }, {
    key: 'getRepeatX',
    value: function getRepeatX() {
      return this._repeatX;
    }

    /**
     * Sets the way the texture is repeated on the Y axis
     * @param {Number} repeat
     */

  }, {
    key: 'setRepeatY',
    value: function setRepeatY(repeat) {
      this._repeatY = repeat;
    }

    /**
     * Returns the way the texture is repeated on the Y axis
     * @return {Number}
     */

  }, {
    key: 'getRepeatY',
    value: function getRepeatY() {
      return this._repeatY;
    }

    /**
     * Returns the correct ENUM value for the given repeat direction
     * @param  {WebGLRenderingContext} gl
     * @param  {String} direction
     * @return {Number}
     */

  }, {
    key: 'getGLRepeat',
    value: function getGLRepeat(gl, direction) {
      var value = direction === 'x' ? this.getRepeatX() : this.getRepeatY();
      switch (value) {
        case BaseTexture.ClampToEdge:
          return gl.CLAMP_TO_EDGE;
        case BaseTexture.Repeat:
          return gl.REPEAT;
        case BaseTexture.MirroredRepeat:
          return gl.MIRRORED_REPEAT;
      }
    }

    /**
     * Checks if this base texture needs to be updated
     * @return {Boolean}
     */
    /* istanbul ignore next */

  }, {
    key: 'isDirty',
    value: function isDirty() {
      return this._dirty;
    }

    /**
     * Sets the dirtiness of this base texture
     * @param {Boolean} dirty
     */
    /* istanbul ignore next */

  }, {
    key: 'setDirty',
    value: function setDirty(dirty) {
      this._dirty = dirty;
    }

    /**
     * Disposes the WebGL textures for all renderers
     */
    /* istanbul ignore next */

  }, {
    key: 'disposeGLTextures',
    value: function disposeGLTextures() {
      var _this2 = this;

      this._renderers.forEach(function (renderer) {
        _this2.disposeGLTexturesForRenderer(renderer);
      });
    }

    /**
     * Disposes the WebGL textures for the given renderer
     * @param {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     */
    /* istanbul ignore next */

  }, {
    key: 'disposeGLTexturesForRenderer',
    value: function disposeGLTexturesForRenderer(renderer) {
      if (!this._glTextures[renderer.id]) return;

      var gl = renderer.getContext();
      gl.deleteTexture(this._glTextures[renderer.id]);
      delete this._glTextures[renderer.id];

      if (!this._renderers[renderer.id]) {
        delete this._renderers[renderer.id];
      }
    }

    /**
     * Checks if mip-mapping is enabled for this texture
     * @return {Boolean}
     */

  }, {
    key: 'isMipMappingEnabled',
    value: function isMipMappingEnabled() {
      return this._mipMapping;
    }

    /**
     * Sets the state for mip mapping
     * @param {Boolean} enabled
     */

  }, {
    key: 'setMipMappingEnabled',
    value: function setMipMappingEnabled(enabled) {
      this._mipMapping = enabled;
    }

    /**
     * Cleans up this object
     * @param  {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {

      this.disposeGLTextures();
      this._source = undefined;
    }
  }], [{
    key: 'getGLFilter',
    value: function getGLFilter(gl, filterEnum) {
      switch (filterEnum) {
        case BaseTexture.LinearFilter:
          return gl.LINEAR;
        case BaseTexture.NearestFilter:
          return gl.NEAREST;
        case BaseTexture.BilinearFilter:
          return gl.LINEAR_MIPMAP_NEAREST;
        case BaseTexture.TrilinearFilter:
          return gl.LINEAR_MIPMAP_LINEAR;
      }
    }
  }]);

  return BaseTexture;
}(__WEBPACK_IMPORTED_MODULE_5__globals__["d" /* EventEmitter */]);

BaseTexture.NearestFilter = 0;
BaseTexture.LinearFilter = 1;
BaseTexture.BilinearFilter = 2;
BaseTexture.TrilinearFilter = 3;

BaseTexture.DefaultMagFilter = BaseTexture.NearestFilter;
BaseTexture.DefaultMinFilter = BaseTexture.LinearFilter;

BaseTexture.ClampToEdge = 0;
BaseTexture.Repeat = 1;
BaseTexture.MirroredRepeat = 2;

BaseTexture.id = 0;

/* harmony default export */ __webpack_exports__["a"] = (BaseTexture);

/***/ }),
/* 69 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_configurable__ = __webpack_require__(70);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shaders_shader__ = __webpack_require__(117);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shaders_texture_shader__ = __webpack_require__(116);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var OptionType = __WEBPACK_IMPORTED_MODULE_5__globals__["c" /* Constants */].OptionType,
    UniformType = __WEBPACK_IMPORTED_MODULE_5__globals__["c" /* Constants */].UniformType,
    RendererType = __WEBPACK_IMPORTED_MODULE_5__globals__["c" /* Constants */].RendererType;

/**
 * A filter can be attached to a DisplayObject and affects the way it is displayed.
 * @class
 * @extends PhotoEditorSDK.Configurable
 * @memberof PhotoEditorSDK.Engine
 */

var Filter = function (_Configurable) {
  _inherits(Filter, _Configurable);

  function Filter() {
    _classCallCheck(this, Filter);

    return _possibleConstructorReturn(this, (Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Filter)).apply(this, arguments));
  }

  _createClass(Filter, [{
    key: '_initOptions',

    /**
     * Goes through the available options, sets _options defaults
     * @param {Object} userOptions
     * @override
     * @protected
     */
    value: function _initOptions() {
      var userOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      this._shaders = [];
      this._availableUniforms = __WEBPACK_IMPORTED_MODULE_8__shaders_texture_shader__["a" /* default */].defaultUniforms;
      this._attributes = __WEBPACK_IMPORTED_MODULE_8__shaders_texture_shader__["a" /* default */].defaultAttributes;
      this._vertexSource = __WEBPACK_IMPORTED_MODULE_8__shaders_texture_shader__["a" /* default */].defaultVertexSource;
      this._fragmentSource = __WEBPACK_IMPORTED_MODULE_8__shaders_texture_shader__["a" /* default */].defaultFragmentSource;

      this._initUniforms();
      _get(Filter.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Filter.prototype), '_initOptions', this).call(this, userOptions);
    }

    /**
     * Initializes the uniforms
     * @private
     */

  }, {
    key: '_initUniforms',
    value: function _initUniforms() {
      this._uniforms = {};
      for (var name in this._availableUniforms) {
        var uniform = this._availableUniforms[name];
        this._uniforms[name] = {
          type: uniform.type,
          value: uniform.default || null
        };
      }

      // Options are also turned into uniforms
      for (var optionName in this.availableOptions) {
        var optionConfig = this.availableOptions[optionName];

        if (!optionConfig.uniformType) {
          __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].trace(this.constructor.name, 'Option `' + optionName + '` is missing a `uniformType`!');
        } else {
          this._uniforms['u_' + optionName] = {
            type: optionConfig.uniformType,
            value: optionConfig.default || null
          };
        }
      }
    }

    /**
     * Sets the value for the given option, validates it
     * @param {String} optionName
     * @param {*} value
     * @param {Boolean} update = true
     * @override
     */

  }, {
    key: 'setOption',
    value: function setOption(optionName, value) {
      var update = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

      _get(Filter.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Filter.prototype), 'setOption', this).call(this, optionName, value, update);

      var uniformValue = value;
      var optionConfig = this.availableOptions[optionName];

      if (!optionConfig.uniformType) {
        return;
      }

      var uniformName = 'u_' + optionName;

      switch (optionConfig.type) {
        case OptionType.COLOR:
          if (optionConfig.uniformType === UniformType.FLOAT4) {
            uniformValue = value.toGLColor();
          } else if (optionConfig.uniformType === UniformType.FLOAT3) {
            uniformValue = value.toRGBGLColor();
          }
          break;
        case OptionType.VECTOR2:
          uniformValue = [value.x, value.y];
          break;
        case OptionType.COLOR_MATRIX:
          // a color matrix splits into 4x4 matrix and translation vector
          uniformValue = [value.a, value.b, value.c, value.d, value.f, value.g, value.h, value.i, value.k, value.l, value.m, value.n, value.p, value.q, value.r, value.s];
          var vectorValue = [value.e, value.j, value.o, value.t];
          this._uniforms[uniformName + '_vec'] = {
            value: vectorValue,
            type: UniformType.FLOAT4
          };
      }

      this.setUniform(uniformName, uniformValue);
    }

    /**
     * Sets the given uniform to the given value
     * @param {String} name
     * @param {*} value
     * @param {Boolean} sync = false
     */

  }, {
    key: 'setUniform',
    value: function setUniform(name, value) {

      this._uniforms[name].value = value;
    }

    /**
     * Sets the given uniforms to their values
     * @param {Object}  uniforms
     * @param {Boolean} sync = false
     */
    /* istanbul ignore next */

  }, {
    key: 'setUniforms',
    value: function setUniforms(uniforms) {
      var sync = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      for (var name in uniforms) {
        this._uniforms[name].value = uniforms[name];
        if (sync) {
          this.syncUniform(name);
        }
      }
    }

    /**
     * Synchronizes the uniform with the given name
     * @param  {String} name
     */
    /* istanbul ignore next */

  }, {
    key: 'syncUniform',
    value: function syncUniform(name) {
      this._shaders.forEach(function (shader) {
        shader.syncUniform(name);
      });
    }

    /**
     * Synchronizes all uniforms with WebGL
     */
    /* istanbul ignore next */

  }, {
    key: 'syncUniforms',
    value: function syncUniforms() {
      this._shaders.forEach(function (shader) {
        shader.syncUniforms();
      });
    }

    /**
     * Returns the shader for the given renderer
     * @param  {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     * @return {PhotoEditorSDK.Engine.Shader}
     */
    /* istanbul ignore next */

  }, {
    key: 'getShaderForRenderer',
    value: function getShaderForRenderer(renderer) {
      var gl = renderer.getContext();
      var shader = this._shaders[gl.id];

      if (!shader) {
        shader = new __WEBPACK_IMPORTED_MODULE_7__shaders_shader__["a" /* default */](renderer, this._vertexSource, this._fragmentSource, this._uniforms, this._attributes);

        this._shaders[gl.id] = shader;
      }

      return shader;
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget
     * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param  {PhotoEditorSDK.Engine.RenderTarget} inputTarget
     * @param  {PhotoEditorSDK.Engine.RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     */

  }, {
    key: 'apply',
    value: function apply(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      /* istanbul ignore if */
      if (renderer.isOfType(RendererType.WEBGL)) {
        this._applyWebGL(renderer, inputTarget, outputTarget, clear);
      } else if (renderer.isOfType(RendererType.CANVAS)) {
        this._applyCanvas(renderer, inputTarget, outputTarget, clear);
      }
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the WebGLRenderer
     * @param  {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     * @param  {PhotoEditorSDK.Engine.WebGLRenderTarget} inputTarget
     * @param  {PhotoEditorSDK.Engine.WebGLRenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_applyWebGL',
    value: function _applyWebGL(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var gl = renderer.getContext();
      var shader = this.getShaderForRenderer(renderer);

      renderer.setRenderTarget(outputTarget);
      if (clear) {
        outputTarget.clear();
      }

      renderer.setShader(shader);

      var projectionMatrix = renderer.getCurrentRenderTarget().getProjectionMatrix().toArray();
      shader.setUniform('u_projMatrix', projectionMatrix);
      shader.syncUniforms();

      // Render!
      gl.activeTexture(gl.TEXTURE0);
      gl.bindTexture(gl.TEXTURE_2D, inputTarget.getTexture());
      gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the CanvasRenderer
     * @param  {PhotoEditorSDK.Engine.CanvasRenderer} renderer
     * @param  {PhotoEditorSDK.Engine.RenderTarget} inputTarget
     * @param  {PhotoEditorSDK.Engine.RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var outputContext = outputTarget.getContext();

      __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].warn(this.constructor.name, '`_applyCanvas` is not implemented. Just copying image data from `inputTarget` to `outputTarget`.');

      outputContext.clearRect(0, 0, canvas.width, canvas.height);
      outputContext.drawImage(canvas, 0, 0);
    }

    /**
     * Disposes this Filter
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._shaders.forEach(function (shader) {
        return shader.dispose();
      });
      this._shaders = [];
    }
  }]);

  return Filter;
}(__WEBPACK_IMPORTED_MODULE_6__lib_configurable__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Filter);

/***/ }),
/* 70 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_keys__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_vendor_promise__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__shared_log_js__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__event_emitter__ = __webpack_require__(67);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__math_vector2__ = __webpack_require__(45);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__color__ = __webpack_require__(66);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__utils__ = __webpack_require__(32);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__image__ = __webpack_require__(89);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__math_color_matrix__ = __webpack_require__(164);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__constants__ = __webpack_require__(40);









var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _extends = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _defineProperty(obj, key, value) { if (key in obj) { __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default()(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* global HTMLImageElement, HTMLCanvasElement */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/* eslint-disable valid-typeof */











/**
 * Adds `set{OptionName}` and `get{OptionName}` methods to an object. Method names
 * are specified via the `availableOptions` object.
 * @class
 * @extends EventEmitter
 * @memberof PhotoEditorSDK
 */

var Configurable = function (_EventEmitter) {
  _inherits(Configurable, _EventEmitter);

  function Configurable() {
    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var additionalAvailableOptions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, Configurable);

    var _this = _possibleConstructorReturn(this, (Configurable.__proto__ || __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of___default()(Configurable)).call(this));

    _this.availableOptions = _this.availableOptions || {};
    _this.availableOptions = __WEBPACK_IMPORTED_MODULE_13__utils__["a" /* default */].extend(_this.availableOptions, additionalAvailableOptions);

    _this._onConfigurableUpdate = _this._onConfigurableUpdate.bind(_this);

    _this._initOptions(options);
    return _this;
  }

  /**
   * Builds an error message from the given string
   * @param  {String} message
   * @return {Error}
   * @private
   */


  _createClass(Configurable, [{
    key: '_buildConfigError',
    value: function _buildConfigError(message) {
      var errorMessage = '';
      if (this.constructor.name) {
        errorMessage = this.constructor.name + ': ';
      }
      errorMessage += message;
      return new Error(errorMessage);
    }

    /**
     * Gets called when options have been changed
     * @protected
     */

  }, {
    key: '_onOptionsChange',
    value: function _onOptionsChange() {}

    /**
     * Checks whether all required options are specified
     * @return {Promise}
     */

  }, {
    key: 'validateSettings',
    value: function validateSettings() {
      var _this2 = this;

      return new __WEBPACK_IMPORTED_MODULE_8__shared_vendor_promise__["a" /* default */](function (resolve, reject) {
        // Check for required options
        for (var optionName in _this2.availableOptions) {
          var optionConfig = _this2.availableOptions[optionName];
          if (optionConfig.required && typeof _this2._options[optionName] === 'undefined') {
            return reject(_this2._buildConfigError('Option `' + optionName + '` is required.'));
          }
        }

        resolve();
      });
    }

    /**
     * Goes through the available options, sets _options defaults
     * @param {Object} userOptions
     * @protected
     */

  }, {
    key: '_initOptions',
    value: function _initOptions() {
      var userOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      this._options = {};

      // Set defaults, create getters and setters
      var optionName = void 0,
          option = void 0,
          capitalized = void 0;
      var self = this;
      for (optionName in this.availableOptions) {
        capitalized = optionName.charAt(0).toUpperCase() + optionName.slice(1);
        option = this.availableOptions[optionName];

        if ([__WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].STRING, __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].NUMBER, __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].BOOLEAN, __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].OBJECT, __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].VECTOR2, __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].COLOR, __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].CONFIGURABLE, __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].COLOR_MATRIX, __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].ARRAY, __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].IMAGE, __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].FUNCTION, __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].ALL].indexOf(option.type) === -1) {
          throw this._buildConfigError('Unknown option type: `' + option.type + '`');
        }

        // Create setter and getter
        var fn = function fn(optionName, option) {
          self['set' + capitalized] = function (value, update, initial) {
            self.setOption(optionName, value, update, initial);
          };

          // Default getter
          self['get' + capitalized] = function () {
            return self.getOption(optionName);
          };
        };
        fn(optionName, option);

        // Handle configurable initialization
        if (option.type === __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].CONFIGURABLE) {
          this._options[optionName] = new Configurable(undefined, option.structure || {});
          this._options[optionName].on('update', this._onConfigurableUpdate);
        }

        // Set default if available
        if (!(optionName in userOptions) || typeof userOptions[optionName] === 'undefined') {
          if (typeof option.default !== 'undefined') {
            var defaultValue = option.default;
            if (typeof option.default === 'function') {
              defaultValue = option.default();
            }
            this['set' + capitalized](defaultValue, false, true);
          } else if (option.type !== __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].CONFIGURABLE) {
            this._options[optionName] = undefined;
          }
        }
      }

      // Overwrite options with the ones given by user
      for (optionName in userOptions) {
        // Check if option is available
        if (typeof this.availableOptions[optionName] === 'undefined') {
          throw new Error('Invalid option: ' + optionName);
        }

        if (typeof userOptions[optionName] !== 'undefined') {
          // Call setter
          capitalized = optionName.charAt(0).toUpperCase() + optionName.slice(1);
          this['set' + capitalized](userOptions[optionName], false, true);
        }
      }
    }

    /**
     * Sets the given options
     * @param {Object} options
     */

  }, {
    key: 'set',
    value: function set(options) {
      var emitUpdate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      for (var optionName in options) {
        this.setOption(optionName, options[optionName], false);
      }
      this._onOptionsChange();

      if (emitUpdate) {
        this.emit('update', this, options);
      }
    }

    /**
     * Returns the value for the given option
     * @param {String} optionName
     * @return {*}
     */

  }, {
    key: 'getOption',
    value: function getOption(optionName) {
      return this._options[optionName];
    }

    /**
     * Checks if this configurable has an option with the given name
     * @param  {String}  optionName
     * @return {Boolean}
     */

  }, {
    key: 'hasOption',
    value: function hasOption(optionName) {
      return !!this.availableOptions[optionName];
    }

    /**
     * Returns the default value for the given option
     * @param  {String} optionName
     * @return {*}
     */

  }, {
    key: 'getOptionDefault',
    value: function getOptionDefault(optionName) {
      var option = this.availableOptions[optionName];
      if (!option) {
        throw new Error('Invalid option: ' + optionName);
      }
      return option.default;
    }

    /**
     * Resets the options of the configurable to the default
     * ones.
     */

  }, {
    key: 'resetOptions',
    value: function resetOptions() {
      this.set(this.getDefaultOptions());
    }

    /**
     * Returns a hash with the default options
     * @return {Object}
     */

  }, {
    key: 'getDefaultOptions',
    value: function getDefaultOptions() {
      var options = {};
      for (var optionName in this.availableOptions) {
        var defaultValue = this.availableOptions[optionName].default;
        if (typeof defaultValue === 'undefined') continue;

        options[optionName] = defaultValue;
      }
      return options;
    }

    /**
     * Returns hash with all options
     * @return {Object}
     * @memberof Configurable
     */

  }, {
    key: 'getOptions',
    value: function getOptions() {
      return _extends({}, this._options);
    }

    /**
     * Check if the current object equals the given other
     * @param  {Configurable} other
     * @return {Boolean}
     * @memberof Configurable
     */

  }, {
    key: 'equals',
    value: function equals(other) {
      var otherOptions = other.getOptions();
      return this.optionsEqual(otherOptions);
    }

    /**
     * Check if the current options equal the given ones
     * @param  {Object} options
     * @return {Boolean}
     */

  }, {
    key: 'optionsEqual',
    value: function optionsEqual(options) {
      for (var optionName in options) {
        var value = options[optionName];
        if (!this._optionEquals(optionName, value)) {
          return false;
        }
      }
      return true;
    }

    /**
     * Checks if the given option has the given value
     * @param  {String} optionName
     * @param  {*} value
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_optionEquals',
    value: function _optionEquals(optionName, value) {
      var option = this.availableOptions[optionName];
      if (typeof option === 'undefined') {
        throw new Error('Invalid option: ' + optionName);
      }

      var optionType = this.availableOptions[optionName].type;
      var currentValue = this._options[optionName];
      if (currentValue === value) return true;

      if (typeof value === 'undefined' || typeof currentValue === 'undefined') return false;

      switch (optionType) {
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].OBJECT:
          if (typeof currentValue.optionsEqual === 'function') {
            return currentValue.optionsEqual(value._options);
          } else {
            return currentValue === value;
          }
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].STRING:
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].NUMBER:
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].BOOLEAN:
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].FUNCTION:
        case '*':
          return currentValue === value;
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].VECTOR2:
          return currentValue.equals(value);
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].COLOR:
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].COLOR_MATRIX:
          return value.equals(currentValue);
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].CONFIGURABLE:
          return currentValue.optionsEqual(value);
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].ARRAY:
          return this._arrayOptionEquals(optionName, value);
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].IMAGE:
          return currentValue.src === value.src;
      }
    }

    /**
     * Checks if the given option of type `array` matches the given value
     * @param  {String} optionName
     * @param  {Array} arr
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_arrayOptionEquals',
    value: function _arrayOptionEquals(optionName, arr) {
      var thisArr = this._options[optionName];

      if (arr.length !== thisArr.length) {
        return false;
      }

      var equal = true;
      for (var i = 0; i < thisArr.length; i++) {
        var thisValue = thisArr[i];
        var value = arr[i];
        if (thisValue instanceof Configurable) {
          if (typeof value === 'undefined' || !thisValue.optionsEqual(value)) {
            equal = false;
            break;
          }
        } else if (value !== thisValue) {
          equal = false;
          break;
        }
      }
      return equal;
    }

    /**
     * Returns a serialized version of this configurable
     * @param {Boolean} toObject = false
     * @return {Object}
     */

  }, {
    key: 'serializeOptions',
    value: function serializeOptions() {
      var _this3 = this;

      var keys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_keys___default()(this._options);
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var options = {};
      keys.forEach(function (key) {
        if (typeof _this3.availableOptions[key] === 'undefined') {
          return __WEBPACK_IMPORTED_MODULE_9__shared_log_js__["a" /* default */].warn('Trying to serialize a key that does not exist: ' + key);
        }
        if (_this3.availableOptions[key].serializable === false) return;
        options[key] = _this3.serializeOption(key, toObject);
      });
      return options;
    }

    /**
     * Returns a serialized version of the given option
     * @param {String} optionName
     * @param {Boolean} toObject = false
     * @return {*}
     */

  }, {
    key: 'serializeOption',
    value: function serializeOption(optionName) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var option = this.availableOptions[optionName];
      var optionType = option.type;
      var value = this._options[optionName];
      if (!value) return value;
      if (option.serializable === false) {
        throw new Error('Option `' + optionName + '` is not serializable.');
      }

      switch (optionType) {
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].STRING:
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].NUMBER:
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].BOOLEAN:
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].OBJECT:
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].FUNCTION:
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].ALL:
          return value;
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].VECTOR2:
          return toObject ? value.toObject() : value.clone();
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].COLOR:
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].COLOR_MATRIX:
          return toObject ? value.toArray() : value.clone();
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].CONFIGURABLE:
          return value.serializeOptions(undefined, toObject);
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].ARRAY:
          return value.slice(0);
        case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].IMAGE:
          return toObject ? value.src : value;
      }
    }

    /**
     * Sets the value for the given option, validates it
     * @param {String} optionName
     * @param {*} value
     * @param {Boolean} [update = true] - Should an `update` event be emitted?
     * @param {Boolean} [initial = false] - Is this the first time this option is set?
     */

  }, {
    key: 'setOption',
    value: function setOption(optionName, value) {
      var update = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
      var initial = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var optionConfig = this.availableOptions[optionName];
      if (!optionConfig) {
        throw new Error('Invalid option: ' + optionName);
      }

      if (typeof optionConfig.setter !== 'undefined') {
        value = optionConfig.setter.call(this, value, initial);
      }

      if (typeof optionConfig.validation !== 'undefined') {
        optionConfig.validation(value);
      }

      if (value === null || typeof value === 'undefined') {
        if (optionConfig.required) {
          throw this._buildConfigError('Option `' + optionName + '` is required.');
        }
        this._options[optionName] = value;
      } else {
        switch (optionConfig.type) {
          // String options
          case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].STRING:
            if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) !== __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].STRING) {
              throw this._buildConfigError('Option `' + optionName + '` has to be a string.');
            }

            // String value restrictions
            var available = optionConfig.available;
            if (typeof available !== 'undefined' && available.indexOf(value) === -1) {
              throw this._buildConfigError('Invalid value for `' + optionName + '` (valid values are: ' + optionConfig.available.join(', ') + ')');
            }

            this._options[optionName] = value;
            break;

          // Number options
          case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].NUMBER:
            if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) !== __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].NUMBER) {
              throw this._buildConfigError('Option `' + optionName + '` has to be a number.');
            }

            this._options[optionName] = value;
            break;

          // Boolean options
          case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].BOOLEAN:
            if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) !== __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].BOOLEAN) {
              throw this._buildConfigError('Option `' + optionName + '` has to be a boolean.');
            }

            this._options[optionName] = value;

            break;

          // Vector2 options
          case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].VECTOR2:
            if (!(value instanceof __WEBPACK_IMPORTED_MODULE_11__math_vector2__["a" /* default */]) && !((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && 'x' in value && 'y' in value)) {
              throw this._buildConfigError('Option `' + optionName + '` has to be an instance of Vector2 or an Object holding x and y values.');
            }

            if (value instanceof __WEBPACK_IMPORTED_MODULE_11__math_vector2__["a" /* default */]) {
              this._options[optionName] = value.clone();
            } else {
              this._options[optionName] = __WEBPACK_IMPORTED_MODULE_11__math_vector2__["a" /* default */].fromObject(value);
            }

            break;

          // Color options
          case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].COLOR:
            if (!(value instanceof __WEBPACK_IMPORTED_MODULE_12__color__["a" /* default */])) {
              throw this._buildConfigError('Option `' + optionName + '` has to be an instance of Color.');
            }

            this._options[optionName] = value;
            break;

          // ColorMatrix options
          case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].COLOR_MATRIX:
            if (!(value instanceof __WEBPACK_IMPORTED_MODULE_15__math_color_matrix__["a" /* default */])) {
              throw this._buildConfigError('Option `' + optionName + '` has to be an instance of ColorMatrix.');
            }

            this._options[optionName] = value.clone();

            break;

          // Function options
          case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].FUNCTION:
            if (typeof value !== 'function') {
              throw this._buildConfigError('Option `' + optionName + '` has to be a function.');
            }

            this._options[optionName] = value;

            break;

          // Object options
          case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].OBJECT:
          case '*':
            this._options[optionName] = value;
            break;

          case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].IMAGE:
            if (typeof value === 'string') {
              var image = new __WEBPACK_IMPORTED_MODULE_14__image__["a" /* default */]();
              image.crossOrigin = __WEBPACK_IMPORTED_MODULE_13__utils__["a" /* default */].getCrossOriginValue(optionConfig.crossOrigin);
              image.src = value;
              this._options[optionName] = image;
            } else if (value instanceof __WEBPACK_IMPORTED_MODULE_14__image__["a" /* default */] || typeof HTMLCanvasElement !== 'undefined' && value instanceof HTMLCanvasElement || typeof HTMLImageElement !== 'undefined' && value instanceof HTMLImageElement) {
              this._options[optionName] = value;
            } else {
              throw this._buildConfigError('Option `' + optionName + '` has to be an Image, Canvas or String.');
            }
            break;

          // Configurable options
          case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].CONFIGURABLE:
            if (value instanceof Configurable) {
              this._options[optionName] = value;
            } else {
              this._options[optionName].set(value);
            }
            break;

          // Array options
          case __WEBPACK_IMPORTED_MODULE_16__constants__["OptionType"].ARRAY:
            if (!(value instanceof Array)) {
              throw this._buildConfigError('Option `' + optionName + '` has to be an Array.');
            }
            this._options[optionName] = value.slice(0);
            break;

          // Unknown option type
          default:
            throw this._buildConfigError('Unknown option type: `' + optionConfig.type + '`');
        }
      }

      if (update) {
        this._onOptionsChange();
        this.emit('update', this, _defineProperty({}, optionName, value));
      }
    }

    /**
     * Gets called when a `configurable` option has been updated
     * @param  {*} ...args
     * @private
     */

  }, {
    key: '_onConfigurableUpdate',
    value: function _onConfigurableUpdate() {
      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      this.emit.apply(this, ['update'].concat(args));
    }

    /**
     * Check if the configurable has any options that differ from the default options
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      var defaultOptions = this.getDefaultOptions();
      return !this.optionsEqual(defaultOptions);
    }
  }]);

  return Configurable;
}(__WEBPACK_IMPORTED_MODULE_10__event_emitter__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Configurable);

/***/ }),
/* 71 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* WEBPACK VAR INJECTION */(function(global) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vendor_promise__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_url__ = __webpack_require__(302);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_url___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_url__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* global XMLHttpRequest */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var TIMEOUT = 5000;

var root = typeof window !== 'undefined' ? window : global;

var JSONLoader = function () {
  function JSONLoader(url) {
    _classCallCheck(this, JSONLoader);

    this._url = url;
    this._parsedUrl = __WEBPACK_IMPORTED_MODULE_2_url___default.a.parse(this._url, true);
  }

  /**
   * Checks if this request is a JSONP request
   * @return {Boolean}
   */


  _createClass(JSONLoader, [{
    key: '_isJSONPRequest',
    value: function _isJSONPRequest() {
      var query = this._parsedUrl.query;

      for (var key in query) {
        var value = query[key];
        if (value === '?') {
          return true;
        }
      }
      return false;
    }

    /**
     * Loads the JSON(P) from the given URL
     * @return {Promise}
     */

  }, {
    key: 'load',
    value: function load() {
      if (this._isJSONPRequest()) {
        return this._loadJSONP();
      } else {
        return this._loadJSON();
      }
    }

    /**
     * Loads the URL as JSON
     * @return {Promise}
     */

  }, {
    key: '_loadJSON',
    value: function _loadJSON() {
      var _this = this;

      return new __WEBPACK_IMPORTED_MODULE_1__vendor_promise__["a" /* default */](function (resolve, reject) {
        var xhr = void 0;
        if (root.XDomainRequest) {
          xhr = new root.XDomainRequest();

          xhr.onload = function () {
            var json = JSON.parse(xhr.responseText);
            resolve(json);
          };
          xhr.onerror = function (e) {
            reject(e);
          };
          xhr.open('GET', _this._url, true);
          xhr.send();
        } else if (root.XMLHttpRequest) {
          xhr = new XMLHttpRequest();

          xhr.onreadystatechange = function (oEvent) {
            if (xhr.readyState === 4) {
              if (xhr.status === 200) {
                var json = JSON.parse(xhr.responseText);
                resolve(json);
              } else {
                reject(new Error('HTTP Status ' + xhr.status));
              }
            }
          };
          xhr.open('GET', _this._url, true);
          xhr.send();
        }
      });
    }

    /**
     * Loads the URL as JSONP
     * @return {Promise}
     */

  }, {
    key: '_loadJSONP',
    value: function _loadJSONP() {
      var _this2 = this;

      var failed = false;
      var succeeded = false;

      var fnName = 'pesdk' + Math.round(Math.random() * 99999999999999);
      return new __WEBPACK_IMPORTED_MODULE_1__vendor_promise__["a" /* default */](function (resolve, reject) {
        var node = _this2._createJSONPNode(fnName);
        root[fnName] = function (result) {
          _this2._removeJSONPNode(node);
          if (!failed) {
            succeeded = true;
            resolve(result);
          }
        };

        root.setTimeout(function () {
          if (!succeeded) {
            _this2._removeJSONPNode(node);
            failed = true;
            reject(new Error('Timeout of 5 seconds exceeded.'));
          }
        }, TIMEOUT);
      });
    }

    /**
     * Creates a JSONP <script> node inside the <head> element
     * @param  {String} fnName
     * @return {DOMElement}
     * @private
     */

  }, {
    key: '_createJSONPNode',
    value: function _createJSONPNode(fnName) {
      var JSONPUrl = this._buildJSONPUrl(fnName);
      var headNode = document.querySelector('head');
      var scriptNode = document.createElement('script');
      scriptNode.src = JSONPUrl;
      headNode.appendChild(scriptNode);
      return scriptNode;
    }

    /**
     * Removes the JSONP <script> node from the <head> element
     * @param  {DOMElement} node
     * @private
     */

  }, {
    key: '_removeJSONPNode',
    value: function _removeJSONPNode(node) {
      node.parentNode.removeChild(node);
    }

    /**
     * Builds a JSONP url for the given function name
     * @param  {String} fnName
     * @return {String}
     */

  }, {
    key: '_buildJSONPUrl',
    value: function _buildJSONPUrl(fnName) {
      // Find JSONP parameter
      var query = this._parsedUrl.query;

      var parameter = null;
      for (var param in query) {
        if (query[param] === '?') {
          parameter = param;
          break;
        }
      }

      delete this._parsedUrl.search;
      query[parameter] = fnName;

      return __WEBPACK_IMPORTED_MODULE_2_url___default.a.format(this._parsedUrl);
    }
  }]);

  return JSONLoader;
}();

/* harmony default export */ __webpack_exports__["a"] = (JSONLoader);
/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(64)));

/***/ }),
/* 72 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__);




var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/* eslint-disable brace-style */

/* harmony default export */ __webpack_exports__["a"] = ({
  load: function load(url) {
    var _this = this;

    var crossOrigin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : { cors: true, value: 'anonymous' };

    var loadPromise = function loadPromise() {
      if (url.substr(0, 5) === 'data:' || "boolean" !== 'undefined') {
        return __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a.resolve([url, url]);
      }
    };

    return loadPromise().then(function (_ref) {
      var _ref2 = _slicedToArray(_ref, 2),
          originalSrc = _ref2[0],
          src = _ref2[1];

      return _this._createAndLoadImage(originalSrc, src, crossOrigin);
    });
  },
  loadImage: function loadImage(src) {
    var crossOrigin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : { cors: true, value: 'anonymous' };

    {
      return this._loadWithoutExif(src, crossOrigin);
    }
  },
  _loadWithoutExif: function _loadWithoutExif(src) {
    var crossOrigin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : { cors: true, value: 'anonymous' };

    return new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
      var image = new window.Image();
      image.addEventListener('load', function () {
        resolve(image);
      });
      image.addEventListener('error', function () {
        reject(new Error('Failed to load image at ' + src));
      });
      if (crossOrigin.cors) {
        image.crossOrigin = crossOrigin.value;
      }
      image.src = src;
    });
  },
  _createAndLoadImage: function _createAndLoadImage(originalSrc, src) {
    var _this2 = this;

    var crossOrigin = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : { cors: true, value: 'anonymous' };

    return new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
      {
        var loadWithoutExif = _this2._loadWithoutExif(src, crossOrigin).then(function (img) {
          return resolve(img);
        });
        var loadWithExif = new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
          _this2._loadAsDataURL(src, crossOrigin).then(function (dataURL) {
            var image = new window.Image();
            image.addEventListener('load', function () {
              resolve(image);
            });
            image.src = dataURL;
            image.rawSource = dataURL;
          }).catch(function (_) {
            loadWithoutExif.then(function (img) {
              return resolve(img);
            });
          });
        });
        if (_this2._stringEndsWith(src, '.svg')) {
          return loadWithoutExif.then(function (img) {
            return resolve(img);
          });
        } else {
          return loadWithExif.then(function (img) {
            return resolve(img);
          });
        }
      }
    });
  },
  _stringEndsWith: function _stringEndsWith(srcString, search) {
    var length = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : srcString.length;

    if (length === undefined || length > srcString.length) {
      length = srcString.length;
    }

    return srcString.substring(length - search.length, length) === search;
  },
  _loadAsDataURL: function _loadAsDataURL(url) {
    var crossOrigin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : { cors: true, value: 'anonymous' };

    {
      /* eslint-env browser */
      return new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var xhr = new XMLHttpRequest();
        xhr.onload = function () {
          var reader = new FileReader();
          reader.onloadend = function () {
            if (reader.error) {
              reject(reader.error);
            }
            resolve(reader.result);
          };
          reader.readAsDataURL(xhr.response);
        };
        xhr.open('GET', url);
        xhr.responseType = 'blob';
        xhr.withCredentials = crossOrigin.cors && crossOrigin.value === 'use-credentials';
        xhr.send();
      });
    }
  },
  loadXHR: function loadXHR(url, mime) {
    return new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
      var xhr = void 0;
      if (window.XDomainRequest) {
        xhr = new window.XDomainRequest();
        if (mime) xhr.overrideMimeType(mime);

        xhr.onload = function () {
          resolve(xhr);
        };
        xhr.onerror = function (e) {
          reject(e);
        };
      } else if (window.XMLHttpRequest) {
        xhr = new window.XMLHttpRequest();
        if (mime) xhr.overrideMimeType(mime);

        xhr.onreadystatechange = function (oEvent) {
          if (xhr.readyState === 4) {
            if (xhr.status === 200) {
              resolve(xhr);
            } else {
              reject(new Error('HTTP Status ' + xhr.status));
            }
          }
        };
      }

      xhr.open('GET', url, true);
      xhr.send();
    });
  }
});

/***/ }),
/* 73 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__vendor_stack_blur__ = __webpack_require__(91);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__vendor_stack_blur___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5__vendor_stack_blur__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

var BlurFilter = function (_Engine$Filter) {
  _inherits(BlurFilter, _Engine$Filter);

  function BlurFilter() {
    var _ref;

    _classCallCheck(this, BlurFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = BlurFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(BlurFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(330);

    _this._lastBlurRadius = null;
    _this._lastDimensions = new Vector2(0, 0);

    _this._blurredRenderTarget = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(BlurFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
      var blurRadius = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;

      if (this._options.blurQuality === 'low') {
        this._renderLQBlur(renderer, inputTarget, outputTarget, clear);
        return;
      }

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      if (this._lastBlurRadius === this._options.blurRadius) {
        outputContext.drawImage(canvas, 0, 0);
      }

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var outputData = outputContext.getImageData(0, 0, canvas.width, canvas.height);

      var radius = this._options.blurRadius;
      var delta = this._options.delta;

      var steps = 30.0;

      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var i = x + y * canvas.width;
          var index = i * 4;

          var colorR = 0;
          var colorG = 0;
          var colorB = 0;
          var colorA = 0;

          var total = 0.0;

          if (blurRadius) {
            radius = blurRadius(x / canvas.width, y / canvas.height);
          }

          var rand = this._random(x, 1 - y / canvas.height);

          for (var t = -steps; t <= steps; t++) {
            var percent = (t + rand - 0.5) / steps;
            var weight = 1.0 - Math.abs(percent);

            var offsetX = delta.x * percent * radius;
            var offsetY = delta.y * percent * radius;

            var clampedX = Math.max(Math.min(x + offsetX, canvas.width - 1), 0);
            var clampedY = Math.max(Math.min(y + offsetY, canvas.height - 1), 0);
            var _i = (Math.round(clampedY) * canvas.width + Math.round(clampedX)) * 4;

            var sampleA = imageData.data[_i + 3];
            var sampleR = sampleA * imageData.data[_i];
            var sampleG = sampleA * imageData.data[_i + 1];
            var sampleB = sampleA * imageData.data[_i + 2];

            colorR += sampleR * weight;
            colorG += sampleG * weight;
            colorB += sampleB * weight;
            colorA += sampleA * weight;

            total += weight;
          }

          colorR /= total;
          colorG /= total;
          colorB /= total;
          colorA /= total;

          outputData.data[index] = colorR / colorA;
          outputData.data[index + 1] = colorG / colorA;
          outputData.data[index + 2] = colorB / colorA;
          outputData.data[index + 3] = colorA;
        }
      }

      outputContext.putImageData(outputData, 0, 0);

      this._lastDimensions.copy(new Vector2(canvas.width, canvas.height));
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the CanvasRenderer using the low
     * quality but fast stack-blur implementation
     * @param  {CanvasRenderer} renderer
     * @param  {RenderTarget} inputTarget
     * @param  {RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_renderLQBlur',
    value: function _renderLQBlur(renderer, inputTarget, outputTarget, clear) {
      var inputDimensions = inputTarget.getDimensions();
      var dimensionsChanged = !this._lastDimensions.equals(inputDimensions);

      this._blurredRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._blurredRenderTarget.resizeTo(inputTarget.getDimensions());

      outputTarget.setPixelRatio(inputTarget.getPixelRatio());
      outputTarget.resizeTo(inputTarget.getDimensions());

      if (this._lastBlurRadius !== this._options.blurRadius || dimensionsChanged) {
        this._blurImage(inputTarget);
        this._lastBlurRadius = this._options.blurRadius;
      }

      var outputContext = outputTarget.getContext();
      outputContext.drawImage(this._blurredRenderTarget.getCanvas(), 0, 0);

      this._lastDimensions.copy(inputDimensions);
    }

    /**
     * Creates a blurred copy of the image
     * @param  {CanvasRenderTarget} inputTarget
     * @return {Canvas}
     * @private
     */

  }, {
    key: '_blurImage',
    value: function _blurImage(inputTarget) {
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var inputDimensions = new Vector2(inputCanvas.width, inputCanvas.height);
      var blurryImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      __WEBPACK_IMPORTED_MODULE_5__vendor_stack_blur___default.a.stackBlurCanvasRGBA(blurryImageData, 0, 0, inputCanvas.width, inputCanvas.height, this._options.blurRadius * inputDimensions.min());

      var outputContext = this._blurredRenderTarget.getContext();
      outputContext.putImageData(blurryImageData, 0, 0);
    }

    /**
     * A uniformly distributed pseudo-random number generator
     * often used inside of shaders.
     * @param {Number} x The input x coordinate
     * @param {Number} y The input y coordinate
     */

  }, {
    key: '_random',
    value: function _random(x, y) {
      var a = 12.9898;
      var b = 78.233;
      var c = 43758.5453;
      var dt = x * a + y * b;
      var sn = dt - 3.14 * Math.floor(dt / 3.14);
      var tempR = Math.sin(sn) * c;
      return tempR - Math.floor(tempR);
    }
  }]);

  return BlurFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

BlurFilter.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 30, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  delta: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 1), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  texSize: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  blurQuality: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING, default: 'low' }
};

/* harmony default export */ __webpack_exports__["a"] = (BlurFilter);

/***/ }),
/* 74 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

var Sprite = function (_Configurable) {
  _inherits(Sprite, _Configurable);

  function Sprite(operation, options) {
    _classCallCheck(this, Sprite);

    var _this = _possibleConstructorReturn(this, (Sprite.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Sprite)).call(this, options));

    _this._operation = operation;
    _this._dirtiness = {};
    _this.id = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].getUUID();

    _this._renderTextures = {};
    _this._identitySprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite();
    _this._sprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite();

    _this._hitTestSprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite();
    _this._renderers = [];
    return _this;
  }

  /**
   * Applies the given scale to this sprite
   * @param  {PhotoEditorSDK.Math.Vector2} scale
   */


  _createClass(Sprite, [{
    key: 'applyScale',
    value: function applyScale(scale) {}

    /**
     * Applies a rotation with the given degrees
     * @param  {Number} degrees
     */

  }, {
    key: 'applyRotation',
    value: function applyRotation(degrees) {
      var inputDimensions = this._operation.getInputDimensions();

      // Update sprite rotation
      var spriteDegrees = this.getRotation() * 180 / Math.PI;
      spriteDegrees += degrees;
      this.setRotation(spriteDegrees * Math.PI / 180);

      var actualDegrees = (degrees + 360) % 360;
      var radians = actualDegrees * Math.PI / 180;

      var cos = Math.cos(radians);
      var sin = Math.sin(radians);

      var relativePosition = this._options.position.clone().subtract(0.5).multiply(inputDimensions);

      var newRelativePosition = new Vector2(relativePosition.x * cos - relativePosition.y * sin, relativePosition.x * sin + relativePosition.y * cos).divide(inputDimensions.clone().flip());

      this.setPosition(new Vector2(0.5, 0.5).add(newRelativePosition));
    }

    /**
     * Applies a flip in the given direction
     * @param  {String} direction
     */

  }, {
    key: 'applyFlip',
    value: function applyFlip(direction) {
      var position = this.getPosition().clone();
      switch (direction) {
        case 'horizontal':
          position.x = 1 - this._options.position.x;
          break;
        case 'vertical':
          position.y = 1 - this._options.position.y;
          break;
      }

      this.setPosition(position);
    }

    /**
     * Applies a transform with the given options
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     */

  }, {
    key: 'applyTransform',
    value: function applyTransform(transformChange) {
      var newOptions = {};
      newOptions.rotation = transformChange.applyToRotation(this.getRotation());
      newOptions.position = transformChange.applyToRelativePoint(this.getPosition());
      if (this._options.dimensions) {
        newOptions.dimensions = transformChange.applyToDimensions(this.getDimensions());
      }
      this.set(newOptions, false);
    }

    // -------------------------------------------------------------------------- EVENTS

    /**
     * Returns the DisplayObject of this Sprite
     * @return {PhotoEditorSDK.Engine.Sprite}
     */

  }, {
    key: 'getDisplayObject',
    value: function getDisplayObject() {
      return this._sprite;
    }
  }, {
    key: 'getHitTestDisplayObject',
    value: function getHitTestDisplayObject() {
      return this._sprite;
    }

    /**
     * Returns the texture for the sprite that should be rendered
     * @return {PhotoEditorSDK.Engine.Texture}
     * @private
     * @abstract
     */

  }, {
    key: '_getTexture',
    value: function _getTexture() {
      throw new Error('Sprite#_getTexture is abstract and not implemented in child class.');
    }

    /**
     * Prepares for rendering this sprite to a render texture
     * @param {PhotoEditorSDK} sdk
     * @private
     */

  }, {
    key: '_prepareRenderTexture',
    value: function _prepareRenderTexture(sdk) {
      if (!this._renderTexture) {
        var texture = this._getTexture();
        this._renderTextureContainer = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Container();
        this._renderTextureSprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite(texture);
        this._renderTextureContainer.addChild(this._renderTextureSprite);
        this._renderTexture = this._getRenderTexture(sdk.getRenderer(), texture.getDimensions());
      } else {
        this._renderTexture.clear();
      }
    }

    /**
     * Checks if this sprite should be rendered to a render texture
     * @param  {PhotoEditorSDK} sdk
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_rendersToRenderTexture',
    value: function _rendersToRenderTexture(sdk) {
      return sdk.getOptions().smoothDownscaling && sdk.getRenderer().isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL);
    }

    /**
     * Checks if the given option has the given value
     * @param  {String} optionName
     * @param  {*} value
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_optionEquals',
    value: function _optionEquals(optionName, value) {
      if (optionName === 'type') {
        return true;
      }

      return _get(Sprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Sprite.prototype), '_optionEquals', this).call(this, optionName, value);
    }

    /**
     * Updates this sprite
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'update',
    value: function update(sdk, inputDimensions) {
      if (this._rendersToRenderTexture(sdk)) {
        this._prepareRenderTexture(sdk);
        this._renderToRenderTexture(sdk);
      }

      this._updateSprite(inputDimensions);
    }

    /**
     * Updates the sprite's properties according to the options
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @private
     */

  }, {
    key: '_updateSprite',
    value: function _updateSprite(inputDimensions) {
      var _this2 = this;

      var sprites = [this._sprite, this._hitTestSprite];
      sprites.forEach(function (sprite) {
        if (!sprite.getTexture()) return;

        sprite.setAnchor(_this2._options.anchor);
        sprite.setPosition(_this2._options.position.clone().multiply(inputDimensions));
        if (typeof _this2._options.alpha !== 'undefined') {
          sprite.setAlpha(_this2._options.alpha);
        }

        var dimensions = _this2._options.dimensions;

        if (dimensions) {
          dimensions = dimensions.clone().multiply(_this2._operation.getSDK().getTextureScale());
          sprite.setWidth(dimensions.x);
          sprite.setHeight(dimensions.y);
        }
        sprite.updateTransform();

        var frame = sprite.getTexture().getFrame();
        var spriteDimensions = new Vector2(frame.width, frame.height);

        sprite.setPivot(_this2._options.pivot.clone().multiply(spriteDimensions));
        sprite.setRotation(_this2._options.rotation);
        sprite.updateTransform();
      });
    }

    /**
     * Renders this sprite to the render texture. If power-of-two textures are enforced,
     * it automatically resizes the texture and updates its UV coordinates accordingly.
     * @param  {PhotoEditorSDK} sdk
     * @private
     */

  }, {
    key: '_renderToRenderTexture',
    value: function _renderToRenderTexture(sdk) {
      var textureDimensions = this._getTexture().getDimensions();
      var renderTexture = this._getRenderTexture(sdk.getRenderer(), textureDimensions);

      var finalDimensions = textureDimensions.clone();
      if (this._options.smoothDownscaling) {
        finalDimensions.x = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].nextHighestPOT(finalDimensions.x);
        finalDimensions.y = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].nextHighestPOT(finalDimensions.y);
      }

      this._renderTexture.resizeTo(finalDimensions);
      this._renderTexture.render(this._renderTextureContainer);

      if (this._options.smoothDownscaling) {
        var relativeDifference = finalDimensions.clone().subtract(textureDimensions.x, textureDimensions.y).divide(finalDimensions);

        var uvs = renderTexture.getUVs().getUVs();
        uvs[0].x = uvs[3].x = 0;
        uvs[1].x = uvs[2].x = 1 - relativeDifference.x;
        uvs[0].y = uvs[1].y = 0;
        uvs[2].y = uvs[3].y = 1 - relativeDifference.y;
      }

      this._sprite.setTexture(renderTexture);
    }

    /**
     * Checks if this operation is dirty for the given renderer
     * @param  {PhotoEditorSDK.Engine.BaseRenderer}  renderer
     * @return {Boolean}
     */

  }, {
    key: 'isDirtyForRenderer',
    value: function isDirtyForRenderer(renderer) {
      if (!(renderer.id in this._dirtiness)) {
        this._dirtiness[renderer.id] = true;
      }
      return this._dirtiness[renderer.id];
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {
      this._renderers[renderer.id] = renderer;
      this._dirtiness[renderer.id] = dirty;
    }

    /**
     * Sets the dirtiness for all renderers
     * @param {Boolean} dirty
     */

  }, {
    key: 'setDirty',
    value: function setDirty(dirty) {
      for (var rendererId in this._dirtiness) {
        this.setDirtyForRenderer(dirty, this._renderers[rendererId]);
      }
    }

    /**
     * Creates and/or returns a RenderTexture
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param {PhotoEditorSDK.Math.Vector2} dimensions = new Vector(100, 100)
     * @return {PhotoEditorSDK.Engine.RenderTexture}
     * @private
     */

  }, {
    key: '_getRenderTexture',
    value: function _getRenderTexture(renderer) {
      var dimensions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Vector2(100, 100);

      if (!this._renderTextures[renderer.id]) {
        this._renderTextures[renderer.id] = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].RenderTexture(renderer, dimensions.x, dimensions.y, 1);
      }
      return this._renderTextures[renderer.id];
    }

    /**
     * Cleans up this Sprite
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      for (var rendererId in this._renderTextures) {
        this._renderTextures[rendererId].dispose();
      }
    }

    /**
     * Defines if sprite can be duplicated
     * @return {Boolean}
     * @memberof Sprite
     */

  }, {
    key: 'canBeDuplicated',
    value: function canBeDuplicated() {
      return true;
    }

    /**
     * Defines if sprite can be deleted
     * @return {Boolean}
     * @memberof Sprite
     */

  }, {
    key: 'canBeDeleted',
    value: function canBeDeleted() {
      return true;
    }

    /**
     * Defines if sprite can be masked
     * @return {Boolean}
     * @memberof Sprite
     */

  }, {
    key: 'canMaskCanvas',
    value: function canMaskCanvas() {
      return false;
    }

    /**
     * Defines if sprite‘s padding could be changed
     * @return {Boolean}
     * @memberof Sprite
     */

  }, {
    key: 'canAdjustPadding',
    value: function canAdjustPadding() {
      return false;
    }

    /**
     * Defines if sprite can be taken to the front
     * @return {Boolean}
     * @memberof Sprite
     */

  }, {
    key: 'canBeTakenToFront',
    value: function canBeTakenToFront() {
      return true;
    }

    /**
     * Defines if sprite can be flipped horizontally
     * @return {Boolean}
     * @memberof Sprite
     */

  }, {
    key: 'canBeFlippedHorizontally',
    value: function canBeFlippedHorizontally() {
      return true;
    }
  }]);

  return Sprite;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Configurable"]);

/* harmony default export */ __webpack_exports__["a"] = (Sprite);

/***/ }),
/* 75 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignBlocks; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_design__ = __webpack_require__(76);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__models_rows_blocks_text_design_row_triple__ = __webpack_require__(429);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__models_text_design_banderole__ = __webpack_require__(123);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__models_rows_default_text_design_row_single__ = __webpack_require__(26);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__models_rows_masked_text_design_row_masked__ = __webpack_require__(124);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__models_text_design_attributes__ = __webpack_require__(77);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__text_design_asset_manager__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__models_randomizer__ = __webpack_require__(20);








var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */










var TextDesignBlocks = function (_TextDesign) {
  _inherits(TextDesignBlocks, _TextDesign);

  function TextDesignBlocks() {
    var _ref;

    _classCallCheck(this, TextDesignBlocks);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignBlocks.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignBlocks)).call.apply(_ref, [this].concat(args)));

    _this.getImagePaths = function () {
      var banderoles = _this.getBanderoles();
      return banderoles && banderoles.map(function (b) {
        return b.getImagePath();
      }) || [];
    };

    _this.onImagesLoaded = function () {
      var banderoles = _this.getBanderoles();
      banderoles && banderoles.forEach(function (b) {
        var image = __WEBPACK_IMPORTED_MODULE_14__text_design_asset_manager__["a" /* AssetManager */].getImage(b.getImagePath());
        if (!image) {
          __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Log"].warn('TextDesignBlocks#onImagesLoaded: Image not found \'' + b.getImagePath() + '\'');
          return;
        }

        b.setImage(image);
      });
    };

    _this._rowTypeLessThan3WordsRandomizer = new __WEBPACK_IMPORTED_MODULE_15__models_randomizer__["a" /* Randomizer */](0);
    _this._rowTypeMoreThan3WordsRandomizer = new __WEBPACK_IMPORTED_MODULE_15__models_randomizer__["a" /* Randomizer */](0);
    _this._banderolesRandomizer = new __WEBPACK_IMPORTED_MODULE_15__models_randomizer__["a" /* Randomizer */](0);

    _this._seedPool = [].concat(_toConsumableArray(_this._seedPool), [_this._rowTypeLessThan3WordsRandomizer, _this._rowTypeMoreThan3WordsRandomizer, _this._banderolesRandomizer]);
    return _this;
  }

  _createClass(TextDesignBlocks, [{
    key: '_modifiedText',
    value: function _modifiedText(text) {
      return _get(TextDesignBlocks.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignBlocks.prototype), '_modifiedText', this).call(this, text).toUpperCase();
    }
  }, {
    key: 'generateLayoutData',
    value: function generateLayoutData(text, width) {
      this._options.hasMaskedText = false;
      return _get(TextDesignBlocks.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignBlocks.prototype), 'generateLayoutData', this).call(this, text, width);
    }
  }, {
    key: '_randomLayoutRow',
    value: function _randomLayoutRow(words, index, width, attributes) {
      if (words.size() < 3) {
        var isMasked = this._rowTypeLessThan3WordsRandomizer.nextInRange(0, 2) === 0;
        return this._layoutRow(words, width, attributes, isMasked);
      } else {
        var randomValue = this._rowTypeMoreThan3WordsRandomizer.nextInRange(0, 3);

        switch (randomValue) {
          case 0:
            return new __WEBPACK_IMPORTED_MODULE_9__models_rows_blocks_text_design_row_triple__["a" /* TextDesignRowTriple */]({
              words: words,
              width: width,
              attributes: attributes,
              orientation: __WEBPACK_IMPORTED_MODULE_9__models_rows_blocks_text_design_row_triple__["a" /* TextDesignRowTriple */].Orientations.Left
            });

          case 1:
            return new __WEBPACK_IMPORTED_MODULE_9__models_rows_blocks_text_design_row_triple__["a" /* TextDesignRowTriple */]({
              words: words,
              width: width,
              attributes: attributes,
              orientation: __WEBPACK_IMPORTED_MODULE_9__models_rows_blocks_text_design_row_triple__["a" /* TextDesignRowTriple */].Orientations.Right
            });

          case 2:
            return this._layoutRow(words, width, attributes, true);

          case 3:
            return new __WEBPACK_IMPORTED_MODULE_11__models_rows_default_text_design_row_single__["a" /* TextDesignRowSingle */]({ words: words, width: width, attributes: attributes });

          default:
            throw new Error('TextDesignBlocks#_randomLayoutRow: Invalid randomValue generated: ' + randomValue + '.');
        }
      }
    }
  }, {
    key: '_layoutRow',
    value: function _layoutRow(words, width, attributes, isMasked) {
      if (this.getHasMaskedText()) {
        isMasked = false;
      }

      if (isMasked) {
        this.setHasMaskedText(true);
        var banderole = this._banderolesRandomizer.pickNext(this.getBanderoles());

        var row = new __WEBPACK_IMPORTED_MODULE_12__models_rows_masked_text_design_row_masked__["a" /* TextDesignRowMasked */]({
          words: words,
          width: width,
          attributes: new __WEBPACK_IMPORTED_MODULE_13__models_text_design_attributes__["a" /* TextDesignAttributes */]({ alignment: 'left', fontIdentifier: banderole.getFontIdentifier() }),
          image: banderole.getImage(),
          imageInsets: banderole.insetsForWidth(width),
          capInsets: null,
          backgroundColor: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Color"].WHITE
        });

        // Fix: We need to disable image smoothing on server to render the rectangle
        if (banderole.getNeedsImageSmoothingFix()) {
          row.serverImageSmoothingFix = true;
        }

        return row;
      } else {
        return new __WEBPACK_IMPORTED_MODULE_11__models_rows_default_text_design_row_single__["a" /* TextDesignRowSingle */]({ words: words, width: width, attributes: attributes });
      }
    }
  }]);

  return TextDesignBlocks;
}(__WEBPACK_IMPORTED_MODULE_8__text_design__["a" /* TextDesign */]);

TextDesignBlocks.defaultFontIdentifiers = ['imgly_font_campton_bold'];
TextDesignBlocks.identifier = 'imgly_text_design_blocks';
TextDesignBlocks.defaultBanderoles = [__WEBPACK_IMPORTED_MODULE_10__models_text_design_banderole__["a" /* TextDesignBanderole */].Rectangle, __WEBPACK_IMPORTED_MODULE_10__models_text_design_banderole__["a" /* TextDesignBanderole */].Small];
TextDesignBlocks.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_8__text_design__["a" /* TextDesign */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignBlocks.defaultFontIdentifiers },
  relativeLineSpacing: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 / 3 },
  hasMaskedText: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  banderoles: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignBlocks.defaultBanderoles }
});

/***/ }),
/* 76 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesign; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_number_max_safe_integer__ = __webpack_require__(423);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_number_max_safe_integer___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_number_max_safe_integer__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__models_randomizer__ = __webpack_require__(20);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__models_rectangle_insets__ = __webpack_require__(21);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__text_words__ = __webpack_require__(47);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__models_text_design_layout_data__ = __webpack_require__(426);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__models_text_design_attributes__ = __webpack_require__(77);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__models_rows_default_text_design_row_single__ = __webpack_require__(26);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */









var MAXIMUM_NUMBER_OF_TRIES = 10;
var MIN_LINE_COUNT_OF_RANDOM = 4;
var RANDOM_ADDITIONAL_LINE_PERCENTAGE = 0.4;

var TextDesign = function (_Configurable) {
  _inherits(TextDesign, _Configurable);

  function TextDesign(options) {
    _classCallCheck(this, TextDesign);

    var _this = _possibleConstructorReturn(this, (TextDesign.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesign)).call(this, options));

    _this._relativeInsets = new __WEBPACK_IMPORTED_MODULE_8__models_rectangle_insets__["a" /* RectangleInsets */]();

    _this._background = null;

    _this._fontRandomizer = new __WEBPACK_IMPORTED_MODULE_7__models_randomizer__["a" /* Randomizer */](0);
    _this._lineNumberRandomizer = new __WEBPACK_IMPORTED_MODULE_7__models_randomizer__["a" /* Randomizer */](0);
    _this._wordsPerLineRandomizer = new __WEBPACK_IMPORTED_MODULE_7__models_randomizer__["a" /* Randomizer */](0);

    _this._seedPool = [_this._fontRandomizer, _this._lineNumberRandomizer, _this._wordsPerLineRandomizer];
    return _this;
  }

  _createClass(TextDesign, [{
    key: 'seed',
    value: function seed(value) {
      this._seedPool.forEach(function (s) {
        return s.seed(value);
      });
    }
  }, {
    key: 'getImagePaths',
    value: function getImagePaths() {
      return [];
    }
  }, {
    key: 'onImagesLoaded',
    value: function onImagesLoaded() {}
  }, {
    key: 'getMaximumNumberOfTries',
    value: function getMaximumNumberOfTries() {
      return MAXIMUM_NUMBER_OF_TRIES;
    }
  }, {
    key: 'getMinLineCountOfRandom',
    value: function getMinLineCountOfRandom() {
      return MIN_LINE_COUNT_OF_RANDOM;
    }
  }, {
    key: 'getRandomAdditionalLinePercentage',
    value: function getRandomAdditionalLinePercentage() {
      return RANDOM_ADDITIONAL_LINE_PERCENTAGE;
    }
  }, {
    key: '_fontForRow',
    value: function _fontForRow(index, words) {
      return this._fontRandomizer.pickNext(this.getFontIdentifiers());
    }
  }, {
    key: '_modifiedText',
    value: function _modifiedText(text) {
      return text.replace('\n', ' ').replace('\t', ' ');
    }
  }, {
    key: '_minimumNumberOfLines',
    value: function _minimumNumberOfLines(words) {
      return Math.ceil(Math.sqrt(words.size()));
    }
  }, {
    key: '_maximumNumberOfLines',
    value: function _maximumNumberOfLines(words) {
      return words.size();
    }
  }, {
    key: '_calculatedNumberOfLines',
    value: function _calculatedNumberOfLines(words) {
      var lineCount = this._minimumNumberOfLines(words);

      if (words.size() >= this.getMinLineCountOfRandom()) {
        var max = Math.floor(Math.max(1, lineCount * this.getRandomAdditionalLinePercentage()));
        lineCount += this._lineNumberRandomizer.nextInRange(0, max);
      }

      return Math.min(lineCount, this._maximumNumberOfLines(words));
    }
  }, {
    key: '_randomizedNumberOfWordsPerLine',
    value: function _randomizedNumberOfWordsPerLine(numberOfLines, numberOfWords) {
      var _this2 = this;

      if (numberOfLines > numberOfWords) {
        __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Log"].warn('TextDesign#_randomizedNumberOfWordsPerLine: Invalid number of lines');
        return numberOfWords;
      }

      var wordsPerLine = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].Array.repeat(1, numberOfLines);

      __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].Array.range(numberOfLines, numberOfWords).forEach(function (_) {
        var index = _this2._wordsPerLineRandomizer.nextInRange(0, numberOfLines - 1);
        wordsPerLine[index] += 1;
      });

      return wordsPerLine;
    }
  }, {
    key: '_textLines',
    value: function _textLines(text) {
      var words = new __WEBPACK_IMPORTED_MODULE_9__text_words__["a" /* Words */](text);

      var numberOfLines = this._calculatedNumberOfLines(words);
      var numberOfWordsPerLine = this._randomizedNumberOfWordsPerLine(numberOfLines, words.size());

      return numberOfWordsPerLine.reduce(function (acc, numOfWordsInLine) {
        return {
          index: acc.index + numOfWordsInLine,
          lines: [].concat(_toConsumableArray(acc.lines), [words.slice(acc.index, Math.min(acc.index + numOfWordsInLine, words.size()))])
        };
      }, { index: 0, lines: [] }).lines;
    }
  }, {
    key: '_validTextLines',
    value: function _validTextLines(text) {
      var textLines = this._textLines(text);

      var indexOfLineWithLassThan3Chars = 0;
      do {
        indexOfLineWithLassThan3Chars = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].Array.findIndex(textLines, function (words) {
          return words.countNumberOfCharacters() < 3;
        });

        if (indexOfLineWithLassThan3Chars >= 0) {
          var lineBefore = textLines[indexOfLineWithLassThan3Chars - 1];
          var lineAfter = textLines[indexOfLineWithLassThan3Chars + 1];

          var charCountOfLineBefore = lineBefore ? lineBefore.countNumberOfCharacters() : __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_number_max_safe_integer___default.a;
          var charCountOfLineAfter = lineAfter ? lineAfter.countNumberOfCharacters() : __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_number_max_safe_integer___default.a;

          if (charCountOfLineBefore < charCountOfLineAfter && lineBefore) {
            lineBefore.words = [].concat(_toConsumableArray(lineBefore.words), _toConsumableArray(textLines[indexOfLineWithLassThan3Chars].words));
            textLines = [].concat(_toConsumableArray(textLines.slice(0, indexOfLineWithLassThan3Chars)), _toConsumableArray(textLines.slice(indexOfLineWithLassThan3Chars + 1)));
          } else if (lineAfter) {
            lineAfter.words = [].concat(_toConsumableArray(textLines[indexOfLineWithLassThan3Chars].words), _toConsumableArray(lineAfter.words));
            textLines = [].concat(_toConsumableArray(textLines.slice(0, indexOfLineWithLassThan3Chars)), _toConsumableArray(textLines.slice(indexOfLineWithLassThan3Chars + 1)));
          }
        }
      } while (indexOfLineWithLassThan3Chars > -1 && textLines.length > 1);

      return textLines;
    }
  }, {
    key: '_modifiedLines',
    value: function _modifiedLines(lines) {
      return lines;
    }
  }, {
    key: '_getBackground',
    value: function _getBackground() {
      return this._background;
    }
  }, {
    key: 'generateLayoutData',
    value: function generateLayoutData(text, width) {
      var updatedText = this._modifiedText(text);
      var lines = this._modifiedLines(this._validTextLines(updatedText));

      var insetWidth = width * (1 - this._relativeInsets.left - this._relativeInsets.right);
      var rows = this._layoutRows(lines, insetWidth);

      return new __WEBPACK_IMPORTED_MODULE_10__models_text_design_layout_data__["a" /* TextDesignLayoutData */]({
        text: updatedText,
        relativeInsets: this._relativeInsets.clone(),
        relativeLineSpacing: this.getRelativeLineSpacing(),
        background: this._background || this._getBackground(),
        lines: lines,
        rows: rows,
        width: width
      });
    }
  }, {
    key: '_layoutRows',
    value: function _layoutRows(lines, width) {
      var _this3 = this;

      return lines.map(function (line, index) {
        return _this3._randomLayoutRow(line, index, width, new __WEBPACK_IMPORTED_MODULE_11__models_text_design_attributes__["a" /* TextDesignAttributes */]({ fontIdentifier: _this3._fontForRow(index, line) })).layout();
      });
    }
  }, {
    key: '_randomLayoutRow',
    value: function _randomLayoutRow(words, index, width, attributes) {
      return new __WEBPACK_IMPORTED_MODULE_12__models_rows_default_text_design_row_single__["a" /* TextDesignRowSingle */]({ words: words, width: width, attributes: attributes });
    }
  }]);

  return TextDesign;
}(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Configurable"]);

TextDesign.defaultFontIdentifiers = [];
TextDesign.identifier = 'textdesign';
TextDesign.prototype.availableOptions = {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, default: [] },
  relativeLineSpacing: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 }
};

/***/ }),
/* 77 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignAttributes; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var TextDesignAttributes = function (_Configurable) {
  _inherits(TextDesignAttributes, _Configurable);

  function TextDesignAttributes() {
    _classCallCheck(this, TextDesignAttributes);

    return _possibleConstructorReturn(this, (TextDesignAttributes.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignAttributes)).apply(this, arguments));
  }

  return TextDesignAttributes;
}(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Configurable"]);

TextDesignAttributes.prototype.availableOptions = {
  tintColor: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Color"].BLACK },
  textColor: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Color"].BLACK },
  alignment: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].STRING, default: 'left', available: ['left', 'center', 'right'] },
  lineSpacing: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  fontIdentifier: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].STRING, default: 'imgly_font_open_sans_bold' }
};

/***/ }),
/* 78 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignFont; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__models_size_value__ = __webpack_require__(33);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_design_asset_manager__ = __webpack_require__(27);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var TextDesignFont = function (_Configurable) {
  _inherits(TextDesignFont, _Configurable);

  function TextDesignFont(options) {
    _classCallCheck(this, TextDesignFont);

    var _this = _possibleConstructorReturn(this, (TextDesignFont.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignFont)).call(this, options));

    var fontVariation = __WEBPACK_IMPORTED_MODULE_8__text_design_asset_manager__["a" /* AssetManager */].getVariation(_this.getFontIdentifier());
    if (!fontVariation) {
      __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Log"].warn('TextDesignFont: Unable to find font \'' + _this._fontIdentifier + '\'');
    }

    _this.set({ fontVariation: fontVariation });

    _this._metrics = null;

    _this._canvas = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].createCanvas();
    _this._context = _this._canvas.getContext('2d');

    _this._isDirty = true;
    return _this;
  }

  _createClass(TextDesignFont, [{
    key: '_onOptionsChange',
    value: function _onOptionsChange() {
      this._isDirty = true;
    }
  }, {
    key: 'setOption',
    value: function setOption(optionName, value) {
      var update = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
      var initial = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      _get(TextDesignFont.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignFont.prototype), 'setOption', this).call(this, optionName, value, update, initial);

      if (optionName === 'fontIdentifier' && !initial) {
        this.updateFontVariation();
      }
    }

    /**
     * Updates the font variation for the current font identifier.
     *
     */

  }, {
    key: 'updateFontVariation',
    value: function updateFontVariation() {
      var fontVariation = __WEBPACK_IMPORTED_MODULE_8__text_design_asset_manager__["a" /* AssetManager */].getVariation(this.getFontIdentifier());
      if (!fontVariation) {
        __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Log"].warn('TextDesignFont: Unable to find font \'' + this._fontIdentifier + '\'');
      }

      this.setFontVariation(fontVariation);
      return fontVariation;
    }
  }, {
    key: 'setOptions',
    value: function setOptions() {
      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      this._options = _extends({}, this._options, options);

      this._isDirty = true;
    }
  }, {
    key: '_applyTextOptions',
    value: function _applyTextOptions() {
      var ctx = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._context;
      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      var _options$options = _extends({}, this._options, options),
          fontSize = _options$options.fontSize,
          fontVariation = _options$options.fontVariation,
          lineHeight = _options$options.lineHeight,
          textColor = _options$options.textColor,
          alignment = _options$options.alignment;

      var _fontVariation$serial = fontVariation.serializeOptions(),
          fontStyle = _fontVariation$serial.fontStyle,
          fontWeight = _fontVariation$serial.fontWeight,
          fontFamily = _fontVariation$serial.fontFamily;

      // node-canvas doesn't support the line height property


      {
        ctx.font = fontStyle + ' ' + fontWeight + ' ' + fontSize + 'px / ' + lineHeight + ' ' + fontFamily;
      }

      ctx.fillStyle = textColor;
      ctx.textBaseline = 'alphabetic'; // textBaseline
      ctx.textAlign = alignment || 'left';
    }
  }, {
    key: 'getTextMetrics',
    value: function getTextMetrics() {
      if (!this._metrics || this._isDirty) {
        this._calculateTextMetrics();
      }

      return _extends({}, this._metrics);
    }
  }, {
    key: 'getSizeValue',
    value: function getSizeValue() {
      if (!this._metrics || this._isDirty) {
        this._calculateTextMetrics();
      }

      return new __WEBPACK_IMPORTED_MODULE_7__models_size_value__["a" /* SizeValue */](this._metrics.width, this._metrics.height);
    }
  }, {
    key: 'fitWidth',
    value: function fitWidth(width) {
      var variation = this.getFontVariation();

      if (!variation) {
        __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Log"].warn('TextDesignFont#fitText: missing font variation');
        return;
      }

      this._applyTextOptions(this._context, { fontSize: 50 });

      var measuredWidth = this._context.measureText(this.getText()).width;
      var scale = width / measuredWidth;
      var fontSize = Math.floor(scale * 50);

      this.setFontSize(fontSize);

      this._calculateTextMetrics();

      return this.getTextMetrics();
    }
  }, {
    key: 'fitHeight',
    value: function fitHeight(height) {
      var variation = this.getFontVariation();

      if (!variation) {
        __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Log"].warn('TextDesignFont#fitText: missing font variation');
        return;
      }

      var measuredHeight = this._calculateTextMetrics({ fontSize: 50 }).height;
      var scale = height / measuredHeight;
      var fontSize = Math.floor(scale * 50);

      this.setFontSize(fontSize);
      this._calculateTextMetrics();

      return this.getTextMetrics();
    }
  }, {
    key: '_calculateTextMetrics',
    value: function _calculateTextMetrics() {
      var overrideOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      var canvas = this._canvas;
      var ctx = this._context;
      var options = _extends({}, this._options, overrideOptions);
      var text = this.getText();

      this._applyTextOptions(ctx, options);

      var textWidth = Math.ceil(ctx.measureText(text).width);
      var canvasWidth = Math.floor(textWidth + options.fontSize * 2);
      var canvasHeight = Math.floor(options.fontSize * 3);

      canvas.width = canvasWidth;
      canvas.height = canvasHeight;

      var xPos = Math.floor(options.fontSize);
      var yPos = Math.floor(canvasHeight * (3 / 5));

      this._applyTextOptions(ctx, options);
      ctx.fillText(text, xPos, yPos);

      var pixels = ctx.getImageData(0, 0, canvas.width, canvas.height).data;

      var ascender = getAscender(pixels, canvasWidth, canvasHeight, yPos, this._options.excludeAccents);
      var descender = getDescender(pixels, canvasWidth, canvasHeight, yPos, this._options.excludeAccents);
      var width = textWidth;
      var height = ascender + descender;

      this._metrics = {
        width: width,
        height: height,
        ascender: ascender,
        descender: descender
      };

      this._isDirty = false;

      return _extends({}, this._metrics);
    }
  }, {
    key: 'draw',
    value: function draw() {
      var ctx = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._context;
      var x = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      var y = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var options = arguments[3];
      var debug = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;

      ctx.save();

      if (!this._metrics || this._isDirty) {
        this._calculateTextMetrics();
      }

      this._applyTextOptions(ctx, options);

      ctx.fillText(this.getText(), x, y + this._metrics.ascender);

      if (debug) {
        drawRect(ctx, x, y, this._metrics.width, this._metrics.height);
        hLine(ctx, y + this._metrics.ascender, x, x + this._metrics.width);
      }

      ctx.restore();
    }
  }]);

  return TextDesignFont;
}(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Configurable"]);

var getPixel = function getPixel(data, x, y, width) {
  var index = y * (width * 4) + x * 4;
  var pixel = {
    r: data[index],
    g: data[index + 1],
    b: data[index + 2],
    a: data[index + 3]
  };
  return pixel;
};

var isTransparent = function isTransparent(pixel) {
  return pixel.a <= 254;
};

var isBlankScanline = function isBlankScanline(data, y, width) {
  var isBlank = true;
  for (var x = 0; x < width; x++) {
    var pixel = getPixel(data, x, y, width);
    if (!isTransparent(pixel)) {
      isBlank = false;
      break;
    }
  }

  return isBlank;
};

var getDescender = function getDescender(pixels, width, height, startY) {
  var exitOnFirstBlank = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;

  var descender = 0;
  for (var y = startY + 1; y < height; y++) {
    if (!isBlankScanline(pixels, y, width)) {
      descender = y - startY + 1;
    } else if (exitOnFirstBlank) {
      break;
    }
  }

  return descender;
};

var getAscender = function getAscender(pixels, width, height, startY) {
  var exitOnFirstBlank = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;

  var ascender = 0;
  for (var y = startY - 1; y >= 0; y--) {
    if (!isBlankScanline(pixels, y, width)) {
      ascender = startY - y;
    } else if (exitOnFirstBlank) {
      break;
    }
  }

  return ascender;
};

var strokeLine = function strokeLine(ctx, fromX, fromY, toX, toY) {
  ctx.beginPath();
  ctx.moveTo(fromX, fromY);
  ctx.lineTo(toX, toY);
  ctx.stroke();
};

var hLine = function hLine(ctx, y, xmin, xmax) {
  var color = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 'red';

  ctx.save();
  ctx.strokeStyle = color;
  strokeLine(ctx, xmin, y, xmax, y);
  ctx.restore();
};

var drawRect = function drawRect(ctx, x, y, width, height) {
  var color = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 'blue';

  ctx.save();
  ctx.strokeStyle = color;
  ctx.strokeRect(x, y, width, height);
  ctx.restore();
};

TextDesignFont.prototype.availableOptions = {
  text: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: '' },
  fontIdentifier: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: 'imgly_font_open_sans_bold' },
  fontVariation: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].OBJECT, default: null },
  lineHeight: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  fontSize: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 22 },
  textColor: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: 'black' },
  strokeStyle: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: 'black' },
  outlineWidth: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  textBaseline: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: 'alphabetic' },
  excludeAccents: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

/***/ }),
/* 79 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(427);


/***/ }),
/* 80 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RowType; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__ = __webpack_require__(21);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var RowType = function (_Configurable) {
  _inherits(RowType, _Configurable);

  function RowType() {
    _classCallCheck(this, RowType);

    return _possibleConstructorReturn(this, (RowType.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(RowType)).apply(this, arguments));
  }

  _createClass(RowType, [{
    key: 'insetsForWidth',
    value: function insetsForWidth(width) {
      var insets = this.getRelativeInsets().clone();
      return insets.scale(width);
    }
  }]);

  return RowType;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Configurable"]);

RowType.prototype.availableOptions = {
  imagePath: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING, default: '' },
  minimumHeightRatio: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  sizeToFitContent: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].BOOLEAN, default: true },
  capInsets: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */]() },
  relativeInsets: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */]() }
};

RowType.Box = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_black_background.png',
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.1, 0.1, 0.1, 0.1)
});

RowType.Badge1 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_badge1.png',
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.3, 0.18, 0.2, 0.18)
});

RowType.Badge2 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_badge2.png',
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.3, 0.18, 0.2, 0.18)
});

RowType.Badge3 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_badge3.png',
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.3, 0.18, 0.2, 0.18)
});

RowType.Badge4 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_badge4.png',
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.3, 0.18, 0.2, 0.18)
});

RowType.SpeechBubble1 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_speech_bubble_small2.png',
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.04, 0.07, 0.12, 0.07),
  capInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](19 * 3, 57 * 3, 41 * 3, 17 * 3)
});

RowType.SpeechBubble2 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_speech_bubble3.png',
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.04, 0.07, 0.12, 0.07),
  capInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](2 * 3, 35 * 3, 29 * 3, 5 * 3)
});

RowType.SpeechBubble3 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_speech_bubble_small.png',
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.165664675, 0.2, 0.165664675, 0.2),
  minimumHeightRatio: 0.7
});

RowType.SpeechBubble4 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_speech_bubble4.png',
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.124800224, 0.2, 0.291200523, 0.2),
  minimumHeightRatio: 0.7
});

RowType.SpeechBubble5 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_speech_bubble5.png',
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.114892823, 0.27, 0.15984926, 0.27)
});

RowType.Watercolor1 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_watercolor_01.png',
  minimumHeightRatio: 0.7,
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.2, 0.25, 0.2, 0.25)
});

RowType.Watercolor2 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_watercolor_02.png',
  minimumHeightRatio: 0.7,
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.08, 0.25, 0.3, 0.25)
});

RowType.Watercolor3 = new RowType({
  imagePath: 'text-design/images/imgly_text_design_asset_watercolor_03.png',
  minimumHeightRatio: 0.7,
  relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.1, 0.2, 0.15, 0.2)
});

/***/ }),
/* 81 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])
var anObject = __webpack_require__(28);
var dPs = __webpack_require__(231);
var enumBugKeys = __webpack_require__(102);
var IE_PROTO = __webpack_require__(100)('IE_PROTO');
var Empty = function () { /* empty */ };
var PROTOTYPE = 'prototype';

// Create object with fake `null` prototype: use iframe Object with cleared prototype
var createDict = function () {
  // Thrash, waste and sodomy: IE GC bug
  var iframe = __webpack_require__(94)('iframe');
  var i = enumBugKeys.length;
  var lt = '<';
  var gt = '>';
  var iframeDocument;
  iframe.style.display = 'none';
  __webpack_require__(138).appendChild(iframe);
  iframe.src = 'javascript:'; // eslint-disable-line no-script-url
  // createDict = iframe.contentWindow.Object;
  // html.removeChild(iframe);
  iframeDocument = iframe.contentWindow.document;
  iframeDocument.open();
  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);
  iframeDocument.close();
  createDict = iframeDocument.F;
  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];
  return createDict();
};

module.exports = Object.create || function create(O, Properties) {
  var result;
  if (O !== null) {
    Empty[PROTOTYPE] = anObject(O);
    result = new Empty();
    Empty[PROTOTYPE] = null;
    // add "__proto__" for Object.getPrototypeOf polyfill
    result[IE_PROTO] = O;
  } else result = createDict();
  return Properties === undefined ? result : dPs(result, Properties);
};


/***/ }),
/* 82 */
/***/ (function(module, exports, __webpack_require__) {

// 7.1.15 ToLength
var toInteger = __webpack_require__(99);
var min = Math.min;
module.exports = function (it) {
  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991
};


/***/ }),
/* 83 */
/***/ (function(module, exports) {

var id = 0;
var px = Math.random();
module.exports = function (key) {
  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));
};


/***/ }),
/* 84 */
/***/ (function(module, exports, __webpack_require__) {

// getting tag from 19.1.3.6 Object.prototype.toString()
var cof = __webpack_require__(59);
var TAG = __webpack_require__(17)('toStringTag');
// ES3 wrong here
var ARG = cof(function () { return arguments; }()) == 'Arguments';

// fallback for IE11 Script Access Denied error
var tryGet = function (it, key) {
  try {
    return it[key];
  } catch (e) { /* empty */ }
};

module.exports = function (it) {
  var O, T, B;
  return it === undefined ? 'Undefined' : it === null ? 'Null'
    // @@toStringTag case
    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T
    // builtinTag case
    : ARG ? cof(O)
    // ES3 arguments fallback
    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;
};


/***/ }),
/* 85 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__renderers_canvas_canvas_renderer__ = __webpack_require__(256);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__renderers_webgl_webgl_renderer__ = __webpack_require__(273);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__managers_canvas_filter_manager__ = __webpack_require__(115);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__managers_webgl_filter_manager__ = __webpack_require__(119);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__display_display_object__ = __webpack_require__(118);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__display_container__ = __webpack_require__(162);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__textures_base_texture__ = __webpack_require__(68);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__textures_texture__ = __webpack_require__(163);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__textures_render_texture__ = __webpack_require__(282);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__utils_webgl_render_target__ = __webpack_require__(88);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__utils_canvas_render_target__ = __webpack_require__(87);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__sprites_sprite__ = __webpack_require__(283);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__shaders___ = __webpack_require__(285);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__shaders_shader__ = __webpack_require__(117);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__filters_filter__ = __webpack_require__(69);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__filters__ = __webpack_require__(289);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__utils_pixel_array_image__ = __webpack_require__(161);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



















/**
 * The heart of PhotoEditorSDK. Handles all the rendering in a scene-graph fashion
 * @namespace PhotoEditorSDK.Engine
 */
var Engine = {
  WebGLRenderer: __WEBPACK_IMPORTED_MODULE_1__renderers_webgl_webgl_renderer__["a" /* default */],
  CanvasRenderer: __WEBPACK_IMPORTED_MODULE_0__renderers_canvas_canvas_renderer__["a" /* default */],
  WebGLFilterManager: __WEBPACK_IMPORTED_MODULE_3__managers_webgl_filter_manager__["a" /* default */],
  CanvasFilterManager: __WEBPACK_IMPORTED_MODULE_2__managers_canvas_filter_manager__["a" /* default */],
  DisplayObject: __WEBPACK_IMPORTED_MODULE_4__display_display_object__["a" /* default */],
  Container: __WEBPACK_IMPORTED_MODULE_5__display_container__["a" /* default */],
  BaseTexture: __WEBPACK_IMPORTED_MODULE_6__textures_base_texture__["a" /* default */],
  Texture: __WEBPACK_IMPORTED_MODULE_7__textures_texture__["a" /* default */],
  RenderTexture: __WEBPACK_IMPORTED_MODULE_8__textures_render_texture__["a" /* default */],
  WebGLRenderTarget: __WEBPACK_IMPORTED_MODULE_9__utils_webgl_render_target__["a" /* default */],
  CanvasRenderTarget: __WEBPACK_IMPORTED_MODULE_10__utils_canvas_render_target__["a" /* default */],
  Sprite: __WEBPACK_IMPORTED_MODULE_11__sprites_sprite__["a" /* default */],
  Shaders: __WEBPACK_IMPORTED_MODULE_12__shaders___["a" /* default */],
  Shader: __WEBPACK_IMPORTED_MODULE_13__shaders_shader__["a" /* default */],
  Filter: __WEBPACK_IMPORTED_MODULE_14__filters_filter__["a" /* default */],
  Filters: __WEBPACK_IMPORTED_MODULE_15__filters__,
  PixelArrayImage: __WEBPACK_IMPORTED_MODULE_16__utils_pixel_array_image__["a" /* default */],

  /**
   * If WebGL is supported, this returns a WebGLRenderer and falls back to CanvasRenderer
   * @param  {Number} width
   * @param  {Number} height
   * @param  {Object} [options = {} ]
   * @return {(PhotoEditorSDK.Engine.WebGLRenderer|PhotoEditorSDK.Engine.CanvasRenderer)}
   */
  autoDetectRenderer: function autoDetectRenderer(width, height) {
    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

    if (__WEBPACK_IMPORTED_MODULE_1__renderers_webgl_webgl_renderer__["a" /* default */].isSupported()) {
      return new __WEBPACK_IMPORTED_MODULE_1__renderers_webgl_webgl_renderer__["a" /* default */](width, height, options);
    } else {
      return new __WEBPACK_IMPORTED_MODULE_0__renderers_canvas_canvas_renderer__["a" /* default */](width, height, options);
    }
  }
};

/* harmony default export */ __webpack_exports__["a"] = (Engine);

/***/ }),
/* 86 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process) {// Generated by CoffeeScript 1.7.1
(function() {
  var getNanoSeconds, hrtime, loadTime;

  if ((typeof performance !== "undefined" && performance !== null) && performance.now) {
    module.exports = function() {
      return performance.now();
    };
  } else if ((typeof process !== "undefined" && process !== null) && process.hrtime) {
    module.exports = function() {
      return (getNanoSeconds() - loadTime) / 1e6;
    };
    hrtime = process.hrtime;
    getNanoSeconds = function() {
      var hr;
      hr = hrtime();
      return hr[0] * 1e9 + hr[1];
    };
    loadTime = getNanoSeconds();
  } else if (Date.now) {
    module.exports = function() {
      return Date.now() - loadTime;
    };
    loadTime = Date.now();
  } else {
    module.exports = function() {
      return new Date().getTime() - loadTime;
    };
    loadTime = new Date().getTime();
  }

}).call(this);

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(152)));

/***/ }),
/* 87 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__ = __webpack_require__(68);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * A canvas render target that you can render to.
 * Canvas equivalent of {@link PhotoEditorSDK.Engine.WebGLRenderTarget}
 * @class
 * @memberof PhotoEditorSDK.Engine
 */

var CanvasRenderTarget = function () {
  /**
   * Creates a CanvasRenderTarget
   * @param  {Number} width
   * @param  {Number} height
   * @param  {Number} pixelRatio
   * @param  {HTMLCanvasElement} canvas
   * @param  {CanvasRenderingContext2D} context
   */
  function CanvasRenderTarget(width, height, pixelRatio, canvas, context) {
    _classCallCheck(this, CanvasRenderTarget);

    this._width = width;
    this._height = height;
    this._pixelRatio = pixelRatio;

    this._baseTexture = new __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__["a" /* default */]();
    this._canvas = canvas || this._createCanvas();
    this._context = context || this._canvas.getContext('2d');
    this._baseTexture.setSource(this._canvas);

    this._canvas.width = this._width * this._pixelRatio;
    this._canvas.height = this._height * this._pixelRatio;
    this._filterStack = [{
      renderTarget: this,
      filter: []
    }];
  }

  /**
   * Creates a canvas
   * @return {Canvas}
   * @private
   */


  _createClass(CanvasRenderTarget, [{
    key: '_createCanvas',
    value: function _createCanvas() {
      return __WEBPACK_IMPORTED_MODULE_1__globals__["i" /* Utils */].createCanvas();
    }

    /**
     * Clears this CanvasRenderTarget
     */

  }, {
    key: 'clear',
    value: function clear() {
      var ctx = this._context;
      ctx.setTransform(1, 0, 0, 1, 0, 0);
      ctx.clearRect(0, 0, this._width * this._pixelRatio, this._height * this._pixelRatio);
    }

    /**
     * Resizes this canvas buffer to the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     */

  }, {
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      this._baseTexture.resizeTo(dimensions);

      if (this._width !== dimensions.x) {
        this._width = dimensions.x;
        this._canvas.width = this._width * this._pixelRatio;
      }

      if (this._height !== dimensions.y) {
        this._height = dimensions.y;
        this._canvas.height = this._height * this._pixelRatio;
      }
    }

    /**
     * Returns the canvas
     * @return {HTMLCanvasElement}
     */

  }, {
    key: 'getCanvas',
    value: function getCanvas() {
      return this._canvas;
    }

    /**
     * Returns the rendering context
     * @return {CanvasRenderingContext2D} [description]
     */

  }, {
    key: 'getContext',
    value: function getContext() {
      return this._context;
    }

    /**
     * Returns the filter stack
     * @return {Object[]}
     */

  }, {
    key: 'getFilterStack',
    value: function getFilterStack() {
      return this._filterStack;
    }

    /**
     * Returns the width
     * @return {Number}
     */

  }, {
    key: 'getWidth',
    value: function getWidth() {
      return this._width;
    }

    /**
     * Returns the height
     * @return {Number}
     */

  }, {
    key: 'getHeight',
    value: function getHeight() {
      return this._height;
    }

    /**
     * Returns the pixel ratio
     * @return {Number}
     */

  }, {
    key: 'getPixelRatio',
    value: function getPixelRatio() {
      return this._pixelRatio;
    }

    /**
     * Sets the pixel ratio
     * @param {Number} pixelRatio
     */

  }, {
    key: 'setPixelRatio',
    value: function setPixelRatio(pixelRatio) {
      this._pixelRatio = pixelRatio;
    }

    /**
     * Returns the dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions() {
      return new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](this._width, this._height);
    }

    /**
     * Returns the base texture
     * @return {PhotoEditorSDK.Engine.BaseTexture}
     */

  }, {
    key: 'getBaseTexture',
    value: function getBaseTexture() {
      return this._baseTexture;
    }

    /**
     * Cleans up this canvas buffer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._canvas = null;
      this._context = null;
      this._baseTexture.dispose();
    }
  }]);

  return CanvasRenderTarget;
}();

/* harmony default export */ __webpack_exports__["a"] = (CanvasRenderTarget);

/***/ }),
/* 88 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__ = __webpack_require__(68);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * An object that you can render to. WebGL equivalent of {@link PhotoEditorSDK.Engine.CanvasRenderTarget}
 * @class
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var WebGLRenderTarget = function () {
  /**
   * Creates a WebGLRenderTarget
   * @param  {PhotoEditorSDK.Engine.BaseRenderer}  renderer
   * @param  {Number}  width
   * @param  {Number}  height
   * @param  {Number}  pixelRatio
   * @param  {Boolean} [isRoot = false]
   */
  function WebGLRenderTarget(renderer, width, height, pixelRatio) {
    var isRoot = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;

    _classCallCheck(this, WebGLRenderTarget);

    this._renderer = renderer;
    this._gl = renderer.getContext();
    this._width = width;
    this._height = height;
    this._frame = null;
    this._pixelRatio = pixelRatio;
    this._projectionMatrix = new __WEBPACK_IMPORTED_MODULE_1__globals__["g" /* Matrix */]();
    this._mipMapping = false;

    this._baseTexture = new __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__["a" /* default */]();
    var frame = this._baseTexture.getFrame();
    frame.width = width;
    frame.height = height;
    this._baseTexture.setPixelRatio(pixelRatio);
    this._baseTexture.setLoaded(true);

    // `null` means render to canvas directly
    this._framebuffer = null;
    this._isRoot = isRoot;
    this._filterStack = [{
      renderTarget: this,
      filter: []
    }];

    if (!isRoot) {
      this._initFrameBuffer();
    }
  }

  /**
   * Resizes this WebGLRenderTarget to the given dimensions
   * @param  {PhotoEditorSDK.Math.Vector2} dimensions
   */


  _createClass(WebGLRenderTarget, [{
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      this._width = dimensions.x | 0; // rounded
      this._height = dimensions.y | 0; // rounded

      this._baseTexture.resizeTo(dimensions);

      if (!this._isRoot) {
        this._resizeTexture();
      }

      this._baseTexture.setMinFilter(this._getMinFilter());
      this._baseTexture.setMagFilter(this._getMagFilter());

      this._calculateProjectionMatrix();
    }

    /**
     * Returns the downsampling filter
     * @return {Number}
     * @private
     */

  }, {
    key: '_getMinFilter',
    value: function _getMinFilter() {
      var minFilter = __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__["a" /* default */].DefaultMinFilter;
      if (this._mipMapping) {
        minFilter = __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__["a" /* default */].TrilinearFilter;
      }
      return minFilter;
    }

    /**
     * Returns the upsampling filter
     * @return {Number}
     * @private
     */

  }, {
    key: '_getMagFilter',
    value: function _getMagFilter() {
      return __WEBPACK_IMPORTED_MODULE_2__textures_base_texture__["a" /* default */].DefaultMagFilter;
    }

    /**
     * Resizes the FBO's texture to the current dimensions
     * @private
     */

  }, {
    key: '_resizeTexture',
    value: function _resizeTexture() {
      var gl = this._gl;

      var realWidth = this._width * this._pixelRatio;
      var realHeight = this._height * this._pixelRatio;

      // Create a new texture and if we have an old we must delete this.
      if (this._texture) {
        gl.deleteTexture(this._texture);
        this._texture = null;
      }
      this._texture = gl.createTexture(); // Mojave crash fix!
      gl.bindTexture(gl.TEXTURE_2D, this._texture);

      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, realWidth, realHeight, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);

      // Bind texture to FBO
      gl.bindFramebuffer(gl.FRAMEBUFFER, this._framebuffer);
      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this._texture, 0);

      this._baseTexture.setGLTextureForRenderer(this._texture, this._renderer);

      if (this._renderer._options.debug) {
        __WEBPACK_IMPORTED_MODULE_1__globals__["e" /* GLUtils */].checkFramebufferStatus('WebGLRenderTarget#_initFramebuffer', gl);
      }

      var dimensions = new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](this._width, this._height);
      if (__WEBPACK_IMPORTED_MODULE_1__globals__["i" /* Utils */].isPowerOfTwo(dimensions)) {
        __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].info('WebGLRenderTarget', 'Mip-mapping enabled');
        this._mipMapping = true;
      } else {
        this._mipMapping = false;
      }

      this._baseTexture.setMipMappingEnabled(this._mipMapping);
    }

    /**
     * Binds the framebuffer and resizes the viewport
     */

  }, {
    key: 'activate',
    value: function activate() {
      var gl = this._gl;
      gl.bindFramebuffer(gl.FRAMEBUFFER, this._framebuffer);

      this._calculateProjectionMatrix();

      gl.viewport(0, 0, this._width * this._pixelRatio, this._height * this._pixelRatio);
      gl.disable(gl.STENCIL_TEST);
    }

    /**
     * Clears the framebuffer
     */

  }, {
    key: 'clear',
    value: function clear() {
      var color = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : __WEBPACK_IMPORTED_MODULE_1__globals__["b" /* Color */].TRANSPARENT;

      var gl = this._gl;
      gl.bindFramebuffer(gl.FRAMEBUFFER, this._framebuffer);

      if (this._renderer._options.debug) {
        __WEBPACK_IMPORTED_MODULE_1__globals__["e" /* GLUtils */].checkFramebufferStatus('WebGLRenderTarget#clear', gl);
      }

      gl.clearColor.apply(gl, color.toGLColor());
      gl.clear(gl.COLOR_BUFFER_BIT);
    }

    /**
     * Calculates the projection matrix for this render target
     * @private
     */

  }, {
    key: '_calculateProjectionMatrix',
    value: function _calculateProjectionMatrix() {
      var projectionMatrix = this._projectionMatrix;
      projectionMatrix.reset();

      var frame = this._frame || new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, this._width, this._height);

      var x = frame.x,
          y = frame.y;

      if (!this._isRoot) {
        projectionMatrix.a = 1 / this._width * 2;
        projectionMatrix.d = 1 / this._height * 2;

        projectionMatrix.tx = -1 - x * projectionMatrix.a;
        projectionMatrix.ty = -1 - y * projectionMatrix.d;
      } else {
        projectionMatrix.a = 1 / this._width * 2;
        projectionMatrix.d = -1 / this._height * 2;

        projectionMatrix.tx = -1 - x * projectionMatrix.a;
        projectionMatrix.ty = 1 - y * projectionMatrix.d;
      }
    }

    /**
     * Initializes the WebGL FBO and Texture for this WebGLRenderTarget
     * @private
     */

  }, {
    key: '_initFrameBuffer',
    value: function _initFrameBuffer() {
      var gl = this._gl;

      // Init the FBO
      if (this._framebuffer) {
        gl.deleteFramebuffer(this._framebuffer);
        this._framebuffer = null;
      }
      if (this._texture) {
        gl.deleteTexture(this._texture);
        this._texture = null;
      }

      this._framebuffer = gl.createFramebuffer();
      // Create the texture
      this._texture = gl.createTexture();
      gl.bindTexture(gl.TEXTURE_2D, this._texture);

      // Bind texture to FBO
      gl.bindFramebuffer(gl.FRAMEBUFFER, this._framebuffer);
      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this._texture, 0);

      this._baseTexture.setGLTextureForRenderer(this._texture, this._renderer);
      this.resizeTo(new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](this._width, this._height));

      if (this._renderer._options.debug) {
        __WEBPACK_IMPORTED_MODULE_1__globals__["e" /* GLUtils */].checkFramebufferStatus('WebGLRenderTarget#_initFramebuffer', gl);
      }
    }

    /**
     * Returns the projection matrix
     * @return {PhotoEditorSDK.Math.Matrix}
     */

  }, {
    key: 'getProjectionMatrix',
    value: function getProjectionMatrix() {
      return this._projectionMatrix;
    }

    /**
     * Returns the texture
     * @return {PhotoEditorSDK.Engine.Texture}
     */

  }, {
    key: 'getTexture',
    value: function getTexture() {
      return this._texture;
    }

    /**
     * Returns the frame
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getFrame',
    value: function getFrame() {
      return this._frame;
    }

    /**
     * Sets the frame
     * @param {PhotoEditorSDK.Math.Rectangle} frame
     */

  }, {
    key: 'setFrame',
    value: function setFrame(frame) {
      this._frame = frame;
    }

    /**
     * Returns the filter stack
     * @return {Object[]}
     */

  }, {
    key: 'getFilterStack',
    value: function getFilterStack() {
      return this._filterStack;
    }

    /**
     * Returns the current pixel ratio
     * @return {Number}
     */

  }, {
    key: 'getPixelRatio',
    value: function getPixelRatio() {
      return this._pixelRatio;
    }

    /**
     * Sets the pixel ratio
     * @param {Number} pixelRatio
     */

  }, {
    key: 'setPixelRatio',
    value: function setPixelRatio(pixelRatio) {
      this._pixelRatio = pixelRatio;

      if (!this._isRoot) {
        this._resizeTexture();
      }
    }

    /**
     * Returns the base texture
     * @return {PhotoEditorSDK.Engine.BaseTexture}
     */

  }, {
    key: 'getBaseTexture',
    value: function getBaseTexture() {
      return this._baseTexture;
    }

    /**
     * Disposes this WebGLRenderTarget
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var gl = this._gl;
      this._baseTexture.dispose();
      if (this._framebuffer) {
        gl.deleteFramebuffer(this._framebuffer);
        this._framebuffer = null;
      }
      if (this._texture) {
        gl.deleteTexture(this._texture);
        this._texture = null;
      }
    }
  }]);

  return WebGLRenderTarget;
}();

/* harmony default export */ __webpack_exports__["a"] = (WebGLRenderTarget);

/***/ }),
/* 89 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

var Image = void 0;
{
  Image = window.Image;
}

/* harmony default export */ __webpack_exports__["a"] = (Image);

/***/ }),
/* 90 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Events; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__art_filters__ = __webpack_require__(298);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Events = {
  EXPORT: 'export',
  CLOSE: 'close',

  OPERATION_CREATED: 'operation:created',
  OPERATION_UPDATED: 'operation:updated',
  OPERATION_REMOVED: 'operation:removed',

  EDITOR_READY: 'editor:ready',

  WINDOW_RESIZE: 'window:resize',

  ZOOM_DONE: 'editor:zoom_done',

  HISTORY_UNDO: 'history:undo',
  HISTORY_UPDATED: 'history:update',

  FEATURES_DISABLED: 'editor:features:disabled',
  FEATURES_ENABLED: 'editor:features:enabled',
  FEATURES_UPDATED: 'editor:features:updated',

  TRANSFORM_REAPPLY_RATIO: 'transform:reapply_ratio'
};



/* harmony default export */ __webpack_exports__["b"] = ({
  DEFAULTS: {
    ART_FILTERS: __WEBPACK_IMPORTED_MODULE_0__art_filters__["a" /* default */],
    FILTERS: [{
      identifier: 'imgly_filters_duotone',
      defaultName: 'DuoTone',
      assetFileName: 'duotone',
      filters: [{
        identifier: 'imgly_duotone_desert',
        defaultName: 'Desert',
        lightColor: '#e1de9a',
        darkColor: '#cb2129'
      }, {
        identifier: 'imgly_duotone_peach',
        defaultName: 'Peach',
        lightColor: '#e9abb8',
        darkColor: '#0040ff'
      }, {
        identifier: 'imgly_duotone_clash',
        defaultName: 'Clash',
        lightColor: '#f41a0f',
        darkColor: '#23007c'
      }, {
        identifier: 'imgly_duotone_plum',
        defaultName: 'Plum',
        lightColor: '#74d7ff',
        darkColor: '#23007c'
      }, {
        identifier: 'imgly_duotone_breezy',
        defaultName: 'Breezy',
        lightColor: '#68fdff',
        darkColor: '#c20000'
      }, {
        identifier: 'imgly_duotone_deepblue',
        defaultName: 'Deep Blue',
        lightColor: '#2de9eb',
        darkColor: '#58007c'
      }, {
        identifier: 'imgly_duotone_frog',
        defaultName: 'Frog',
        lightColor: '#5bff60',
        darkColor: '#7f23a9'
      }, {
        identifier: 'imgly_duotone_sunset',
        defaultName: 'Sunset',
        lightColor: '#f8ea46',
        darkColor: '#c400be'
      }]
    }, {
      identifier: 'imgly_filters_bw',
      assetFileName: 'b&w',
      defaultName: 'Black & White',
      filters: [{
        identifier: 'imgly_lut_ad1920',
        defaultName: '1920 A.D.',
        lutImage: 'filters/imgly_lut_ad1920_5_5_128.png'
      }, {
        identifier: 'imgly_lut_bw',
        defaultName: 'Greyed',
        lutImage: 'filters/imgly_lut_bw_5_5_128.png'
      }, {
        identifier: 'imgly_lut_x400',
        defaultName: 'Dusty',
        lutImage: 'filters/imgly_lut_dusty_5_5_128.png'
      }, {
        identifier: 'imgly_lut_litho',
        defaultName: 'Litho',
        lutImage: 'filters/imgly_lut_litho_5_5_128.png'
      }, {
        identifier: 'imgly_lut_sepiahigh',
        defaultName: 'Sepia',
        lutImage: 'filters/imgly_lut_sepia_5_5_128.png'
      }, {
        identifier: 'imgly_lut_plate',
        defaultName: 'Weathered',
        lutImage: 'filters/imgly_lut_weathered_5_5_128.png'
      }, {
        identifier: 'imgly_lut_sin',
        defaultName: 'Hard Stuff',
        lutImage: 'filters/imgly_lut_hard_stuff_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }]
    }, {
      identifier: 'imgly_filters_retro',
      assetFileName: 'vintage',
      defaultName: 'Vintage',
      filters: [{
        identifier: 'imgly_lut_blues',
        defaultName: 'Polaroid',
        lutImage: 'filters/imgly_lut_polaroid_5_5_128.png'
      }, {
        identifier: 'imgly_lut_front',
        defaultName: 'Sunny 70s',
        lutImage: 'filters/imgly_lut_sunny_70s_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_texas',
        defaultName: 'Oldtimer',
        lutImage: 'filters/imgly_lut_oldtimer_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_celsius',
        defaultName: 'Inferno',
        lutImage: 'filters/imgly_lut_inferno_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_cool',
        defaultName: 'Snappy',
        lutImage: 'filters/imgly_lut_snappy_5_5_128.png'
      }]
    }, {
      identifier: 'imgly_filters_analog',
      assetFileName: 'smooth',
      defaultName: 'Smooth',
      filters: [{
        identifier: 'imgly_lut_chest',
        defaultName: 'Chestnut',
        lutImage: 'filters/imgly_lut_chestnut_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_winter',
        defaultName: 'Softly',
        lutImage: 'filters/imgly_lut_softly_5_5_128.png'
      }, {
        identifier: 'imgly_lut_kdynamic',
        defaultName: 'Pebble',
        lutImage: 'filters/imgly_lut_pebble_5_5_128.png'
      }, {
        identifier: 'imgly_lut_fall',
        defaultName: 'Moss',
        lutImage: 'filters/imgly_lut_moss_5_5_128.png'
      }, {
        identifier: 'imgly_lut_lenin',
        defaultName: 'Lemon',
        lutImage: 'filters/imgly_lut_lemon_5_5_128.png'
      }, {
        identifier: 'imgly_lut_pola669',
        defaultName: 'Green Gap',
        lutImage: 'filters/imgly_lut_green_gap_5_5_128.png'
      }]
    }, {
      identifier: 'imgly_filters_winter',
      assetFileName: 'cold',
      defaultName: 'Cold',
      filters: [{
        identifier: 'imgly_lut_elder',
        defaultName: 'Colla',
        lutImage: 'filters/imgly_lut_colla_5_5_128.png'
      }, {
        identifier: 'imgly_lut_orchid',
        defaultName: 'Solanus',
        lutImage: 'filters/imgly_lut_solanus_5_5_128.png'
      }, {
        identifier: 'imgly_lut_bleached',
        defaultName: 'Kalmen',
        lutImage: 'filters/imgly_lut_kalmen_5_5_128.png'
      }, {
        identifier: 'imgly_lut_bleachedblue',
        defaultName: 'Joran',
        lutImage: 'filters/imgly_lut_joran_5_5_128.png'
      }, {
        identifier: 'imgly_lut_breeze',
        defaultName: 'Levante',
        lutImage: 'filters/imgly_lut_levante_5_5_128.png'
      }, {
        identifier: 'imgly_lut_blueshadows',
        defaultName: 'Zephyr',
        lutImage: 'filters/imgly_lut_zephyr_5_5_128.png'
      }]
    }, {
      identifier: 'imgly_filters_summer',
      assetFileName: 'warm',
      defaultName: 'Warm',
      filters: [{
        identifier: 'imgly_lut_sunset',
        defaultName: 'Golden',
        lutImage: 'filters/imgly_lut_golden_5_5_128.png'
      }, {
        identifier: 'imgly_lut_eighties',
        defaultName: 'Low Fire',
        lutImage: 'filters/imgly_lut_low_fire_5_5_128.png'
      }, {
        identifier: 'imgly_lut_evening',
        defaultName: 'Sunrise',
        lutImage: 'filters/imgly_lut_sunrise_5_5_128.png'
      }, {
        identifier: 'imgly_lut_k2',
        defaultName: 'Flat Black',
        lutImage: 'filters/imgly_lut_flat_black_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_nogreen',
        defaultName: 'Pumpkin',
        lutImage: 'filters/imgly_lut_pumpkin_5_5_128.png'
      }]
    }, {
      identifier: 'imgly_filters_legacy',
      defaultName: 'Legacy',
      assetFileName: 'legacy',
      filters: [{
        identifier: 'imgly_lut_ancient',
        defaultName: 'Ancient',
        lutImage: 'filters/imgly_lut_ancient_5_5_128.png'
      }, {
        identifier: 'imgly_lut_cottoncandy',
        defaultName: 'Candy',
        lutImage: 'filters/imgly_lut_cottoncandy_5_5_128.png'
      }, {
        identifier: 'imgly_lut_classic',
        defaultName: 'Classic',
        lutImage: 'filters/imgly_lut_classic_5_5_128.png'
      }, {
        identifier: 'imgly_lut_colorful',
        defaultName: 'Colorful',
        lutImage: 'filters/imgly_lut_colorful_5_5_128.png'
      }, {
        identifier: 'imgly_lut_creamy',
        defaultName: 'Creamy',
        lutImage: 'filters/imgly_lut_creamy_5_5_128.png'
      }, {
        identifier: 'imgly_lut_fixie',
        defaultName: 'Fixie',
        lutImage: 'filters/imgly_lut_fixie_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_food',
        defaultName: 'Food',
        lutImage: 'filters/imgly_lut_food_5_5_128.png'
      }, {
        identifier: 'imgly_lut_fridge',
        defaultName: 'Fridge',
        lutImage: 'filters/imgly_lut_fridge_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_glam',
        defaultName: 'Glam',
        lutImage: 'filters/imgly_lut_glam_5_5_128.png'
      }, {
        identifier: 'imgly_lut_gobblin',
        defaultName: 'Gobblin',
        lutImage: 'filters/imgly_lut_gobblin_5_5_128.png'
      }, {
        identifier: 'imgly_lut_highcontrast',
        defaultName: 'Hicon',
        lutImage: 'filters/imgly_lut_highcontrast_5_5_128.png'
      }, {
        identifier: 'imgly_lut_highcarb',
        defaultName: 'High Carb',
        lutImage: 'filters/imgly_lut_highcarb_5_5_128.png'
      }, {
        identifier: 'imgly_lut_k1',
        defaultName: 'K1',
        lutImage: 'filters/imgly_lut_k1_5_5_128.png'
      }, {
        identifier: 'imgly_lut_k6',
        defaultName: 'K6',
        lutImage: 'filters/imgly_lut_k6_5_5_128.png'
      }, {
        identifier: 'imgly_lut_keen',
        defaultName: 'Keen',
        lutImage: 'filters/imgly_lut_keen_5_5_128.png'
      }, {
        identifier: 'imgly_lut_lomo',
        defaultName: 'Lomo',
        lutImage: 'filters/imgly_lut_lomo_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_lomo100',
        defaultName: 'Lomo 100',
        lutImage: 'filters/imgly_lut_lomo100_5_5_128.png'
      }, {
        identifier: 'imgly_lut_lucid',
        defaultName: 'Lucid',
        lutImage: 'filters/imgly_lut_lucid_5_5_128.png'
      }, {
        identifier: 'imgly_lut_mellow',
        defaultName: 'Mellow',
        lutImage: 'filters/imgly_lut_mellow_8_8_512.png',
        resolution: 512,
        horizontalTileCount: 8,
        verticalTileCount: 8
      }, {
        identifier: 'imgly_lut_neat',
        defaultName: 'Neat',
        lutImage: 'filters/imgly_lut_neat_5_5_128.png'
      }, {
        identifier: 'imgly_lut_pale',
        defaultName: 'Pale',
        lutImage: 'filters/imgly_lut_pale_5_5_128.png'
      }, {
        identifier: 'imgly_lut_pitched',
        defaultName: 'Pitched',
        lutImage: 'filters/imgly_lut_pitched_5_5_128.png'
      }, {
        identifier: 'imgly_lut_polasx',
        defaultName: 'Pola SX',
        lutImage: 'filters/imgly_lut_polasx_5_5_128.png'
      }, {
        identifier: 'imgly_lut_pro400',
        defaultName: 'Pro 400',
        lutImage: 'filters/imgly_lut_pro400_5_5_128.png'
      }, {
        identifier: 'imgly_lut_quozi',
        defaultName: 'Quozi',
        lutImage: 'filters/imgly_lut_quozi_5_5_128.png'
      }, {
        identifier: 'imgly_lut_settled',
        defaultName: 'Settled',
        lutImage: 'filters/imgly_lut_settled_5_5_128.png'
      }, {
        identifier: 'imgly_lut_seventies',
        defaultName: 'Seventies',
        lutImage: 'filters/imgly_lut_seventies_5_5_128.png'
      }, {
        identifier: 'imgly_lut_soft',
        defaultName: 'Soft',
        lutImage: 'filters/imgly_lut_soft_5_5_128.png'
      }, {
        identifier: 'imgly_lut_steel',
        defaultName: 'Steel',
        lutImage: 'filters/imgly_lut_steel_5_5_128.png'
      }, {
        identifier: 'imgly_lut_summer',
        defaultName: 'Summer',
        lutImage: 'filters/imgly_lut_summer_5_5_128.png'
      }, {
        identifier: 'imgly_lut_tender',
        defaultName: 'Tender',
        lutImage: 'filters/imgly_lut_tender_5_5_128.png'
      }, {
        identifier: 'imgly_lut_twilight',
        defaultName: 'Twilight',
        lutImage: 'filters/imgly_lut_twilight_5_5_128.png'
      }]
    }],
    OVERLAYS: [{
      identifier: 'imgly_overlay_golden',
      defaultName: 'Golden',
      image: 'overlays/imgly_overlay_golden.jpg',
      thumbnail: 'overlays/imgly_overlay_golden_thumb.jpg',
      blendMode: 'lighten'
    }, {
      identifier: 'imgly_overlay_bokeh',
      defaultName: 'Bokeh',
      image: 'overlays/imgly_overlay_bokeh.jpg',
      thumbnail: 'overlays/imgly_overlay_bokeh_thumb.jpg',
      blendMode: 'lighten'
    }, {
      identifier: 'imgly_overlay_hearts',
      defaultName: 'Hearts',
      image: 'overlays/imgly_overlay_hearts.jpg',
      thumbnail: 'overlays/imgly_overlay_hearts_thumb.jpg',
      blendMode: 'screen'
    }, {
      identifier: 'imgly_overlay_lightleak1',
      defaultName: 'Light Leak',
      image: 'overlays/imgly_overlay_lightleak1.jpg',
      thumbnail: 'overlays/imgly_overlay_lightleak1_thumb.jpg',
      blendMode: 'screen'
    }, {
      identifier: 'imgly_overlay_lightleak2',
      defaultName: 'Light Leak 2',
      image: 'overlays/imgly_overlay_lightleak2.jpg',
      thumbnail: 'overlays/imgly_overlay_lightleak2_thumb.jpg',
      blendMode: 'lighten'
    }, {
      identifier: 'imgly_overlay_rain',
      defaultName: 'Rain',
      image: 'overlays/imgly_overlay_rain.jpg',
      thumbnail: 'overlays/imgly_overlay_rain_thumb.jpg',
      blendMode: 'overlay'
    }, {
      identifier: 'imgly_overlay_wood',
      defaultName: 'Wood',
      image: 'overlays/imgly_overlay_wood.jpg',
      thumbnail: 'overlays/imgly_overlay_wood_thumb.jpg',
      blendMode: 'multiply'
    }, {
      identifier: 'imgly_overlay_mosaic',
      defaultName: 'Mosaic',
      image: 'overlays/imgly_overlay_mosaic.jpg',
      thumbnail: 'overlays/imgly_overlay_mosaic_thumb.jpg',
      blendMode: 'multiply'
    }, {
      identifier: 'imgly_overlay_chop',
      defaultName: 'Chop',
      image: 'overlays/imgly_overlay_chop.jpg',
      thumbnail: 'overlays/imgly_overlay_chop_thumb.jpg',
      blendMode: 'multiply'
    }, {
      identifier: 'imgly_overlay_vintage',
      defaultName: 'Vintage',
      image: 'overlays/imgly_overlay_vintage.jpg',
      thumbnail: 'overlays/imgly_overlay_vintage_thumb.jpg',
      blendMode: 'darken'
    }, {
      identifier: 'imgly_overlay_metal',
      defaultName: 'Metal',
      image: 'overlays/imgly_overlay_metal.jpg',
      thumbnail: 'overlays/imgly_overlay_metal_thumb.jpg',
      blendMode: 'overlay'
    }, {
      identifier: 'imgly_overlay_paper',
      defaultName: 'Paper',
      image: 'overlays/imgly_overlay_paper.jpg',
      thumbnail: 'overlays/imgly_overlay_paper_thumb.jpg',
      blendMode: 'multiply'
    }, {
      identifier: 'imgly_overlay_painting',
      defaultName: 'Painting',
      image: 'overlays/imgly_overlay_painting.jpg',
      thumbnail: 'overlays/imgly_overlay_painting_thumb.jpg',
      blendMode: 'overlay'
    }, {
      identifier: 'imgly_overlay_grain',
      defaultName: 'Grain',
      image: 'overlays/imgly_overlay_grain.jpg',
      thumbnail: 'overlays/imgly_overlay_grain_thumb.jpg',
      blendMode: 'overlay'
    }, {
      identifier: 'imgly_overlay_clouds',
      defaultName: 'Clouds',
      image: 'overlays/imgly_overlay_clouds.jpg',
      thumbnail: 'overlays/imgly_overlay_clouds_thumb.jpg',
      blendMode: 'softLight'
    }, {
      identifier: 'imgly_overlay_wall1',
      defaultName: 'Wall',
      image: 'overlays/imgly_overlay_wall1.jpg',
      thumbnail: 'overlays/imgly_overlay_wall1_thumb.jpg',
      blendMode: 'lighten'
    }, {
      identifier: 'imgly_overlay_wall2',
      defaultName: 'Wall 2',
      image: 'overlays/imgly_overlay_wall2.jpg',
      thumbnail: 'overlays/imgly_overlay_wall2_thumb.jpg',
      blendMode: 'overlay'
    }],
    FRAME_CATEGORIES: [{
      identifier: 'imgly_frame_generic',
      defaultName: 'Generic',
      metaData: {
        backgroundImage: 'frames/generic.png' // Not used yet
      },
      frames: [{
        identifier: 'imgly_frame_dia',
        defaultName: 'Dia',
        layoutMode: 'horizontal-inside',
        thumbnail: 'frames/imgly_frame_dia/imgly_frame_dia_thumb.png',
        imageGroups: {
          top: {
            mid: {
              image: 'frames/imgly_frame_dia/imgly_frame_dia_top.png',
              mode: 'repeat'
            }
          },
          left: {
            start: 'frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png',
            mid: 'frames/imgly_frame_dia/imgly_frame_dia_left.png',
            end: 'frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png'
          },
          right: {
            start: 'frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png',
            mid: 'frames/imgly_frame_dia/imgly_frame_dia_right.png',
            end: 'frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png'
          },
          bottom: {
            mid: {
              image: 'frames/imgly_frame_dia/imgly_frame_dia_bottom.png',
              mode: 'repeat'
            }
          }
        }
      }, {
        identifier: 'imgly_frame_art_decor',
        defaultName: 'Art Decor',
        tintable: true,
        layoutMode: 'horizontal-inside',
        thumbnail: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png',
        imageGroups: {
          top: {
            start: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png'
          },
          left: {
            mid: {
              image: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png',
              mode: 'stretch'
            }
          },
          right: {
            mid: {
              image: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png',
              mode: 'stretch'
            }
          },
          bottom: {
            start: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png'
          }
        }
      }, {
        identifier: 'imgly_frame_black_passepartout',
        defaultName: 'Black Passepartout',
        layoutMode: 'horizontal-inside',
        thumbnail: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png',
        imageGroups: {
          top: {
            start: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png'
          },
          left: {
            mid: {
              image: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png',
              mode: 'stretch'
            }
          },
          right: {
            mid: {
              image: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png',
              mode: 'stretch'
            }
          },
          bottom: {
            start: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png'
          }
        }
      }, {
        identifier: 'imgly_frame_lowpoly_shadow',
        defaultName: 'Low Poly',
        layoutMode: 'horizontal-inside',
        thumbnail: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png',
        imageGroups: {
          top: {
            start: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png'
          },
          left: {
            mid: {
              image: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png',
              mode: 'stretch'
            }
          },
          right: {
            mid: {
              image: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png',
              mode: 'stretch'
            }
          },
          bottom: {
            start: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png'
          }
        }
      }, {
        identifier: 'imgly_frame_wood_passepartout',
        defaultName: 'Wood Passepartout',
        layoutMode: 'horizontal-inside',
        thumbnail: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png',
        imageGroups: {
          top: {
            start: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png'
          },
          left: {
            mid: {
              image: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png',
              mode: 'stretch'
            }
          },
          right: {
            mid: {
              image: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png',
              mode: 'stretch'
            }
          },
          bottom: {
            start: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png',
            mid: {
              image: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png',
              mode: 'stretch'
            },
            end: 'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png'
          }
        }
      }]
    }],
    STICKER_CATEGORIES: [{
      identifier: 'imgly_sticker_emoticons',
      defaultName: 'Emoticons',
      'metaData': {
        'backgroundImage': 'stickers/emoticons/background.png'
      },
      'stickers': [{
        identifier: 'imgly_sticker_emoticons_alien',
        defaultName: 'Alien',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png'],
            width: 1000,
            height: 935
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_angel',
        defaultName: 'Angel',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png'],
            width: 62,
            height: 64
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_angry',
        defaultName: 'Angry',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_anxious',
        defaultName: 'Anxious',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_asleep',
        defaultName: 'Asleep',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_attention',
        defaultName: 'Attention',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_baby_chicken',
        defaultName: 'Baby Chicken',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png'],
            width: 61,
            height: 42
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_batman',
        defaultName: 'Batman',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_beer',
        defaultName: 'Beer',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png'],
            width: 62,
            height: 59
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_blush',
        defaultName: 'Blush',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_boxer',
        defaultName: 'Boxer',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_business',
        defaultName: 'Business',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png'],
            width: 60,
            height: 63
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_chicken',
        defaultName: 'Chicken',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png'],
            width: 63,
            height: 55
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_cool',
        defaultName: 'Cool',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_cry',
        defaultName: 'Cry',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_deceased',
        defaultName: 'Deceased',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_devil',
        defaultName: 'Devil',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_duckface',
        defaultName: 'Duckface',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_furious',
        defaultName: 'Furious',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png'],
            width: 62,
            height: 61
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_grin',
        defaultName: 'Grin',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_guitar',
        defaultName: 'Guitar',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png'],
            width: 64,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_harry_potter',
        defaultName: 'Harry Potter',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png'],
            width: 64,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_hippie',
        defaultName: 'Hippie',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_hitman',
        defaultName: 'Hitman',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png'],
            width: 64,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_humourous',
        defaultName: 'Humourous',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png'],
            width: 64,
            height: 64
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_idea',
        defaultName: 'Idea',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png'],
            width: 64,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_impatient',
        defaultName: 'Impatient',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_kiss',
        defaultName: 'Kiss',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_kisses',
        defaultName: 'Kisses',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_laugh',
        defaultName: 'Laugh',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_loud_cry',
        defaultName: 'Loud Cry',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png'],
            width: 64,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_loving',
        defaultName: 'Loving',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_masked',
        defaultName: 'Masked',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_music',
        defaultName: 'Music',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png'],
            width: 62,
            height: 54
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_nerd',
        defaultName: 'Nerd',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png']
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_ninja',
        defaultName: 'Ninja',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_not_speaking_to_you',
        defaultName: 'Not Speaking To You',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_pig',
        defaultName: 'Pig',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png'],
            width: 63,
            height: 41
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_pumpkin',
        defaultName: 'Pumpkin',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_question',
        defaultName: 'Question',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_rabbit',
        defaultName: 'Rabbit',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png'],
            width: 65,
            height: 47
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_sad',
        defaultName: 'Sad',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png']
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_sick',
        defaultName: 'Sick',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_skateboard',
        defaultName: 'Skateboard',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png'],
            width: 62,
            height: 64
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_skull',
        defaultName: 'Skull',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png'],
            width: 62,
            height: 62
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_sleepy',
        defaultName: 'Sleepy',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_smile',
        defaultName: 'Smile',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_smoking',
        defaultName: 'Smoking',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_sobbing',
        defaultName: 'Sobbing',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png'],
            width: 62,
            height: 59
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_star',
        defaultName: 'Star',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png'],
            width: 64,
            height: 64
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_steaming_furious',
        defaultName: 'Steaming Furious',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_sunbathing',
        defaultName: 'Sunbathing',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_tired',
        defaultName: 'Tired',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_tongue_out_wink',
        defaultName: 'Tongue Out Wink',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_wave',
        defaultName: 'Wave',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_wide_grin',
        defaultName: 'Wide Grin',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_wink',
        defaultName: 'Wink',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png'],
            width: 62,
            height: 58
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png']
          }
        }
      }, {
        identifier: 'imgly_sticker_emoticons_wrestler',
        defaultName: 'Wrestler',
        images: {
          mediaThumb: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg', 'stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png'],
            width: 62,
            height: 60
          },
          mediaBase: {
            uris: ['stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg', 'stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png']
          }
        }
      }]
    }, {
      identifier: 'imgly_sticker_shapes',
      defaultName: 'Shapes',
      'metaData': {
        'backgroundImage': 'stickers/shapes/background.png'
      },
      'stickers': [{
        identifier: 'imgly_sticker_shapes_arrow_02',
        defaultName: 'Arrow 1',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png'],
            width: 2000,
            height: 1236
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png'],
            width: 2000,
            height: 1236
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_arrow_03',
        defaultName: 'Arrow 2',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png'],
            width: 2000,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png'],
            width: 2000,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_01',
        defaultName: 'Badge 1',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png'],
            width: 2000,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png'],
            width: 2000,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_04',
        defaultName: 'Badge 2',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png'],
            width: 2000,
            height: 1589
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png'],
            width: 2000,
            height: 1589
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_06',
        defaultName: 'Badge 3',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png'],
            width: 2000,
            height: 1733
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png'],
            width: 2000,
            height: 1733
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_08',
        defaultName: 'Badge 4',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png'],
            width: 2000,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png'],
            width: 2000,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_11',
        defaultName: 'Badge 5',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png'],
            width: 2000,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png'],
            width: 2000,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_12',
        defaultName: 'Badge 6',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png'],
            width: 2001,
            height: 1903
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png'],
            width: 2001,
            height: 1903
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_13',
        defaultName: 'Badge 7',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png'],
            width: 2000,
            height: 1718
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png'],
            width: 2000,
            height: 1718
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_15',
        defaultName: 'Badge 8',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png'],
            width: 1618,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png'],
            width: 1618,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_18',
        defaultName: 'Badge 9',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png'],
            width: 1198,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png'],
            width: 1198,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_19',
        defaultName: 'Badge 10',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png'],
            width: 2127,
            height: 481
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png'],
            width: 2127,
            height: 481
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_20',
        defaultName: 'Badge 11',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png'],
            width: 2000,
            height: 1404
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png'],
            width: 2000,
            height: 1404
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_28',
        defaultName: 'Badge 12',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png'],
            width: 2000,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png'],
            width: 2000,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_32',
        defaultName: 'Badge 13',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png'],
            width: 1960,
            height: 2000
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png'],
            width: 1960,
            height: 2000
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_35',
        defaultName: 'Badge 14',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png'],
            width: 2000,
            height: 2002
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png'],
            width: 2000,
            height: 2002
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_badge_36',
        defaultName: 'Badge 15',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png'],
            width: 2000,
            height: 1668
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png'],
            width: 2000,
            height: 1668
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_spray_01',
        defaultName: 'Spray 1',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png'],
            width: 1912,
            height: 2039
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png'],
            width: 1912,
            height: 2039
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_spray_03',
        defaultName: 'Spray 2',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png'],
            width: 1681,
            height: 1779
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png'],
            width: 1681,
            height: 1779
          }
        }
      }, {
        identifier: 'imgly_sticker_shapes_spray_04',
        defaultName: 'Spray 3',
        tintMode: 'solid',
        images: {
          mediaThumb: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg', 'stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png'],
            width: 1407,
            height: 2248
          },
          mediaBase: {
            uris: ['stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg', 'stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png'],
            width: 1407,
            height: 2248
          }
        }
      }]
    }]
  }
});

/***/ }),
/* 91 */
/***/ (function(module, exports, __webpack_require__) {
/* eslint-disable */

/*!
StackBlur - a fast almost Gaussian Blur For Canvas

Version:  0.5
Author:   Mario Klingemann
Contact:  mario@quasimondo.com
Website:  http://www.quasimondo.com/StackBlurForCanvas
Twitter:  @quasimondo

In case you find this class useful - especially in commercial projects -
I am not totally unhappy for a small donation to my PayPal account
mario@quasimondo.de

Or support me on flattr:
https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript

Copyright (c) 2010 Mario Klingemann

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
@license
*/

var mul_table = [512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512, 454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512, 482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456, 437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512, 497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328, 320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456, 446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335, 329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512, 505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405, 399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328, 324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271, 268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456, 451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388, 385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335, 332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292, 289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259];

var shg_table = [9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24];

function stackBlurCanvasRGBA(imageData, top_x, top_y, width, height, radius) {
  if (isNaN(radius) || radius < 1) {
    return;
  }
  radius |= 0;

  var pixels = imageData.data;

  var x, y, i, p, yp, yi, yw, r_sum, g_sum, b_sum, a_sum, r_out_sum, g_out_sum, b_out_sum, a_out_sum, r_in_sum, g_in_sum, b_in_sum, a_in_sum, pr, pg, pb, pa, rbs;

  var div = radius + radius + 1;
  var widthMinus1 = width - 1;
  var heightMinus1 = height - 1;
  var radiusPlus1 = radius + 1;
  var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;

  var stackStart = new BlurStack();
  var stackEnd;
  var stack = stackStart;
  for (i = 1; i < div; i++) {
    stack = stack.next = new BlurStack();
    if (i == radiusPlus1) stackEnd = stack;
  }
  stack.next = stackStart;
  var stackIn = null;
  var stackOut = null;

  yw = yi = 0;

  var mul_sum = mul_table[radius];
  var shg_sum = shg_table[radius];

  for (y = 0; y < height; y++) {
    r_in_sum = g_in_sum = b_in_sum = a_in_sum = r_sum = g_sum = b_sum = a_sum = 0;

    r_out_sum = radiusPlus1 * (pr = pixels[yi]);
    g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);
    b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);
    a_out_sum = radiusPlus1 * (pa = pixels[yi + 3]);

    r_sum += sumFactor * pr;
    g_sum += sumFactor * pg;
    b_sum += sumFactor * pb;
    a_sum += sumFactor * pa;

    stack = stackStart;

    for (i = 0; i < radiusPlus1; i++) {
      stack.r = pr;
      stack.g = pg;
      stack.b = pb;
      stack.a = pa;
      stack = stack.next;
    }

    for (i = 1; i < radiusPlus1; i++) {
      p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);
      r_sum += (stack.r = pr = pixels[p]) * (rbs = radiusPlus1 - i);
      g_sum += (stack.g = pg = pixels[p + 1]) * rbs;
      b_sum += (stack.b = pb = pixels[p + 2]) * rbs;
      a_sum += (stack.a = pa = pixels[p + 3]) * rbs;

      r_in_sum += pr;
      g_in_sum += pg;
      b_in_sum += pb;
      a_in_sum += pa;

      stack = stack.next;
    }

    stackIn = stackStart;
    stackOut = stackEnd;
    for (x = 0; x < width; x++) {
      pixels[yi + 3] = pa = a_sum * mul_sum >> shg_sum;
      if (pa !== 0) {
        pa = 255 / pa;
        pixels[yi] = (r_sum * mul_sum >> shg_sum) * pa;
        pixels[yi + 1] = (g_sum * mul_sum >> shg_sum) * pa;
        pixels[yi + 2] = (b_sum * mul_sum >> shg_sum) * pa;
      } else {
        pixels[yi] = pixels[yi + 1] = pixels[yi + 2] = 0;
      }

      r_sum -= r_out_sum;
      g_sum -= g_out_sum;
      b_sum -= b_out_sum;
      a_sum -= a_out_sum;

      r_out_sum -= stackIn.r;
      g_out_sum -= stackIn.g;
      b_out_sum -= stackIn.b;
      a_out_sum -= stackIn.a;

      p = yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1) << 2;

      r_in_sum += stackIn.r = pixels[p];
      g_in_sum += stackIn.g = pixels[p + 1];
      b_in_sum += stackIn.b = pixels[p + 2];
      a_in_sum += stackIn.a = pixels[p + 3];

      r_sum += r_in_sum;
      g_sum += g_in_sum;
      b_sum += b_in_sum;
      a_sum += a_in_sum;

      stackIn = stackIn.next;

      r_out_sum += pr = stackOut.r;
      g_out_sum += pg = stackOut.g;
      b_out_sum += pb = stackOut.b;
      a_out_sum += pa = stackOut.a;

      r_in_sum -= pr;
      g_in_sum -= pg;
      b_in_sum -= pb;
      a_in_sum -= pa;

      stackOut = stackOut.next;

      yi += 4;
    }
    yw += width;
  }

  for (x = 0; x < width; x++) {
    g_in_sum = b_in_sum = a_in_sum = r_in_sum = g_sum = b_sum = a_sum = r_sum = 0;

    yi = x << 2;
    r_out_sum = radiusPlus1 * (pr = pixels[yi]);
    g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);
    b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);
    a_out_sum = radiusPlus1 * (pa = pixels[yi + 3]);

    r_sum += sumFactor * pr;
    g_sum += sumFactor * pg;
    b_sum += sumFactor * pb;
    a_sum += sumFactor * pa;

    stack = stackStart;

    for (i = 0; i < radiusPlus1; i++) {
      stack.r = pr;
      stack.g = pg;
      stack.b = pb;
      stack.a = pa;
      stack = stack.next;
    }

    yp = width;

    for (i = 1; i <= radius; i++) {
      yi = yp + x << 2;

      r_sum += (stack.r = pr = pixels[yi]) * (rbs = radiusPlus1 - i);
      g_sum += (stack.g = pg = pixels[yi + 1]) * rbs;
      b_sum += (stack.b = pb = pixels[yi + 2]) * rbs;
      a_sum += (stack.a = pa = pixels[yi + 3]) * rbs;

      r_in_sum += pr;
      g_in_sum += pg;
      b_in_sum += pb;
      a_in_sum += pa;

      stack = stack.next;

      if (i < heightMinus1) {
        yp += width;
      }
    }

    yi = x;
    stackIn = stackStart;
    stackOut = stackEnd;
    for (y = 0; y < height; y++) {
      p = yi << 2;
      pixels[p + 3] = pa = a_sum * mul_sum >> shg_sum;
      if (pa > 0) {
        pa = 255 / pa;
        pixels[p] = r_sum * mul_sum >> shg_sum;
        pixels[p + 1] = g_sum * mul_sum >> shg_sum;
        pixels[p + 2] = b_sum * mul_sum >> shg_sum;
      } else {
        pixels[p] = pixels[p + 1] = pixels[p + 2] = 0;
      }

      r_sum -= r_out_sum;
      g_sum -= g_out_sum;
      b_sum -= b_out_sum;
      a_sum -= a_out_sum;

      r_out_sum -= stackIn.r;
      g_out_sum -= stackIn.g;
      b_out_sum -= stackIn.b;
      a_out_sum -= stackIn.a;

      p = x + ((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width << 2;

      r_sum += r_in_sum += stackIn.r = pixels[p];
      g_sum += g_in_sum += stackIn.g = pixels[p + 1];
      b_sum += b_in_sum += stackIn.b = pixels[p + 2];
      a_sum += a_in_sum += stackIn.a = pixels[p + 3];

      stackIn = stackIn.next;

      r_out_sum += pr = stackOut.r;
      g_out_sum += pg = stackOut.g;
      b_out_sum += pb = stackOut.b;
      a_out_sum += pa = stackOut.a;

      r_in_sum -= pr;
      g_in_sum -= pg;
      b_in_sum -= pb;
      a_in_sum -= pa;

      stackOut = stackOut.next;

      yi += width;
    }
  }
}

function BlurStack() {
  this.r = 0;
  this.g = 0;
  this.b = 0;
  this.a = 0;
  this.next = null;
}

module.exports = {
  stackBlurCanvasRGBA: stackBlurCanvasRGBA
};

/***/ }),
/* 92 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignRow; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__size_value__ = __webpack_require__(33);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_attributes__ = __webpack_require__(77);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var Rectangle = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Rectangle;


var TextDesignRow = function (_Configurable) {
  _inherits(TextDesignRow, _Configurable);

  function TextDesignRow(options) {
    _classCallCheck(this, TextDesignRow);

    var _this = _possibleConstructorReturn(this, (TextDesignRow.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRow)).call(this, options));

    _this.setSize(new __WEBPACK_IMPORTED_MODULE_5__size_value__["a" /* SizeValue */](_this.getWidth(), 0));

    _this.serverImageSmoothingFix = false;
    return _this;
  }

  /**
   * Returns the full-frame of the row; origin is always (0, 0).
   *
   * @returns {PhotoEditorSDK.Math.Rectangle}
   * @memberof TextDesignRow
   */


  _createClass(TextDesignRow, [{
    key: '_getFrame',
    value: function _getFrame() {
      var size = this.getSize();
      return new Rectangle(0, 0, size.width, size.height);
    }

    /**
     * Returns the text-drawable portion of the frame.
     *
     * @returns {PhotoEditorSDK.Math.Rectangle}
     * @memberof TextDesignRow
     */

  }, {
    key: '_getTextFrame',
    value: function _getTextFrame() {
      return this._getFrame();
    }

    /**
     * Returns the textFrame for a given element.
     *
     * @param {TextDesignElement} element
     * @returns {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: '_getTextFrameForElement',
    value: function _getTextFrameForElement(element) {
      return element.getFrame().clone();
    }
  }, {
    key: '_calculateLayoutElements',
    value: function _calculateLayoutElements() {
      __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Log"].warn('TextDesignRow is an abstract class.');
    }
  }, {
    key: '_getLayoutElements',
    value: function _getLayoutElements() {
      if (this._options.elements.length <= 0) {
        this.layout();
      }

      return this.getElements();
    }
  }, {
    key: '_fontSize',
    value: function _fontSize(element) {
      __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Log"].warn('TextDesignRow#_fontSize not implemented. @TODO: Is it necessary?');
      return 0;
    }
  }, {
    key: 'layout',
    value: function layout() {
      this.setElements(this._calculateLayoutElements());
      return this;
    }
  }, {
    key: 'textFrame',
    value: function textFrame(element, fontSize) {
      return element.getFrame().clone();
    }
  }, {
    key: 'willRender',
    value: function willRender(context) {}
  }, {
    key: 'didRender',
    value: function didRender(context) {}
  }, {
    key: 'render',
    value: function render(context) {
      var _this2 = this;

      context.save();

      this._getLayoutElements().forEach(function (element) {
        var _element$serializeOpt = element.serializeOptions(),
            text = _element$serializeOpt.text,
            frame = _element$serializeOpt.frame,
            font = _element$serializeOpt.font;

        var attributes = _this2.getAttributes();

        font.draw(context, frame.x, frame.y, {
          textColor: attributes.getTextColor().toRGBA(),
          alignment: attributes.getAlignment()
        });
      });

      context.restore();
    }
  }]);

  return TextDesignRow;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Configurable"]);

TextDesignRow.prototype.availableOptions = {
  words: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: null },
  width: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 100 },
  attributes: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].CONFIGURABLE, default: new __WEBPACK_IMPORTED_MODULE_6__text_design_attributes__["a" /* TextDesignAttributes */]() },
  shearingAngle: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  elements: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].ARRAY, default: [] },
  size: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: null }
};

/***/ }),
/* 93 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);


var _OverlayFilter$BLEND_;

function _defineProperty(obj, key, value) { if (key in obj) { __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var OverlayFilter = __WEBPACK_IMPORTED_MODULE_1_globals__["j" /* SDK */].Engine.Filters.OverlayFilter;


/* harmony default export */ __webpack_exports__["a"] = (_OverlayFilter$BLEND_ = {}, _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.NORMAL, 'normal'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.OVERLAY, 'overlay'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.HARD_LIGHT, 'hard light'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.SOFT_LIGHT, 'soft light'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.MULTIPLY, 'multiply'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.DARKEN, 'darken'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.LIGHTEN, 'lighten'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.SCREEN, 'screen'), _defineProperty(_OverlayFilter$BLEND_, OverlayFilter.BLEND_MODES.COLOR_BURN, 'color burn'), _OverlayFilter$BLEND_);

/***/ }),
/* 94 */
/***/ (function(module, exports, __webpack_require__) {

var isObject = __webpack_require__(23);
var document = __webpack_require__(16).document;
// typeof document.createElement is 'object' in old IE
var is = isObject(document) && isObject(document.createElement);
module.exports = function (it) {
  return is ? document.createElement(it) : {};
};


/***/ }),
/* 95 */
/***/ (function(module, exports, __webpack_require__) {

// 7.1.1 ToPrimitive(input [, PreferredType])
var isObject = __webpack_require__(23);
// instead of the ES6 spec version, we didn't implement @@toPrimitive case
// and the second argument - flag - preferred type is a string
module.exports = function (it, S) {
  if (!isObject(it)) return it;
  var fn, val;
  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;
  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;
  throw TypeError("Can't convert object to primitive value");
};


/***/ }),
/* 96 */
/***/ (function(module, exports, __webpack_require__) {

var pIE = __webpack_require__(58);
var createDesc = __webpack_require__(57);
var toIObject = __webpack_require__(35);
var toPrimitive = __webpack_require__(95);
var has = __webpack_require__(43);
var IE8_DOM_DEFINE = __webpack_require__(136);
var gOPD = Object.getOwnPropertyDescriptor;

exports.f = __webpack_require__(19) ? gOPD : function getOwnPropertyDescriptor(O, P) {
  O = toIObject(O);
  P = toPrimitive(P, true);
  if (IE8_DOM_DEFINE) try {
    return gOPD(O, P);
  } catch (e) { /* empty */ }
  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);
};


/***/ }),
/* 97 */
/***/ (function(module, exports, __webpack_require__) {

// fallback for non-array-like ES3 and non-enumerable old V8 strings
var cof = __webpack_require__(59);
// eslint-disable-next-line no-prototype-builtins
module.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {
  return cof(it) == 'String' ? it.split('') : Object(it);
};


/***/ }),
/* 98 */
/***/ (function(module, exports) {

// 7.2.1 RequireObjectCoercible(argument)
module.exports = function (it) {
  if (it == undefined) throw TypeError("Can't call method on  " + it);
  return it;
};


/***/ }),
/* 99 */
/***/ (function(module, exports) {

// 7.1.4 ToInteger
var ceil = Math.ceil;
var floor = Math.floor;
module.exports = function (it) {
  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);
};


/***/ }),
/* 100 */
/***/ (function(module, exports, __webpack_require__) {

var shared = __webpack_require__(101)('keys');
var uid = __webpack_require__(83);
module.exports = function (key) {
  return shared[key] || (shared[key] = uid(key));
};


/***/ }),
/* 101 */
/***/ (function(module, exports, __webpack_require__) {

var core = __webpack_require__(11);
var global = __webpack_require__(16);
var SHARED = '__core-js_shared__';
var store = global[SHARED] || (global[SHARED] = {});

(module.exports = function (key, value) {
  return store[key] || (store[key] = value !== undefined ? value : {});
})('versions', []).push({
  version: core.version,
  mode: __webpack_require__(60) ? 'pure' : 'global',
  copyright: '© 2019 Denis Pushkarev (zloirock.ru)'
});


/***/ }),
/* 102 */
/***/ (function(module, exports) {

// IE 8- don't enum bug keys
module.exports = (
  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'
).split(',');


/***/ }),
/* 103 */
/***/ (function(module, exports, __webpack_require__) {

// most Object methods by ES6 should accept primitives
var $export = __webpack_require__(14);
var core = __webpack_require__(11);
var fails = __webpack_require__(42);
module.exports = function (KEY, exec) {
  var fn = (core.Object || {})[KEY] || Object[KEY];
  var exp = {};
  exp[KEY] = exec(fn);
  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);
};


/***/ }),
/* 104 */
/***/ (function(module, exports, __webpack_require__) {

var LIBRARY = __webpack_require__(60);
var $export = __webpack_require__(14);
var redefine = __webpack_require__(141);
var hide = __webpack_require__(34);
var Iterators = __webpack_require__(51);
var $iterCreate = __webpack_require__(240);
var setToStringTag = __webpack_require__(61);
var getPrototypeOf = __webpack_require__(139);
var ITERATOR = __webpack_require__(17)('iterator');
var BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`
var FF_ITERATOR = '@@iterator';
var KEYS = 'keys';
var VALUES = 'values';

var returnThis = function () { return this; };

module.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {
  $iterCreate(Constructor, NAME, next);
  var getMethod = function (kind) {
    if (!BUGGY && kind in proto) return proto[kind];
    switch (kind) {
      case KEYS: return function keys() { return new Constructor(this, kind); };
      case VALUES: return function values() { return new Constructor(this, kind); };
    } return function entries() { return new Constructor(this, kind); };
  };
  var TAG = NAME + ' Iterator';
  var DEF_VALUES = DEFAULT == VALUES;
  var VALUES_BUG = false;
  var proto = Base.prototype;
  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];
  var $default = $native || getMethod(DEFAULT);
  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;
  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;
  var methods, key, IteratorPrototype;
  // Fix native
  if ($anyNative) {
    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));
    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {
      // Set @@toStringTag to native iterators
      setToStringTag(IteratorPrototype, TAG, true);
      // fix for some old engines
      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);
    }
  }
  // fix Array#{values, @@iterator}.name in V8 / FF
  if (DEF_VALUES && $native && $native.name !== VALUES) {
    VALUES_BUG = true;
    $default = function values() { return $native.call(this); };
  }
  // Define iterator
  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {
    hide(proto, ITERATOR, $default);
  }
  // Plug for library
  Iterators[NAME] = $default;
  Iterators[TAG] = returnThis;
  if (DEFAULT) {
    methods = {
      values: DEF_VALUES ? $default : getMethod(VALUES),
      keys: IS_SET ? $default : getMethod(KEYS),
      entries: $entries
    };
    if (FORCED) for (key in methods) {
      if (!(key in proto)) redefine(proto, key, methods[key]);
    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);
  }
  return methods;
};


/***/ }),
/* 105 */
/***/ (function(module, exports, __webpack_require__) {

exports.f = __webpack_require__(17);


/***/ }),
/* 106 */
/***/ (function(module, exports, __webpack_require__) {

var META = __webpack_require__(83)('meta');
var isObject = __webpack_require__(23);
var has = __webpack_require__(43);
var setDesc = __webpack_require__(22).f;
var id = 0;
var isExtensible = Object.isExtensible || function () {
  return true;
};
var FREEZE = !__webpack_require__(42)(function () {
  return isExtensible(Object.preventExtensions({}));
});
var setMeta = function (it) {
  setDesc(it, META, { value: {
    i: 'O' + ++id, // object ID
    w: {}          // weak collections IDs
  } });
};
var fastKey = function (it, create) {
  // return primitive with prefix
  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return 'F';
    // not necessary to add metadata
    if (!create) return 'E';
    // add missing metadata
    setMeta(it);
  // return object ID
  } return it[META].i;
};
var getWeak = function (it, create) {
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return true;
    // not necessary to add metadata
    if (!create) return false;
    // add missing metadata
    setMeta(it);
  // return hash weak collections IDs
  } return it[META].w;
};
// add metadata on freeze-family methods calling
var onFreeze = function (it) {
  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);
  return it;
};
var meta = module.exports = {
  KEY: META,
  NEED: false,
  fastKey: fastKey,
  getWeak: getWeak,
  onFreeze: onFreeze
};


/***/ }),
/* 107 */
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__(16);
var core = __webpack_require__(11);
var LIBRARY = __webpack_require__(60);
var wksExt = __webpack_require__(105);
var defineProperty = __webpack_require__(22).f;
module.exports = function (name) {
  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});
  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });
};


/***/ }),
/* 108 */
/***/ (function(module, exports) {

exports.f = Object.getOwnPropertySymbols;


/***/ }),
/* 109 */
/***/ (function(module, exports) {



/***/ }),
/* 110 */
/***/ (function(module, exports) {

module.exports = function (it, Constructor, name, forbiddenField) {
  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {
    throw TypeError(name + ': incorrect invocation!');
  } return it;
};


/***/ }),
/* 111 */
/***/ (function(module, exports, __webpack_require__) {

var classof = __webpack_require__(84);
var ITERATOR = __webpack_require__(17)('iterator');
var Iterators = __webpack_require__(51);
module.exports = __webpack_require__(11).getIteratorMethod = function (it) {
  if (it != undefined) return it[ITERATOR]
    || it['@@iterator']
    || Iterators[classof(it)];
};


/***/ }),
/* 112 */
/***/ (function(module, exports, __webpack_require__) {

var ctx = __webpack_require__(30);
var invoke = __webpack_require__(251);
var html = __webpack_require__(138);
var cel = __webpack_require__(94);
var global = __webpack_require__(16);
var process = global.process;
var setTask = global.setImmediate;
var clearTask = global.clearImmediate;
var MessageChannel = global.MessageChannel;
var Dispatch = global.Dispatch;
var counter = 0;
var queue = {};
var ONREADYSTATECHANGE = 'onreadystatechange';
var defer, channel, port;
var run = function () {
  var id = +this;
  // eslint-disable-next-line no-prototype-builtins
  if (queue.hasOwnProperty(id)) {
    var fn = queue[id];
    delete queue[id];
    fn();
  }
};
var listener = function (event) {
  run.call(event.data);
};
// Node.js 0.9+ & IE10+ has setImmediate, otherwise:
if (!setTask || !clearTask) {
  setTask = function setImmediate(fn) {
    var args = [];
    var i = 1;
    while (arguments.length > i) args.push(arguments[i++]);
    queue[++counter] = function () {
      // eslint-disable-next-line no-new-func
      invoke(typeof fn == 'function' ? fn : Function(fn), args);
    };
    defer(counter);
    return counter;
  };
  clearTask = function clearImmediate(id) {
    delete queue[id];
  };
  // Node.js 0.8-
  if (__webpack_require__(59)(process) == 'process') {
    defer = function (id) {
      process.nextTick(ctx(run, id, 1));
    };
  // Sphere (JS game engine) Dispatch API
  } else if (Dispatch && Dispatch.now) {
    defer = function (id) {
      Dispatch.now(ctx(run, id, 1));
    };
  // Browsers with MessageChannel, includes WebWorkers
  } else if (MessageChannel) {
    channel = new MessageChannel();
    port = channel.port2;
    channel.port1.onmessage = listener;
    defer = ctx(port.postMessage, port, 1);
  // Browsers with postMessage, skip WebWorkers
  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'
  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {
    defer = function (id) {
      global.postMessage(id + '', '*');
    };
    global.addEventListener('message', listener, false);
  // IE8-
  } else if (ONREADYSTATECHANGE in cel('script')) {
    defer = function (id) {
      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {
        html.removeChild(this);
        run.call(id);
      };
    };
  // Rest old browsers
  } else {
    defer = function (id) {
      setTimeout(ctx(run, id, 1), 0);
    };
  }
}
module.exports = {
  set: setTask,
  clear: clearTask
};


/***/ }),
/* 113 */
/***/ (function(module, exports, __webpack_require__) {

// 25.4.1.5 NewPromiseCapability(C)
var aFunction = __webpack_require__(56);

function PromiseCapability(C) {
  var resolve, reject;
  this.promise = new C(function ($$resolve, $$reject) {
    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');
    resolve = $$resolve;
    reject = $$reject;
  });
  this.resolve = aFunction(resolve);
  this.reject = aFunction(reject);
}

module.exports.f = function (C) {
  return new PromiseCapability(C);
};


/***/ }),
/* 114 */
/***/ (function(module, exports, __webpack_require__) {

var hide = __webpack_require__(34);
module.exports = function (target, src, safe) {
  for (var key in src) {
    if (safe && target[key]) target[key] = src[key];
    else hide(target, key, src[key]);
  } return target;
};


/***/ }),
/* 115 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_canvas_render_target__ = __webpack_require__(87);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Manages the filters for a {@link PhotoEditorSDK.Engine.CanvasRenderer}
 * @class
 * @memberof PhotoEditorSDK.Engine
 */

var CanvasFilterManager = function () {
  function CanvasFilterManager(renderer) {
    _classCallCheck(this, CanvasFilterManager);

    this._renderer = renderer;
    this._filterStack = [{
      renderTarget: renderer.getCurrentRenderTarget(),
      filters: []
    }];

    this._currentFrame = null;
    this._textures = [];
    this._textureFrame = new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, renderer.getWidth(), renderer.getHeight());
  }

  /**
   * Resizes this FilterManager and its textures to the given dimensions
   * @param  {PhotoEditorSDK.Math.Vector2} dimensions
   */


  _createClass(CanvasFilterManager, [{
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      this._textureFrame.width = dimensions.x;
      this._textureFrame.height = dimensions.y;

      this._textures.forEach(function (texture) {
        return texture.resizeTo(dimensions);
      });
    }

    /**
     * Pushes the given filters to the
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @param  {Array.<Filter>} filters
     */

  }, {
    key: 'pushFilters',
    value: function pushFilters(displayObject, filters) {
      var bounds = displayObject.getBounds();
      this._currentFrame = bounds;

      var renderTarget = this._getOrCreateRenderTarget();
      this._renderer.setRenderTarget(renderTarget);
      this._filterStack.push({ renderTarget: renderTarget, filters: filters });
      renderTarget.clear();
    }

    /**
     * Removes, applies and returns the last filters from the stack
     * @return {Object}
     */

  }, {
    key: 'popFilters',
    value: function popFilters() {
      var _filterStack$pop = this._filterStack.pop(),
          filters = _filterStack$pop.filters,
          renderTarget = _filterStack$pop.renderTarget;

      var lastFilter = this._filterStack[this._filterStack.length - 1];

      var inputRenderTarget = renderTarget;
      var outputRenderTarget = lastFilter.renderTarget;

      if (filters.length === 1) {
        filters[0].apply(this._renderer, inputRenderTarget, outputRenderTarget);
        this._textures.push(inputRenderTarget);
      } else {
        this._applyFilters(filters, inputRenderTarget, outputRenderTarget);
      }
      return filters;
    }

    /**
     * Applies the given filters to the given inputRenderTarget and outputs
     * the filtered content to the outputRenderTarget
     * @param  {PhotoEditorSDK.Engine.Filter[]} filters
     * @param  {PhotoEditorSDK.Engine.CanvasRenderTarget} inputRenderTarget
     * @param  {PhotoEditorSDK.Engine.CanvasRenderTarget} outputRenderTarget
     * @private
     */

  }, {
    key: '_applyFilters',
    value: function _applyFilters(filters, inputRenderTarget, outputRenderTarget) {
      var _this = this;

      var flipRenderTarget = inputRenderTarget;
      var flopRenderTarget = this._getOrCreateRenderTarget(true);

      var lastFilter = filters[filters.length - 1];
      filters.forEach(function (filter, i) {
        var isLastFilter = filter === lastFilter;

        if (!isLastFilter) {
          // Render from flip to flop with filter
          filter.apply(_this._renderer, flipRenderTarget, flopRenderTarget);

          // Flip the render buffers
          var temp = flipRenderTarget;
          flipRenderTarget = flopRenderTarget;
          flopRenderTarget = temp;
        } else {
          // Render to output
          filter.apply(_this._renderer, flipRenderTarget, outputRenderTarget);
        }
      });

      // Push the textures back into the texture pool to use them again later
      this._textures.push(flipRenderTarget);
      this._textures.push(flopRenderTarget);
    }

    /**
     * Returns a render buffer from the pool or creates a new one
     * @param  {Boolean} clear
     * @return {PhotoEditorSDK.Engine.RenderTexture}
     * @private
     */

  }, {
    key: '_getOrCreateRenderTarget',
    value: function _getOrCreateRenderTarget(clear) {
      var renderTarget = this._textures.pop();
      if (!renderTarget) {
        renderTarget = new __WEBPACK_IMPORTED_MODULE_2__utils_canvas_render_target__["a" /* default */](this._textureFrame.width, this._textureFrame.height, 1);
      }

      if (clear) {
        renderTarget.clear();
      }

      return renderTarget;
    }

    /**
     * Sets the filter stack to the given stack
     * @param {Object[]} filterStack
     */

  }, {
    key: 'setFilterStack',
    value: function setFilterStack(filterStack) {
      this._filterStack = filterStack;
    }

    /**
     * Disposes this CanvasFilterManager
     */

  }, {
    key: 'dispose',
    value: function dispose() {}
  }]);

  return CanvasFilterManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (CanvasFilterManager);

/***/ }),
/* 116 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shader__ = __webpack_require__(117);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var UniformType = __WEBPACK_IMPORTED_MODULE_3__globals__["c" /* Constants */].UniformType;

/**
 * The default texture shader
 * @class
 * @extends PhotoEditorSDK.Engine.Shader
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var TextureShader = function (_Shader) {
  _inherits(TextureShader, _Shader);

  /**
   * Creates a TextureShader
   * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
   * @param  {String} vertexSource
   * @param  {String} fragmentSource
   */
  function TextureShader(renderer, vertexSource, fragmentSource) {
    _classCallCheck(this, TextureShader);

    vertexSource = vertexSource || TextureShader.defaultVertexSource;
    fragmentSource = fragmentSource || TextureShader.defaultFragmentSource;

    return _possibleConstructorReturn(this, (TextureShader.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(TextureShader)).call(this, renderer, vertexSource, fragmentSource, TextureShader.defaultUniforms, TextureShader.defaultAttributes));
  }

  return TextureShader;
}(__WEBPACK_IMPORTED_MODULE_4__shader__["a" /* default */]);

/**
 * The default vertex shader source code
 * @type {String}
 */


TextureShader.defaultVertexSource = __webpack_require__(277);

/**
 * The default fragment shader source code
 * @type {String}
 */
TextureShader.defaultFragmentSource = __webpack_require__(278);

var matrix = new __WEBPACK_IMPORTED_MODULE_3__globals__["g" /* Matrix */]();

/**
 * The default uniforms
 * @type {Object}
 */
TextureShader.defaultUniforms = {
  u_image: {
    type: UniformType.SAMPLER2D,
    value: 0
  },
  u_projMatrix: {
    type: UniformType.MAT3,
    value: matrix.toArray()
  }

  /**
   * The default WebGL attributes
   * @type {String[]}
   */
};TextureShader.defaultAttributes = ['a_position', 'a_texCoord', 'a_color'];

/* harmony default export */ __webpack_exports__["a"] = (TextureShader);

/***/ }),
/* 117 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__constants__ = __webpack_require__(40);



var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Log = __WEBPACK_IMPORTED_MODULE_2__globals__["f" /* Log */],
    Utils = __WEBPACK_IMPORTED_MODULE_2__globals__["i" /* Utils */];

/**
 * Represents a WebGL shader with a vertex shader, a fragment shader, uniforms and attributes
 * @class
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var Shader = function () {
  /**
   * Creates a Shader
   * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
   * @param  {String} vertexSource
   * @param  {String} fragmentSource
   * @param  {Object} uniforms
   * @param  {String[]} attributes
   */
  function Shader(renderer, vertexSource, fragmentSource, uniforms, attributes) {
    _classCallCheck(this, Shader);

    this._renderer = renderer;
    this._vertexSource = vertexSource;
    this._fragmentSource = fragmentSource;
    this._uniforms = uniforms || {};
    this._uniformLocations = {};
    this._attributes = attributes || [];
    this._attributeLocations = {};

    this._onContextChange = this._onContextChange.bind(this);
    this._renderer.on('context', this._onContextChange);

    this._init();
  }

  /**
   * Compiles this shader and caches the uniform locations
   * @private
   */


  _createClass(Shader, [{
    key: '_init',
    value: function _init() {
      this._compile();

      var gl = this._renderer.getContext();
      gl.useProgram(this._program);

      this._cacheUniformLocations();
      this._cacheAttributeLocations();
    }

    /**
     * Gets called when the attached Renderer changes its context
     * @private
     */

  }, {
    key: '_onContextChange',
    value: function _onContextChange() {
      this._init();
    }

    /**
     * Binds the given buffers for this shader
     * @param {WebGLBuffer} vertexBuffer
     * @param {WebGLBuffer} indexBuffer
     */

  }, {
    key: 'setupBuffers',
    value: function setupBuffers(vertexBuffer, indexBuffer) {
      var gl = this._renderer.getContext();
      gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);

      gl.vertexAttribPointer(this._attributeLocations.a_position, 2, gl.FLOAT, false, __WEBPACK_IMPORTED_MODULE_2__globals__["j" /* VERTEX_BYTE_SIZE */], 0);
      gl.vertexAttribPointer(this._attributeLocations.a_texCoord, 2, gl.FLOAT, false, __WEBPACK_IMPORTED_MODULE_2__globals__["j" /* VERTEX_BYTE_SIZE */], 2 * 4);
      gl.vertexAttribPointer(this._attributeLocations.a_color, 4, gl.UNSIGNED_BYTE, true, __WEBPACK_IMPORTED_MODULE_2__globals__["j" /* VERTEX_BYTE_SIZE */], 4 * 4);
    }

    /**
     * Synchronizes all uniforms with WebGL
     */

  }, {
    key: 'syncUniforms',
    value: function syncUniforms() {
      var _this = this;

      __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(this._uniforms).forEach(function (key) {
        _this.syncUniform(key);
      });
    }

    /**
     * Synchronizes the uniform with the given name
     * @param  {String} name
     */

  }, {
    key: 'syncUniform',
    value: function syncUniform(name) {
      var gl = this._renderer.getContext();
      var uniform = this._uniforms[name];
      var location = this._uniformLocations[name];
      switch (uniform.type) {
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].SAMPLER2D:
          gl.uniform1i(location, uniform.value);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].INT:
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].INT1:
          gl.uniform1i(location, uniform.value);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].INT2:
          gl.uniform2i(location, uniform.value[0], uniform.value[1]);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].INT3:
          gl.uniform3i(location, uniform.value[0], uniform.value[1], uniform.value[2]);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].INT4:
          gl.uniform4i(location, uniform.value[0], uniform.value[1], uniform.value[2], uniform.value[3]);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT:
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT1:
          gl.uniform1f(location, uniform.value);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT2:
          gl.uniform2f(location, uniform.value[0], uniform.value[1]);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT3:
          gl.uniform3f(location, uniform.value[0], uniform.value[1], uniform.value[2]);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT4:
          gl.uniform4f(location, uniform.value[0], uniform.value[1], uniform.value[2], uniform.value[3]);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].FLOAT_VECTOR2:
          gl.uniform2fv(location, uniform.value);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].MAT3:
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].MAT3FV:
          gl.uniformMatrix3fv(location, false, uniform.value);
          break;
        case __WEBPACK_IMPORTED_MODULE_3__constants__["UniformType"].MAT4:
          gl.uniformMatrix4fv(location, false, uniform.value);
          break;
        default:
          Log.warn(this.constructor.name, 'Unknown uniform type: ' + uniform.type);
      }
    }

    /**
     * Caches the locations for all attributes
     * @private
     */

  }, {
    key: '_cacheAttributeLocations',
    value: function _cacheAttributeLocations() {
      var _this2 = this;

      var gl = this._renderer.getContext();
      this._attributes.forEach(function (name) {
        _this2._attributeLocations[name] = gl.getAttribLocation(_this2._program, name);
      });
    }

    /**
     * Caches the locations for all uniforms
     * @private
     */

  }, {
    key: '_cacheUniformLocations',
    value: function _cacheUniformLocations() {
      var _this3 = this;

      var gl = this._renderer.getContext();
      var keys = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(this._uniforms);
      keys.forEach(function (key) {
        _this3._uniformLocations[key] = gl.getUniformLocation(_this3._program, key);
      });
    }

    /**
     * Adds the preferred precision for the current device to the given shader source
     * @param  {String} source
     * @return {String}
     */

  }, {
    key: '_addPrecisionToSource',
    value: function _addPrecisionToSource(source) {
      var maxFloatPrecision = this._renderer.getMaxFloatPrecision();

      var precision = 'mediump';
      if (Utils.isMobile() && maxFloatPrecision === 'highp') {
        precision = 'highp';
      }

      return 'precision ' + precision + ' float;\n' + source;
    }

    /**
     * Compiles the vertex and fragment sources of this shader
     * @private
     */

  }, {
    key: '_compile',
    value: function _compile() {
      var gl = this._renderer.getContext();

      var vertexShader = this._compileShader(gl.VERTEX_SHADER, this._vertexSource);
      this._vertexShader = vertexShader;

      var fragmentSource = this._addPrecisionToSource(this._fragmentSource);
      var fragmentShader = this._compileShader(gl.FRAGMENT_SHADER, fragmentSource);
      this._fragmentShader = fragmentShader;

      // Create the WebGL program and attach the shaders
      var program = gl.createProgram();
      gl.attachShader(program, vertexShader);
      gl.attachShader(program, fragmentShader);

      // Link the program
      gl.linkProgram(program);

      // Check linking status
      var linked = gl.getProgramParameter(program, gl.LINK_STATUS);
      if (!linked) {
        var errorMessage = gl.getProgramInfoLog(program);
        if (gl.isContextLost()) errorMessage = 'WebGL context lost';
        gl.deleteProgram(program);
        Log.error(this.constructor.name, 'WebGL program linking error: ' + errorMessage);
      } else {
        this._program = program;
      }
    }

    /**
     * Creates and compiles a shader with the given type and source
     * @param  {Number} shaderType
     * @param  {String} shaderSource
     * @return {WebGLShader}
     * @private
     */

  }, {
    key: '_compileShader',
    value: function _compileShader(shaderType, shaderSource) {
      var gl = this._renderer.getContext();

      // Create the shader and compile it
      var shader = gl.createShader(shaderType);
      gl.shaderSource(shader, shaderSource);
      gl.compileShader(shader);

      // Check compilation status
      var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);
      if (!compiled) {
        var errorMessage = gl.getShaderInfoLog(shader);
        if (gl.isContextLost()) errorMessage = 'WebGL context lost';
        gl.deleteShader(shader);
        Log.error(this.constructor.name, 'WebGL shader compilation error: ' + errorMessage);
      }

      return shader;
    }

    /**
     * Sets the given uniform to the given value
     * @param {String} name
     * @param {*} value
     * @param {Boolean} sync = false
     */

  }, {
    key: 'setUniform',
    value: function setUniform(name, value) {
      var sync = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

      this._uniforms[name].value = value;
      if (sync) {
        this.syncUniform(name);
      }
    }

    /**
     * Sets the given uniforms to their values
     * @param {Object}  uniforms
     * @param {Boolean} sync = false
     */

  }, {
    key: 'setUniforms',
    value: function setUniforms(uniforms) {
      var sync = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      for (var name in uniforms) {
        this._uniforms[name].value = uniforms[name];
        if (sync) {
          this.syncUniform(name);
        }
      }
    }

    /**
     * Returns the uniforms
     * @return {Object}
     */

  }, {
    key: 'getUniforms',
    value: function getUniforms() {
      return this._uniforms;
    }

    /**
     * Returns the attributes
     * @return {String[]}
     */

  }, {
    key: 'getAttributes',
    value: function getAttributes() {
      return this._attributes;
    }

    /**
     * Returns the attribute locations
     * @return {Object}
     */

  }, {
    key: 'getAttributeLocations',
    value: function getAttributeLocations() {
      return this._attributeLocations;
    }

    /**
     * Returns this shader's WebGL program
     * @return {WebGLProgram}
     */

  }, {
    key: 'getProgram',
    value: function getProgram() {
      return this._program;
    }

    /**
     * Cleans up this shader
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var gl = this._renderer.getContext();
      gl.deleteProgram(this._program);

      gl.deleteShader(this._vertexShader);
      gl.deleteShader(this._fragmentShader);

      this._uniforms = null;
      this._uniformLocations = null;
      this._attributes = null;
      this._attributeLocations = null;

      this._renderer.off('context', this._onContextChange);
    }
  }]);

  return Shader;
}();

/* harmony default export */ __webpack_exports__["a"] = (Shader);

/***/ }),
/* 118 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(12);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * The base class for all objects that can be displayed
 * on the screen
 * @class
 * @memberof PhotoEditorSDK.Engine
 */

var DisplayObject = function () {
  /**
   * Creates a DisplayObject
   */
  function DisplayObject() {
    _classCallCheck(this, DisplayObject);

    this._position = new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](0, 0);
    this._scale = new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](1, 1);
    this._pivot = new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](0, 0);
    this._rotation = 0;
    this._lastRotation = null;
    this._alpha = 1;
    this._visible = true;
    this._worldTransform = new __WEBPACK_IMPORTED_MODULE_1__globals__["g" /* Matrix */]();
    this._parent = null;
    this._shaders = [];
    this._boundsNeedUpdate = true;
    this._bounds = new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, 1, 1);
    this._localBoundsNeedUpdate = true;
    this._localBounds = new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, 1, 1);
    this._tint = 0xffffff;
    this._filterRectangle = new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, 0, 0);
  }

  /**
   * Renders this DisplayObject using the given WebGLRenderer
   * @param  {PhotoEditorSDK.Engine.WebGLRenderer} renderer
   * @abstract
   */


  _createClass(DisplayObject, [{
    key: 'renderWebGL',
    value: function renderWebGL(renderer) {
      __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].warn(this.constructor.name, '`renderWebGL` is abstract and not implemented in inherited class');
    }

    /**
     * Renders this DisplayObject using the given CanvasRenderer
     * @param  {PhotoEditorSDK.Engine.CanvasRenderer} renderer
     * @abstract
     */

  }, {
    key: 'renderCanvas',
    value: function renderCanvas(renderer) {
      __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].warn(this.constructor.name, '`renderCanvas` is abstract and not implemented in inherited class');
    }

    /**
     * Updates the world transform for this DisplayObject
     */

  }, {
    key: 'updateTransform',
    value: function updateTransform() {
      var parentTransform = this._parent ? this._parent.getWorldTransform() : __WEBPACK_IMPORTED_MODULE_1__globals__["g" /* Matrix */].IDENTITY;
      var worldTransform = this._worldTransform;

      // Only build rotation matrix if rotation has changed since last update
      var rotationChanged = this._rotation !== this._lastRotation;
      if (rotationChanged) {
        this._sinRotation = Math.sin(this._rotation);
        this._cosRotation = Math.cos(this._rotation);
        this._lastRotation = this._rotation;
      }

      worldTransform.a = this._cosRotation * this._scale.x;
      worldTransform.b = this._sinRotation * this._scale.x;
      worldTransform.c = -this._sinRotation * this._scale.y;
      worldTransform.d = this._cosRotation * this._scale.y;
      worldTransform.tx = this._position.x;
      worldTransform.ty = this._position.y;

      if (this._pivot.x || this._pivot.y) {
        worldTransform.tx -= this._pivot.x * worldTransform.a + this._pivot.y * worldTransform.c;
        worldTransform.ty -= this._pivot.x * worldTransform.b + this._pivot.y * worldTransform.d;
      }

      // Floor
      // worldTransform.tx |= 0
      // worldTransform.ty |= 0

      worldTransform.multiply(parentTransform);

      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    // -------------------------------------------------------------------------- SHADERS

    /**
     * Pushes the given shader to the list of shaders
     * @param {PhotoEditorSDK.Engine.Shader} shader
     */

  }, {
    key: 'addShader',
    value: function addShader(shader) {
      this._shaders.push(shader);
    }

    /**
     * Removes the given shader from the list of shaders
     * @param  {PhotoEditorSDK.Engine.Shader} shader
     * @return {Boolean}
     */

  }, {
    key: 'removeShader',
    value: function removeShader(shader) {
      var index = this._shaders.indexOf(shader);
      if (index !== -1) {
        this._shaders.splice(index, 1);
        return true;
      }
      return false;
    }

    /**
     * Removes the shader at the given index from the list of shaders
     * @param  {Number} index
     * @return {Boolean}
     */

  }, {
    key: 'removeShaderAt',
    value: function removeShaderAt(index) {
      if (!this._shaders[index]) {
        return false;
      }
      this._shaders.splice(index, 1);
      return true;
    }

    /**
     * Returns the bounds for this DisplayObject
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getBounds',
    value: function getBounds() {
      return this._bounds.clone();
    }

    // -------------------------------------------------------------------------- GETTERS / SETTERS

    /**
     * Returns the current position
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getPosition',
    value: function getPosition() {
      return this._position;
    }

    /**
     * Sets the position to the given one
     * @param {PhotoEditorSDK.Math.Vector2|Number} x
     * @param {Number} [y]
     */

  }, {
    key: 'setPosition',
    value: function setPosition(position, y) {
      if (position instanceof __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */]) {
        this._position.copy(position);
      } else {
        this._position.set(position, y);
      }
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the current scale
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getScale',
    value: function getScale() {
      return this._scale;
    }

    /**
     * Sets the scale to the given one
     * @param {PhotoEditorSDK.Math.Vector2|Number} x
     * @param {Number} [y]
     */

  }, {
    key: 'setScale',
    value: function setScale(scale, y) {
      if (scale instanceof __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */]) {
        this._scale.copy(scale);
      } else {
        this._scale.set(scale, y);
      }
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the current pivot (The point that this Displayobject rotates around)
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getPivot',
    value: function getPivot() {
      return this._pivot;
    }

    /**
     * Sets the pivot (The point that this DisplayObject rotates around)
     * @param {PhotoEditorSDK.Math.Vector2|Number} pivot
     * @param {Number} [y]
     */

  }, {
    key: 'setPivot',
    value: function setPivot(pivot, y) {
      if (pivot instanceof __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */]) {
        this._pivot.copy(pivot);
      } else {
        this._pivot.set(pivot, y);
      }
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the current rotation in radians
     * @return {Number}
     */

  }, {
    key: 'getRotation',
    value: function getRotation() {
      return this._rotation;
    }

    /**
     * Sets this object's rotation (in radians)
     * @param {Number} rotation
     */

  }, {
    key: 'setRotation',
    value: function setRotation(rotation) {
      this._rotation = rotation;
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the current alpha (0...1)
     * @return {Number}
     */

  }, {
    key: 'getAlpha',
    value: function getAlpha() {
      return this._alpha;
    }

    /**
     * Sets the alpha (0...1)
     * @param {Number} alpha
     */

  }, {
    key: 'setAlpha',
    value: function setAlpha(alpha) {
      this._alpha = alpha;
    }

    /**
     * Returns the computed alpha of this DisplayObject
     * @return {Number}
     */

  }, {
    key: 'getWorldAlpha',
    value: function getWorldAlpha() {
      if (this._parent) {
        return this._parent.getAlpha() * this._alpha;
      } else {
        return this._alpha;
      }
    }

    /**
     * Returns the current world transformation matrix
     * @return {PhotoEditorSDK.Math.Matrix}
     */

  }, {
    key: 'getWorldTransform',
    value: function getWorldTransform() {
      return this._worldTransform;
    }

    /**
     * Returns the parent object
     * @return {PhotoEditorSDK.Engine.DisplayObject}
     */

  }, {
    key: 'getParent',
    value: function getParent() {
      return this._parent;
    }

    /**
     * Sets this object's parent object
     * @param {PhotoEditorSDK.Engine.DisplayObject} parent
     */

  }, {
    key: 'setParent',
    value: function setParent(parent) {
      this._parent = parent;
    }

    /**
     * Returns the filter rectangle
     * @return {PhotoEditorSDK.Math.Rectangle} rectangle
     */

  }, {
    key: 'getFilterRectangle',
    value: function getFilterRectangle() {
      return this._filterRectangle;
    }

    /**
     * Sets the filter rectangle
     * @param {PhotoEditorSDK.Math.Rectangle} rectangle
     */

  }, {
    key: 'setFilterRectangle',
    value: function setFilterRectangle(rectangle) {
      this._filterRectangle.copy(rectangle);
    }

    /**
     * Returns the current tint color
     * @return {Number}
     */

  }, {
    key: 'getTint',
    value: function getTint() {
      return this._tint;
    }

    /**
     * Sets the tint color
     * @param {Number} tint
     */

  }, {
    key: 'setTint',
    value: function setTint(tint) {
      this._tint = tint;
    }

    /**
     * Checks whether this object is currently visible or not
     * @return {Boolean} [description]
     */

  }, {
    key: 'isVisible',
    value: function isVisible() {
      return this._visible;
    }

    /**
     * Sets this object's visibility
     * @param {Boolean} visible
     */

  }, {
    key: 'setVisible',
    value: function setVisible(visible) {
      this._visible = visible;
    }
  }]);

  return DisplayObject;
}();

/* harmony default export */ __webpack_exports__["a"] = (DisplayObject);

/***/ }),
/* 119 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_webgl_render_target__ = __webpack_require__(88);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_quad__ = __webpack_require__(160);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var RendererType = __WEBPACK_IMPORTED_MODULE_1__globals__["c" /* Constants */].RendererType;

/**
 * Manages the filters for a {@link PhotoEditorSDK.Engine.WebGLRenderer}
 * @class
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var WebGLFilterManager = function () {
  function WebGLFilterManager(renderer) {
    _classCallCheck(this, WebGLFilterManager);

    this._renderer = renderer;
    this._filterStack = [{
      filters: []
    }];

    this._currentFrame = null;
    this._renderTargets = [];
    this._textureFrame = new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Rectangle */](0, 0, renderer.getWidth(), renderer.getHeight());

    this._onContextChange = this._onContextChange.bind(this);
    this._renderer.on('context', this._onContextChange);

    // Initial context
    this._onContextChange();
  }

  /**
   * Resizes this FilterManager and its textures to the given dimensions
   * @param  {PhotoEditorSDK.Math.Vector2} dimensions
   */


  _createClass(WebGLFilterManager, [{
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      this._textureFrame.width = dimensions.x;
      this._textureFrame.height = dimensions.y;

      this._renderTargets.forEach(function (texture) {
        return texture.resizeTo(dimensions);
      });
    }

    /**
     * Returns the filter stack
     * @return {Object[]}
     */

  }, {
    key: 'getFilterStack',
    value: function getFilterStack() {
      return this._filterStack;
    }

    /**
     * Sets the filter stack to the given stack
     * @param {Object[]} filterStack
     */

  }, {
    key: 'setFilterStack',
    value: function setFilterStack(filterStack) {
      this._filterStack = filterStack;
    }

    /**
     * Returns a render target from the pool or creates a new one
     * @param  {Boolean} clear
     * @return {PhotoEditorSDK.Engine.WebGLRenderTarget}
     * @private
     */

  }, {
    key: '_getOrCreateRenderTarget',
    value: function _getOrCreateRenderTarget(clear) {
      var renderTarget = this._renderTargets.pop();
      if (!renderTarget) {
        renderTarget = new __WEBPACK_IMPORTED_MODULE_2__utils_webgl_render_target__["a" /* default */](this._renderer, this._textureFrame.width, this._textureFrame.height, 1);
      }
      renderTarget.setFrame(this._currentFrame);

      if (clear) {
        renderTarget.clear();
      }

      return renderTarget;
    }

    /**
     * Pushes the given filters to the
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @param  {PhotoEditorSDK.Engine.Filter[]} filters
     */

  }, {
    key: 'pushFilters',
    value: function pushFilters(displayObject, filters) {
      var bounds = displayObject.getBounds();
      this._currentFrame = bounds;

      var filterRectangle = displayObject.getFilterRectangle();
      if (filterRectangle.width > 0 && filterRectangle.height > 0) {
        this._currentFrame = filterRectangle;
      }

      var renderTarget = this._getOrCreateRenderTarget();
      this._renderer.setRenderTarget(renderTarget);
      renderTarget.clear();

      this._filterStack.push({ renderTarget: renderTarget, filters: filters });
    }

    /**
     * Removes, applies and returns the last filters from the stack
     * @return {Object}
     */

  }, {
    key: 'popFilters',
    value: function popFilters() {
      var _filterStack$pop = this._filterStack.pop(),
          filters = _filterStack$pop.filters,
          renderTarget = _filterStack$pop.renderTarget;

      var lastFilter = this._filterStack[this._filterStack.length - 1];

      var inputRenderTarget = renderTarget;
      var outputRenderTarget = lastFilter.renderTarget;

      // Update the Quad's buffers
      this._quad.map(this._textureFrame, inputRenderTarget.getFrame());

      var shader = filters[0].getShaderForRenderer(this._renderer);
      var vertexBuffer = this._quad.getVertexBuffer();
      var indexBuffer = this._quad.getIndexBuffer();

      var gl = this._renderer.getContext();
      gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);

      var attributeLocations = shader.getAttributeLocations();
      gl.vertexAttribPointer(attributeLocations.a_position, 2, gl.FLOAT, false, 0, 0);
      gl.vertexAttribPointer(attributeLocations.a_texCoord, 2, gl.FLOAT, false, 0, 2 * 4 * 4);
      gl.vertexAttribPointer(attributeLocations.a_color, 4, gl.FLOAT, false, 0, 4 * 4 * 4);

      this._renderer.updateTexture(inputRenderTarget.getBaseTexture(), false);

      if (filters.length === 1) {
        filters[0].apply(this._renderer, inputRenderTarget, outputRenderTarget);
        this._renderTargets.push(inputRenderTarget);
      } else {
        this._applyFilters(filters, inputRenderTarget, outputRenderTarget);
      }

      return filters;
    }

    /**
     * Applies the given filters to the given inputRenderTarget and outputs
     * the filtered content to the outputRenderTarget
     * @param  {PhotoEditorSDK.Engine.Filter[]} filters
     * @param  {PhotoEditorSDK.Engine.WebGLRenderTarget} inputRenderTarget
     * @param  {PhotoEditorSDK.Engine.WebGLRenderTarget} outputRenderTarget
     */

  }, {
    key: '_applyFilters',
    value: function _applyFilters(filters, inputRenderTarget, outputRenderTarget) {
      var _this = this;

      var flipRenderTarget = inputRenderTarget;
      var flopRenderTarget = this._getOrCreateRenderTarget(true);

      this._renderer.updateTexture(flopRenderTarget.getBaseTexture(), false);

      var lastFilter = filters[filters.length - 1];
      filters.forEach(function (filter, i) {
        var isLastFilter = filter === lastFilter;

        if (!isLastFilter) {
          // Render from flip to flop with filter
          filter.apply(_this._renderer, flipRenderTarget, flopRenderTarget, true);

          // Flip the render targets
          var temp = flipRenderTarget;
          flipRenderTarget = flopRenderTarget;
          flopRenderTarget = temp;
        } else {
          // Render to output
          filter.apply(_this._renderer, flipRenderTarget, outputRenderTarget, true);
        }
      });

      // Push the textures back into the texture pool to use them again later
      this._renderTargets.push(flipRenderTarget);
      this._renderTargets.push(flopRenderTarget);
    }

    /**
     * Gets called when the WebGL context has been changed
     * @private
     */

  }, {
    key: '_onContextChange',
    value: function _onContextChange() {
      this._renderTargets.length = 0;
      /* istanbul ignore next */
      if (this._renderer.isOfType(RendererType.WEBGL)) {
        if (this._quad) {
          this._quad.dispose();
        }
        this._quad = new __WEBPACK_IMPORTED_MODULE_3__utils_quad__["a" /* default */](this._renderer);
      }
    }

    /**
     * Disposes this WebGLFilterManager
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._renderer.off('context', this._onContextChange);
      if (this._quad) {
        this._quad.dispose();
      }
      this._renderTargets.forEach(function (target) {
        target.dispose();
      });
    }
  }]);

  return WebGLFilterManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (WebGLFilterManager);

/***/ }),
/* 120 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__base64__ = __webpack_require__(65);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__array_stream__ = __webpack_require__(121);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils__ = __webpack_require__(32);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__jpeg_constants__ = __webpack_require__(122);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__jpeg_jfif_data__ = __webpack_require__(315);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__jpeg_exif_data__ = __webpack_require__(316);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/*
 * Based on https://github.com/exif-js/exif-js by Jacob Seidelin
 * Licensed under MIT
 * @license
 */

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








var invariant = __WEBPACK_IMPORTED_MODULE_3__utils__["a" /* default */].invariant;
var MARKERS = __WEBPACK_IMPORTED_MODULE_4__jpeg_constants__["a" /* default */].MARKERS;


var DATA_JPEG_PREFIX = 'data:image/jpeg;base64,';
var JPEG_REGEX = new RegExp('^' + DATA_JPEG_PREFIX, 'i');

/**
 * Reads EXIF tags from the given byte array and restores them
 * @class
 * @memberof PhotoEditorSDK
 * @ignore
 */

var EXIF = function () {
  /**
   * Creates an EXIF object
   * @param  {Array} buf
   */
  function EXIF(buf) {
    _classCallCheck(this, EXIF);

    this._buf = buf;
    this._stream = new __WEBPACK_IMPORTED_MODULE_2__array_stream__["a" /* default */](this._buf);
    this._stream.setHead(0);

    this._segments = this._sliceIntoSegments(this._buf);

    this._exifData = new __WEBPACK_IMPORTED_MODULE_6__jpeg_exif_data__["a" /* default */](this._getMarkerBuffer(MARKERS.EXIF));
    this._jfifData = new __WEBPACK_IMPORTED_MODULE_5__jpeg_jfif_data__["a" /* default */](this._getMarkerBuffer(MARKERS.JFIF));
  }

  /**
   * Convert raw data buffer to base64 encoded data url
   * @param {Uint8Array}
   * @returns {String}
   */


  _createClass(EXIF, [{
    key: 'restoreSegmentsInArray',


    /**
     * Restores the header segments into the given buffer
     * @param {Uint8Array} buffer
     */
    value: function restoreSegmentsInArray(buffer) {
      buffer = this.restoreExifTagsToImageData(buffer);
      return this.restoreJfifSegmentToImageData(buffer);
    }

    /**
     * Restores the header segments into the given data url
     * @return {string} data
     */

  }, {
    key: 'restoreSegments',
    value: function restoreSegments(base64String) {
      var data = EXIF.fromDataURL(base64String);
      data = this.restoreSegmentsInArray(data);
      return EXIF.toDataURL(data);
    }

    /**
     * Restores the exif tags into the given data url
     * @return {Uint8Array} data
     */

  }, {
    key: 'restoreExifTagsToImageData',
    value: function restoreExifTagsToImageData(data) {
      if (!this._exifData.isValid()) {
        return data;
      }
      var segments = this._sliceIntoSegments(data);
      var segmentStart = segments[1][0];
      var dataBefore = data.slice(0, segmentStart);
      var dataAfter = data.slice(segmentStart);
      var newData = dataBefore.concat(this._exifData.getBuffer()); // copy exifdata
      newData = newData.concat(dataAfter);
      return newData;
    }

    /**
     * Restores the JFIF Header data into the given data url
     * @return {Uint8Array} base64String
     */

  }, {
    key: 'restoreJfifSegmentToImageData',
    value: function restoreJfifSegmentToImageData(data) {
      if (!this._jfifData.isValid()) {
        return data;
      }
      // First, make the given string a data array
      var segments = this._sliceIntoSegments(data);

      var segment = this._findSegment(MARKERS.JFIF, segments);
      var newData = [];
      if (segment) {
        // we have one and just need to update it
        var offset = segment[0];
        var end = segment[1];
        var dataBefore = data.slice(0, offset);
        var dataBuf = data.slice(offset, end);
        var dataAfter = data.slice(end);

        var jfifData = new __WEBPACK_IMPORTED_MODULE_5__jpeg_jfif_data__["a" /* default */](dataBuf);
        jfifData.setDensityX(this._jfifData.getDensityX());
        jfifData.setDensityY(this._jfifData.getDensityY());
        jfifData.setUnitDensity(this._jfifData.getUnitDensity());
        newData = dataBefore.concat(dataBuf).concat(dataAfter);
      } else {
        return data;
      }
      return newData;
    }

    /**
     * Restores the exif tags into the given data url
     * @return {String} base64String
     */

  }, {
    key: 'restoreExifTags',
    value: function restoreExifTags(base64String) {
      // First, make the given string a data array
      var data = EXIF.fromDataURL(base64String);
      var newData = this.restoreExifTagsToImageData(data);
      return EXIF.toDataURL(newData);
    }

    /**
     * Restores the JFIF Header data into the given data url
     * @return {String} base64String
     */

  }, {
    key: 'restoreJfifSegment',
    value: function restoreJfifSegment(base64String) {
      if (!this._jfifData.isValid()) {
        return base64String;
      }
      var data = EXIF.fromDataURL(base64String);
      var newData = this.restoreJfifSegmentToImageData(data);
      return EXIF.toDataURL(newData);
    }

    /**
     * Overwrites the orientation with the given 16 bit integer
     * @param {Number} orientation
     */

  }, {
    key: 'setOrientation',
    value: function setOrientation(orientation) {
      return this._exifData.setOrientation(orientation);
    }

    /**
     * Checks whether the given base64 data url is a jpeg image
     * @param  {String}  base64String
     * @return {Boolean}
     */

  }, {
    key: '_findSegment',


    /**
     *
     * @param {String} identifier
     * @param {Object[]} segments
     */
    value: function _findSegment(identifier) {
      var segments = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._segments;

      for (var i = 0; i < segments.length; i++) {
        var offset = segments[i][0];
        var end = segments[i][1];
        this._stream.setHead(offset);
        var marker = this._stream.peekInt16();
        if (marker === identifier) {
          return [offset, end];
        }
      }
      return false;
    }

    /**
     *
     * @param {Array} [segments=this._segments]
     * @returns the last segment
     * @memberof EXIF
     */

  }, {
    key: '_getLastSegment',
    value: function _getLastSegment() {
      var segments = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._segments;

      return segments[segments.length - 1];
    }

    /**
     * Returns a new buffer containing the Exif segment
     * @return {Array}
     * @memberof EXIF
     */

  }, {
    key: '_getMarkerBuffer',
    value: function _getMarkerBuffer(identifier) {
      var segments = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._segments;

      var segment = this._findSegment(identifier, segments);
      if (segment) {
        var offset = segment[0];
        var end = segment[1];
        return this._buf.slice(offset, end);
      }
      return false;
    }

    /**
     * Slices the array into segments
     * @param  {Array.<Number>} buf
     * @return {Array}
     * @private
     */

  }, {
    key: '_sliceIntoSegments',
    value: function _sliceIntoSegments(buf) {
      var stream = new __WEBPACK_IMPORTED_MODULE_2__array_stream__["a" /* default */](buf);
      var segments = [];
      while (stream.getHead() < buf.length) {
        var marker = stream.readInt16();
        if (marker === MARKERS.SOI) {
          continue;
        } // SOI
        if (marker === MARKERS.SOS) {
          break;
        } // SOS Marker

        if (marker >= 0xff00 && marker <= 0xffff) {
          // Marker (FF-XX-HL-LL)
          var length = stream.readInt16();
          var end = stream.getHead() + length - 2;
          segments.push([stream.getHead() - 4, end]);
          stream.setHead(end);
        } else {
          throw new Error('Invalid marker: 0x' + marker.toString(16));
        }
      }

      this._stream.setHead(0);

      return segments;
    }

    /**
     * Returns the tags
     * @return {Object}
     */

  }, {
    key: 'getTags',
    value: function getTags() {
      return this._exifData.getTags();
    }

    /**
     * Returns the tag data (key, value, byte position etc.)
     * @return {Object[]}
     */

  }, {
    key: 'getTagData',
    value: function getTagData() {
      return this._exifData.getTagData();
    }

    /**
     * Disposes this EXIF object
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._buf = [];
      this._segments = [];
    }
  }], [{
    key: 'toDataURL',
    value: function toDataURL(data) {
      return DATA_JPEG_PREFIX + __WEBPACK_IMPORTED_MODULE_1__base64__["a" /* default */].encode(data);
    }

    /**
     * Convert base64 encoded data url to raw binary data
     * @param {String} dataURL
     * @returns {Uint8Array}
     */

  }, {
    key: 'fromDataURL',
    value: function fromDataURL(dataURL) {
      var raw = dataURL.replace(DATA_JPEG_PREFIX, '');
      var data = __WEBPACK_IMPORTED_MODULE_1__base64__["a" /* default */].decode(raw);
      return data;
    }
  }, {
    key: 'isJPEG',
    value: function isJPEG(base64String) {
      return JPEG_REGEX.test(base64String);
    }

    /**
     * Checks whether the given buffer is a JPEG image
     * @param  {Buffer} data
     * @return {Boolean}
     */

  }, {
    key: 'bufferIsJPEG',
    value: function bufferIsJPEG(data) {
      return data[0] === 255 && data[1] === 216 && data[2] === 255;
    }

    /**
     * Creates a new instance of Exif from the given base64-encoded
     * string
     * @param  {String} base64String
     * @return {PhotoEditorSDK.Exif}
     */

  }, {
    key: 'fromBase64String',
    value: function fromBase64String(base64String) {
      var raw = base64String.replace(DATA_JPEG_PREFIX, '');
      var data = __WEBPACK_IMPORTED_MODULE_1__base64__["a" /* default */].decode(raw);
      return new EXIF(data);
    }
  }]);

  return EXIF;
}();

/* harmony default export */ __webpack_exports__["a"] = (EXIF);

/***/ }),
/* 121 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * An ArrayStream provides methods for working with a byte array
 * @class
 * @memberof PhotoEditorSDK
 * @ignore
 */
/* istanbul ignore next */
var ArrayStream = function () {
  /**
   * Creates an ArrayStream
   * @param  {Array} buf
   */
  function ArrayStream(buf) {
    _classCallCheck(this, ArrayStream);

    this._head = 0;
    this._buf = buf;
  }

  /**
   * Returns the value of the following 8 bit integer
   * @return {Number}
   */


  _createClass(ArrayStream, [{
    key: 'peekInt8',
    value: function peekInt8() {
      return this._buf[this._head];
    }

    /**
     * Returns the value of the following 16 bit integer
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'peekInt16',
    value: function peekInt16() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var a = this._buf[this._head];
      var b = this._buf[this._head + 1];
      if (!littleEndian) {
        return (a << 8) + b;
      } else {
        return (b << 8) + a;
      }
    }

    /**
     * Returns the value of the following 24 bit integer
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'peekInt24',
    value: function peekInt24() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var a = this._buf[this._head];
      var b = this._buf[this._head + 1];
      var c = this._buf[this._head + 2];
      if (!littleEndian) {
        return (a << 16) + (b << 8) + c;
      } else {
        return (c << 16) + (b << 8) + a;
      }
    }

    /**
     * Returns the value of the following 32 bit integer
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'peekInt32',
    value: function peekInt32() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var a = this._buf[this._head];
      var b = this._buf[this._head + 1];
      var c = this._buf[this._head + 2];
      var d = this._buf[this._head + 3];
      if (!littleEndian) {
        return (a << 32) + (b << 16) + (c << 8) + d;
      } else {
        return (d << 32) + (c << 16) + (b << 8) + a;
      }
    }

    /**
     * Writes the given 16 bit integer at the current head position
     * @param  {Number} num
     */

  }, {
    key: 'writeInt8',
    value: function writeInt8(num) {
      this._buf[this._head] = num & 0xff;
    }
    /**
     * Writes the given 16 bit integer at the current head position
     * @param  {Number} num
     */

  }, {
    key: 'writeInt16',
    value: function writeInt16(num) {
      this._buf[this._head] = num >> 8; // upper
      this._buf[this._head + 1] = num & 0xff; // lower
    }

    /**
     * Returns the value of the following 8 bit integer and moves the head by 1 byte
     * @return {Number}
     */

  }, {
    key: 'readInt8',
    value: function readInt8() {
      var num = this.peekInt8();
      this._head += 1;
      return num;
    }

    /**
     * Returns the value of the following 16 bit integer and moves the head by 2 bytes
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'readInt16',
    value: function readInt16() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var num = this.peekInt16(littleEndian);
      this._head += 2;
      return num;
    }

    /**
     * Returns the value of the following 24 bit integer and moves the head by 3 bytes
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'readInt24',
    value: function readInt24() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var num = this.peekInt24(littleEndian);
      this._head += 3;
      return num;
    }

    /**
     * Returns the value of the following 32 bit integer and moves the head by 4 bytes
     * @param  {Boolean} [littleEndian = false]
     * @return {Number}
     */

  }, {
    key: 'readInt32',
    value: function readInt32() {
      var littleEndian = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var num = this.peekInt32(littleEndian);
      this._head += 4;
      return num;
    }

    /**
     * Reads a string with the given length
     * @param  {Number} length
     * @return {String}
     */

  }, {
    key: 'readString',
    value: function readString(length) {
      var str = '';
      for (var i = 0; i < length; i++) {
        var character = this.readInt8();
        str += String.fromCharCode(character);
      }
      return str;
    }

    /**
     * Returns the current head position
     * @return {Number}
     */

  }, {
    key: 'getHead',
    value: function getHead() {
      return this._head;
    }

    /**
     * Sets the head position
     * @param {Number} head
     */

  }, {
    key: 'setHead',
    value: function setHead(head) {
      this._head = head;
    }
  }]);

  return ArrayStream;
}();

/* harmony default export */ __webpack_exports__["a"] = (ArrayStream);

/***/ }),
/* 122 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * http://vip.sugovica.hu/Sardi/kepnezo/JPEG%20File%20Layout%20and%20Format.htm
 */

var MARKERS = {
  SOI: 0xffd8,
  SOS: 0xffda,
  APP0: 0xffe0,
  APP1: 0xffe1,
  JFIF: 0xffe0,
  EXIF: 0xffe1
};

var EXIF_TAGS = {
  0x0100: 'ImageWidth',
  0x0101: 'ImageHeight',
  0x8769: 'ExifIFDPointer',
  0x8825: 'GPSInfoIFDPointer',
  0xA005: 'InteroperabilityIFDPointer',
  0x0102: 'BitsPerSample',
  0x0103: 'Compression',
  0x0106: 'PhotometricInterpretation',
  0x0112: 'Orientation',
  0x0115: 'SamplesPerPixel',
  0x011C: 'PlanarConfiguration',
  0x0212: 'YCbCrSubSampling',
  0x0213: 'YCbCrPositioning',
  0x011A: 'XResolution',
  0x011B: 'YResolution',
  0x0128: 'ResolutionUnit',
  0x0111: 'StripOffsets',
  0x0116: 'RowsPerStrip',
  0x0117: 'StripByteCounts',
  0x0201: 'JPEGInterchangeFormat',
  0x0202: 'JPEGInterchangeFormatLength',
  0x012D: 'TransferFunction',
  0x013E: 'WhitePoint',
  0x013F: 'PrimaryChromaticities',
  0x0211: 'YCbCrCoefficients',
  0x0214: 'ReferenceBlackWhite',
  0x0132: 'DateTime',
  0x010E: 'ImageDescription',
  0x010F: 'Make',
  0x0110: 'Model',
  0x0131: 'Software',
  0x013B: 'Artist',
  0x8298: 'Copyright'
};

/* harmony default export */ __webpack_exports__["a"] = ({
  MARKERS: MARKERS,
  EXIF_TAGS: EXIF_TAGS
});

/***/ }),
/* 123 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignBanderole; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__ = __webpack_require__(21);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var TextDesignBanderole = function (_Configurable) {
  _inherits(TextDesignBanderole, _Configurable);

  function TextDesignBanderole() {
    _classCallCheck(this, TextDesignBanderole);

    return _possibleConstructorReturn(this, (TextDesignBanderole.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignBanderole)).apply(this, arguments));
  }

  _createClass(TextDesignBanderole, [{
    key: 'insetsForWidth',
    value: function insetsForWidth(width) {
      return this.getRelativeInsets().clone().scale(width);
    }
  }], [{
    key: 'Small',
    get: function get() {
      return new TextDesignBanderole({
        imagePath: 'text-design/images/imgly_text_design_asset_banderole_small.png',
        fontIdentifier: 'imgly_font_campton_bold',
        relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.05, 0.2, 0.05, 0.2)
      });
    }
  }, {
    key: 'Rectangle',
    get: function get() {
      return new TextDesignBanderole({
        imagePath: 'text-design/images/imgly_text_design_asset_black_background.png',
        fontIdentifier: 'imgly_font_campton_bold',
        relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.05, 0.05, 0.05, 0.05),
        needsImageSmoothingFix: true
      });
    }
  }, {
    key: 'Celebrate1',
    get: function get() {
      return new TextDesignBanderole({
        imagePath: 'text-design/images/imgly_text_design_asset_celebrate_01.png',
        fontIdentifier: 'imgly_font_rasa_500',
        relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.05, 0.2, 0.05, 0.2)
      });
    }
  }, {
    key: 'Celebrate2',
    get: function get() {
      return new TextDesignBanderole({
        imagePath: 'text-design/images/imgly_text_design_asset_celebrate_02.png',
        fontIdentifier: 'imgly_font_rasa_500',
        relativeInsets: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */](0.05, 0.2, 0.05, 0.2)
      });
    }
  }]);

  return TextDesignBanderole;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Configurable"]);

TextDesignBanderole.prototype.availableOptions = {
  image: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].IMAGE, default: null },
  imagePath: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING, default: null },
  relativeInsets: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */]() },
  fontIdentifier: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING, default: 'imgly_font_open_sans_bold' },
  needsImageSmoothingFix: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

/***/ }),
/* 124 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignRowMasked; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__rectangle_insets__ = __webpack_require__(21);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__default_text_design_row_single__ = __webpack_require__(26);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__utils_canvas__ = __webpack_require__(48);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var TextDesignRowMasked = function (_TextDesignRowSingle) {
  _inherits(TextDesignRowMasked, _TextDesignRowSingle);

  function TextDesignRowMasked() {
    _classCallCheck(this, TextDesignRowMasked);

    return _possibleConstructorReturn(this, (TextDesignRowMasked.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRowMasked)).apply(this, arguments));
  }

  _createClass(TextDesignRowMasked, [{
    key: '_getTextColor',
    value: function _getTextColor() {
      if (this.getAutoAdjustTextColor() && !this.getIsMasked()) {
        if (this.getBackgroundColor().equals(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Color"].WHITE)) {
          return __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Color"].BLACK;
        } else {
          return __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Color"].WHITE;
        }
      }

      return this.getAttributes().getTextColor().clone();
    }
  }, {
    key: '_getTextFrame',
    value: function _getTextFrame() {
      return this.getImageInsets().applyToRectangle(this._getFrame());
    }
  }, {
    key: '_getTextFrameForElement',
    value: function _getTextFrameForElement(element) {
      var frame = _get(TextDesignRowMasked.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRowMasked.prototype), '_getTextFrameForElement', this).call(this, element);
      var imageInsets = this.getImageInsets();

      if (this.getIsMasked() || this.getIsUsedInInvertedLayout()) {
        frame.y -= imageInsets.top;
      }

      return frame;
    }
  }, {
    key: 'willRender',
    value: function willRender(context) {
      // If needed, disable smoothing on server

      var attributes = this.getAttributes();
      attributes.setTextColor(this._getTextColor());

      var image = this.getImage();

      if (image) {
        var capInsets = this.getCapInsets();
        var frame = this._getFrame();

        if (capInsets && !capInsets.equals(__WEBPACK_IMPORTED_MODULE_7__rectangle_insets__["a" /* RectangleInsets */].ZERO)) {
          Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["b" /* drawImageWithCapInsets */])(context, image, frame, capInsets);
        } else {
          context.drawImage(image, frame.x, frame.y, frame.width, frame.height);
        }

        Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["d" /* fillRect */])(context, frame, this.getBackgroundColor(), 'source-atop', true);
      }

      if ((this.getIsMasked() || this.getIsUsedInInvertedLayout()) && image) {
        context.save();
        context.globalCompositeOperation = 'destination-out';
      }
    }
  }, {
    key: 'didRender',
    value: function didRender(context) {
      _get(TextDesignRowMasked.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRowMasked.prototype), 'didRender', this).call(this, context);

      if (this.getIsMasked() || this.getIsUsedInInvertedLayout()) {
        context.restore();
      }
    }
  }]);

  return TextDesignRowMasked;
}(__WEBPACK_IMPORTED_MODULE_8__default_text_design_row_single__["a" /* TextDesignRowSingle */]);

TextDesignRowMasked.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_8__default_text_design_row_single__["a" /* TextDesignRowSingle */].prototype.availableOptions, {
  image: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].IMAGE, default: null },
  capInsets: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].OBJECT, default: new __WEBPACK_IMPORTED_MODULE_7__rectangle_insets__["a" /* RectangleInsets */]() },
  backgroundColor: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Color"].WHITE },
  autoAdjustTextColor: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].BOOLEAN, default: true },
  isMasked: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].BOOLEAN, default: true },
  isUsedInInvertedLayout: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
});

/***/ }),
/* 125 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignRowImage; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__default_text_design_row_single__ = __webpack_require__(26);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_text_design_font__ = __webpack_require__(78);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__text_design_element__ = __webpack_require__(52);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__size_value__ = __webpack_require__(33);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__utils_canvas__ = __webpack_require__(48);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








var Rectangle = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Math"].Rectangle;


var TextDesignRowImage = function (_TextDesignRowSingle) {
  _inherits(TextDesignRowImage, _TextDesignRowSingle);

  function TextDesignRowImage() {
    _classCallCheck(this, TextDesignRowImage);

    return _possibleConstructorReturn(this, (TextDesignRowImage.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRowImage)).apply(this, arguments));
  }

  _createClass(TextDesignRowImage, [{
    key: 'getImageSize',
    value: function getImageSize() {
      var leftImage = this.getLeftImage();
      var rightImage = this.getRightImage();
      var words = this.getWords();
      var attributes = this.getAttributes();
      var fontIdentifier = attributes.getFontIdentifier();

      var imageSize = leftImage ? new __WEBPACK_IMPORTED_MODULE_10__size_value__["a" /* SizeValue */](leftImage.width, leftImage.height) : new __WEBPACK_IMPORTED_MODULE_10__size_value__["a" /* SizeValue */]();
      var text = words.joined(1)[0];

      if (!text) {
        return imageSize;
      }

      var font = new __WEBPACK_IMPORTED_MODULE_8__text_text_design_font__["a" /* TextDesignFont */]({ text: text, fontIdentifier: fontIdentifier, fontSize: 50 });
      var textSize = font.getSizeValue();

      var imageCount = rightImage ? 2 : 1;
      imageSize.scale(imageCount, 1);

      var newImageSize = imageSize.clone().fitInWidthWithOther(this._getFrame().width, textSize);

      newImageSize.scale(1 / imageCount, 1);

      return newImageSize;
    }
  }, {
    key: '_getTextFrame',
    value: function _getTextFrame() {
      var textFrame = _get(TextDesignRowImage.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRowImage.prototype), '_getTextFrame', this).call(this).clone();
      var imageSize = this.getImageSize();
      var rightImage = this.getRightImage();
      var imagePosition = this.getImagePosition();

      if (!rightImage) {
        if (imagePosition === TextDesignRowImage.ImagePosition.Left) {
          textFrame.x += imageSize.width;
        }
      } else {
        textFrame.x += imageSize.width;
        textFrame.width -= 2 * imageSize.width;
      }
      return textFrame;
    }
  }, {
    key: '_calculateLayoutElements',
    value: function _calculateLayoutElements() {
      var elements = _get(TextDesignRowImage.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRowImage.prototype), '_calculateLayoutElements', this).call(this);
      var frame = this._getFrame();
      var rightImage = this.getRightImage();
      var imageSize = this.getImageSize();
      var imagePosition = this.getImagePosition();
      var textFrame = this._getTextFrame();
      var attributes = this.getAttributes();
      var fontIdentifier = attributes.getFontIdentifier();

      var font = new __WEBPACK_IMPORTED_MODULE_8__text_text_design_font__["a" /* TextDesignFont */]({ text: 'stickerClock', fontIdentifier: fontIdentifier });
      font.fitWidth(this._getTextFrame().width);

      var leftImageRect = new Rectangle().set(frame.x, frame.y, imageSize.width, imageSize.height);

      if (!rightImage && imagePosition === TextDesignRowImage.ImagePosition.Right) {
        leftImageRect.x += textFrame.width;
      }

      elements.push(new __WEBPACK_IMPORTED_MODULE_9__text_design_element__["a" /* TextDesignElement */]({ text: 'stickerClock', frame: leftImageRect, font: font }));

      if (rightImage) {
        var firstElement = elements[0];

        if (firstElement) {
          var rightImageRect = leftImageRect.clone();
          rightImageRect.translate(firstElement.getFrame().width + rightImageRect.width, 0);
          elements.push(new __WEBPACK_IMPORTED_MODULE_9__text_design_element__["a" /* TextDesignElement */]({ text: 'stickerClock', frame: rightImageRect, font: font }));
        }
      }

      return elements;
    }
  }, {
    key: 'render',
    value: function render(context) {
      var elements = this._getLayoutElements();
      var attributes = this.getAttributes();
      var textColor = attributes.getTextColor();
      var leftImage = this.getLeftImage();
      var rightImage = this.getRightImage();

      var layoutElement = elements[0];
      var secondElement = elements[1];

      var _layoutElement$serial = layoutElement.serializeOptions(),
          font = _layoutElement$serial.font;

      var textFrame = this._getTextFrameForElement(layoutElement);

      font.draw(context, textFrame.x, textFrame.y, {
        textColor: attributes.getTextColor().toRGBA(),
        alignment: attributes.getAlignment()
      });

      if (leftImage) {
        var dest = secondElement.getFrame();
        context.drawImage(leftImage, dest.x, dest.y, dest.width, dest.height);
        Object(__WEBPACK_IMPORTED_MODULE_11__utils_canvas__["d" /* fillRect */])(context, dest, textColor, 'source-atop');
      }

      if (elements.length > 2) {
        var rightElement = elements[2];
        var rightElementFrame = rightElement.getFrame().clone();

        context.drawImage(rightImage, rightElementFrame.x, rightElementFrame.y, rightElementFrame.width, rightElementFrame.height);
        Object(__WEBPACK_IMPORTED_MODULE_11__utils_canvas__["d" /* fillRect */])(context, rightElementFrame, textColor, 'source-atop');
      }
    }
  }]);

  return TextDesignRowImage;
}(__WEBPACK_IMPORTED_MODULE_7__default_text_design_row_single__["a" /* TextDesignRowSingle */]);

TextDesignRowImage.ImagePosition = {
  Left: 'LEFT',
  right: 'RIGHT'
};
TextDesignRowImage.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_7__default_text_design_row_single__["a" /* TextDesignRowSingle */].prototype.availableOptions, {
  leftImage: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].IMAGE, default: null },
  rightImage: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].IMAGE, default: null },
  imagePosition: {
    type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING,
    default: TextDesignRowImage.ImagePosition.Left,
    available: [TextDesignRowImage.ImagePosition.Left, TextDesignRowImage.ImagePosition.Right]
  }
});

/***/ }),
/* 126 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignRowSingleImage; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__default_text_design_row__ = __webpack_require__(92);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_words__ = __webpack_require__(47);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_design_attributes__ = __webpack_require__(77);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__text_design_element__ = __webpack_require__(52);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__text_text_design_font__ = __webpack_require__(78);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__utils_canvas__ = __webpack_require__(48);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__size_value__ = __webpack_require__(33);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */










var TextDesignRowSingleImage = function (_TextDesignRow) {
  _inherits(TextDesignRowSingleImage, _TextDesignRow);

  function TextDesignRowSingleImage() {
    var _ref;

    _classCallCheck(this, TextDesignRowSingleImage);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignRowSingleImage.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRowSingleImage)).call.apply(_ref, [this].concat(args)));

    _this.setSize(new __WEBPACK_IMPORTED_MODULE_12__size_value__["a" /* SizeValue */](_this.getWidth(), _this.getHeight()));
    return _this;
  }

  _createClass(TextDesignRowSingleImage, [{
    key: '_getImageFrame',
    value: function _getImageFrame() {
      var imageRect = this._getTextFrame().clone();
      var image = this.getImage();
      // TODO: drawingModeAspectFit
      if (this.getDrawingModeAspectFit() && image) {
        var ratio = Math.min(imageRect.width / image.width, imageRect.height / image.height);
        var newWidth = image.width * ratio;
        var newHeight = image.height * ratio;

        imageRect.x += (imageRect.width - newWidth) / 2;
        imageRect.y += (imageRect.height - newHeight) / 2;
        imageRect.width = newWidth;
        imageRect.height = newHeight;
      }

      return imageRect;
    }
  }, {
    key: '_calculateLayoutElements',
    value: function _calculateLayoutElements() {
      return [new __WEBPACK_IMPORTED_MODULE_9__text_design_element__["a" /* TextDesignElement */]({
        text: '', frame: this._getImageFrame(), font: new __WEBPACK_IMPORTED_MODULE_10__text_text_design_font__["a" /* TextDesignFont */]()
      })];
    }
  }, {
    key: 'render',
    value: function render(context) {
      var image = this.getImage();
      var imageFrame = this._getImageFrame();
      var attributes = this.getAttributes();
      var textColor = attributes.getTextColor();

      Object(__WEBPACK_IMPORTED_MODULE_11__utils_canvas__["a" /* drawImageFrame */])(context, image, imageFrame, textColor);
    }
  }]);

  return TextDesignRowSingleImage;
}(__WEBPACK_IMPORTED_MODULE_6__default_text_design_row__["a" /* TextDesignRow */]);

TextDesignRowSingleImage.RowImages = {
  decorative1: 'text-design/images/imgly_text_design_asset_decorative_01.png',
  decorative2: 'text-design/images/imgly_text_design_asset_decorative_02.png',
  decorative3: 'text-design/images/imgly_text_design_asset_decorative_05.png',
  decorative4: 'text-design/images/imgly_text_design_asset_decorative_06.png',
  celebrate1: 'text-design/images/imgly_text_design_asset_celebrate_03.png',
  celebrate2: 'text-design/images/imgly_text_design_asset_celebrate_04.png',
  celebrate3: 'text-design/images/imgly_text_design_asset_celebrate_05.png'
};
TextDesignRowSingleImage.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_6__default_text_design_row__["a" /* TextDesignRow */].prototype.availableOptions, {
  words: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].OBJECT, default: new __WEBPACK_IMPORTED_MODULE_7__text_words__["a" /* Words */]() },
  height: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  image: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].IMAGE, default: null },
  imagePath: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: TextDesignRowSingleImage.RowImages.decorative1 },
  drawingModeAspectFit: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  attributes: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].CONFIGURABLE, default: new __WEBPACK_IMPORTED_MODULE_8__text_design_attributes__["a" /* TextDesignAttributes */]() }
});

/***/ }),
/* 127 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignRowMultiline; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_row_masked__ = __webpack_require__(124);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design_element__ = __webpack_require__(52);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_text_design_font__ = __webpack_require__(78);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__text_text_renderer__ = __webpack_require__(177);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__text_text_design_font_multiline__ = __webpack_require__(435);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








var TextDesignRowMultiline = function (_TextDesignRowMasked) {
  _inherits(TextDesignRowMultiline, _TextDesignRowMasked);

  function TextDesignRowMultiline() {
    _classCallCheck(this, TextDesignRowMultiline);

    return _possibleConstructorReturn(this, (TextDesignRowMultiline.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRowMultiline)).apply(this, arguments));
  }

  _createClass(TextDesignRowMultiline, [{
    key: '_calculateLayoutElements',
    value: function _calculateLayoutElements() {
      var words = this.getWords();
      var textFrame = this._getTextFrame();
      var attributes = this.getAttributes();
      var fontIdentifier = attributes.getFontIdentifier();
      var imageInsets = this.getImageInsets();

      var font = new __WEBPACK_IMPORTED_MODULE_8__text_text_design_font__["a" /* TextDesignFont */]({ text: words.getWord(0), fontIdentifier: fontIdentifier });
      font.fitWidth(textFrame.width);

      var element = new __WEBPACK_IMPORTED_MODULE_7__text_design_element__["a" /* TextDesignElement */]({ text: words.getWord(0), frame: textFrame, font: font });

      element.setFrame(this._getTextFrameForElement(element));

      // is  this.getSize().height already calculated here?
      var size = this.getSize();
      if (this.getSizeToFitContent() || size.height <= 1) {
        size.height = imageInsets.top + element.getFrame().height + imageInsets.bottom;
      }

      size.height = Math.max(size.height, this.getMinimumHeight());

      return [element];
    }
  }, {
    key: '_getTextFrameForElement',
    value: function _getTextFrameForElement(element) {
      var words = this.getWords();
      var text = words.getWord(0);
      var attributes = this.getAttributes();
      var fontIdentifier = attributes.getFontIdentifier();
      var imageInsets = this.getImageInsets();

      var insettedRect = this.getImageInsets().applyToRectangle(this._getFrame()).scale(this.getTextScaleFactor());

      var font = new __WEBPACK_IMPORTED_MODULE_10__text_text_design_font_multiline__["a" /* TextDesignFontMultiline */]({
        text: text,
        fontIdentifier: fontIdentifier,
        alignment: attributes.getAlignment(),
        lineHeight: 1 // attributes.getLineSpacing()
      });

      font.fitInFrame(insettedRect);

      var textSize = font.getSize();

      insettedRect.height = textSize.height;

      var stringHeight = textSize.height * this.getRowScaleFactor();

      if (this.getSizeToFitContent()) {
        stringHeight += imageInsets.top + imageInsets.bottom;
      }

      var frame = this._getFrame();
      var alignment = attributes.getAlignment();
      if (this.getCenteredVertically()) {
        insettedRect.y = frame.height / 2 - stringHeight / 2 + imageInsets.top;
      } else {
        switch (alignment) {
          case 'left':
            insettedRect.y = frame.height - stringHeight - imageInsets.bottom;
            break;

          case 'center':
            insettedRect.y = frame.height / 2 - stringHeight / 2 + stringHeight * this.getCenterOffset();
            insettedRect.x = (frame.width - insettedRect.width) / 2;
            break;

          case 'right':
            insettedRect.x = frame.width - insettedRect.width - imageInsets.right;
            break;
        }
      }

      return insettedRect; // insettedRect.scale(this.getTextScaleFactor())
    }
  }, {
    key: 'render',
    value: function render(context) {
      var _this2 = this;

      context.save();

      this._getLayoutElements().forEach(function (element) {
        var _element$serializeOpt = element.serializeOptions(),
            text = _element$serializeOpt.text,
            frame = _element$serializeOpt.frame;

        var attributes = _this2.getAttributes();
        var fontIdentifier = attributes.getFontIdentifier();

        var fontMultiline = new __WEBPACK_IMPORTED_MODULE_10__text_text_design_font_multiline__["a" /* TextDesignFontMultiline */]({
          text: text,
          fontIdentifier: fontIdentifier,
          alignment: attributes.getAlignment(),
          lineHeight: 1, // attributes.getLineSpacing(),
          textColor: attributes.getTextColor().toRGBA()
        });

        frame = _this2._getTextFrameForElement(element);

        fontMultiline.fitInFrame(frame);

        fontMultiline.draw(context, frame.x, frame.y);
      });

      context.restore();
    }
  }]);

  return TextDesignRowMultiline;
}(__WEBPACK_IMPORTED_MODULE_6__text_design_row_masked__["a" /* TextDesignRowMasked */]);

TextDesignRowMultiline.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_6__text_design_row_masked__["a" /* TextDesignRowMasked */].prototype.availableOptions, {
  centerOffset: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  sizeToFitContent: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  textScaleFactor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.95 },
  rowScaleFactor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  minimumHeight: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  centeredVertically: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
});

/***/ }),
/* 128 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignMaskedSpeechBubble; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__models_masked_row_type__ = __webpack_require__(80);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_design_masked__ = __webpack_require__(53);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__models_randomizer__ = __webpack_require__(20);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var TextDesignMaskedSpeechBubble = function (_TextDesignMasked) {
  _inherits(TextDesignMaskedSpeechBubble, _TextDesignMasked);

  function TextDesignMaskedSpeechBubble() {
    var _ref;

    _classCallCheck(this, TextDesignMaskedSpeechBubble);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignMaskedSpeechBubble.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignMaskedSpeechBubble)).call.apply(_ref, [this].concat(args)));

    _this._possibleRowTypes = [__WEBPACK_IMPORTED_MODULE_7__models_masked_row_type__["a" /* RowType */].SpeechBubble1, __WEBPACK_IMPORTED_MODULE_7__models_masked_row_type__["a" /* RowType */].SpeechBubble3];

    _this._rowTypesRandomizer = new __WEBPACK_IMPORTED_MODULE_9__models_randomizer__["a" /* Randomizer */](0);
    _this._isMaskedRandomizer = new __WEBPACK_IMPORTED_MODULE_9__models_randomizer__["a" /* Randomizer */](0);

    _this._seedPool.push(_this._rowTypesRandomizer);
    _this._seedPool.push(_this._isMaskedRandomizer);
    return _this;
  }

  _createClass(TextDesignMaskedSpeechBubble, [{
    key: 'getImagePaths',
    value: function getImagePaths() {
      return this._possibleRowTypes.map(function (rowType) {
        return rowType.getImagePath();
      });
    }
  }, {
    key: '_rowTypes',
    value: function _rowTypes(words) {
      return this._possibleRowTypes;
    }
  }, {
    key: '_randomLayoutRow',
    value: function _randomLayoutRow(words, index, width, attributes) {
      this._rowType = this._rowTypesRandomizer.pickNext(this._rowTypes(words));

      attributes.setLineSpacing(0.9);

      var row = _get(TextDesignMaskedSpeechBubble.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignMaskedSpeechBubble.prototype), '_randomLayoutRow', this).call(this, words, index, width, attributes);

      row.set({
        textScaleFactor: 1,
        minimumHeight: width * this._rowType.getMinimumHeightRatio(),
        sizeToFitContent: this._rowType.getSizeToFitContent(),
        centeredVertically: true
      });

      return row;
    }
  }]);

  return TextDesignMaskedSpeechBubble;
}(__WEBPACK_IMPORTED_MODULE_8__text_design_masked__["a" /* TextDesignMasked */]);

TextDesignMaskedSpeechBubble.defaultFontIdentifiers = ['imgly_font_panton_black_caps', 'imgly_font_panton_light_caps', 'imgly_font_panton_black_italic_caps', 'imgly_font_panton_light_italic_caps'];
TextDesignMaskedSpeechBubble.identifier = 'imgly_text_design_masked_speech_bubble';
TextDesignMaskedSpeechBubble.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_8__text_design_masked__["a" /* TextDesignMasked */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignMaskedSpeechBubble.defaultFontIdentifiers },
  squareLayout: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  alignment: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: 'left', available: __WEBPACK_IMPORTED_MODULE_8__text_design_masked__["a" /* TextDesignMasked */].ValidAlignments }
});

/***/ }),
/* 129 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignSunshine; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_9_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__text_design__ = __webpack_require__(76);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__models_rows_default_text_design_row_single__ = __webpack_require__(26);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__text_design_asset_manager__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__models_rectangle_insets__ = __webpack_require__(21);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__text_words__ = __webpack_require__(47);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__models_rows_image_text_design_row_single_image__ = __webpack_require__(126);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__models_rows_image_text_design_row_image__ = __webpack_require__(125);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__models_randomizer__ = __webpack_require__(20);










var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_8_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */










var TextDesignSunshine = function (_TextDesign) {
  _inherits(TextDesignSunshine, _TextDesign);

  // NOTE: Order and position is important for serialization
  function TextDesignSunshine() {
    var _ref;

    _classCallCheck(this, TextDesignSunshine);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignSunshine.__proto__ || __WEBPACK_IMPORTED_MODULE_8_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSunshine)).call.apply(_ref, [this].concat(args)));

    _this._relativeInsets = new __WEBPACK_IMPORTED_MODULE_13__models_rectangle_insets__["a" /* RectangleInsets */](0, 0, 0, 0);

    _this._INVALID_FONTS_IF_LESS_THEN_5_CHARS = ['imgly_font_montserrat_light'];

    _this._INVALID_FONTS_IF_LESS_THEN_4_CHARS = ['imgly_font_montserrat_light', 'imgly_font_wolesbro'];

    _this._lineCount = 0;

    _this._decorativeRowCreated = false;

    _this._useImageRowRandomizer = new __WEBPACK_IMPORTED_MODULE_17__models_randomizer__["a" /* Randomizer */](0);
    _this._rowTypeRandomizer = new __WEBPACK_IMPORTED_MODULE_17__models_randomizer__["a" /* Randomizer */](0);
    _this._lineDecorativeTypeRandomizer = new __WEBPACK_IMPORTED_MODULE_17__models_randomizer__["a" /* Randomizer */](0);

    _this._seedPool.push(_this._useImageRowRandomizer);
    _this._seedPool.push(_this._rowTypeRandomizer);
    _this._seedPool.push(_this._lineDecorativeTypeRandomizer);
    return _this;
  }

  _createClass(TextDesignSunshine, [{
    key: 'getImagePaths',
    value: function getImagePaths() {
      return [].concat(_toConsumableArray(TextDesignSunshine.DecoratorImages), _toConsumableArray(TextDesignSunshine.RowImages));
    }
  }, {
    key: '_fontForRow',
    value: function _fontForRow(index, words) {
      var _this2 = this;

      var numOfCharacters = words.countNumberOfCharacters();

      var fonts = this.getFontIdentifiers();

      if (numOfCharacters < 4) {
        fonts = fonts.filter(function (font) {
          return _this2._INVALID_FONTS_IF_LESS_THEN_4_CHARS.indexOf(font) < 0;
        });
      } else if (numOfCharacters < 5) {
        fonts = fonts.filter(function (font) {
          return _this2._INVALID_FONTS_IF_LESS_THEN_5_CHARS.indexOf(font) < 0;
        });
      }

      return fonts[index % fonts.length];
    }
  }, {
    key: '_modifiedText',
    value: function _modifiedText(text) {
      return _get(TextDesignSunshine.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_8_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSunshine.prototype), '_modifiedText', this).call(this, text).toUpperCase();
    }
  }, {
    key: '_modifiedLines',
    value: function _modifiedLines(lines) {
      this._lineCount = lines.length;
      return lines;
    }
  }, {
    key: 'generateLayoutData',
    value: function generateLayoutData(text, width) {
      this._decorativeRowCreated = false;
      return _get(TextDesignSunshine.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_8_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSunshine.prototype), 'generateLayoutData', this).call(this, text, width);
    }
  }, {
    key: '_randomLayoutRow',
    value: function _randomLayoutRow(words, index, width, attributes) {
      var fontIdentifier = attributes.getFontIdentifier();

      var modifiedWords = words;

      switch (fontIdentifier) {
        case 'imgly_font_wolesbro':
          modifiedWords = new __WEBPACK_IMPORTED_MODULE_14__text_words__["a" /* Words */]().set(words.getLowerCase());
          break;

        case 'imgly_font_permanent_marker':
          modifiedWords = new __WEBPACK_IMPORTED_MODULE_14__text_words__["a" /* Words */]().set(words.getUpperCase());
          break;
      }

      // const modifiedWords = R.cond([
      //   [R.equals('imgly_font_wolesbro'), R.always(new Words().set(words.getLowerCase()))],
      //   [R.equals('imgly_font_permanent_marker'), R.always(new Words().set(words.getUpperCase()))],
      //   [R.T, R.always(words)]
      // ])(fontIdentifier)

      var noDecorations = this.getDecorativeRowsInTheMiddleOnly() && (index === 0 || index === this._lineCount - 1);

      if (this._useImageRowRandomizer.nextBool() || this._decorativeRowCreated || noDecorations) {
        return new __WEBPACK_IMPORTED_MODULE_11__models_rows_default_text_design_row_single__["a" /* TextDesignRowSingle */]({ words: modifiedWords, width: width, attributes: attributes });
      } else {
        this._decorativeRowCreated = true;

        var _randomDecoratorImage = this._randomDecoratorImages(),
            _randomDecoratorImage2 = _slicedToArray(_randomDecoratorImage, 2),
            leftImage = _randomDecoratorImage2[0],
            rightImage = _randomDecoratorImage2[1];

        return new __WEBPACK_IMPORTED_MODULE_16__models_rows_image_text_design_row_image__["a" /* TextDesignRowImage */]({
          words: words,
          width: width,
          attributes: attributes,
          leftImage: leftImage,
          rightImage: rightImage
        });
      }
    }
  }, {
    key: '_layoutRows',
    value: function _layoutRows(lines, width) {
      var elements = _get(TextDesignSunshine.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_8_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSunshine.prototype), '_layoutRows', this).call(this, lines, width);

      if (!this.getDecorationsVisible()) {
        return elements;
      }

      var formHeight = 0.0625 * width;
      var firstRow = new __WEBPACK_IMPORTED_MODULE_15__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */]({
        width: width,
        height: formHeight,
        image: __WEBPACK_IMPORTED_MODULE_12__text_design_asset_manager__["a" /* AssetManager */].getImage(this._rowTypeRandomizer.pickNext(TextDesignSunshine.RowImages))
      }).layout();

      var lastRow = new __WEBPACK_IMPORTED_MODULE_15__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */]({
        width: width,
        height: formHeight,
        image: __WEBPACK_IMPORTED_MODULE_12__text_design_asset_manager__["a" /* AssetManager */].getImage(this._rowTypeRandomizer.pickNext(TextDesignSunshine.RowImages))
      }).layout();

      return [firstRow].concat(_toConsumableArray(elements), [lastRow]);
    }
  }, {
    key: '_randomDecoratorImages',
    value: function _randomDecoratorImages() {
      if (this._lineDecorativeTypeRandomizer.nextInRange(0, 1)) {
        return TextDesignSunshine.DecoratorImages.slice(0, 2).map(function (path) {
          return __WEBPACK_IMPORTED_MODULE_12__text_design_asset_manager__["a" /* AssetManager */].getImage(path);
        });
      } else {
        return TextDesignSunshine.DecoratorImages.slice(2).map(function (path) {
          return __WEBPACK_IMPORTED_MODULE_12__text_design_asset_manager__["a" /* AssetManager */].getImage(path);
        });
      }
    }
  }]);

  return TextDesignSunshine;
}(__WEBPACK_IMPORTED_MODULE_10__text_design__["a" /* TextDesign */]);

TextDesignSunshine.defaultFontIdentifiers = ['imgly_font_permanent_marker', 'imgly_font_wolesbro', 'imgly_font_wolesbro', 'imgly_font_montserrat_light'];
TextDesignSunshine.identifier = 'imgly_text_design_sunshine';
TextDesignSunshine.RowImages = [__WEBPACK_IMPORTED_MODULE_15__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */].RowImages.decorative1, __WEBPACK_IMPORTED_MODULE_15__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */].RowImages.decorative2, __WEBPACK_IMPORTED_MODULE_15__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */].RowImages.decorative3, __WEBPACK_IMPORTED_MODULE_15__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */].RowImages.decorative4];
TextDesignSunshine.DecoratorImages = ['text-design/images/imgly_text_design_asset_decorative_03.png', 'text-design/images/imgly_text_design_asset_decorative_04.png', 'text-design/images/imgly_text_design_asset_decorative_07.png', 'text-design/images/imgly_text_design_asset_decorative_08.png'];
TextDesignSunshine.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_10__text_design__["a" /* TextDesign */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_9_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignSunshine.defaultFontIdentifiers },
  relativeLineSpacing: { type: __WEBPACK_IMPORTED_MODULE_9_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 / 3 * 4 },
  decorationsVisible: { type: __WEBPACK_IMPORTED_MODULE_9_photoeditorsdk_core__["OptionType"].BOOLEAN, default: true },
  decorativeRowsInTheMiddleOnly: { type: __WEBPACK_IMPORTED_MODULE_9_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
});

/***/ }),
/* 130 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignParticlesBackground; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_background__ = __webpack_require__(183);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design_asset_manager__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__utils_canvas__ = __webpack_require__(48);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__text_design_particle__ = __webpack_require__(443);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







var Rectangle = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Rectangle;


var TextDesignParticlesBackground = function (_TextDesignBackground) {
  _inherits(TextDesignParticlesBackground, _TextDesignBackground);

  function TextDesignParticlesBackground() {
    var _ref;

    _classCallCheck(this, TextDesignParticlesBackground);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignParticlesBackground.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignParticlesBackground)).call.apply(_ref, [this].concat(args)));

    _this._MAX_TRIES = 1000;
    _this._PRECISION = 1000;
    return _this;
  }

  _createClass(TextDesignParticlesBackground, [{
    key: 'render',
    value: function render(context, size, relativeInsets, color, randomizer) {
      var _options = this._options,
          imagePaths = _options.imagePaths,
          relativeParticleSize = _options.relativeParticleSize;


      if (imagePaths.length <= 0) {
        return;
      }

      var aspect = size.width / size.height;

      var textRect = new Rectangle(Math.round(relativeInsets.left * this._PRECISION), Math.round(relativeInsets.top * this._PRECISION * aspect), this._PRECISION, this._PRECISION);

      textRect.width -= textRect.x + Math.round(relativeInsets.right * this._PRECISION);
      textRect.height -= textRect.y + Math.round(relativeInsets.bottom * this._PRECISION * aspect);

      var particles = [];

      var count = 0;
      var tryCount = 0;

      while (count < this.getParticleCount() && tryCount < this._MAX_TRIES) {
        var radius = relativeParticleSize / 2;
        var minX = Math.round(radius * this._PRECISION);
        var minY = Math.round(radius * this._PRECISION * aspect);

        var maxX = Math.floor(this._PRECISION) - minX;
        var maxY = Math.floor(this._PRECISION) - minY;

        var randomValueX = randomizer.nextInRange(minX, maxX);
        var randomValueY = randomizer.nextInRange(minY, maxY);

        var frame = new Rectangle(randomValueX - minX, randomValueY - minY, 2 * minX, 2 * minY);

        if (!frame.intersects(textRect) && !this.hasCollision(particles, frame)) {
          particles.push(new __WEBPACK_IMPORTED_MODULE_9__text_design_particle__["a" /* TextDesignParticle */]({ frame: frame }));
          count += 1;
        }

        tryCount += 1;
      }

      for (var i = 0; i < particles.length; i++) {
        var particle = particles[i];
        var randomImagePath = randomizer.pickNext(imagePaths);
        var randomImage = __WEBPACK_IMPORTED_MODULE_7__text_design_asset_manager__["a" /* AssetManager */].getImage(randomImagePath);
        var opacity = randomizer.nextInRange(140, 230) / 255; // (55 + randomizer.next() % 35) / 100

        var scaleX = size.width / this._PRECISION;
        var scaleY = size.height / this._PRECISION;

        var destination = particle.getContentFrame();
        destination.x *= scaleX;
        destination.y *= scaleY;
        destination.width *= scaleX;
        destination.height *= scaleY;

        var finalColor = color.clone();
        finalColor.a = opacity;

        Object(__WEBPACK_IMPORTED_MODULE_8__utils_canvas__["a" /* drawImageFrame */])(context, randomImage, destination, finalColor, 'source-atop');
      }
    }
  }, {
    key: 'hasCollision',
    value: function hasCollision(particles, rect) {
      for (var i = 0; i < particles.length; i++) {
        if (rect.intersects(particles[i].getFrame())) {
          return true;
        }
      }

      return false;
    }
  }]);

  return TextDesignParticlesBackground;
}(__WEBPACK_IMPORTED_MODULE_6__text_design_background__["a" /* TextDesignBackground */]);

TextDesignParticlesBackground.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_6__text_design_background__["a" /* TextDesignBackground */].prototype.availableOptions, {
  particleCount: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 50 },
  relativeParticleSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.08 },
  imagePaths: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: [] }
});

/***/ }),
/* 131 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(454), __esModule: true };

/***/ }),
/* 132 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__tensor_filter__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__tensor_utils__ = __webpack_require__(54);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * Expects a 4D input shape representing an representing an RGB image. The
 * values will be packed into an RGB representation, i.e. spread across the
 * output textures RGB channels, for display within the SDK. Alpha is set
 * to 1.0.
 *
 * Inputs: x - 4D tensor with 3 channels
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var PackRGBAFilter = function (_TensorFilter) {
  _inherits(PackRGBAFilter, _TensorFilter);

  function PackRGBAFilter() {
    _classCallCheck(this, PackRGBAFilter);

    return _possibleConstructorReturn(this, (PackRGBAFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(PackRGBAFilter)).apply(this, arguments));
  }

  _createClass(PackRGBAFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      var input = this._getInputWithName('x');
      var inputShape = input.logicalShape;
      if (inputShape.length !== 4) {
        throw new Error('UnpackRGBAFilter expects 4D inputs');
      }

      var batch = inputShape[0];
      var channels = inputShape[3];
      if (channels !== 3) {
        throw new Error('Expected RGB values');
      }
      if (batch !== 1) {
        throw new Error('PackRGBAFilter does not support batches of images.');
      }
      var requestedOutputSize = this._options.outputSize;
      if (requestedOutputSize.length !== 2) {
        throw new Error('Expected outputSize of length 2');
      }

      if (requestedOutputSize[0] * requestedOutputSize[1] !== __WEBPACK_IMPORTED_MODULE_7__tensor_utils__["a" /* default */].getSizeOfLogicalShape(inputShape) / 3) {
        throw new Error('Input shape ' + inputShape + ' can\'t be broken up into 3 channels.');
      }

      return requestedOutputSize;
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      return '\n      void main ()\n      {\n        ivec2 outputCoords = getOutputCoords();\n        int row = outputCoords.x;\n        int col = outputCoords.y;\n        float r = getX(0, row, col, 0);\n        float g = getX(0, row, col, 1);\n        float b = getX(0, row, col, 2);\n        gl_FragColor = vec4(r, g, b, 1.0);\n      }\n    ';
    }
  }, {
    key: 'requiresFloatTextures',
    value: function requiresFloatTextures() {
      return false;
    }
  }]);

  return PackRGBAFilter;
}(__WEBPACK_IMPORTED_MODULE_6__tensor_filter__["b" /* default */]);

PackRGBAFilter.prototype.availableOptions = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({
  outputSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY }
}, __WEBPACK_IMPORTED_MODULE_6__tensor_filter__["b" /* default */].prototype.availableOptions);

/* harmony default export */ __webpack_exports__["a"] = (PackRGBAFilter);

/***/ }),
/* 133 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/**
 * @class
 */
var PadUtils = function () {
  function PadUtils() {
    _classCallCheck(this, PadUtils);
  }

  _createClass(PadUtils, null, [{
    key: 'calculatePadding',
    value: function calculatePadding(pad, inHeight, inWidth, strideHeight, strideWidth, filterHeight, filterWidth) {
      var outHeight = void 0;
      var outWidth = void 0;
      var padInfo = void 0;
      if (pad === 'same') {
        outHeight = Math.ceil(inHeight / strideHeight);
        outWidth = Math.ceil(inWidth / strideWidth);
        var padAlongHeight = (outHeight - 1) * strideHeight + filterHeight - inHeight;
        var padAlongWidth = (outWidth - 1) * strideWidth + filterWidth - inWidth;
        var top = Math.floor(padAlongHeight / 2);
        var bottom = padAlongHeight - top;
        var left = Math.floor(padAlongWidth / 2);
        var right = padAlongWidth - left;
        padInfo = { top: top, bottom: bottom, left: left, right: right, type: 'SAME' };
      } else if (pad === 'valid') {
        padInfo = { top: 0, bottom: 0, left: 0, right: 0, type: 'VALID' };
        outHeight = Math.ceil((inHeight - filterHeight + 1) / strideHeight);
        outWidth = Math.ceil((inWidth - filterWidth + 1) / strideWidth);
      } else {
        throw Error('Unknown padding parameter: ' + pad);
      }

      return { padInfo: padInfo, outHeight: outHeight, outWidth: outWidth };
    }
  }]);

  return PadUtils;
}();

/* harmony default export */ __webpack_exports__["a"] = (PadUtils);

/***/ }),
/* 134 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__ = __webpack_require__(31);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_shared_constants__ = __webpack_require__(90);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_shared_loaders_json_loader__ = __webpack_require__(71);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_shared_assets_asset_library__ = __webpack_require__(491);




var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







var CUSTOM_CATEGORY_ID = 'imgly_sticker_custom';

var StickerManager = function () {
  function StickerManager(ui, options, dynamicAssetsLibrary) {
    _classCallCheck(this, StickerManager);

    this._ui = ui;
    this._options = options;
    this._dynamicAssetsLibrary = dynamicAssetsLibrary || this._ui.getEditor().getDynamicAssetsLibrary() || new __WEBPACK_IMPORTED_MODULE_7_shared_assets_asset_library__["a" /* default */]();
    this._categoriesById = {};
    this._categories = [];
    this._stickersById = {};

    this._customStickerCanvas = __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["Utils"].createCanvas();

    this.reload();
  }

  /**
   * Refreshes the contents of the sticker-manager
   */


  _createClass(StickerManager, [{
    key: 'reload',
    value: function reload() {
      this._categoriesById = {};
      this._categories = [];
      this._stickersById = {};

      var customAssetsAllowed = this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed();

      this._addCategories(__WEBPACK_IMPORTED_MODULE_5_shared_constants__["b" /* default */].DEFAULTS.STICKER_CATEGORIES);

      var _options = this._options,
          categories = _options.categories,
          replaceCategories = _options.replaceCategories;

      if (customAssetsAllowed && this._options.categories) {
        this._addCategories(categories, replaceCategories);
      } else {
        this._updateCategoriesMap();
        this._updateAllCategory();
      }

      if (customAssetsAllowed) {
        var customStickers = this._dynamicAssetsLibrary.getAssets('sticker');

        if (customStickers.length > 0) {
          var customCategory = this._createCustomStickerCategory(customStickers);
          // This also updates the "all" category
          this._addCategories([customCategory], false, true);
        }
      }
    }

    /**
     * Loads stickers from the given external URL
     * @param  {String} url
     * @return {Promise}
     */

  }, {
    key: 'loadExternal',
    value: function loadExternal(url) {
      var _this = this;

      var loader = new __WEBPACK_IMPORTED_MODULE_6_shared_loaders_json_loader__["a" /* default */](url);
      return loader.load().then(function (result) {
        _this._addCategories(result.categories, _this._options.replaceCategories);
      });
    }

    /**
     * Initializes the categories
     * @param {Object[]} categories
     * @param {Boolean} replace = false
     * @private
     */

  }, {
    key: '_addCategories',
    value: function _addCategories(categories) {
      var replace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      var insertAtBeginning = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

      if (replace) {
        this._categories = categories.slice(0);
      } else {
        if (insertAtBeginning) {
          this._categories = this._mergeCategories(categories, this._categories);
        } else {
          this._categories = this._mergeCategories(this._categories, categories);
        }
      }

      this._updateCategoriesMap();
      this._updateAllCategory();
    }

    /**
     * Merges the given `newCategories` into the given `categories`.
     * @param {Object[]} categories
     * @param {Object[]} newCategories
     * @returns {Object[]}
     */

  }, {
    key: '_mergeCategories',
    value: function _mergeCategories(categories, newCategories) {
      categories = __WEBPACK_IMPORTED_MODULE_4_globals__["m" /* Utils */].cloneCategories(categories, 'stickers');

      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default()(newCategories), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          var newCategory = _step.value;

          var duplicateCategory = false;
          var _iteratorNormalCompletion2 = true;
          var _didIteratorError2 = false;
          var _iteratorError2 = undefined;

          try {
            for (var _iterator2 = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default()(categories), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
              var existingCategory = _step2.value;

              if (newCategory.identifier === existingCategory.identifier) {
                // Add completely new stickers to the end of the category and
                // overwrite existing sticker properties with duplicate entries
                var _iteratorNormalCompletion3 = true;
                var _didIteratorError3 = false;
                var _iteratorError3 = undefined;

                try {
                  for (var _iterator3 = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default()(newCategory.stickers), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
                    var newSticker = _step3.value;

                    var duplicateSticker = false;
                    var _iteratorNormalCompletion4 = true;
                    var _didIteratorError4 = false;
                    var _iteratorError4 = undefined;

                    try {
                      for (var _iterator4 = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default()(existingCategory.stickers), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {
                        var existingSticker = _step4.value;

                        if (newSticker.identifier === existingSticker.identifier) {
                          __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default()(existingSticker, newSticker);
                          duplicateSticker = true;
                          break;
                        }
                      }
                    } catch (err) {
                      _didIteratorError4 = true;
                      _iteratorError4 = err;
                    } finally {
                      try {
                        if (!_iteratorNormalCompletion4 && _iterator4.return) {
                          _iterator4.return();
                        }
                      } finally {
                        if (_didIteratorError4) {
                          throw _iteratorError4;
                        }
                      }
                    }

                    if (!duplicateSticker) {
                      existingCategory.stickers.push(newSticker);
                    }
                  }
                } catch (err) {
                  _didIteratorError3 = true;
                  _iteratorError3 = err;
                } finally {
                  try {
                    if (!_iteratorNormalCompletion3 && _iterator3.return) {
                      _iterator3.return();
                    }
                  } finally {
                    if (_didIteratorError3) {
                      throw _iteratorError3;
                    }
                  }
                }

                duplicateCategory = true;
                break;
              }
            }
          } catch (err) {
            _didIteratorError2 = true;
            _iteratorError2 = err;
          } finally {
            try {
              if (!_iteratorNormalCompletion2 && _iterator2.return) {
                _iterator2.return();
              }
            } finally {
              if (_didIteratorError2) {
                throw _iteratorError2;
              }
            }
          }

          if (!duplicateCategory) {
            categories.push(newCategory);
          }
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }

      return categories;
    }

    /**
     * Updates the categories map
     * @private
     */

  }, {
    key: '_updateCategoriesMap',
    value: function _updateCategoriesMap() {
      var _this2 = this;

      this._categoriesById = {};
      this._categories.forEach(function (c) {
        _this2._categoriesById[c.identifier] = c;
      });

      // Build sticker id => sticker hash
      this._categories.forEach(function (c) {
        c.stickers.forEach(function (s) {
          _this2._stickersById[s.identifier] = s;
        });
      });

      // Filter stickers
      if (typeof this._options.availableStickers !== 'undefined' && this._options.availableStickers !== null) {
        this._categories.forEach(function (category) {
          // Stickers uploaded by the end users should not be affected by this filter
          // That features can be disabled separately using the customUploadDisabled
          // controlsOption.
          if (category.identifier !== CUSTOM_CATEGORY_ID) {
            category.stickers = category.stickers.filter(function (sticker) {
              return _this2._options.availableStickers.indexOf(sticker.identifier) !== -1;
            });
          }
        });

        this._categories = this._categories.filter(function (category) {
          return category.stickers.length > 0;
        });
      }

      this._updateAllCategory();
    }

    /**
     * Updates the `all` category which contains all stickers
     * @private
     */

  }, {
    key: '_updateAllCategory',
    value: function _updateAllCategory() {
      this._allCategory = {
        identifier: 'all',
        defaultName: 'All',
        stickers: this._categories.map(function (c) {
          return c.stickers;
        }).reduce(function (a, b) {
          return a.concat(b);
        }, [])
      };
      this._categoriesById.all = this._allCategory;
    }
  }, {
    key: 'renderStickerThumbnailFromImage',
    value: function renderStickerThumbnailFromImage(image) {
      var canvas = this._customStickerCanvas;

      var context = canvas.getContext('2d');
      context.save();

      var thumbWidth = 62;
      var scale = thumbWidth / image.width;
      var thumbHeight = scale * image.height;
      canvas.width = thumbWidth;
      canvas.height = thumbWidth;
      context.clearRect(0, 0, image.width, image.height);
      context.translate(0, 0.5 * (canvas.height - thumbHeight));
      context.scale(scale, scale);
      context.drawImage(image, 0, 0);
      var thumbURL = canvas.toDataURL('image/png');

      context.restore();

      return {
        data: thumbURL,
        width: thumbWidth,
        height: thumbHeight
      };
    }

    /**
     * Creates a new custom sticker from the specified image
     * @param {Image} image
     */

  }, {
    key: 'addCustomStickerFromImage',
    value: function addCustomStickerFromImage(image, name) {
      var _this3 = this;

      var tintMode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'none';

      var needsResize = function needsResize(image) {
        // Most of this is taken from the image-resizer implementation
        // We don't need (or want) the image-resizer to do the actual resizing,
        // since it does it asynchronously for some reason
        var sdk = _this3._ui.getEditor().getSDK();
        var renderer = sdk.getRenderer();
        var dimensions = new __WEBPACK_IMPORTED_MODULE_4_globals__["n" /* Vector2 */](image.width, image.height);
        var maxPixels = _this3._ui.getEditor().getMaxMegapixels() * 1000000;
        var maxDimensions = renderer.getMaxDimensions();
        var exceedsMaxPixels = dimensions.x * dimensions.y > maxPixels;
        var exceedsMaxDimensions = maxDimensions !== null && (dimensions.x > maxDimensions || dimensions.y > maxDimensions);

        if (exceedsMaxPixels) {
          var ratioHV = image.width / image.height;
          var ratioVH = image.height / image.width;
          maxDimensions = new __WEBPACK_IMPORTED_MODULE_4_globals__["n" /* Vector2 */](Math.sqrt(maxPixels * ratioHV), Math.sqrt(maxPixels * ratioVH)).floor().max();
        }

        var safeDimensions = dimensions.clone();
        if (exceedsMaxPixels || exceedsMaxDimensions) {
          if (dimensions.x / dimensions.y > 1) {
            safeDimensions.x = maxDimensions;
            safeDimensions.y = maxDimensions / dimensions.x * dimensions.y;
          } else {
            safeDimensions.x = maxDimensions / dimensions.y * dimensions.x;
            safeDimensions.y = maxDimensions;
          }
        }
        return safeDimensions;
      };

      var scaledSizeWithLongerSide = function scaledSizeWithLongerSide(imageSize, maxDimension) {
        var aspect = imageSize.x / imageSize.y;
        if (aspect > 1) {
          return new __WEBPACK_IMPORTED_MODULE_4_globals__["n" /* Vector2 */](maxDimension, maxDimension / aspect);
        } else {
          return new __WEBPACK_IMPORTED_MODULE_4_globals__["n" /* Vector2 */](maxDimension * aspect, maxDimension);
        }
      };

      var isSVG = image.src.substring(0, 14) === 'data:image/svg';

      var sdk = this._ui.getEditor().getSDK();
      image = sdk.correctExifOrientation(image);
      // Resize the image if necessary
      var svgSize = scaledSizeWithLongerSide(new __WEBPACK_IMPORTED_MODULE_4_globals__["n" /* Vector2 */](image.width, image.height), 2048);
      var safeDimensions = isSVG ? svgSize : needsResize(image);

      // Render sticker into canvas to get base64 encoded url
      var canvas = this._customStickerCanvas;

      var context = canvas.getContext('2d');
      context.save();

      // Thumbnail
      var thumb = this.renderStickerThumbnailFromImage(image);

      // Base image
      if (isSVG) {
        if (image.width > image.height) {
          canvas.width = 2048;
          canvas.height = 2048 / image.width * image.height;
        } else {
          canvas.height = 2048;
          canvas.width = 2048 / image.height * image.width;
        }
        image.width = canvas.width;
        image.height = canvas.height;
      } else {
        canvas.width = safeDimensions.x;
        canvas.height = safeDimensions.y;
        context.scale(safeDimensions.x / image.width, safeDimensions.y / image.height);
      }

      context.drawImage(image, 0, 0, image.width, image.height);
      var baseURL = canvas.toDataURL();

      context.restore();

      var sticker = {
        identifier: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["Utils"].generateUUID(),
        defaultName: name || '',
        tintMode: tintMode,
        images: {
          mediaThumb: {
            uris: [thumb.data],
            rawData: true,
            width: thumb.width,
            height: thumb.height
          },
          mediaBase: {
            // We add the base64 svg data to be included in the serialization
            uris: isSVG ? [baseURL, image.src] : [baseURL],
            rawData: true,
            isSVG: isSVG,
            width: safeDimensions.x,
            height: safeDimensions.y
          }
        }
      };

      var assetsLibrary = this._dynamicAssetsLibrary;
      assetsLibrary.addAsset('sticker', sticker, true);
      var customStickers = assetsLibrary.getAssets('sticker');

      if (customStickers.length === 1) {
        // Add a new category for all custom stickers
        var customCategory = this._createCustomStickerCategory(customStickers);

        // This also updates the "all" category
        this._addCategories([customCategory], false, true);
      } else {
        this.getCategory(CUSTOM_CATEGORY_ID).stickers = customStickers;
        this._updateAllCategory();
      }
      this._updateCategoriesMap();
    }
  }, {
    key: '_createCustomStickerCategory',
    value: function _createCustomStickerCategory(stickers) {
      return {
        identifier: CUSTOM_CATEGORY_ID,
        defaultName: 'Custom',
        metaData: {
          backgroundImage: stickers[stickers.length - 1].images.mediaBase.uris[0],
          rawData: true
        },
        stickers: stickers
      };
    }

    /**
     * Returns the stickers for the category with the given name
     * @param  {String} categoryName
     * @return {Object[]}
     */

  }, {
    key: 'getStickersForCategory',
    value: function getStickersForCategory(categoryName) {
      if (!this._categoriesById[categoryName]) {
        throw new Error('Unknown sticker category \'' + categoryName + '\'');
      }
      return this._categoriesById[categoryName].stickers;
    }

    /**
     * Returns the sticker with the given identifier
     * @param  {String} identifier
     */

  }, {
    key: 'getStickerByIdentifier',
    value: function getStickerByIdentifier(identifier) {
      return this._stickersById[identifier];
    }

    /**
     * Returns the categories
     * @param {Boolean} includeAllCategory = false
     * @return {Object[]}
     */

  }, {
    key: 'getCategories',
    value: function getCategories() {
      var includeAllCategory = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      if (includeAllCategory) {
        return [this._allCategory].concat(this._categories);
      }

      return this._categories;
    }

    /**
     * Returns the category object for the given id
     * @param  {String} id
     * @return {Object}
     */

  }, {
    key: 'getCategory',
    value: function getCategory(id) {
      return this._categoriesById[id];
    }

    /**
     * Returns the URL for the given sticker. If the user is using Internet Explorer, we
     * fall back to the svg variant (if present)
     * @param  {Object} sticker
     * @param  {String} size
     * @return {String}
     */

  }], [{
    key: 'getURLForSticker',
    value: function getURLForSticker(sticker) {
      var size = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'base';
      var images = sticker.images;

      var media = size === 'base' ? images.mediaBase || images.mediaThumb : images.mediaThumb;
      var uris = media.uris || [media.uri];
      if (typeof __WEBPACK_IMPORTED_MODULE_4_globals__["m" /* Utils */].Browser !== 'undefined' && !__WEBPACK_IMPORTED_MODULE_4_globals__["m" /* Utils */].Browser.getIEVersion()) {
        var svgs = uris.filter(function (f) {
          return (/\.svg$/i.test(f)
          );
        });
        return svgs.length ? svgs[0] : uris[0];
      } else {
        var notSvgs = uris.filter(function (f) {
          return !/\.svg$/i.test(f);
        });
        return notSvgs.length ? notSvgs[0] : uris[0];
      }
    }
  }]);

  return StickerManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (StickerManager);

/***/ }),
/* 135 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__loaders_google_font_loader__ = __webpack_require__(493);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__loaders_file_font_loader__ = __webpack_require__(496);





var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FontLoader = function () {
  function FontLoader(ui, fonts) {
    _classCallCheck(this, FontLoader);

    this._ui = ui;
    this._fonts = fonts;
    this._loadedFonts = [];
  }

  /**
   * Sets the fonts
   * @param {Font[]} fonts
   */


  _createClass(FontLoader, [{
    key: 'setFonts',
    value: function setFonts(fonts) {
      this._fonts = fonts;
    }

    /**
     * Checks if the font loader needs to load something
     * @return {Boolean}
     */

  }, {
    key: 'needsToLoad',
    value: function needsToLoad() {
      var _this = this;

      var _loop = function _loop(i) {
        var provider = void 0;
        _this._fonts[i].getVariations().forEach(function (variation) {
          provider = provider || variation.getProvider();
        });
        if (!provider) return 'continue';
        return {
          v: true
        };
      };

      for (var i = 0; i < this._fonts.length; i++) {
        var _ret = _loop(i);

        switch (_ret) {
          case 'continue':
            continue;

          default:
            if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === "object") return _ret.v;
        }
      }
    }

    /**
     * Checks if the given font has already been loaded
     * @param  {Font} font
     */

  }, {
    key: 'fontLoaded',
    value: function fontLoaded(font) {
      var identifier = font.getFontFamily();
      return this._loadedFonts.indexOf(identifier) !== -1;
    }

    /**
     * Sets the given font to loaded
     * @param {Font} font
     */

  }, {
    key: 'setFontLoaded',
    value: function setFontLoaded(font) {
      if (!this.fontLoaded(font)) {
        var identifier = font.getFontFamily();
        this._loadedFonts.push(identifier);
      }
    }

    /**
     * Loads the given fonts
     * @param  {Object[]} fonts
     */

  }, {
    key: 'load',
    value: function load() {
      var _this2 = this;

      var fonts = this._fonts;
      var loaders = {
        google: new __WEBPACK_IMPORTED_MODULE_4__loaders_google_font_loader__["a" /* default */](this._ui),
        file: new __WEBPACK_IMPORTED_MODULE_5__loaders_file_font_loader__["a" /* default */](this._ui)
      };

      var disposeLoaders = function disposeLoaders() {
        for (var identifier in loaders) {
          var loader = loaders[identifier];
          loader.dispose();
        }
      };

      fonts.filter(function (font) {
        return !_this2.fontLoaded(font);
      }).forEach(function (font) {
        font.getVariations().forEach(function (variation) {
          var provider = variation.getProvider();
          if (!provider) return;

          var loader = loaders[provider];
          loader.add(variation);
        });
      });

      var promises = [];
      for (var name in loaders) {
        promises.push(loaders[name].load());
      }
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.all(promises).then(function () {
        disposeLoaders();
        fonts.forEach(function (font) {
          _this2.setFontLoaded(font);
        });
      }).catch(function (e) {
        disposeLoaders();
        throw e;
      });
    }
  }]);

  return FontLoader;
}();

/* harmony default export */ __webpack_exports__["a"] = (FontLoader);

/***/ }),
/* 136 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = !__webpack_require__(19) && !__webpack_require__(42)(function () {
  return Object.defineProperty(__webpack_require__(94)('div'), 'a', { get: function () { return 7; } }).a != 7;
});


/***/ }),
/* 137 */
/***/ (function(module, exports, __webpack_require__) {

var has = __webpack_require__(43);
var toIObject = __webpack_require__(35);
var arrayIndexOf = __webpack_require__(232)(false);
var IE_PROTO = __webpack_require__(100)('IE_PROTO');

module.exports = function (object, names) {
  var O = toIObject(object);
  var i = 0;
  var result = [];
  var key;
  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);
  // Don't enum bug & hidden keys
  while (names.length > i) if (has(O, key = names[i++])) {
    ~arrayIndexOf(result, key) || result.push(key);
  }
  return result;
};


/***/ }),
/* 138 */
/***/ (function(module, exports, __webpack_require__) {

var document = __webpack_require__(16).document;
module.exports = document && document.documentElement;


/***/ }),
/* 139 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)
var has = __webpack_require__(43);
var toObject = __webpack_require__(44);
var IE_PROTO = __webpack_require__(100)('IE_PROTO');
var ObjectProto = Object.prototype;

module.exports = Object.getPrototypeOf || function (O) {
  O = toObject(O);
  if (has(O, IE_PROTO)) return O[IE_PROTO];
  if (typeof O.constructor == 'function' && O instanceof O.constructor) {
    return O.constructor.prototype;
  } return O instanceof Object ? ObjectProto : null;
};


/***/ }),
/* 140 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__globals__ = __webpack_require__(38);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__operations___ = __webpack_require__(166);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__lib_operations_stack__ = __webpack_require__(169);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__lib_exif__ = __webpack_require__(120);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__lib_image__ = __webpack_require__(89);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__lib_image_exporter__ = __webpack_require__(317);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__lib_performance_test__ = __webpack_require__(168);








var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 * @license
 */








var bd = function bd(str) {
  return Utils.byteArrayToString(Base64.decode(str));
};

var Rectangle = __WEBPACK_IMPORTED_MODULE_7__globals__["Rectangle"],
    Constants = __WEBPACK_IMPORTED_MODULE_7__globals__["Constants"],
    Engine = __WEBPACK_IMPORTED_MODULE_7__globals__["Engine"],
    Utils = __WEBPACK_IMPORTED_MODULE_7__globals__["Utils"],
    EventEmitter = __WEBPACK_IMPORTED_MODULE_7__globals__["EventEmitter"],
    Events = __WEBPACK_IMPORTED_MODULE_7__globals__["Events"],
    Vector2 = __WEBPACK_IMPORTED_MODULE_7__globals__["Vector2"],
    Log = __WEBPACK_IMPORTED_MODULE_7__globals__["Log"],
    Base64 = __WEBPACK_IMPORTED_MODULE_7__globals__["Base64"],
    Color = __WEBPACK_IMPORTED_MODULE_7__globals__["Color"];
var RenderType = Constants.RenderType,
    ImageFormat = Constants.ImageFormat,
    RendererType = Constants.RendererType;

/**
 * The main SDK class which handles rendering and manages
 * operations.
 * @class
 * @alias PhotoEditorSDK
 */

var PhotoEditorSDK = function (_EventEmitter) {
  _inherits(PhotoEditorSDK, _EventEmitter);

  /**
   * Creates a PhotoEditorSDK instance
   * @param  {String} [preferredRenderer = webgl] - `webgl` or `canvas`
   * @param  {Object} options
   * @param  {String} options.license - Your license
   * @param  {Image} [options.image] - The image that should be rendered
   * @param  {String} [options.renderMode = dynamic] - `dynamic` or `export`
   * @param  {Boolean} [options.versionCheck = true] - Should a version check be performed?
   * @param  {Boolean} [options.displayWelcomeMessage = true] - Should a welcome message be printed
   *   in the console?
   * @param  {Boolean} [options.transparent = false] - Should the canvas background be transparent?
   * @param  {HTMLCanvasElement} [options.canvas] - The canvas element the SDK should render to
   * @param  {Number} [options.zoom = 1] - The zoom level. Only available in `dynamic` mode
   * @param  {Number} [options.spriteScale = 1] - The output sprite's scale. Only available in `dynamic` mode
   * @param  {String} [options.logLevel = warn] - `trace`, `info`, `warn`, `error` or `log`
   * @param  {Number} [options.pixelRatio = 1] - If none is given, PhotoEditorSDK automatically
   * @param  {String} [options.crossOrigin = 'anonymous'] - 'anonymous', 'use-credentials' or 'none'
   *   detects the current device's pixel ratio
   * @param  {Boolean} [options.smoothDownscaling = false] - Toggles smooth downscaling
   * @param  {Boolean} [options.smoothUpscaling = false] - Toggles smooth upscaling
   */
  function PhotoEditorSDK(preferredRenderer) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, PhotoEditorSDK);

    var _this = _possibleConstructorReturn(this, (PhotoEditorSDK.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(PhotoEditorSDK)).call(this));

    _this._onOperationUpdate = _this._onOperationUpdate.bind(_this);
    _this._onContextRestored = _this._onContextRestored.bind(_this);

    var _require = __webpack_require__(170),
        version = _require.version;

    _this.version = version;

    _this[bd('VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=')] = true;
    _this._preferredRenderer = preferredRenderer;
    _this._options = Utils.defaults(options, {
      extensions: {},
      renderMode: 'dynamic',
      versionCheck: true,
      displayWelcomeMessage: true,
      image: null,
      canvas: null,
      transparent: false,
      clearColor: Color.TRANSPARENT,
      textureQuality: 1,
      zoom: 1,
      spriteScale: 1,
      rotation: 0,
      smoothDownscaling: false,
      smoothUpscaling: false,
      crossOrigin: 'anonymous',
      logLevel: 'warn',
      pixelRatio: typeof window !== 'undefined' && window.devicePixelRatio || 1
    });

    if (_this._options.smoothUpscaling) {
      Engine.BaseTexture.DefaultMagFilter = Engine.BaseTexture.LinearFilter;
    }

    _this._options.extensions = Utils.defaults(_this._options.extensions, {
      operations: [],
      controls: [],
      languages: []
    });

    Log.setLevel(_this._options.logLevel);

    _this[bd('Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=')] = false;

    // Check for free-license mode first, then for license
    if (!_this[bd('X29wdGlvbnM=')][bd('bGljZW5zZQ==')]) {
      _this[bd('Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=')] = true;
      _this._l = new __WEBPACK_IMPORTED_MODULE_7__globals__[bd('RnJlZUxpY2Vuc2VDaGVja2Vy')]();
    } else {
      if (!_this._v()) return _possibleConstructorReturn(_this);

      // const L = globals.LicenseChecker
      var L = __WEBPACK_IMPORTED_MODULE_7__globals__[bd('TGljZW5zZUNoZWNrZXI=')];
      // this._l = new LicenseChecker(this._options.license)
      _this._l = new L(_this[bd('X29wdGlvbnM=')][bd('bGljZW5zZQ==')]);
      _this._cv(true).then(function () {
        _this._ct();
      }).catch(function (e) {
        Log.error(bd('TGljZW5zaW5n'), e.message);
      });
    }

    _this._defaultRenderMode = _this._options.renderMode;
    _this._renderMode = _this._options.renderMode;

    _this._textureQuality = _this._options.textureQuality;
    _this._offset = new Vector2();
    _this._zoom = _this._options.zoom;
    _this._spriteScale = _this._options.spriteScale;
    _this._rotation = _this._options.rotation;
    _this._operations = {};
    _this._operationsStack = null;
    _this.setOperationsStack(new __WEBPACK_IMPORTED_MODULE_9__lib_operations_stack__["a" /* default */]());

    // Engine stuff
    _this._container = new Engine.Container();
    _this._sprite = new Engine.Sprite();
    _this._container.addChild(_this._sprite);

    _this._inputTexture = _this._options.inputTexture;
    _this._currentInputTexture = null;
    _this._currentTexture = null;

    _this._resizedTexture = null;
    _this._resizedContainer = new Engine.Container();
    _this._resizedSprite = new Engine.Sprite();
    _this._resizedContainer.addChild(_this._resizedSprite);

    // Textures that are flagged for disposal at the end of the next render
    _this._texturesToDispose = [];

    _this.setSmoothDownscaling(_this._options.smoothDownscaling);

    _this._registerOperations();
    _this._initRenderer();

    var renderer = _this._renderer.constructor.type;
    if (_this._options.displayWelcomeMessage) {
      Log.log('Version:', _this.version + ' (' + renderer + ') - https://www.photoeditorsdk.com');
    }

    // Print free-license mode message
    if (_this[bd('Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=')]) {
      Log.log(bd('VGhlIFBob3RvRWRpdG9yIFNESyBpcyBhIGNvbW1lcmNpYWwgcHJvZHVjdC4gQmV' + 'mb3JlIGJlaW5nIGFibGUgdG8gdXNlIGl0IHdpdGhvdXQgbGltaXRhdGlvbnMsIH' + 'lvdSBuZWVkIHRvIHVubG9jayB0aGUgU0RLIHdpdGggYSBsaWNlbnNlIGZpbGUuI' + 'FlvdSBjYW4gb2J0YWluIGEgdGltZS1saW1pdGVkIGV2YWx1YXRpb24gbGljZW5z' + 'ZSBieSBzdGFydGluZyBhIHRyaWFsIGF0IGh0dHBzOi8vd3d3LnBob3RvZWRpdG9' + 'yc2RrLmNvbS91c2Vycy9uZXcgb3IgeW91IGNhbiBwdXJjaGFzZSBhIGxpY2Vuc2' + 'UgYnkgcmVxdWVzdGluZyBhIHF1b3RlIGF0IGh0dHBzOi8vd3d3LnBob3RvZWRpd' + 'G9yc2RrLmNvbS9wcmljaW5nLgoKQmVjYXVzZSB5b3UgZGlkIG5vdCBzcGVjaWZ5' + 'IGEgbGljZW5zZSBmaWxlIHlldCwgdGhlIFNESyB3aWxsIG5vdyBkaXNwbGF5IGE' + 'gd2F0ZXJtYXJrIGltYWdlIG9uIHRvcCBvZiBhbnkgcGhvdG9zIHlvdSBkaXNwbG' + 'F5IG9yIGV4cG9ydCB3aXRoIGl0LiBGb3IgaW5zdHJ1Y3Rpb25zIGZvciBob3cgd' + 'G8gdW5sb2NrIHRoZSBTREssIHBsZWFzZSB2aXNpdCBodHRwczovL2RvY3MucGhv' + 'dG9lZGl0b3JzZGsuY29tL2d1aWRlcy9odG1sNS92NC9pbnRyb2R1Y3Rpb24vZ2V' + '0dGluZ19zdGFydGVkLg=='));
    }

    // Async image handling
    if (_this._options.image) {
      _this.setImage(_this._options.image, _this._options.exif);
    }
    return _this;
  }

  /**
   * Validates presence of the license
   * @return {Boolean}
   * @private
   */


  _createClass(PhotoEditorSDK, [{
    key: '_v',
    value: function _v() {
      // this._options.license
      if (!this[bd('X29wdGlvbnM=')][bd('bGljZW5zZQ==')]) {
        // Log.error('license', 'No `license` option given.')
        Log.error(bd('TGljZW5zaW5n'), bd('Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbi4='));
        Log.error(bd('TGljZW5zaW5n'), bd('SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg=='));
        return false;
      }
      return true;
    }

    /**
     * Checks if license expires at some point, prints message about days left
     * @private
     */

  }, {
    key: '_ct',
    value: function _ct() {
      if (this._l.exp()) {
        var expired = this._l.isExp();
        if (expired) {
          Log.error(bd('TGljZW5zaW5n'), bd('WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCB1cyBhdCBzYWxlc0BwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZS4='));
        } else {
          Log.warn(bd('TGljZW5zaW5n'), bd('WW91ciB0cmlhbCBsaWNlbnNlIHdpbGwgZXhwaXJlIGluICVkIGRheXMu').replace('%d', this._l.dl()));
        }
      }
    }

    /**
     * Checks for valid license
     * @return {Promise}
     * @private
     */

  }, {
    key: '_cv',
    value: function _cv() {
      var _this2 = this;

      var print = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      return this._l.c().catch(function (e) {
        _this2[bd('VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=')] = false;
        var errorMessage = bd('SW52YWxpZCBsaWNlbnNlLg==');
        if (print) {
          if (e.code === 'ELICEXP') {
            // 'Your trial license has expired. Please contact us at sales@photoeditorsdk.com to obtain a license.'
            errorMessage = bd('WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCB1cyBhdCBzYWxlc0BwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZS4=');
          } else if (e.code === 'ELICINVHOST') {
            // 'This license is not valid for the hostname ...'
            errorMessage = bd('VGhpcyBsaWNlbnNlIGlzIG5vdCB2YWxpZCBmb3IgdGhlIGhvc3RuYW1lIA==') + window.location.hostname + '.';
          } else if (e.code === 'ELICINVPLAT') {
            // 'This license is not valid for the current platform.'
            errorMessage = bd('VGhpcyBsaWNlbnNlIGlzIG5vdCB2YWxpZCBmb3IgdGhlIGN1cnJlbnQgcGxhdGZvcm0u');
          } else if (e.code === 'ELICINVFMT') {
            // 'Invalid license format. Please make sure you're passing your license as a string, not as \`$format\`.'
            errorMessage = bd('SW52YWxpZCBsaWNlbnNlIGZvcm1hdC4gUGxlYXNlIG1ha2Ugc3VyZSB5b3UncmUgcGFzc2luZyB5b3VyIGxpY2Vuc2UgYXMgYSBzdHJpbmcsIG5vdCBhcyBgJGZvcm1hdGAu').replace('$format', _typeof(_this2._options.license));
          } else if (e.code === 'ELICINV') {
            // 'Invalid license! Please contact our sales staff at support@photoeditorsdk.com to obtain a license or log in to your customer dashboard.'
            errorMessage = bd('SW52YWxpZCBsaWNlbnNlISBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc3VwcG9ydEBwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZSBvciBsb2cgaW4gdG8geW91ciBjdXN0b21lciBkYXNoYm9hcmQu');
          } else {
            // 'In case you don't have a license yet, please contact our sales staff at sales@photoeditorsdk.com to obtain a license or log in to your customer dashboard.'
            errorMessage = bd('SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==');
          }
        }
        e.message = errorMessage;
        throw new Error(e);
      });
    }

    /**
     * Tracks an export / edit
     * @private
     */

  }, {
    key: '_t',
    value: function _t() {
      this._l.t();
    }

    /**
     * Whether the SDK is running in 'free-license mode'
     * @private
     */

  }, {
    key: '_fl',
    value: function _fl() {
      return this[bd('Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=')]; // eslint-disable-line valid-typeof
    }

    // -------------------------------------------------------------------------- EVENTS

    /**
     * Gets called when an operation is updated. Delegates the event.
     * @private
     */

  }, {
    key: '_onOperationUpdate',
    value: function _onOperationUpdate() {
      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      this.emit.apply(this, [Events.OPERATION_UPDATED].concat(args));
    }

    /**
     * Gets called when the WebGL context has been restored. Re-triggers a render.
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_onContextRestored',
    value: function _onContextRestored() {
      Log.warn(this.constructor.name, 'Trying to re-render after WebGL context has been restored.');
      this.setAllOperationsToDirty();
      this._operationsStack.forEach(function (operation) {
        operation.disposeRenderTextures();
      });
      this.render();
    }

    // -------------------------------------------------------------------------- RENDERING

    /**
     * Exports the image with the given options. Result of the Promise is the exported image or data url.
     * @param  {PhotoEditorSDK.RenderType} [renderType=PhotoEditorSDK.RenderType.DATAURL] - The output type
     * @param  {PhotoEditorSDK.ImageFormat} [imageFormat=PhotoEditorSDK.ImageFormat.PNG] - The output image format
     * @param  {Number} [quality=0.8] - The image quality, between 0 and 1
     * @return {Promise}
     */

  }, {
    key: 'export',
    value: function _export() {
      var renderType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : RenderType.DATAURL;

      var _this3 = this;

      var imageFormat = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ImageFormat.PNG;
      var quality = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0.8;

      return this._cv(true).then(function () {
        if (_this3.hasChanges()) {
          _this3._t(); // track exports
        }
        _this3._operationsStack.forEach(function (op) {
          op.onBeforeExport();
        });
        var imageExporter = new __WEBPACK_IMPORTED_MODULE_12__lib_image_exporter__["a" /* default */](_this3, {
          renderType: renderType, imageFormat: imageFormat, quality: quality
        });
        return imageExporter.export().then(function (result) {
          _this3._operationsStack.forEach(function (op) {
            op.onAfterExport();
          });
          return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve(result);
        });
      });
    }

    /**
     * Renders the current image to the canvas
     * @param {Boolean} renderOutput = true
     * @return {Promise}
     */

  }, {
    key: 'render',
    value: function render() {
      var _this4 = this;

      var renderOutput = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

      if (!this._inputTexture) {
        throw new Error('You need to set an image before calling PhotoEditorSDK#render.');
      }

      var context = this._renderer.getContext();
      if (context.startFrame) {
        context.startFrame();
      }

      var perfTest = void 0;
      if (Log.canLog('info')) {
        perfTest = new __WEBPACK_IMPORTED_MODULE_13__lib_performance_test__["a" /* default */]('⚡⚡⚡', 'Frame rendering');
      }
      Log.info('⚡⚡⚡', 'Rendering starts');

      var stack = this._operationsStack;
      stack.updateDirtinessForRenderer(this._renderer);

      return this._prepareTexture().then(function (texture) {
        if (_this4._renderMode === 'export') {
          texture = _this4._inputTexture;
        }

        _this4._currentTexture = texture;
        _this4._sprite.setTexture(texture);
        _this4._container.updateTransform();
      }).then(function () {
        return stack.validateSettings();
      }).then(function () {
        // Make sure the watermark is applied when there is no license
        // or if the license is expired or otherwise invalid
        if (_this4._fl() || !_this4[bd('VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=')]) {
          if (!stack.getByIdentifier('license-watermark')) {
            _this4.createOperation('license-watermark');
          } else {
            stack.moveToTop('license-watermark');
          }
        }
        return stack.render(_this4, _this4._currentTexture);
      }).then(function (response) {
        var outputTexture = response.outputTexture;

        // Input texture has been passed through all operations which return
        // a new RenderTexture. Use this texture for the Sprite and render it
        // to the output canvas.

        _this4._currentTexture = outputTexture;
        _this4._sprite.setTexture(_this4._currentTexture);

        switch (_this4._renderMode) {
          case 'dynamic':
            // Always center image, set scale to zoom level
            var center = _this4._renderer.getDimensions().clone().divide(2).add(_this4._offset);

            _this4._container.setScale(_this4._zoom / _this4.getTextureScale(), _this4._zoom / _this4.getTextureScale());
            _this4._container.setPosition(center);
            _this4._sprite.setAnchor(0.5, 0.5);
            _this4._sprite.setScale(_this4._spriteScale, _this4._spriteScale);
            _this4._sprite.setRotation(_this4._rotation);
            break;
          case 'export':
            // Move sprite to upper left hand corner, render at full scale
            _this4._container.setScale(1, 1);
            _this4._container.setPosition(0, 0);
            _this4._sprite.setAnchor(0, 0);
            _this4._sprite.setPosition(0, 0);
            _this4._sprite.setScale(_this4._spriteScale, _this4._spriteScale);
            _this4._sprite.setRotation(0);
            break;
          case 'adapter':
            _this4._container.setScale(1, 1);
            _this4._container.setPosition(0, 0);
            _this4._sprite.setAnchor(0, 0);
            _this4._sprite.setPosition(0, 0);
            _this4._sprite.setScale(1, 1);
            _this4._sprite.setRotation(0);
            break;
        }

        // This renders to the output
        if (renderOutput) {
          _this4._renderer.render(_this4._container);
        }

        return response;
      }).then(function (response) {
        if (perfTest) {
          perfTest.stop();
        }
        if (context.endFrame) {
          context.endFrame();
        }
        // Dispose flagged textures
        _this4._disposeTextures();

        return response;
      });
    }
  }, {
    key: 'getTextureScale',
    value: function getTextureScale() {
      return Math.min(1, this._textureQuality * this._options.pixelRatio);
    }

    /**
     * Prepares the input texture for the current zoom level
     * @private
     */

  }, {
    key: '_prepareTexture',
    value: function _prepareTexture() {
      var _this5 = this;

      return new __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var textureScale = _this5.getTextureScale();
        if (_this5._textureQuality === 1) {
          return resolve(_this5._inputTexture);
        }

        var dimensions = _this5.getInputDimensions().multiply(textureScale).floor();

        var needsRerender = void 0;
        if (!_this5._resizedTexture) {
          _this5._resizedTexture = new Engine.RenderTexture(_this5._renderer, dimensions.x, dimensions.y);
          needsRerender = true;
        } else if (!_this5._resizedTexture.getDimensions().equals(dimensions)) {
          _this5._resizedTexture.resizeTo(dimensions);
          needsRerender = true;
        }

        if (needsRerender) {
          _this5._resizedSprite.setScale(textureScale, textureScale);
          _this5._resizedSprite.setTexture(_this5._inputTexture);
          _this5._resizedTexture.render(_this5._resizedContainer);
        }

        resolve(_this5._resizedTexture);
      });
    }

    // -------------------------------------------------------------------------- OPERATIONS

    /**
     * Registers all default operations
     * @private
     */

  }, {
    key: '_registerOperations',
    value: function _registerOperations() {
      this._operations = {};

      for (var operationName in __WEBPACK_IMPORTED_MODULE_8__operations___) {
        var operation = __WEBPACK_IMPORTED_MODULE_8__operations___[operationName];
        this._operations[operation.identifier] = operation;
      }

      this._operations = Utils.extend(this._operations, this._options.extensions.operations);
    }

    /**
     * Registers the given operations
     * @param  {PhotoEditorSDK.Operation[]} operations
     */

  }, {
    key: 'registerOperations',
    value: function registerOperations(operations) {
      var _this6 = this;

      operations.forEach(function (operation) {
        _this6._operations[operation.identifier] = operation;
      });
    }

    /**
     * Sets all operations in the stack to dirty
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setAllOperationsToDirty',
    value: function setAllOperationsToDirty() {
      var dimensionsChanged = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      this._operationsStack.setAllToDirty(dimensionsChanged);
    }

    /**
     * Creates an operation with the given identifier
     * @param {String} identifier
     * @param {Object} [options = {}]
     * @param {Boolean} [addToStack = true]
     * @returns {PhotoEditorSDK.Operation}
     */

  }, {
    key: 'createOperation',
    value: function createOperation(identifier) {
      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var addToStack = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

      var Operation = this._operations[identifier];
      if (!Operation) {
        throw new Error('No operation with identifier `' + identifier + '` found.');
      }

      var operation = new Operation(this, options);
      if (addToStack) {
        this.addOperation(operation);
      }
      return operation;
    }

    /**
     * Adds the given operation to the operations stack
     * @param {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'addOperation',
    value: function addOperation(operation) {
      this._operationsStack.push(operation);
    }

    /**
     * Removes the given operation from the operations stack
     * @param  {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'removeOperation',
    value: function removeOperation(operation) {
      this._operationsStack.remove(operation);
    }

    // -------------------------------------------------------------------------- DIMENSIONS

    /**
     * Returns the initial image dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getInputDimensions',
    value: function getInputDimensions() {
      var frame = this._inputTexture.getFrame();
      return new Vector2(frame.width, frame.height);
    }

    /**
     * Returns the final dimensions that the input image would have
     * after all existing operations have been applied
     * @param {Boolean} incorporateSpriteScale = false
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getFinalDimensions',
    value: function getFinalDimensions() {
      var incorporateSpriteScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var dimensions = this.getInputDimensions();
      var operationsStack = this._operationsStack;

      operationsStack.forEach(function (operation) {
        if (!operation.getEnabled()) return;
        dimensions = operation.getNewDimensions(dimensions);
      });

      if (incorporateSpriteScale) {
        dimensions.multiply(this._spriteScale);
      }

      return dimensions.floor();
    }

    /**
     * Returns the current sprite dimensions
     * @param {Boolean} incorporateSpriteScale = false
     * @return {Vector2}
     */

  }, {
    key: 'getOutputDimensions',
    value: function getOutputDimensions() {
      var incorporateSpriteScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      return this.getFinalDimensions(incorporateSpriteScale).clone().multiply(this._zoom).floor();
    }

    /**
     * Returns the dimensions of the output texture
     * @param  {Boolean} incorporateSpriteScale = false
     * @return {Vector2}
     */

  }, {
    key: 'getOutputTextureDimensions',
    value: function getOutputTextureDimensions() {

      var textureScale = this.getTextureScale();
      var dimensions = this.getInputDimensions().multiply(textureScale).floor();
      this._operationsStack.forEach(function (op) {
        dimensions = op.getNewDimensions(dimensions);
      });
      return dimensions;
    }
  }, {
    key: 'getCrossOrigin',
    value: function getCrossOrigin() {
      return Utils.getCrossOrigin(this._options.crossOrigin || 'Anonymous');
    }

    // -------------------------------------------------------------------------- MISC

    /**
     * Initializes the renderer
     * @private
     */

  }, {
    key: '_initRenderer',
    value: function _initRenderer() {
      var rendererOptions = {
        canvas: this._options.canvas,
        pixelRatio: this._options.pixelRatio,
        debug: this._options.debug,
        transparent: this._options.transparent,
        clearColor: this._options.clearColor
      };

      var width = void 0,
          height = void 0;
      if (this._renderMode !== 'export' && this._options.canvas) {
        var canvas = this._options.canvas;

        width = canvas.width;
        height = canvas.height;
      } else if (this._inputTexture) {
        var dimensions = this.getFinalDimensions();
        width = dimensions.x;
        height = dimensions.y;
      } else {
        width = 1;
        height = 1;
      }

      switch (this._preferredRenderer) {
        /* istanbul ignore next */
        case RendererType.WEBGL:
          this._renderer = Engine.autoDetectRenderer(width, height, rendererOptions);
          this._renderer.on('context-restored', this._onContextRestored);
          break;
        case RendererType.CANVAS:
          this._renderer = new Engine.CanvasRenderer(width, height, rendererOptions);
          this._renderer.on('context-restored', this._onContextRestored);
          break;
        default:
          Log.warn('PhotoEditorSDK', 'PhotoEditorSDK Error: Renderer `' + this._preferredRenderer + '` not supported. Falling back to automatically detected renderer.');
          this._renderer = Engine.autoDetectRenderer(width, height, rendererOptions);
      }
    }

    /**
     * Resizes the renderer to the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     */

  }, {
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      this._renderer.resizeTo(dimensions, true);
    }

    /**
     * Resets all custom and selected operations
     */

  }, {
    key: 'reset',
    value: function reset() {
      this._operationsStack.clear();
    }

    // -------------------------------------------------------------------------- EXIF

    /**
     * Parses the exif data from the given image
     * @param {Image} image
     * @returns {Exif|undefined}
     * @private
     */

  }, {
    key: 'parseExif',
    value: function parseExif(image) {
      if (!image) {
        return;
      }
      var src = image.src;

      var isJPEG = false;
      var base64String = null;

      {
        isJPEG = __WEBPACK_IMPORTED_MODULE_10__lib_exif__["a" /* default */].isJPEG(src);
        base64String = src;
      }

      if (isJPEG) {
        var exif = null;
        try {
          exif = __WEBPACK_IMPORTED_MODULE_10__lib_exif__["a" /* default */].fromBase64String(base64String);
        } catch (e) {}
        if (!exif) {
          return;
        }

        return exif;
      }
    }

    /**
     * Reads the EXIF orientation tag and fixes it with the OrientationOperation
     * @private
     */

  }, {
    key: '_handleExifOrientation',
    value: function _handleExifOrientation() {
      var exifTags = this._exif.getTags();

      if (exifTags && exifTags.Orientation) {
        var rotationNeedsChange = exifTags.Orientation !== 1 && exifTags.Orientation !== 2;
        var flipNeedsChange = [2, 4, 5, 7].indexOf(exifTags.Orientation) !== -1;

        if (rotationNeedsChange || flipNeedsChange) {
          if (!this._exifOperation) {
            this._exifOperation = this.createOperation('exif-orientation');
          }
          this._exifOperation.setTags(exifTags);

          // We fixed the orientation, new EXIF orientation is 1
          this._exif.setOrientation(1);
        }
      }
    }

    /**
     * Parses the exif data and fixes the orientation of the image if necessary.
     * @param {Image} image
     * @returns {Image|Canvas}
     * @private
     */

  }, {
    key: 'correctExifOrientation',
    value: function correctExifOrientation(image) {
      var exifData = this.parseExif(image);
      if (!exifData) {
        return image;
      }
      var tags = exifData.getTags();
      if (tags && tags.Orientation) {
        var rotationNeedsChange = tags.Orientation !== 1 && tags.Orientation !== 2;
        var flipNeedsChange = [2, 4, 5, 7].indexOf(tags.Orientation) !== -1;
        if (rotationNeedsChange || flipNeedsChange) {
          var exifOperation = this.createOperation('exif-orientation', {}, false);
          exifOperation.setTags(tags);
          var correctedImage = exifOperation.applyTo(image);
          exifData.setOrientation(1);
          tags.Orientation = 1;
          return correctedImage;
        }
      }
      return image;
    }

    // -------------------------------------------------------------------------- GETTERS / SETTERS

    /**
     * Checks if an image is provided
     * @return {Boolean} [description]
     */

  }, {
    key: 'hasImage',
    value: function hasImage() {
      return this._image !== null && typeof this._image !== 'undefined';
    }

    /**
     * Returns the image
     * @return {Image}
     */

  }, {
    key: 'getImage',
    value: function getImage() {
      return this._image;
    }

    /**
     * Flag a texture for disposal at the end of the next render.
     * @param {PhotoEditorSDK.Engine.Texture} texture
     */

  }, {
    key: 'disposeTexture',
    value: function disposeTexture(texture) {
      this._texturesToDispose.push(texture);
    }

    /**
     * Dispose the flagged textures.
     */

  }, {
    key: '_disposeTextures',
    value: function _disposeTextures() {
      for (var i = 0; i < this._texturesToDispose.length; i++) {
        this._texturesToDispose[i].dispose();
      }

      this._texturesToDispose = [];
    }

    /**
     * Sets the image and parses the exif data
     * @param {Image} image
     * @param {PhotoEditorSDK.Exif} [exif = null]
     * @param {PhotoEditorSDK.Math.Vector2} [dimensions]
     */

  }, {
    key: 'setImage',
    value: function setImage(image) {
      var exif = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      var dimensions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;

      // Dispose all textures that are no longer being used
      this._disposeTextures();

      // Reset exif orientation compensation
      if (this._exifOperation) {
        this.removeOperation(this._exifOperation);
        this._exifOperation = null;
      }

      this._options.image = image;
      this._image = image;

      this._exif = exif || this.parseExif(image);
      if (this._exif) {
        this._handleExifOrientation();
      }

      var baseTexture = new Engine.BaseTexture(this._image);
      var frame = new Rectangle(0, 0, this._image.naturalWidth || this._image.width, this._image.naturalHeight || this._image.height);
      if (dimensions) {
        frame.width = dimensions.x;
        frame.height = dimensions.y;
      }

      if (this._resizedTexture) {
        this._resizedTexture.dispose();
      }
      this._resizedTexture = null;

      if (this._inputTexture) {
        this.disposeTexture(this._inputTexture.getBaseTexture());
      }
      this._inputTexture = new Engine.Texture(baseTexture, frame);
      this._currentTexture = this._inputTexture;

      this._sprite.clearTexture(false);
      this._sprite.setTexture(this._inputTexture);

      this.emit('new-image');
      this.setAllOperationsToDirty(true);
    }

    /**
     * Set the input texture for this SDK as an alternative to passing in an image
     * @param {PhotoEditorSDK.Engine.Texture} texture
     */

  }, {
    key: 'setInputTexture',
    value: function setInputTexture(texture) {
      this._inputTexture = texture;
    }

    /**
     * Returns the canvas
     * @return {HTMLCanvasElement}
     */

  }, {
    key: 'getCanvas',
    value: function getCanvas() {
      return this._renderer.getCanvas();
    }

    /**
     * Sets the canvas
     * @param {HTMLCanvasElement} canvas
     */

  }, {
    key: 'setCanvas',
    value: function setCanvas(canvas) {
      this._renderer.setCanvas(canvas);
    }

    /**
     * Returns the sprite
     * @return {PhotoEditorSDK.Engine.Sprite}
     */

  }, {
    key: 'getSprite',
    value: function getSprite() {
      return this._sprite;
    }

    /**
     * Returns the container
     * @return {PhotoEditorSDK.Engine.Container}
     */

  }, {
    key: 'getContainer',
    value: function getContainer() {
      return this._container;
    }

    /**
     * Returns the operation stack
     * @return {PhotoEditorSDK.OperationsStack}
     */

  }, {
    key: 'getOperationsStack',
    value: function getOperationsStack() {
      return this._operationsStack;
    }

    /**
     * Sets the operations stack
     * @param {PhotoEditorSDK.OperationsStack} operationsStack
     */

  }, {
    key: 'setOperationsStack',
    value: function setOperationsStack(operationsStack) {
      if (this._operationsStack) {
        this._operationsStack.off(Events.OPERATION_UPDATED, this._onOperationUpdate);
      }

      this._operationsStack = operationsStack;
      this._operationsStack.on(Events.OPERATION_UPDATED, this._onOperationUpdate);
    }

    /**
     * Returns the available operations
     * @return {Operation[]}
     */

  }, {
    key: 'getOperations',
    value: function getOperations() {
      return this._operations;
    }

    /**
     * Returns the renderer
     * @return {PhotoEditorSDK.Engine.BaseRenderer}
     */

  }, {
    key: 'getRenderer',
    value: function getRenderer() {
      return this._renderer;
    }

    /**
     * Returns the rendering offset
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getOffset',
    value: function getOffset() {
      return this._offset;
    }

    /**
     * Sets the rendering offset
     * @param {PhotoEditorSDK.Math.Vector2|Number} offset
     * @param {Number} y
     */

  }, {
    key: 'setOffset',
    value: function setOffset(offset, y) {
      if (offset instanceof Vector2) {
        this._offset.copy(offset);
      } else {
        this._offset.set(offset, y);
      }
    }

    /**
     * Returns the current render mode
     * @return {String}
     */

  }, {
    key: 'getRenderMode',
    value: function getRenderMode() {
      return this._renderMode;
    }

    /**
     * Sets the render mode
     * @param {String} renderMode
     */

  }, {
    key: 'setRenderMode',
    value: function setRenderMode(renderMode) {
      this._renderMode = renderMode;
    }

    /**
     * Returns the zoom level
     * @return {Number}
     */

  }, {
    key: 'getZoom',
    value: function getZoom() {
      return this._zoom;
    }

    /**
     * Sets the zoom level
     * @param {Number} zoom
     */

  }, {
    key: 'setZoom',
    value: function setZoom(zoom) {
      this._zoom = zoom;
      this._container.setScale(this._zoom, this._zoom);
      this._container.updateTransform();
    }

    /**
     * Returns the texture quality
     * @return {Number}
     */

  }, {
    key: 'getTextureQuality',
    value: function getTextureQuality() {
      if (this._renderMode === 'export') {
        return 1;
      }

      return this._textureQuality;
    }

    /**
     * Sets the texture quality
     * @param {Number} textureQuality
     */

  }, {
    key: 'setTextureQuality',
    value: function setTextureQuality(textureQuality) {
      if (textureQuality !== this._textureQuality) {
        this.setAllOperationsToDirty(true);
      }
      this._textureQuality = Math.min(1, textureQuality);

      // Clean up resized texture, not needed right now
      if (this._textureQuality === 1 && this._resizedTexture) {
        this._resizedTexture.dispose();
        this._resizedTexture = null;
      }
    }

    /**
     * Returns the output sprite's scale
     * @return {Number}
     */

  }, {
    key: 'getSpriteScale',
    value: function getSpriteScale() {
      return this._spriteScale;
    }

    /**
     * Sets the sprite scale to the given value
     * @param {Number} spriteScale
     */

  }, {
    key: 'setSpriteScale',
    value: function setSpriteScale(spriteScale) {
      this._spriteScale = spriteScale;
      this._sprite.setScale(spriteScale, spriteScale);
      this._sprite.updateTransform();
    }

    /**
     * Returns the pixel ratio
     * @return {Number}
     */

  }, {
    key: 'getPixelRatio',
    value: function getPixelRatio() {
      return this._options.pixelRatio;
    }

    /**
     * Returns the Exif instance
     * @return {PhotoEditorSDK.Exif} [description]
     */

  }, {
    key: 'getExif',
    value: function getExif() {
      return this._exif;
    }

    /**
     * Returns the options
     * @return {Object}
     */

  }, {
    key: 'getOptions',
    value: function getOptions() {
      return this._options;
    }

    /**
     * Returns the input texture
     * @return {PhotoEditorSDK.Engine.Texture}
     */

  }, {
    key: 'getInputTexture',
    value: function getInputTexture() {
      return this._inputTexture;
    }

    /**
     * Sets the smooth downscaling flag for the output sprite
     * @param {Boolean} smoothDownscaling
     */

  }, {
    key: 'setSmoothDownscaling',
    value: function setSmoothDownscaling(smoothDownscaling) {
      this._options.smoothDownscaling = smoothDownscaling;
      this._sprite.setSmoothDownscaling(smoothDownscaling);
      this._resizedSprite.setSmoothDownscaling(smoothDownscaling);
    }

    /**
     * Sets the rotation to the given value
     * @param {Number} rotation
     */

  }, {
    key: 'setRotation',
    value: function setRotation(rotation) {
      this._rotation = rotation;
    }

    /**
     * Returns the current rotation
     */

  }, {
    key: 'getRotation',
    value: function getRotation() {
      return this._rotation;
    }

    /**
     * Check if the OperationsStack has changes
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return this.getOperationsStack().hasChanges();
    }
    // -------------------------------------------------------------------------- DISPOSAL

    /**
     * Disposes the SDK
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._operationsStack.dispose();
      this._renderer.dispose();
      if (this._exif) {
        this._exif.dispose();
      }
      if (this._resizedTexture) {
        this._resizedTexture.dispose();
      }
    }
  }]);

  return PhotoEditorSDK;
}(EventEmitter);

/* harmony default export */ __webpack_exports__["a"] = (PhotoEditorSDK);

/***/ }),
/* 141 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(34);


/***/ }),
/* 142 */
/***/ (function(module, exports) {

module.exports = function (done, value) {
  return { value: value, done: !!done };
};


/***/ }),
/* 143 */
/***/ (function(module, exports, __webpack_require__) {

// 7.2.2 IsArray(argument)
var cof = __webpack_require__(59);
module.exports = Array.isArray || function isArray(arg) {
  return cof(arg) == 'Array';
};


/***/ }),
/* 144 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)
var $keys = __webpack_require__(137);
var hiddenKeys = __webpack_require__(102).concat('length', 'prototype');

exports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {
  return $keys(O, hiddenKeys);
};


/***/ }),
/* 145 */
/***/ (function(module, exports, __webpack_require__) {

// call something on iterator step with safe closing on error
var anObject = __webpack_require__(28);
module.exports = function (iterator, fn, value, entries) {
  try {
    return entries ? fn(anObject(value)[0], value[1]) : fn(value);
  // 7.4.6 IteratorClose(iterator, completion)
  } catch (e) {
    var ret = iterator['return'];
    if (ret !== undefined) anObject(ret.call(iterator));
    throw e;
  }
};


/***/ }),
/* 146 */
/***/ (function(module, exports, __webpack_require__) {

// check on default Array iterator
var Iterators = __webpack_require__(51);
var ITERATOR = __webpack_require__(17)('iterator');
var ArrayProto = Array.prototype;

module.exports = function (it) {
  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);
};


/***/ }),
/* 147 */
/***/ (function(module, exports, __webpack_require__) {

// 7.3.20 SpeciesConstructor(O, defaultConstructor)
var anObject = __webpack_require__(28);
var aFunction = __webpack_require__(56);
var SPECIES = __webpack_require__(17)('species');
module.exports = function (O, D) {
  var C = anObject(O).constructor;
  var S;
  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);
};


/***/ }),
/* 148 */
/***/ (function(module, exports) {

module.exports = function (exec) {
  try {
    return { e: false, v: exec() };
  } catch (e) {
    return { e: true, v: e };
  }
};


/***/ }),
/* 149 */
/***/ (function(module, exports, __webpack_require__) {

var anObject = __webpack_require__(28);
var isObject = __webpack_require__(23);
var newPromiseCapability = __webpack_require__(113);

module.exports = function (C, x) {
  anObject(C);
  if (isObject(x) && x.constructor === C) return x;
  var promiseCapability = newPromiseCapability.f(C);
  var resolve = promiseCapability.resolve;
  resolve(x);
  return promiseCapability.promise;
};


/***/ }),
/* 150 */
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__(16);
var core = __webpack_require__(11);
var dP = __webpack_require__(22);
var DESCRIPTORS = __webpack_require__(19);
var SPECIES = __webpack_require__(17)('species');

module.exports = function (KEY) {
  var C = typeof core[KEY] == 'function' ? core[KEY] : global[KEY];
  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {
    configurable: true,
    get: function () { return this; }
  });
};


/***/ }),
/* 151 */
/***/ (function(module, exports, __webpack_require__) {

var ITERATOR = __webpack_require__(17)('iterator');
var SAFE_CLOSING = false;

try {
  var riter = [7][ITERATOR]();
  riter['return'] = function () { SAFE_CLOSING = true; };
  // eslint-disable-next-line no-throw-literal
  Array.from(riter, function () { throw 2; });
} catch (e) { /* empty */ }

module.exports = function (exec, skipClosing) {
  if (!skipClosing && !SAFE_CLOSING) return false;
  var safe = false;
  try {
    var arr = [7];
    var iter = arr[ITERATOR]();
    iter.next = function () { return { done: safe = true }; };
    arr[ITERATOR] = function () { return iter; };
    exec(arr);
  } catch (e) { /* empty */ }
  return safe;
};


/***/ }),
/* 152 */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ());
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] };

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),
/* 153 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(260), __esModule: true };

/***/ }),
/* 154 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vector2__ = __webpack_require__(45);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Represents a 3-dimensional matrix
 * @class
 * @memberof PhotoEditorSDK.Math
 */

var Matrix = function () {
  /**
   * Creates a Matrix
   */
  function Matrix() {
    _classCallCheck(this, Matrix);

    this.reset();
  }

  /**
   * Multiplies this matrix with the given one
   * @param  {PhotoEditorSDK.Math.Matrix} matrix
   * @return {PhotoEditorSDK.Math.Matrix}
   */


  _createClass(Matrix, [{
    key: 'multiply',
    value: function multiply(matrix) {
      var a = void 0,
          b = void 0,
          c = void 0,
          d = void 0,
          tx = void 0,
          ty = void 0;
      a = this.a * matrix.a + this.b * matrix.c;
      b = this.a * matrix.b + this.b * matrix.d;
      c = this.c * matrix.a + this.d * matrix.c;
      d = this.c * matrix.b + this.d * matrix.d;
      tx = this.tx * matrix.a + this.ty * matrix.c + matrix.tx;
      ty = this.tx * matrix.b + this.ty * matrix.d + matrix.ty;

      this.a = a;
      this.b = b;
      this.c = c;
      this.d = d;
      this.tx = tx;
      this.ty = ty;
      return this;
    }

    /**
     * Applies this matrix to the given vector
     * @param  {PhotoEditorSDK.Math.Vector2} position
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'applyToVector',
    value: function applyToVector(position) {
      var _position = position,
          x = _position.x,
          y = _position.y;

      position = position.clone();
      position.x = this.a * x + this.c * y + this.tx;
      position.y = this.b * x + this.d * y + this.tx;
      return position;
    }

    /**
     * Applies the inverse of this matrix to the given vector
     * @param  {PhotoEditorSDK.Math.Vector2} position
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'applyInverseToVector',
    value: function applyInverseToVector(position) {
      var determinant = 1 / (this.a * this.d + this.c * -this.b);

      var _position2 = position,
          x = _position2.x,
          y = _position2.y;

      position = position.clone();
      position.x = this.d * determinant * x + -this.c * determinant * y + (this.ty * this.c - this.tx * this.d) * determinant;
      position.y = this.a * determinant * y + -this.b * determinant * x + (-this.ty * this.a + this.tx * this.b) * determinant;

      return position;
    }

    /**
     * Turns the given rectangle into vector coordinates by applying this Matrix
     * @param  {PhotoEditorSDK.Math.Rectangle} rectangle
     * @param  {PhotoEditorSDK.Math.Vector2} anchor
     * @return {PhotoEditorSDK.Math.Vector2[]}
     */

  }, {
    key: 'rectangleToCoordinates',
    value: function rectangleToCoordinates(rectangle) {
      var anchor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](0, 0);

      // Anchor offsets (w0 = right, w1 = left, h0 = up, h1 = down)
      var w0 = rectangle.width * (1 - anchor.x);
      var w1 = rectangle.width * -anchor.x;
      var h0 = rectangle.height * (1 - anchor.y);
      var h1 = rectangle.height * -anchor.y;

      var positions = [];

      // Bottom Left
      positions.push(new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.a * w1 + this.c * h1 + this.tx, this.d * h1 + this.b * w1 + this.ty));

      // Bottom Right
      positions.push(new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.a * w0 + this.c * h1 + this.tx, this.d * h1 + this.b * w0 + this.ty));

      // Top Right
      positions.push(new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.a * w0 + this.c * h0 + this.tx, this.d * h0 + this.b * w0 + this.ty));

      // Top Left
      positions.push(new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.a * w1 + this.c * h0 + this.tx, this.d * h0 + this.b * w1 + this.ty));

      return positions;
    }

    /**
     * Resets this matrix to the identity matrix
     */

  }, {
    key: 'reset',
    value: function reset() {
      this.a = 1;
      this.b = 0;
      this.c = 0;
      this.d = 1;
      this.tx = 0;
      this.ty = 0;
    }

    /**
     * Returns an array representation of this matrix
     * @return {Float32Array}
     */

  }, {
    key: 'toArray',
    value: function toArray() {
      var arr = [this.a, this.b, 0, this.c, this.d, 0, this.tx, this.ty, 1];
      /* istanbul ignore next */
      if (typeof Float32Array === 'undefined') {
        return arr;
      }
      return new Float32Array(arr);
    }

    /**
     * Returns a string representation of this matrix
     * @return {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'Matrix({ a: ' + this.a + ', b: ' + this.b + ', c: ' + this.c + ', d: ' + this.d + ', tx: ' + this.tx + ', ty: ' + this.ty + ' })';
    }

    /**
     * The identity matrix
     * @static
     * @type {PhotoEditorSDK.Math.Matrix}
     */

  }], [{
    key: 'IDENTITY',
    get: function get() {
      return new Matrix();
    }
  }]);

  return Matrix;
}();

/* harmony default export */ __webpack_exports__["a"] = (Matrix);

/***/ }),
/* 155 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vector2__ = __webpack_require__(45);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Represents a Rectangle
 * @class
 * @memberof PhotoEditorSDK.Math
 */

var Rectangle = function () {
  /**
   * Creartes a Rectangle
   * @param {Number} [x = 0]
   * @param {Number} [y = 0]
   * @param {Number} [width  = 0]
   * @param {Number} [height = 0]
   */
  function Rectangle() {
    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    var width = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
    var height = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;

    _classCallCheck(this, Rectangle);

    this.x = x;
    this.y = y;
    this.width = width;
    this.height = height;
  }

  /**
   * Sets the given values
   * @param {Number} x
   * @param {Number} y
   * @return {PhotoEditorSDK.Math.Rectangle}
   */


  _createClass(Rectangle, [{
    key: 'set',
    value: function set(x, y, width, height) {
      this.x = x;
      this.y = y;
      this.width = width;
      this.height = height;
      return this;
    }

    /**
     * Creates a clone of this rectangle
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'clone',
    value: function clone() {
      return new Rectangle(this.x, this.y, this.width, this.height);
    }

    /**
     * Copies the values of the given rectangle
     * @param  {PhotoEditorSDK.Math.Rectangle} other
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'copy',
    value: function copy(other) {
      this.x = other.x;
      this.y = other.y;
      this.width = other.width;
      this.height = other.height;
      return this;
    }

    /**
     * Checks whether this rectangle's values are the same as the given ones
     * @param  {(Number|PhotoEditorSDK.Math.Rectangle)} rect
     * @param  {Number} y
     * @param  {Number} width
     * @param  {Number} height
     * @return {Boolean}
     */

  }, {
    key: 'equals',
    value: function equals(rect, y, width, height) {
      if (rect instanceof Rectangle) {
        return rect.x === this.x && rect.y === this.y && rect.width === this.width && rect.height === this.height;
      } else {
        var x = rect;
        return x === this.x && y === this.y && width === this.width && height === this.height;
      }
    }
  }, {
    key: 'translate',
    value: function translate(tx, ty) {
      if (tx instanceof __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */]) {
        ty = tx.y;
        tx = tx.x;
      }

      this.x += tx;
      this.y += ty;

      return this;
    }
  }, {
    key: 'scale',
    value: function scale(sx, sy) {
      if (sx instanceof __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */]) {
        sy = sx.y;
        sx = sx.x;
      } else if (sy === undefined) {
        sy = sx;
      }

      this.width *= sx;
      this.height *= sy;

      return this;
    }

    /**
     * Rounds this rectangle's values
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'round',
    value: function round() {
      this.x = Math.round(this.x);
      this.y = Math.round(this.y);
      this.width = Math.round(this.width);
      this.height = Math.round(this.height);
      return this;
    }
  }, {
    key: 'getPosition',
    value: function getPosition() {
      return new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.x, this.y);
    }
  }, {
    key: 'getSize',
    value: function getSize() {
      return new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.width, this.height);
    }
  }, {
    key: 'insetBy',
    value: function insetBy(dx, dy) {
      this.x += dx;
      this.y += dy;

      this.width -= 2 * dx;
      this.height -= 2 * dy;

      return this;
    }
  }, {
    key: 'intersects',
    value: function intersects(rect) {
      var p1 = new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.x, this.y);
      var p2 = new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](this.x + this.width, this.y + this.height);

      var q1 = new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](rect.x, rect.y);
      var q2 = new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](rect.x + rect.width, rect.y + rect.height);

      if (q1.x > p2.x || p1.x > q2.x || q2.y < p1.y || p2.y < q1.y) {
        return false;
      }

      return true;
    }

    /**
     * Returns a string representation of this rectangle
     * @return {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'Rectangle({ x: ' + this.x + ', y: ' + this.y + ', width: ' + this.width + ', height: ' + this.height + ' })';
    }
  }], [{
    key: 'FromDiagonalPoints',
    value: function FromDiagonalPoints(p1, p2) {
      var inverted = false;

      if (p2.x - p1.x < 0) {
        inverted = true;
      }

      var topLeft = inverted ? p2 : p1;
      var bottomRight = inverted ? p1 : p2;
      var width = bottomRight.x - topLeft.x;
      var height = bottomRight.y - topLeft.y;

      return new Rectangle(topLeft.x, topLeft.y, width, height);
    }
  }]);

  return Rectangle;
}();

/* harmony default export */ __webpack_exports__["a"] = (Rectangle);

/***/ }),
/* 156 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_log__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_ua_parser_js__ = __webpack_require__(271);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_ua_parser_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_ua_parser_js__);


function _defineProperty(obj, key, value) { if (key in obj) { __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/* istanbul ignore next */
/* harmony default export */ __webpack_exports__["a"] = ({
  /**
   * Checks if the currently bound framebuffer is complete
   * @param  {String} tag
   * @param  {WebGLRenderingContext} gl
   * @ignore
   */
  checkFramebufferStatus: function checkFramebufferStatus(tag, gl) {
    var _possibleStatuses;

    var fboStatus = gl.checkFramebufferStatus(gl.FRAMEBUFFER);

    var possibleStatuses = (_possibleStatuses = {}, _defineProperty(_possibleStatuses, gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT, 'Incomplete attachment'), _defineProperty(_possibleStatuses, gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT, 'Missing attachment'), _defineProperty(_possibleStatuses, gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS, 'Incomplete dimensions'), _defineProperty(_possibleStatuses, gl.FRAMEBUFFER_UNSUPPORTED, 'Framebuffer unsupported'), _possibleStatuses);

    if (fboStatus !== gl.FRAMEBUFFER_COMPLETE) {
      __WEBPACK_IMPORTED_MODULE_1__shared_log__["a" /* default */].warn(tag, 'Framebuffer incomplete: ' + possibleStatuses[fboStatus]);
    }
  },
  determineGPUName: function determineGPUName(gl) {
    var gpuName = null;
    var canvas = null;
    if (!gl) {
      canvas = document.createElement('canvas');
      gl = canvas.getContext('experimental-webgl') || canvas.getContext('webgl');
    }
    var ext = gl && gl.getExtension('WEBGL_debug_renderer_info');
    if (ext) {
      gpuName = gl.getParameter(ext.UNMASKED_RENDERER_WEBGL);
      canvas && canvas.remove();
    }

    return gpuName;
  },
  isGPUBlacklisted: function isGPUBlacklisted(gpuname) {

    return false;
    // // Unfortunately, there is a known bug in OS X Mojave with some Intel Chipsets
    // userAgent = userAgent && window.navigator.userAgent
    // const uaParser = new UAParser()
    // const os = uaParser.getOS()
    // const gpu = {name: gpuname}
    // const hasChipsetErrors = (os, gpu) => (
    //   ((os.name === 'Mac OS') && os.version.startsWith('10.14')) && (
    //     (gpu.name === 'Intel(R) Iris(TM) Graphics 6100') || (gpu.name === 'Intel® Iris(TM) Graphics 6100') ||
    //     (gpu.name === 'Intel Iris OpenGL Engine') ||
    //     (gpu.name === 'Intel Iris Pro OpenGL Engine') ||
    //     (gpu.name === 'Intel HD Graphics 5000 OpenGL Engine') ||
    //     (gpu.name === 'Intel(R) HD Graphics 6000') || (gpu.name === 'Intel® HD Graphics 6000') ||
    //     (gpu.name === 'Intel(R) HD Graphics 5300') || (gpu.name === 'Intel® HD Graphics 5300')
    //   )
    // )
    // return hasChipsetErrors(os, gpu)
  }
});

/***/ }),
/* 157 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(12);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var now = typeof window !== 'undefined' && window.performance && window.performance.now ? window.performance.now.bind(window.performance) : __webpack_require__(86);

/**
 * Hooks into a rendering context (WebGLRenderingContext or CanvasRenderingContext2D),
 * mocks its methods and measures the time consumed by the method calls. When `endFrame`
 * is called, it prints a performance report
 * @class
 * @memberof PhotoEditorSDK.Engine
 * @ignore
 */

var ContextPerformanceHook = function () {
  function ContextPerformanceHook(context) {
    var _this = this;

    _classCallCheck(this, ContextPerformanceHook);

    this._context = context;
    this._tracking = false;

    var self = this;

    var _loop = function _loop(key) {
      var value = context[key];
      if (typeof value === 'function') {
        _this[key] = function () {
          for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
            args[_key] = arguments[_key];
          }

          var fn = context[key];
          if (!self._tracking) {
            return fn.apply(context, args);
          }

          var start = now();
          var result = fn.apply(context, args);
          var time = now() - start;

          var call = {
            functionName: key,
            arguments: args,
            duration: time
          };
          self._trackedCalls.push(call);

          return result;
        };
      } else {
        _this._makePropertyWrapper(key);
      }
    };

    for (var key in context) {
      _loop(key);
    }
  }

  /**
   * Creates the getter and setter for the given property
   * @param  {String} property
   * @private
   */


  _createClass(ContextPerformanceHook, [{
    key: '_makePropertyWrapper',
    value: function _makePropertyWrapper(property) {
      var insecureProperties = ['_context', '_trackedCalls', '_tracking'];
      if (insecureProperties.indexOf(property) !== -1) return;

      var context = this._context;

      this.__defineGetter__(property, function () {
        return context[property];
      });

      this.__defineSetter__(property, function (value) {
        context[property] = value;
      });
    }

    /**
     * Starts tracking a frame
     */

  }, {
    key: 'startFrame',
    value: function startFrame() {
      this._tracking = true;
      this._trackedCalls = [];
    }

    /**
     * Stops tracking a frame and prints a performance report
     */

  }, {
    key: 'endFrame',
    value: function endFrame() {
      var tag = 'Rendering';
      __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].log(tag, 'Frame rendering results:');
      __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].log(tag, 'Context calls: ' + this._trackedCalls.length);

      var groupedCalls = {};
      this._trackedCalls.forEach(function (_ref) {
        var functionName = _ref.functionName,
            duration = _ref.duration;

        groupedCalls[functionName] = groupedCalls[functionName] || {
          totalDuration: 0,
          calls: 0
        };

        groupedCalls[functionName].totalDuration += duration;
        groupedCalls[functionName].calls++;
      });

      var callsArray = [];
      for (var key in groupedCalls) {
        var data = groupedCalls[key];
        data.averageDuration = data.totalDuration / data.calls;

        callsArray.push({ functionName: key, data: data });
      }

      callsArray.sort(function (a, b) {
        return b.data.totalDuration - a.data.totalDuration;
      });
      callsArray = callsArray.slice(0, 3);

      callsArray.forEach(function (item) {
        __WEBPACK_IMPORTED_MODULE_1__globals__["f" /* Log */].log(tag, item.functionName + ': ' + item.data.calls + ' calls, ' + item.data.totalDuration.toFixed(2) + 'ms');
      });
    }
  }]);

  return ContextPerformanceHook;
}();

/* harmony default export */ __webpack_exports__["a"] = (ContextPerformanceHook);

/***/ }),
/* 158 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_utils__ = __webpack_require__(272);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * The base class for all renderers
 * @class
 * @memberof PhotoEditorSDK.Engine
 */

var BaseRenderer = function (_EventEmitter) {
  _inherits(BaseRenderer, _EventEmitter);

  /**
   * Create a BaseRenderer instance
   * @param  {Number} width
   * @param  {Number} height
   * @param  {Object} options = {}
   * @param  {Number} [options.pixelRatio = 1]
   * @param  {PhotoEditorSDK.Color} [options.clearColor = PhotoEditorSDK.Color.TRANSPARENT]
   * @param  {Boolean} [options.debug = false]
   */
  function BaseRenderer(width, height) {
    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

    _classCallCheck(this, BaseRenderer);

    var _this = _possibleConstructorReturn(this, (BaseRenderer.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(BaseRenderer)).call(this));

    _this._options = __WEBPACK_IMPORTED_MODULE_5__utils_utils__["a" /* default */].defaults(options, {
      pixelRatio: 1,
      transparent: false,
      clearColor: __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */].BLACK,
      debug: false
    });

    _this.setMaxListeners(0);
    _this._width = width || 800;
    _this._height = height || 600;
    _this._dimensions = new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](_this._width, _this._height);
    _this._maxTextureSize = null;
    _this._pixelRatio = _this._options.pixelRatio;
    _this._clearColor = _this._options.transparent ? __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */].TRANSPARENT : _this._options.clearColor || __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */].BLACK;
    return _this;
  }

  /**
   * Sets the canvas to the given one
   * @param {HTMLCanvasElement} canvas
   */


  _createClass(BaseRenderer, [{
    key: 'setCanvas',
    value: function setCanvas(canvas) {
      var previousCanvas = this._canvas;
      this._canvas = canvas;

      if (previousCanvas !== canvas) {
        this._createContext();
        this._onBeforeContext();
        this._setupContext();
      }

      this.resizeTo(new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](this._width, this._height));
    }

    /**
     * Returns the current canvas
     * @return {HTMLCanvasElement}
     */

  }, {
    key: 'getCanvas',
    value: function getCanvas() {
      return this._canvas;
    }

    /**
     * Gets called before the context has been set up
     * @protected
     */

  }, {
    key: '_onBeforeContext',
    value: function _onBeforeContext() {}

    /**
     * Resizes the context and view to the given size
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @param  {Boolean} resizeCanvas = true
     */

  }, {
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      var resizeCanvas = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      this._width = dimensions.x * this._pixelRatio;
      this._height = dimensions.y * this._pixelRatio;

      if (resizeCanvas) {
        this._canvas.width = this._width;
        this._canvas.height = this._height;

        if (this._canvas.style) {
          this._canvas.style.width = this._width / this._pixelRatio + 'px';
          this._canvas.style.height = this._height / this._pixelRatio + 'px';
        }
      }

      this._dimensions = dimensions.clone();
    }

    /**
     * Gets the rendering context for this renderer
     * @returns {Object}
     * @protected
     * @abstract
     */
    /* istanbul ignore next */

  }, {
    key: '_createContext',
    value: function _createContext() {
      __WEBPACK_IMPORTED_MODULE_4__globals__["f" /* Log */].warn(this.constructor.name, '`_createContext` is abstract and not implemented in inherited class');
    }

    /**
     * Sets up the rendering context for this renderer
     * @protected
     * @abstract
     */
    /* istanbul ignore next */

  }, {
    key: '_setupContext',
    value: function _setupContext() {
      __WEBPACK_IMPORTED_MODULE_4__globals__["f" /* Log */].warn(this.constructor.name, '`_setupContext` is abstract and not implemented in inherited class');
    }

    /**
     * Renders the given displayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @abstract
     */
    /* istanbul ignore next */

  }, {
    key: 'render',
    value: function render(displayObject) {
      __WEBPACK_IMPORTED_MODULE_4__globals__["f" /* Log */].warn(this.constructor.name, '`render` is abstract and not implemented in inherited class');
    }

    /**
     * Returns the maximum dimensions
     * @return {Number}
     */
    /* istanbul ignore next */

  }, {
    key: 'getMaxDimensions',
    value: function getMaxDimensions() {
      return null;
    }

    /**
     * Returns the current rendering context
     * @return {RenderingContext}
     */

  }, {
    key: 'getContext',
    value: function getContext() {
      return this._context;
    }

    /**
     * Returns the current width
     * @return {Number}
     */

  }, {
    key: 'getWidth',
    value: function getWidth() {
      return this._dimensions.x;
    }

    /**
     * Returns the current height
     * @return {Number}
     */

  }, {
    key: 'getHeight',
    value: function getHeight() {
      return this._dimensions.y;
    }

    /**
     * Returns the current dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions() {
      return this._dimensions;
    }

    /**
     * Returns the current pixel ratio
     * @return {Number}
     */

  }, {
    key: 'getPixelRatio',
    value: function getPixelRatio() {
      return this._pixelRatio;
    }

    /**
     * Sets the pixel ratio
     * @return {Number}
     */

  }, {
    key: 'setPixelRatio',
    value: function setPixelRatio(pixelRatio) {
      this._pixelRatio = pixelRatio;
      if (this._defaultRenderTarget) {
        this._defaultRenderTarget.setPixelRatio(pixelRatio);
      }
    }

    /**
     * Returns the maximum texture size
     * @return {Number}
     */

  }, {
    key: 'getMaxTextureSize',
    value: function getMaxTextureSize() {
      return this._maxTextureSize;
    }

    /**
     * Returns the current filter manager
     * @return {PhotoEditorSDK.Engine.FilterManager}
     */

  }, {
    key: 'getFilterManager',
    value: function getFilterManager() {
      return this._filterManager;
    }

    /**
     * Sets the filter manager
     * @param {PhotoEditorSDK.Engine.FilterManager} filterManager
     */

  }, {
    key: 'setFilterManager',
    value: function setFilterManager(filterManager) {
      this._filterManager = filterManager;
    }

    /**
     * Checks if this renderer is supported on the current device and browser
     * @return {Boolean}
     */

  }, {
    key: 'isOfType',


    /**
     * Checks if this renderer's type is equal to the given one
     * @param  {String}  type
     * @return {Boolean}
     */
    value: function isOfType(type) {
      return this._type === type;
    }

    /**
     * Disposes this Renderer
     * @abstract
     */
    /* istanbul ignore next */

  }, {
    key: 'dispose',
    value: function dispose() {
      __WEBPACK_IMPORTED_MODULE_4__globals__["f" /* Log */].warn(this.constructor.name, '`dispose` is abstract and not implemented in inherited class');
    }
  }], [{
    key: 'isSupported',
    value: function isSupported() {
      return true;
    }
  }]);

  return BaseRenderer;
}(__WEBPACK_IMPORTED_MODULE_4__globals__["d" /* EventEmitter */]);

/* harmony default export */ __webpack_exports__["a"] = (BaseRenderer);

/***/ }),
/* 159 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * The base class for all ObjectRenderer classes
 * @class
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */
var ObjectRenderer = function () {
  /**
   * Creates an ObjectRenderer
   * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
   */
  function ObjectRenderer(renderer) {
    _classCallCheck(this, ObjectRenderer);

    this._renderer = renderer;

    this._onContextChange = this._onContextChange.bind(this);
    this._renderer.on('context', this._onContextChange);
  }

  /**
   * Gets called when the rendering context changes
   * @private
   */


  _createClass(ObjectRenderer, [{
    key: '_onContextChange',
    value: function _onContextChange() {}

    /**
     * Gets called when this object renderer is activated
     */

  }, {
    key: 'start',
    value: function start() {}

    /**
     * Gets called when this object renderer is deactivated
     */

  }, {
    key: 'stop',
    value: function stop() {
      this.flush();
    }

    /**
     * Renders whatever has been queued
     */

  }, {
    key: 'flush',
    value: function flush() {}

    /**
     * Disposes this ObjectRenderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._renderer.off('context', this._onContextChange);
      this._renderer = null;
    }
  }]);

  return ObjectRenderer;
}();

/* harmony default export */ __webpack_exports__["a"] = (ObjectRenderer);

/***/ }),
/* 160 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Represents a rectangle that is rendered using WebGL
 * @class
 * @memberof PhotoEditorSDK.Engine
 * @ignore
 */
/* istanbul ignore next */
var Quad = function () {
  function Quad(renderer) {
    _classCallCheck(this, Quad);

    this._renderer = renderer;
    this._context = this._renderer.getContext();

    this._vertices = new Float32Array([0, 0, 100, 0, 100, 100, 0, 100]);

    this._uvs = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]);

    this._indices = new Uint16Array([0, 1, 2, 0, 3, 2]);

    this._colors = new Float32Array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]);

    this._initBuffers();
    this._uploadBuffers();
  }

  /**
   * Maps the given rectangles to the quad
   * @param  {Rectangle} rect1
   * @param  {Rectangle} rect2
   */


  _createClass(Quad, [{
    key: "map",
    value: function map(rect1, rect2) {
      var x = rect2.x,
          y = rect2.y;

      // Update the UVs
      // We don't have any translation, so these four
      // values are all we need

      this._uvs[2] = rect2.width / rect1.width;
      this._uvs[4] = this._uvs[2];
      this._uvs[5] = rect2.height / rect1.height;
      this._uvs[7] = this._uvs[5];

      // Update the vertices
      this._vertices[0] = x;
      this._vertices[1] = y;

      this._vertices[2] = x + rect2.width;
      this._vertices[3] = y;

      this._vertices[4] = this._vertices[2];
      this._vertices[5] = y + rect2.height;

      this._vertices[6] = x;
      this._vertices[7] = this._vertices[5];

      this._uploadBuffers();
    }

    /**
     * Initializes the buffers
     * @private
     */

  }, {
    key: "_initBuffers",
    value: function _initBuffers() {
      var gl = this._context;

      if (this._vertexBuffer) {
        gl.deleteBuffer(this._vertexBuffer);
        this._vertexBuffer = null;
      }
      if (this._indexBuffer) {
        gl.deleteBuffer(this._indexBuffer);
        this._indexBuffer = null;
      }
      // Init vertex buffer
      this._vertexBuffer = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);
      gl.bufferData(gl.ARRAY_BUFFER, (8 + 8 + 16) * 4, gl.DYNAMIC_DRAW);

      this._indexBuffer = gl.createBuffer();
      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._indexBuffer);
      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this._indices, gl.STATIC_DRAW);
    }

    /**
     * Uploads the buffers
     * @private
     */

  }, {
    key: "_uploadBuffers",
    value: function _uploadBuffers() {
      var gl = this._context;

      gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);
      gl.bufferSubData(gl.ARRAY_BUFFER, 0, this._vertices);
      gl.bufferSubData(gl.ARRAY_BUFFER, 8 * 4, this._uvs);
      gl.bufferSubData(gl.ARRAY_BUFFER, (8 + 8) * 4, this._colors);
    }
  }, {
    key: "getVertexBuffer",
    value: function getVertexBuffer() {
      return this._vertexBuffer;
    }
  }, {
    key: "getIndexBuffer",
    value: function getIndexBuffer() {
      return this._indexBuffer;
    }

    /**
     * Cleans up this Quad's buffers
     */

  }, {
    key: "dispose",
    value: function dispose() {
      var gl = this._context;
      if (this._vertexBuffer) {
        gl.deleteBuffer(this._vertexBuffer);
        this._vertexBuffer = null;
      }
      if (this._indexBuffer) {
        gl.deleteBuffer(this._indexBuffer);
        this._indexBuffer = null;
      }
    }
  }]);

  return Quad;
}();

/* harmony default export */ __webpack_exports__["a"] = (Quad);

/***/ }),
/* 161 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * This class represents an image in pixel array form.
 * @ignore
 */
var PixelArrayImage = function () {
  /**
   * @param  {Number} width
   * @param  {Number} height
   * @param  {UInt8Array} data
   * @constructor
   */
  function PixelArrayImage(width, height, data) {
    _classCallCheck(this, PixelArrayImage);

    this.width = width;
    this.height = height;
    this.data = data;
  }

  /**
   * Creates a PixelArrayImage from the given `node-canvas` Image object by rendering the image
   * to a canvas and reading the pixel data
   * @param  {Canvas.Image} image
   * @return {PixelArrayImage}
   */


  _createClass(PixelArrayImage, null, [{
    key: 'fromNodeCanvasImage',
    value: function fromNodeCanvasImage(image) {
      var canvas = new Canvas(image.width, image.height);
      var context = canvas.getContext('2d');

      context.drawImage(image, 0, 0);
      var imageData = context.getImageData(0, 0, image.width, image.height);
      return new PixelArrayImage(image.width, image.height, imageData.data);
    }
  }]);

  return PixelArrayImage;
}();

/* harmony default export */ __webpack_exports__["a"] = (PixelArrayImage);

/***/ }),
/* 162 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__display_object__ = __webpack_require__(118);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * A container for DisplayObject instances
 * @class
 * @extends PhotoEditorSDK.Engine.DisplayObject
 * @memberof PhotoEditorSDK.Engine
 */

var Container = function (_DisplayObject) {
  _inherits(Container, _DisplayObject);

  /**
   * Creates a Container
   * @override
   */
  function Container() {
    var _ref;

    _classCallCheck(this, Container);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = Container.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Container)).call.apply(_ref, [this].concat(args)));

    _this._children = [];
    _this._filters = [];
    return _this;
  }

  /**
   * Adds the given filter to the filter stack
   * @param {PhotoEditorSDK.Engine.Filter} filter
   */


  _createClass(Container, [{
    key: 'addFilter',
    value: function addFilter(filter) {
      this._filters.push(filter);
    }

    /**
     * Removes the given filter from the filter stack
     * @param  {PhotoEditorSDK.Engine.Filter} filter
     * @return {Boolean} - Whether the filter has been removed
     */

  }, {
    key: 'removeFilter',
    value: function removeFilter(filter) {
      var index = this._filters.indexOf(filter);
      if (index !== -1) {
        this._filters.splice(index, 1);
        return true;
      }
      return false;
    }

    /**
     * Sets the filters
     * @param {Array.<PhotoEditorSDK.Engine.Filter>} filters
     */

  }, {
    key: 'setFilters',
    value: function setFilters(filters) {
      this._filters = filters;
    }

    /**
     * Adds the given DisplayObject to the list of children
     * @param {PhotoEditorSDK.Engine.DisplayObject} child
     */

  }, {
    key: 'addChild',
    value: function addChild(child) {
      // Remove from previous parent
      var originalParent = child.getParent();
      if (originalParent !== null) {
        originalParent.removeChild(child);
      }
      child.setParent(this);

      this._children.push(child);
    }

    /**
     * Prepends the given DisplayObject to the list of children
     * @param  {PhotoEditorSDK.Engine.DisplayObject} child
     */

  }, {
    key: 'prependChild',
    value: function prependChild(child) {
      // Remove from previous parent
      var originalParent = child.getParent();
      if (originalParent !== null) {
        originalParent.removeChild(child);
      }
      child.setParent(this);

      this._children.unshift(child);
    }

    /**
     * Checks whether this container has the given child
     * @param  {PhotoEditorSDK.Engine.DisplayObject}  child
     * @return {Boolean}
     */

  }, {
    key: 'hasChild',
    value: function hasChild(child) {
      var index = this._children.indexOf(child);
      return index !== -1;
    }

    /**
     * Removes the given object from the list of children
     * @param  {PhotoEditorSDK.Engine.DisplayObject} child
     */

  }, {
    key: 'removeChild',
    value: function removeChild(child) {
      var index = this._children.indexOf(child);
      if (index !== -1) {
        this._children.splice(index, 1);
        child.setParent(null);
      } else {
        __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].info(this.constructor.name, 'Tried to remove a child that does not exist');
      }
    }

    /**
     * Removes all children
     */

  }, {
    key: 'clearChildren',
    value: function clearChildren() {
      this._children = [];
    }

    /**
     * Renders this DisplayObject using the given WebGLRenderer
     * @param  {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     * @override
     */

  }, {
    key: 'renderWebGL',
    value: function renderWebGL(renderer) {
      if (!this._visible) {
        return;
      }

      var filterManager = renderer.getFilterManager();
      if (this._filters && this._filters.length) {
        filterManager.pushFilters(this, this._filters);
      }

      renderer.getCurrentObjectRenderer().start();

      this._renderWebGL(renderer);

      this._children.forEach(function (child) {
        child.renderWebGL(renderer);
      });

      renderer.getCurrentObjectRenderer().flush();

      if (this._filters && this._filters.length) {
        filterManager.popFilters();
      }
      renderer.getCurrentObjectRenderer().start();
    }

    /**
     * Renders the contents of this container
     * @param {PhotoEditorSDK.Engine.WebGLRenderer} renderer
     * @protected
     */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(renderer) {}

    /**
     * Renders this DisplayObject using the given CanvasRenderer
     * @param  {PhotoEditorSDK.Engine.CanvasRenderer} renderer
     * @override
     */

  }, {
    key: 'renderCanvas',
    value: function renderCanvas(renderer) {
      if (!this._visible) {
        return;
      }

      var filterManager = renderer.getFilterManager();
      if (this._filters && this._filters.length) {
        filterManager.pushFilters(this, this._filters);
      }

      this._renderCanvas(renderer);
      this._children.forEach(function (child) {
        child.renderCanvas(renderer);
      });

      if (this._filters && this._filters.length) {
        filterManager.popFilters();
      }
    }

    /**
     * Renders the contents of this container
     * @param {PhotoEditorSDK.Engine.CanvasRenderer} renderer
     * @protected
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(renderer) {}

    /**
     * Updates the world transform for this DisplayObject
     */

  }, {
    key: 'updateTransform',
    value: function updateTransform() {
      _get(Container.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Container.prototype), 'updateTransform', this).call(this);
      this._children.forEach(function (child) {
        child.updateTransform();
      });
    }

    /**
     * Returns the non-global bounds of this DisplayObject
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getLocalBounds',
    value: function getLocalBounds() {
      if (this._localBoundsNeedUpdate) {
        // @TODO Calculate bounds by looking at children
        this._localBoundsNeedUpdate = false;
      }
      return this._localBounds.clone();
    }

    /**
     * Returns the bounds for this DisplayObject
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getBounds',
    value: function getBounds() {
      if (this._boundsNeedUpdate) {
        // @TODO Calculate bounds by looking at children
        this._boundsNeedUpdate = false;
      }
      return this._bounds.clone();
    }

    /**
     * Returns this Container's children
     * @return {PhotoEditorSDK.Engine.DisplayObject[]}
     */

  }, {
    key: 'getChildren',
    value: function getChildren() {
      return this._children;
    }

    /**
     * Returns this Container's filters
     * @return {PhotoEditorSDK.Engine.Filter[]}
     */

  }, {
    key: 'getFilters',
    value: function getFilters() {
      return this._filters;
    }

    /**
     * Disposes this Container
     */

  }, {
    key: 'dispose',
    value: function dispose() {}
  }]);

  return Container;
}(__WEBPACK_IMPORTED_MODULE_6__display_object__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Container);

/***/ }),
/* 163 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__base_texture__ = __webpack_require__(68);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_texture_uvs__ = __webpack_require__(281);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * A texture that can be applied to a {@link PhotoEditorSDK.Engine.Sprite}
 * @class
 * @extends EventEmitter
 * @memberof PhotoEditorSDK.Engine
 */

var Texture = function (_EventEmitter) {
  _inherits(Texture, _EventEmitter);

  function Texture(baseTexture, frame) {
    _classCallCheck(this, Texture);

    var _this = _possibleConstructorReturn(this, (Texture.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Texture)).call(this));

    if (!(baseTexture instanceof __WEBPACK_IMPORTED_MODULE_5__base_texture__["a" /* default */])) {
      throw new Error('`baseTexture` should be an instance of BaseTexture');
    }

    _this._uvs = new __WEBPACK_IMPORTED_MODULE_6__utils_texture_uvs__["a" /* default */]();
    _this._frame = frame ? frame.clone() : null;
    _this._frameLocked = !!frame;

    // Bind event handlers
    _this._onBaseTextureLoaded = _this._onBaseTextureLoaded.bind(_this);
    _this._onBaseTextureUpdated = _this._onBaseTextureUpdated.bind(_this);

    // A texture NEEDS to have a frame
    if (!_this._frame) {
      _this._frame = new __WEBPACK_IMPORTED_MODULE_4__globals__["h" /* Rectangle */](0, 0, 1, 1);
    }
    _this.setBaseTexture(baseTexture);
    return _this;
  }

  /**
   * Creates a texture from the given image
   * @param  {Image} image
   */


  _createClass(Texture, [{
    key: '_onBaseTextureLoaded',


    /**
     * Gets called when the base texture has been loaded
     * @private
     */
    value: function _onBaseTextureLoaded() {
      if (!this._frameLocked) {
        var frame = this._baseTexture.getFrame().clone();
        this.setFrame(frame);
      }

      this._baseTexture.on('update', this._onBaseTextureUpdated);
    }

    /**
     * Gets called when the base texture has been updated
     * @private
     */

  }, {
    key: '_onBaseTextureUpdated',
    value: function _onBaseTextureUpdated() {
      var _baseTexture$getFrame = this._baseTexture.getFrame(),
          width = _baseTexture$getFrame.width,
          height = _baseTexture$getFrame.height;

      this._frame.width = width;
      this._frame.height = height;
      this.emit('update');
    }

    /**
     * Updates the UV coordinates of this texture
     * @private
     */

  }, {
    key: '_updateUVs',
    value: function _updateUVs() {
      this._uvs.update(this._frame, this._baseTexture.getFrame());
    }

    /**
     * Returns the base texture
     * @return {PhotoEditorSDK.Engine.BaseTexture}
     */

  }, {
    key: 'getBaseTexture',
    value: function getBaseTexture() {
      return this._baseTexture;
    }

    /**
     * Sets the base texture
     * @param {PhotoEditorSDK.Engine.BaseTexture} baseTexture
     */

  }, {
    key: 'setBaseTexture',
    value: function setBaseTexture(baseTexture) {
      this._baseTexture = baseTexture;

      if (!this._baseTexture.isLoaded()) {
        this._baseTexture.once('loaded', this._onBaseTextureLoaded);
      } else {
        var _baseTexture$getFrame2 = baseTexture.getFrame(),
            width = _baseTexture$getFrame2.width,
            height = _baseTexture$getFrame2.height;

        if (!this._frameLocked) {
          this._frame = new __WEBPACK_IMPORTED_MODULE_4__globals__["h" /* Rectangle */](0, 0, width, height);
        }
        this._onBaseTextureLoaded();
      }
    }

    /**
     * Returns the frame
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getFrame',
    value: function getFrame() {
      return this._frame;
    }

    /**
     * Sets the frame
     * @param {PhotoEditorSDK.Math.Rectangle} frame
     */

  }, {
    key: 'setFrame',
    value: function setFrame(frame) {
      this._frame = frame;
      this._updateUVs();
    }

    /**
     * Returns the width
     * @return {Number}
     */

  }, {
    key: 'getWidth',
    value: function getWidth() {
      return this._frame.width;
    }

    /**
     * Returns the height
     * @return {Number}
     */

  }, {
    key: 'getHeight',
    value: function getHeight() {
      return this._frame.height;
    }

    /**
     * Returns the texture UVs
     * @return {PhotoEditorSDK.Engine.TextureUVs}
     */

  }, {
    key: 'getUVs',
    value: function getUVs() {
      return this._uvs;
    }

    /**
     * Returns the dimensions of this texture
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions() {
      return new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](this._frame.width, this._frame.height);
    }

    /**
     * Disposes this texture
     * @param  {Boolean} baseTexture
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var baseTexture = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

      baseTexture && this._baseTexture.dispose();
    }
  }], [{
    key: 'fromImage',
    value: function fromImage(image) {
      var baseTexture = new __WEBPACK_IMPORTED_MODULE_5__base_texture__["a" /* default */](image);
      return new Texture(baseTexture);
    }

    /**
     * Creates a texture from the given canvas
     * @param  {HTMLCanvasElement} canvas
     */

  }, {
    key: 'fromCanvas',
    value: function fromCanvas(canvas) {
      var baseTexture = new __WEBPACK_IMPORTED_MODULE_5__base_texture__["a" /* default */](canvas);
      return new Texture(baseTexture);
    }
  }]);

  return Texture;
}(__WEBPACK_IMPORTED_MODULE_4__globals__["d" /* EventEmitter */]);

/* harmony default export */ __webpack_exports__["a"] = (Texture);

/***/ }),
/* 164 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__color__ = __webpack_require__(66);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/*
 * [ a, b, c, d, e,
 *   f, g, h, i, j,
 *   k, l, m, n, o,
 *   p, q, r, s, t ]
 *
 */

/**
 * Represents a 4 by 5 matrix that is used to preform color manipulations.
 * The members are names a, b, c,..,t. The vector formed by e, j, o, t
 * represents the offset.
 * @class
 * @memberof PhotoEditorSDK.Math
 */

var ColorMatrix = function () {
  /**
   * Creates a color matrix, and defaults the values to the identity.
   * @return {PhotoEditorSDK.Math.ColorMatrix}
   */
  function ColorMatrix() {
    var a = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
    var b = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
    var c = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
    var d = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
    var e = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;
    var f = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;
    var g = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 1;
    var h = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : 0;
    var i = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 0;
    var j = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 0;
    var k = arguments.length > 10 && arguments[10] !== undefined ? arguments[10] : 0;
    var l = arguments.length > 11 && arguments[11] !== undefined ? arguments[11] : 0;
    var m = arguments.length > 12 && arguments[12] !== undefined ? arguments[12] : 1;
    var n = arguments.length > 13 && arguments[13] !== undefined ? arguments[13] : 0;
    var o = arguments.length > 14 && arguments[14] !== undefined ? arguments[14] : 0;
    var p = arguments.length > 15 && arguments[15] !== undefined ? arguments[15] : 0;
    var q = arguments.length > 16 && arguments[16] !== undefined ? arguments[16] : 0;
    var r = arguments.length > 17 && arguments[17] !== undefined ? arguments[17] : 0;
    var s = arguments.length > 18 && arguments[18] !== undefined ? arguments[18] : 1;
    var t = arguments.length > 19 && arguments[19] !== undefined ? arguments[19] : 0;

    _classCallCheck(this, ColorMatrix);

    this.set(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t);
  }

  /**
   * Sets the values of the color matrix.
   * @param  {number} a
   * @param  {number} b
   * @param  {number} c
   * @param  {number} d
   * @param  {number} e
   * @param  {number} f
   * @param  {number} g
   * @param  {number} h
   * @param  {number} i
   * @param  {number} j
   * @param  {number} k
   * @param  {number} l
   * @param  {number} m
   * @param  {number} n
   * @param  {number} o
   * @param  {number} p
   * @param  {number} q
   * @param  {number} r
   * @param  {number} s
   * @param  {number} t
   * @return {PhotoEditorSDK.Math.ColorMatrix}
   */


  _createClass(ColorMatrix, [{
    key: 'set',
    value: function set(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t) {
      this.a = a;
      this.b = b;
      this.c = c;
      this.d = d;
      this.e = e;
      this.f = f;
      this.g = g;
      this.h = h;
      this.i = i;
      this.j = j;
      this.k = k;
      this.l = l;
      this.m = m;
      this.n = n;
      this.o = o;
      this.p = p;
      this.q = q;
      this.r = r;
      this.s = s;
      this.t = t;
    }

    /**
     * Returns an identity color matrix.
     * @return {ColorMatrix}
     */

  }, {
    key: 'reset',
    value: function reset() {
      this.a = 1;
      this.b = 0;
      this.c = 0;
      this.d = 0;
      this.e = 0;

      this.f = 0;
      this.g = 1;
      this.h = 0;
      this.i = 0;
      this.j = 0;

      this.k = 0;
      this.l = 0;
      this.m = 1;
      this.n = 0;
      this.o = 0;

      this.p = 0;
      this.q = 0;
      this.r = 0;
      this.s = 1;
      this.t = 0;
    }

    /**
     * Applies the color matrix to the given color, and returns the resulting color.
     * @param  {Color} color
     * @return {Color}
     */

  }, {
    key: 'apply',
    value: function apply(color) {
      var r = this.a * color.r + this.b * color.g + this.c * color.b + this.d * color.a + this.e;
      var g = this.f * color.r + this.g * color.g + this.h * color.b + this.i * color.a + this.j;
      var b = this.k * color.r + this.l * color.g + this.m * color.b + this.n * color.a + this.o;
      var a = this.p * color.r + this.q * color.g + this.r * color.b + this.s * color.a + this.t;
      return new __WEBPACK_IMPORTED_MODULE_1__color__["a" /* default */](r, g, b, a);
    }

    /**
    * Multiplies the given matrix with this matrix.
    * @param  {PhotoEditorSDK.Math.ColorMatrix} matrix
    * @return {PhotoEditorSDK.Math.ColorMatrix}
    */

  }, {
    key: 'multiply',
    value: function multiply(matrix) {
      var a = void 0,
          b = void 0,
          c = void 0,
          d = void 0,
          e = void 0,
          f = void 0,
          g = void 0,
          h = void 0,
          i = void 0,
          j = void 0,
          k = void 0,
          l = void 0,
          m = void 0,
          n = void 0,
          o = void 0,
          p = void 0,
          q = void 0,
          r = void 0,
          s = void 0,
          t = void 0;
      // store both factors, so we can swap them easily
      var A = matrix;
      var B = this;

      // transformation
      a = A.a * B.a + A.b * B.f + A.c * B.k + A.d * B.p;
      b = A.a * B.b + A.b * B.g + A.c * B.l + A.d * B.q;
      c = A.a * B.c + A.b * B.h + A.c * B.m + A.d * B.r;
      d = A.a * B.d + A.b * B.i + A.c * B.n + A.d * B.s;

      f = A.f * B.a + A.g * B.f + A.h * B.k + A.i * B.p;
      g = A.f * B.b + A.g * B.g + A.h * B.l + A.i * B.q;
      h = A.f * B.c + A.g * B.h + A.h * B.m + A.i * B.r;
      i = A.f * B.d + A.g * B.i + A.h * B.n + A.i * B.s;

      k = A.k * B.a + A.l * B.f + A.m * B.k + A.n * B.p;
      l = A.k * B.b + A.l * B.g + A.m * B.l + A.n * B.q;
      m = A.k * B.c + A.l * B.h + A.m * B.m + A.n * B.r;
      n = A.k * B.d + A.l * B.i + A.m * B.n + A.n * B.s;

      p = A.p * B.a + A.q * B.f + A.r * B.k + A.s * B.p;
      q = A.p * B.b + A.q * B.g + A.r * B.l + A.s * B.q;
      r = A.p * B.c + A.q * B.h + A.r * B.m + A.s * B.r;
      s = A.p * B.d + A.q * B.i + A.r * B.n + A.s * B.s;

      // translation
      e = A.a * B.e + A.b * B.j + A.c * B.o + A.d * B.t + A.e;
      j = A.f * B.e + A.g * B.j + A.h * B.o + A.i * B.t + A.j;
      o = A.k * B.e + A.l * B.j + A.m * B.o + A.n * B.t + A.o;
      t = A.p * B.e + A.q * B.j + A.r * B.o + A.s * B.t + A.t;

      this.a = a;
      this.b = b;
      this.c = c;
      this.d = d;
      this.e = e;
      this.f = f;
      this.g = g;
      this.h = h;
      this.i = i;
      this.j = j;
      this.k = k;
      this.l = l;
      this.m = m;
      this.n = n;
      this.o = o;
      this.p = p;
      this.q = q;
      this.r = r;
      this.s = s;
      this.t = t;

      return this;
    }

    /**
     * Retuns a clone of the current matrix/
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */

  }, {
    key: 'clone',
    value: function clone() {
      var matrix = new ColorMatrix();
      matrix.set(this.a, this.b, this.c, this.d, this.e, this.f, this.g, this.h, this.i, this.j, this.k, this.l, this.m, this.n, this.o, this.p, this.q, this.r, this.s, this.t);
      return matrix;
    }

    /**
     * Checks if the values of the given matrix match this matrix's values.
     * @param  {PhotoEditorSDK.Math.ColorMatrix} matrix
     * @return {Boolean}
     */

  }, {
    key: 'equals',
    value: function equals(matrix) {
      return this.a === matrix.a && this.b === matrix.b && this.c === matrix.c && this.d === matrix.d && this.e === matrix.e && this.f === matrix.f && this.g === matrix.g && this.h === matrix.h && this.i === matrix.i && this.j === matrix.j && this.k === matrix.k && this.l === matrix.l && this.m === matrix.m && this.n === matrix.n && this.o === matrix.o && this.p === matrix.p && this.q === matrix.q && this.r === matrix.r && this.s === matrix.s && this.t === matrix.t;
    }

    /**
     * Returns the offset values of this matrix
     * @return {Number[]}
     */

  }, {
    key: 'getOffsets',
    value: function getOffsets() {
      return [this.e, this.j, this.o, this.t];
    }

    /**
     * Returns a string representation of this color matrix
     * @return {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'ColorMatrix( ' + this.a + ', ' + this.b + ', ' + this.c + ', ' + this.d + ', ' + this.e + ',\n      ' + this.f + ', ' + this.g + ', ' + this.h + ', ' + this.i + ', ' + this.j + ',\n      ' + this.k + ', ' + this.l + ', ' + this.m + ', ' + this.n + ', ' + this.o + ',\n      ' + this.p + ', ' + this.q + ', ' + this.r + ', ' + this.s + ', ' + this.t + ' )';
    }

    /**
     * Returns an array of numbers
     * @return {Number[]}
     */

  }, {
    key: 'toArray',
    value: function toArray() {
      var _this = this;

      return 'abcdefghijklmnopqrst'.split('').map(function (v) {
        return _this[v];
      });
    }

    /**
     * The identity matrix
     * @static
     * @type {PhotoEditorSDK.Math.ColorMatrix}
     */

  }], [{
    key: 'createBrightnessMatrix',


    /**
     * Returns a color matrix that can be used to change the brightness.
     * @param {Number} brightness
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */
    value: function createBrightnessMatrix(brightness) {
      var matrix = new ColorMatrix();
      matrix.e = brightness;
      matrix.j = brightness;
      matrix.o = brightness;
      return matrix;
    }

    /**
     * Returns a color matrix that can be used to change the contrast.
     * @param {Number} contrast
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */

  }, {
    key: 'createContrastMatrix',
    value: function createContrastMatrix(contrast) {
      var matrix = new ColorMatrix();
      var t = (1.0 - contrast) / 2.0;
      matrix.a = matrix.g = matrix.m = contrast;
      matrix.e = matrix.j = matrix.o = t;
      return matrix;
    }

    /**
     * Returns a color matrix that can be used to change the saturation.
     * @param {Number} saturation
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */

  }, {
    key: 'createSaturationMatrix',
    value: function createSaturationMatrix() {
      var saturation = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1.0;

      var matrix = new ColorMatrix();
      var invSat = 1 - saturation;
      var r = 0.213 * invSat;
      var g = 0.715 * invSat;
      var b = 0.072 * invSat;

      // first row
      matrix.a = r + saturation;
      matrix.b = g;
      matrix.c = b;
      // second row
      matrix.f = r;
      matrix.g = g + saturation;
      matrix.h = b;
      // third row
      matrix.k = r;
      matrix.l = g;
      matrix.m = b + saturation;
      return matrix;
    }

    /**
     * Returns a color matrix that can be used to change the exposure.
     * @param {Number} saturation
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */

  }, {
    key: 'createExposureMatrix',
    value: function createExposureMatrix() {
      var exposure = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

      var scale = Math.pow(2, exposure);
      return new ColorMatrix(scale, 0, 0, 0, 0, 0, scale, 0, 0, 0, 0, 0, scale, 0, 0, 0, 0, 0, 1, 0);
    }

    /**
     * Returns a color matrix that can be used to apply linear changes.
     * @static
     * @param {Number} slope
     * @param {Number} intercept
     * @return {PhotoEditorSDK.Math.ColorMatrix}
     */

  }, {
    key: 'createLinearMatrix',
    value: function createLinearMatrix() {
      var slope = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1.0;
      var intercept = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0.0;

      var matrix = new ColorMatrix();
      matrix.a = matrix.g = matrix.m = slope;
      matrix.e = matrix.j = matrix.o = intercept;
      return matrix;
    }
  }, {
    key: 'IDENTITY',
    get: function get() {
      return new ColorMatrix();
    }
  }]);

  return ColorMatrix;
}();

/* harmony default export */ __webpack_exports__["a"] = (ColorMatrix);

/***/ }),
/* 165 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__vector2__ = __webpack_require__(45);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vector3__ = __webpack_require__(311);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__range__ = __webpack_require__(312);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__rectangle__ = __webpack_require__(155);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__matrix__ = __webpack_require__(154);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__color_matrix__ = __webpack_require__(164);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__cubic_bezier_curve__ = __webpack_require__(313);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Vector2", function() { return __WEBPACK_IMPORTED_MODULE_0__vector2__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Vector3", function() { return __WEBPACK_IMPORTED_MODULE_1__vector3__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Range", function() { return __WEBPACK_IMPORTED_MODULE_2__range__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Rectangle", function() { return __WEBPACK_IMPORTED_MODULE_3__rectangle__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Matrix", function() { return __WEBPACK_IMPORTED_MODULE_4__matrix__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ColorMatrix", function() { return __WEBPACK_IMPORTED_MODULE_5__color_matrix__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "CubicBezierCurve", function() { return __WEBPACK_IMPORTED_MODULE_6__cubic_bezier_curve__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */









/**
 * Some classes that help us do the math
 * @namespace PhotoEditorSDK.Math
 */


/***/ }),
/* 166 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__exif_orientation_operation__ = __webpack_require__(314);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ExifOrientationOperation", function() { return __WEBPACK_IMPORTED_MODULE_0__exif_orientation_operation__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * @namespace PhotoEditorSDK.Operations
 * @memberof  PhotoEditorSDK
 */


/***/ }),
/* 167 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__constants__ = __webpack_require__(40);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_log__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__engine___ = __webpack_require__(85);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__lib_configurable__ = __webpack_require__(70);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__lib_performance_test__ = __webpack_require__(168);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* jshint unused:false */
/* jshint -W083 */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








/**
 * Base class for Operations
 * @class
 * @alias Operation
 * @extends PhotoEditorSDK.Configurable
 * @memberof PhotoEditorSDK
 */

var Operation = function (_Configurable) {
  _inherits(Operation, _Configurable);

  /**
   * Creates an Operation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function Operation(sdk) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, Operation);

    var _this = _possibleConstructorReturn(this, (Operation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Operation)).call(this, options, {
      enabled: { type: __WEBPACK_IMPORTED_MODULE_4__constants__["OptionType"].BOOLEAN, default: true, serializable: false }
    }));

    _this._sdk = sdk;
    _this._cacheEnabled = false;
    _this._dirtiness = {};

    _this._sprite = new __WEBPACK_IMPORTED_MODULE_7__engine___["a" /* default */].Sprite();
    _this._container = new __WEBPACK_IMPORTED_MODULE_7__engine___["a" /* default */].Container();
    _this._container.addChild(_this._sprite);
    return _this;
  }

  // -------------------------------------------------------------------------- EVENTS

  /**
   * Gets called when options have been changed. Sets this operation to dirty.
   * @private
   */


  _createClass(Operation, [{
    key: '_onOptionsChange',
    value: function _onOptionsChange() {
      this.setDirty(true);
    }

    // -------------------------------------------------------------------------- RENDERING

    /**
     * Applies this operation
     * @param  {PhotoEditorSDK.Engine.RenderTexture} inputTexture
     * @return {Promise}
     * @abstract
     */

  }, {
    key: 'render',
    value: function render(inputTexture) {
      var _this2 = this;

      if (!this.getEnabled()) {
        __WEBPACK_IMPORTED_MODULE_6__shared_log__["a" /* default */].info(this.constructor.name, 'Disabled - skipping');
        return __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__["a" /* default */].resolve(inputTexture);
      }

      if (!this._renderTexture) {
        // const frame = this._sdk.getSprite().getTexture().getFrame()
        var newDimensions = inputTexture.getDimensions().floor();
        this._renderTexture = new __WEBPACK_IMPORTED_MODULE_7__engine___["a" /* default */].RenderTexture(this._sdk.getRenderer(), newDimensions.x, newDimensions.y);
      }

      var renderer = this._sdk.getRenderer();
      var promise = void 0;
      var perf = void 0;
      if (__WEBPACK_IMPORTED_MODULE_6__shared_log__["a" /* default */].canLog('info')) {
        perf = new __WEBPACK_IMPORTED_MODULE_9__lib_performance_test__["a" /* default */](this.constructor.name, 'Rendering');
      }

      // Handle caching
      if (this.isDirtyForRenderer(renderer)) {
        // Make sure that this Operation's internal sprite has the input texture and that
        // the RenderTexture we're rendering to has the same dimensions
        this._sprite.setTexture(inputTexture);

        var _newDimensions = this.getNewDimensions(inputTexture.getDimensions()).floor();
        this._renderTexture.resizeTo(_newDimensions);
        this._renderTexture.clear();

        // Let the operation do its work
        promise = this._render(inputTexture)
        // By default, operations are done after a single render pass, but they may return
        // true if more render passes are needed. (e.g. ArtFilterOperation)
        .then(function () {
          var stillDirty = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

          _this2.setDirtyForRenderer(stillDirty, renderer);
          return _this2._renderTexture;
        });
      } else {
        __WEBPACK_IMPORTED_MODULE_6__shared_log__["a" /* default */].info(this.constructor.name, 'Rendering from cache');
        promise = __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__["a" /* default */].resolve(this._renderTexture);
      }

      return promise.then(function (outputTexture) {
        if (perf) perf.stop();
        return outputTexture;
      });
    }

    /**
     * Renders this operation
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @return {Promise}
     * @private
     */

  }, {
    key: '_render',
    value: function _render(inputTexture) {
      var renderFn = void 0;
      if (this._sdk.getRenderer().isOfType(__WEBPACK_IMPORTED_MODULE_4__constants__["RendererType"].WEBGL)) {
        /* istanbul ignore next */
        renderFn = this._renderWebGL.bind(this);
      } else {
        renderFn = this._renderCanvas.bind(this);
      }

      return renderFn(inputTexture);
    }

    /**
     * Applies this operation using WebGL
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @protected
     * @abstract
     */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(inputTexture) {
      throw new Error('Operation#_renderWebGL is abstract and not implemented in inherited class.');
    }

    /**
     * Applies this operation using Canvas2D
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @protected
     * @abstract
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(inputTexture) {
      throw new Error('Operation#_renderCanvas is abstract and not implemented in inherited class.');
    }

    /**
     * Returns the dimensions that an image with the given `dimensions`
     * would have after this operation has been applied
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getNewDimensions',
    value: function getNewDimensions(dimensions) {
      return dimensions.clone();
    }

    /**
     * Is called before the SDK begins exporting
     */

  }, {
    key: 'onBeforeExport',
    value: function onBeforeExport() {
      if (this.transform && this._tempTransformChange) {
        this.transform(this._tempTransformChange);
      }
      this._onBeforeExport();
    }

    /**
     * Is called after the SDK finishes exporting
     */

  }, {
    key: 'onAfterExport',
    value: function onAfterExport() {
      if (this.transform && this._tempInverseTransformChange) {
        this.transform(this._tempInverseTransformChange);
      }
      this._onAfterExport();
    }

    /**
     * Is called before the SDK begins exporting
     * @protected
     */

  }, {
    key: '_onBeforeExport',
    value: function _onBeforeExport() {}

    /**
     * Is called after the SDK finishes exporting
     * @protected
     */

  }, {
    key: '_onAfterExport',
    value: function _onAfterExport() {}

    /**
     * Remembers a temporary transform change and its inverse. These changes
     * are only applied before and after export
     * @param {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @param {PhotoEditorSDK.Operations.TransformOperation.TransformChange} inverseTransformChange
     */

  }, {
    key: 'setTemporaryTransformChange',
    value: function setTemporaryTransformChange(transformChange, inverseTransformChange) {
      this._tempTransformChange = transformChange;
      this._tempInverseTransformChange = inverseTransformChange;
    }

    /**
     * Resets this operation
     */

  }, {
    key: 'reset',
    value: function reset() {
      this._dirty = true;
      this._glslPrograms = {};
    }

    // -------------------------------------------------------------------------- DIRTINESS

    /**
     * Checks if this operation is dirty for the given renderer
     * @param  {PhotoEditorSDK.Engine.BaseRenderer}  renderer
     * @return {Boolean}
     */

  }, {
    key: 'isDirtyForRenderer',
    value: function isDirtyForRenderer(renderer) {
      var dirty = this._dirtiness[renderer.id];
      return typeof dirty === 'undefined' ? true : dirty;
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {

      this._dirtiness[renderer.id] = dirty;
    }

    /**
     * Sets the dirtiness for all renderers
     * @param {Boolean} dirty
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirty',
    value: function setDirty(dirty) {
      var dimensionsChanged = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      for (var rendererId in this._dirtiness) {
        this.setDirtyForRenderer(dirty, { id: rendererId }, dimensionsChanged);
      }
    }

    /**
     * Returns the instance of {@link PhotoEditorSDK} that this operation belongs to
     * @return {PhotoEditorSDK}
     */

  }, {
    key: 'getSDK',
    value: function getSDK() {
      return this._sdk;
    }

    /**
     * Returns the input dimensions for this operation
     * @param {Boolean} incorporateZoom = true
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getInputDimensions',
    value: function getInputDimensions() {
      var _this3 = this;

      var incorporateZoom = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

      var dimensions = this._sdk.getInputDimensions();
      if (incorporateZoom) {
        dimensions.multiply(this._sdk.getZoom()).floor();
      }
      var opFound = void 0;
      this._sdk.getOperationsStack().forEach(function (op) {
        if (opFound) return;
        if (op === _this3) {
          opFound = true;
          return;
        }
        dimensions = op.getNewDimensions(dimensions);
      });
      return dimensions.floor();
    }

    /**
     * Creates a clone of this operation
     * @return {PhotoEditorSDK.Operation}
     */

  }, {
    key: 'clone',
    value: function clone() {
      var Operation = this.constructor;
      return new Operation(this._sdk, this.serializeOptions());
    }

    /**
     * Disposes the RenderTexture
     */

  }, {
    key: 'disposeRenderTextures',
    value: function disposeRenderTextures() {
      if (this._renderTexture) {
        this._renderTexture.dispose();
      }
      this._renderTexture = null;
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this.disposeRenderTextures();
      this._sprite.dispose();
    }
  }]);

  return Operation;
}(__WEBPACK_IMPORTED_MODULE_8__lib_configurable__["a" /* default */]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 */


Operation.identifier = null;

/* harmony default export */ __webpack_exports__["a"] = (Operation);

/***/ }),
/* 168 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(38);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


/* istanbul ignore next */
var now = typeof window !== 'undefined' && window.performance && window.performance.now ? window.performance.now.bind(window.performance) : __webpack_require__(86);

/**
 * A simple class that tracks the time between start and end and renders it as FPS
 * @class
 * @memberof PhotoEditorSDK
 * @ignore
 */
/* istanbul ignore next */

var PerformanceTest = function () {
  /**
   * Creates a PerformanceTest
   * @param  {String} tag
   * @param  {String} name
   */
  function PerformanceTest(tag, name) {
    _classCallCheck(this, PerformanceTest);

    this._tag = tag;
    this._name = name;
    this._start = now();
  }

  /**
   * Stops the performance test and prints the result
   */


  _createClass(PerformanceTest, [{
    key: 'stop',
    value: function stop() {
      var end = now();
      var ms = end - this._start;
      var fps = Math.round(1000 / ms);
      __WEBPACK_IMPORTED_MODULE_1__globals__["Log"].info(this._tag, this._name + ' took ' + ms.toFixed(2) + 'ms (' + fps + ' FPS)');
    }
  }]);

  return PerformanceTest;
}();

/* harmony default export */ __webpack_exports__["a"] = (PerformanceTest);

/***/ }),
/* 169 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(38);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__event_emitter__ = __webpack_require__(67);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * Holds an array of {@link PhotoEditorSDK.Operation} instances and handles their dirtiness
 * @class
 * @memberof PhotoEditorSDK
 */

var OperationsStack = function (_EventEmitter) {
  _inherits(OperationsStack, _EventEmitter);

  /**
   * Creates an OperationsStack
   * @param  {PhotoEditorSDK.Operation[]} [operations = []]
   */
  function OperationsStack() {
    var operations = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

    _classCallCheck(this, OperationsStack);

    var _this = _possibleConstructorReturn(this, (OperationsStack.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(OperationsStack)).call(this));

    _this._onOperationUpdate = _this._onOperationUpdate.bind(_this);

    _this._cacheEnabled = true;
    _this._stack = operations;
    _this._stack.forEach(function (operation) {
      operation.on('update', _this._onOperationUpdate);
    });
    return _this;
  }

  /**
   * Clears this operations stack
   */


  _createClass(OperationsStack, [{
    key: 'clear',
    value: function clear() {
      var _this2 = this;

      this.forEach(function (operation) {
        return _this2.remove(operation);
      });
      this._stack = [];
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return this._stack.filter(function (op) {
        return !!op;
      }).some(function (op) {
        return op.hasChanges();
      });
    }

    /**
     * Gets called when an operation is about to be updated
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {Object} options
     * @private
     */

  }, {
    key: '_onOperationUpdate',
    value: function _onOperationUpdate(operation, options) {
      this.emit(__WEBPACK_IMPORTED_MODULE_4__globals__["Events"].OPERATION_UPDATED, operation, options);
    }

    /**
     * Enables the cache on all operations
     */

  }, {
    key: 'enableCache',
    value: function enableCache() {
      this._cacheEnabled = true;
    }

    /**
     * Disables the cache on all operations
     */

  }, {
    key: 'disableCache',
    value: function disableCache() {
      this._cacheEnabled = false;
    }

    /**
     * Passes Array#forEach
     * @param  {Function} iterator
     * @return {Array}
     */

  }, {
    key: 'forEach',
    value: function forEach(iterator) {
      return this._stack.filter(function (op) {
        return !!op;
      }).forEach(iterator);
    }

    /**
     * Renders all operations
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @return {Promise}
     */

  }, {
    key: 'render',
    value: function render(sdk, inputTexture) {
      var _this3 = this;

      var currentTexture = inputTexture;
      var operations = this._stack.filter(function (op) {
        return !!op;
      }).filter(function (op) {
        return op.getEnabled();
      });

      // Find first operation from end of array that is not dirty
      operations.reverse();
      var firstUndirtyOperation = operations.filter(function (o) {
        return !o.isDirtyForRenderer(sdk.getRenderer());
      })[0];
      var firstUndirtyIndex = operations.indexOf(firstUndirtyOperation);

      operations.reverse();

      // Skip operations that would be overwritten by succeeding operations
      var startIndex = 0;
      if (firstUndirtyIndex !== -1) {
        startIndex = operations.length - firstUndirtyIndex - 1;
      }

      for (var index = 0; index < startIndex; index++) {
        __WEBPACK_IMPORTED_MODULE_4__globals__["Log"].info(this.constructor.name, 'Skipping ' + operations[index].constructor.name);
      }

      var promise = __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__["a" /* default */].resolve(currentTexture);

      var _loop = function _loop(_index) {
        var operation = operations[_index];
        var lastTexture = void 0,
            lastTextureOperation = void 0;
        promise = promise.then(function (inputTexture) {
          return operation.render(inputTexture).then(function (outputTexture) {
            // If cache is disabled, flush textures of previous operation
            if (lastTexture && outputTexture !== lastTexture && !_this3._cacheEnabled) {
              lastTextureOperation.disposeRenderTextures();
            }
            lastTexture = outputTexture;
            lastTextureOperation = operation;
            return outputTexture;
          });
        });
      };

      for (var _index = startIndex; _index < operations.length; _index++) {
        _loop(_index);
      }

      return promise.then(function (outputTexture) {
        var renderDone = !operations.some(function (op) {
          return op.isDirtyForRenderer(sdk.getRenderer());
        });
        return { outputTexture: outputTexture, renderDone: renderDone };
      });
    }

    /**
     * Validates the settings of all operations
     * @return {Promise}
     */

  }, {
    key: 'validateSettings',
    value: function validateSettings() {
      return __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__["a" /* default */].all(this._stack.filter(function (op) {
        return !!op;
      }).map(function (op) {
        return op.validateSettings();
      }));
    }

    /**
     * Sets all operations to dirty
     * @param {Boolean} dimensionsChanged = falses
     */

  }, {
    key: 'setAllToDirty',
    value: function setAllToDirty() {
      var dimensionsChanged = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      this.forEach(function (op) {
        return op.setDirty(true, dimensionsChanged);
      });
    }

    /**
     * Finds the first dirty operation and sets all following operations to dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     */

  }, {
    key: 'updateDirtinessForRenderer',
    value: function updateDirtinessForRenderer(renderer) {
      var dirtyFound = false;
      for (var i = 0; i < this._stack.length; i++) {
        var _operation = this._stack[i];
        if (!_operation) continue;
        if (_operation.isDirtyForRenderer(renderer)) {
          dirtyFound = true;
        }

        if (dirtyFound) {
          _operation.setDirtyForRenderer(true, renderer);
        }
      }
    }

    /**
     * Adds the given operation to this stack
     * @param {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'push',
    value: function push(operation) {
      this._stack.push(operation);
      operation.on('update', this._onOperationUpdate);
    }

    /**
     * Remove the last operation from the stack
     */

  }, {
    key: 'pop',
    value: function pop() {
      var operation = this._stack.pop();

      if (operation) {
        operation.off('update', this._onOperationUpdate);
        operation.dispose();
      }
    }

    /**
     * Adds the given operation before all existing operations
     * @param  {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'unshift',
    value: function unshift(operation) {
      this._stack.unshift(operation);
      operation.on('update', this._onOperationUpdate);
    }

    /**
     * Returns a cloned instance of this stack
     * @return {PhotoEditorSDK.OperationsStack}
     */

  }, {
    key: 'clone',
    value: function clone() {
      return new OperationsStack(this._stack.slice(0));
    }

    /**
     * Returns the operation at the given index
     * @param  {Number} index
     * @return {PhotoEditorSDK.Operation}
     */

  }, {
    key: 'get',
    value: function get(index) {
      return this._stack[index];
    }

    /**
     * Returns the first operation found with the given identifier
     * @param  {string} identifier
     * @return {PhotoEditorSDK.Operation}
     */

  }, {
    key: 'getByIdentifier',
    value: function getByIdentifier(identifier) {
      return __WEBPACK_IMPORTED_MODULE_4__globals__["Utils"].Array.find(this._stack, function (item) {
        return item && item.constructor.identifier === identifier;
      });
    }

    /**
     * Returns the index in the stack of the first operation with the given identifier.
     * Returns -1 if no such operation exists.
     * @param {string} identifier
     * @returns {number}
     */

  }, {
    key: 'getIndexByIdentifier',
    value: function getIndexByIdentifier(identifier) {
      return __WEBPACK_IMPORTED_MODULE_4__globals__["Utils"].Array.findIndex(this._stack, function (item) {
        return item && item.constructor.identifier === identifier;
      });
    }

    /**
     * Moves the operation with a given identifier to the top of the stack.
     *
     * @param {String} identifier
     */

  }, {
    key: 'moveToTop',
    value: function moveToTop(identifier) {
      var index = __WEBPACK_IMPORTED_MODULE_4__globals__["Utils"].Array.findIndex(this._stack, function (item) {
        return item && item.constructor.identifier === identifier;
      });

      if (index < 0 || index === this._stack.length - 1) {
        return;
      }

      var operation = this.getByIdentifier(identifier);

      this._stack.splice(index, 1);
      this._stack[this._stack.length] = operation;
    }

    /**
     * Sets the operation at the given index to the given one
     * @param  {Number} index
     * @param  {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'set',
    value: function set(index, operation) {
      if (this._stack[index]) {
        this._stack[index].off('update', this._onOperationUpdate);
        this._stack[index].dispose();
      }
      this._stack[index] = operation;
      operation.on('update', this._onOperationUpdate);
    }

    /**
     * Removes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'remove',
    value: function remove(operation) {
      var index = this._stack.indexOf(operation);
      if (index === -1) {
        return;
      }
      if (this._stack[index]) {
        this._stack[index].off('update', this._onOperationUpdate);
        this._stack[index].dispose();
      }
      this._stack.splice(index, 1);
    }

    /**
     * Removes the operation at the given index
     * @param  {Number} index
     */

  }, {
    key: 'removeAt',
    value: function removeAt(index) {
      if (this._stack[index]) {
        this._stack[index].off('update', this._onOperationUpdate);
        this._stack[index].dispose();
      }
      delete this._stack[index];
    }

    /**
     * Returns the stack
     * @return {PhotoEditorSDK.Operation[]}
     */

  }, {
    key: 'getStack',
    value: function getStack() {
      return this._stack;
    }
  }, {
    key: 'dispose',
    value: function dispose() {
      this.forEach(function (operation) {
        operation.dispose();
      });
    }
  }]);

  return OperationsStack;
}(__WEBPACK_IMPORTED_MODULE_6__event_emitter__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (OperationsStack);

/***/ }),
/* 170 */
/***/ (function(module, exports) {

module.exports = {"name":"photoeditorsdk","version":"4.22.3","description":"The most comprehensive photo editor SDK for HTML5","repository":"http://github.com/imgly/pesdk-html5","author":"PhotoEditorSDK (img.ly GmbH) <contact@img.ly>","license":"SEE LICENSE IN LICENSE.md","bin":{},"scripts":{"build:engine-wrapper":"webpack"},"devDependencies":{"adonis":"git://github.com/imgly/adonis.git#v1.0.1","ajv":"^5.5.1","babel-core":"^6.26.3","babel-loader":"^7.1.2","babel-minify-webpack-plugin":"^0.2.0","babel-plugin-external-helpers":"^6.22.0","babel-plugin-transform-adonis-hash":"^0.4.0","babel-plugin-transform-class-properties":"^6.19.0","babel-plugin-transform-es2015-classes":"^6.6.4","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-plugin-transform-proto-to-assign":"^6.26.0","babel-plugin-transform-runtime":"^6.6.0","babel-preset-env":"^1.7.0","babel-preset-es2015":"^6.6.0","babel-preset-minify":"^0.2.0","babel-preset-react":"^6.5.0","babel-preset-stage-0":"^6.24.1","babel-preset-stage-3":"^6.24.1","babel-register":"^6.26.0","babel-runtime":"^6.26.0","chalk":"^2.4.1","chromedriver":"^2.37.0","circular-json-es6":"^2.0.2","classnames":"^2.1.3","clean-webpack-plugin":"^0.1.16","compass-mixins":"^0.12.8","copy-webpack-plugin":"^4.5.2","css-loader":"^0.28.7","del":"^2.0.0","djv":"^1.2.0","express":"^4.16.2","extract-text-webpack-plugin":"^3.0.2","html-webpack-plugin":"^3.2.0","husky":"^1.2.0","inquirer":"^0.11.4","inquirer-path":"^1.0.0-beta5","isomorphic-fetch":"^2.2.1","jaguarjs-jsdoc":"git://github.com/imgly/jaguarjs-jsdoc.git#master","jsdoc":"^3.6.3","json-loader":"^0.5.7","lodash.defaults":"^4.2.0","lodash.defaultsdeep":"^4.6.1","minimist":"^1.2.0","mkdirp":"^0.5.1","ncp":"^2.0.0","node-sass":"^4.12.0","node-static":"^0.7.10","optimize-css-assets-webpack-plugin":"^3.2.0","performance-now":"^0.2.0","pixelmatch":"^4.0.2","pngjs":"^3.3.2","preprocess-loader":"^0.3.0","pretty-error":"^2.0.0","prompt":"^1.0.0","raw-loader":"^0.5.1","rembrandt":"^0.1.3","rimraf":"^2.6.2","should":"^4.3.0","sinon":"^1.17.3","sinon-chai":"^2.14.0","standard":"^9.0.2","standard-loader":"^6.0.1","stats.js":"^0.16.0","style-loader":"^0.13.1","styled-components":"^4.2.0","term-img2":"^2.0.1","transform-loader":"^0.2.2","uglifyjs-webpack-plugin":"^1.2.5","vinyl-source-stream":"0.1.1","webpack":"^3.12.0","webpack-notifier":"^1.2.1"},"standard":{"globals":["describe","context","before","beforeEach","after","afterEach","it","expect"],"parser":"babel-eslint"},"dependencies":{"can-use-dom":"^0.1.0","canvas":"^2.6.0","gl":"^4.1.1","lodash.debounce":"^4.0.8","lodash.memoize":"^4.1.2","lodash.throttle":"^4.1.1","opn":"^5.3.0","request":"^2.88.0","resize-observer-polyfill":"^1.5.1"},"devEngines":{"node":"8.x || 9.x || 10.x || 11.x || 12.x"}};

/***/ }),
/* 171 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__image_loader__ = __webpack_require__(72);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ImageLoader", function() { return __WEBPACK_IMPORTED_MODULE_0__image_loader__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__json_loader__ = __webpack_require__(71);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "JSONLoader", function() { return __WEBPACK_IMPORTED_MODULE_1__json_loader__["a"]; });
// export { default as FileLoader } from './file-loader'



/***/ }),
/* 172 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var ColorMatrix = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].ColorMatrix;

var EPSILON = 0.0000001;
function map(x, inMin, inMax, outMin, outMax) {
  return (x - inMin) * (outMax - outMin) / (inMax - inMin) + outMin;
}

var calculateLuminance = function calculateLuminance(color) {
  var max = Math.max(color.r, color.g, color.b);
  var min = Math.min(color.r, color.g, color.b);

  return (max + min) / 2;
};

var AdjustmentsFilter = function (_Engine$Filter) {
  _inherits(AdjustmentsFilter, _Engine$Filter);

  function AdjustmentsFilter() {
    _classCallCheck(this, AdjustmentsFilter);

    var _this = _possibleConstructorReturn(this, (AdjustmentsFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(AdjustmentsFilter)).call(this));

    _this._fragmentSource = __webpack_require__(322);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(AdjustmentsFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var _options = this._options,
          colorMatrix = _options.colorMatrix,
          gamma = _options.gamma,
          shadows = _options.shadows,
          highlights = _options.highlights,
          whites = _options.whites,
          blacks = _options.blacks;

      var applyGamma = gamma !== 1;
      var applyShadowsAndHighlights = shadows !== 0 || highlights !== 0;

      var color = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"](0, 0, 0, 0);

      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;

        color.r = imageData.data[index] / 255;
        color.g = imageData.data[index + 1] / 255;
        color.b = imageData.data[index + 2] / 255;

        // Gamma
        if (applyGamma) {
          color.r = Math.pow(color.r, 1.0 / Math.max(gamma, EPSILON));
          color.g = Math.pow(color.g, 1.0 / Math.max(gamma, EPSILON));
          color.b = Math.pow(color.b, 1.0 / Math.max(gamma, EPSILON));
        }

        // Apply shadows and highlights
        if (applyShadowsAndHighlights) {
          // const luminance = color.r * 0.2125 + color.g * 0.7154 + color.b * 0.0721
          var luminance = calculateLuminance(color);
          // const luminance = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722

          var shadow = shadows >= 0 ? __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(Math.pow(luminance, 1 / (shadows + 1)) + Math.pow(luminance, 2 / (shadows + 1)) * -0.76 - luminance, 0, Math.max(shadows, 1)) : -__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(Math.pow(luminance, 1 / (-shadows + 1)) + Math.pow(luminance, 2 / (-shadows + 1)) * -0.76 - luminance, 0, Math.max(-shadows, 1));

          var highlight = highlights < 0 ? __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(1 - Math.pow(1 - luminance, 1 / (1 - highlights)) - Math.pow(1 - luminance, 2 / (1 - highlights)) * -0.8 - luminance, -1, 0) : -__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(1 - Math.pow(1 - luminance, 1 / (1 + highlights)) - Math.pow(1 - luminance, 2 / (1 + highlights)) * -0.8 - luminance, -1, 0);

          var shadowContrast = shadow * luminance * luminance;
          var shadowBrightness = shadow - shadowContrast;

          var offset = luminance + shadowContrast + highlight;
          color.r = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(offset * ((color.r + shadowBrightness) / Math.max(luminance, EPSILON)), 0, 1);
          color.g = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(offset * ((color.g + shadowBrightness) / Math.max(luminance, EPSILON)), 0, 1);
          color.b = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].clamp(offset * ((color.b + shadowBrightness) / Math.max(luminance, EPSILON)), 0, 1);
        }

        // Brightness, saturation, contrast, exposire
        color = colorMatrix.apply(color).clamp(0, 1);
        color.r = map(color.r, 0.0, 1.0, blacks / 2.0, 1.0 + whites / 2.0);
        color.g = map(color.g, 0.0, 1.0, blacks / 2.0, 1.0 + whites / 2.0);
        color.b = map(color.b, 0.0, 1.0, blacks / 2.0, 1.0 + whites / 2.0);
        // Apply colors
        imageData.data[index] = color.r * 255;
        imageData.data[index + 1] = color.g * 255;
        imageData.data[index + 2] = color.b * 255;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return AdjustmentsFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

AdjustmentsFilter.prototype.availableOptions = {
  gamma: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  shadows: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  highlights: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  whites: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  blacks: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  colorMatrix: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR_MATRIX, default: new ColorMatrix(), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].MAT4 },
  colorOffset: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].ARRAY, default: [], uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT4 }
};

/* harmony default export */ __webpack_exports__["a"] = (AdjustmentsFilter);

/***/ }),
/* 173 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__primitives__ = __webpack_require__(8);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * Identity Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var IdentityFilter = function (_Filter) {
  _inherits(IdentityFilter, _Filter);

  function IdentityFilter() {
    var _ref;

    _classCallCheck(this, IdentityFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = IdentityFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(IdentityFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_7__primitives__["Brightness"]({
      brightness: 0
    }));
    return _this;
  }

  _createClass(IdentityFilter, [{
    key: 'render',
    value: function render(sdk, inputTexture, outputTexture) {
      if (this._stack.isEmpty()) {
        this._stack.push(new __WEBPACK_IMPORTED_MODULE_7__primitives__["Brightness"]({
          brightness: 0
        }));
      }
      return _get(IdentityFilter.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(IdentityFilter.prototype), 'render', this).call(this, sdk, inputTexture, outputTexture);
    }
  }]);

  return IdentityFilter;
}(__WEBPACK_IMPORTED_MODULE_6__filter__["a" /* default */]);

IdentityFilter.isIdentity = true;

/**
 * This filter's identifier
 * @type {String}
 * @default
 */
IdentityFilter.identifier = 'identity';

/* harmony default export */ __webpack_exports__["a"] = (IdentityFilter);

/***/ }),
/* 174 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__primitive__ = __webpack_require__(18);






var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var LookupTableFilter = function (_Engine$Filter) {
  _inherits(LookupTableFilter, _Engine$Filter);

  function LookupTableFilter() {
    var _ref;

    _classCallCheck(this, LookupTableFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = LookupTableFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(352);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(LookupTableFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var table = this._options.lookupTableData;
      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;

        var r = imageData.data[index];
        imageData.data[index] = table[r * 4];
        var g = imageData.data[index + 1];
        imageData.data[index + 1] = table[1 + g * 4];
        var b = imageData.data[index + 2];
        imageData.data[index + 2] = table[2 + b * 4];
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return LookupTableFilter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


LookupTableFilter.prototype.availableOptions = {
  lookupTable: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].INT },
  lookupTableData: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: [] }

  /**
   * Stores a 256 byte long lookup table in a 2d texture which will be
   * used to look up the corresponding value for each channel.
   * @class
   * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
   * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
   */
};
var LookupTable = function (_Primitive) {
  _inherits(LookupTable, _Primitive);

  function LookupTable() {
    var _ref2;

    _classCallCheck(this, LookupTable);

    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref2 = LookupTable.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTable)).call.apply(_ref2, [this].concat(args)));

    _this2._filter = new LookupTableFilter({
      lookupTable: _this2._options.textureGLUnit
    });
    _this2._textures = {};
    _this2._renderers = {};
    return _this2;
  }

  /**
   * Gets called before this primitive's filter is being applied
   * @param {PhotoEditorSDK} sdk
   */


  _createClass(LookupTable, [{
    key: 'update',
    value: function update(sdk) {
      var renderer = sdk.getRenderer();

      /* istanbul ignore if */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        this._updateWebGLTexture(sdk);
      } else if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].CANVAS)) {
        this._filter.setLookupTableData(this._options.data);
      }
    }

    /**
     * Updates the lookup table texture (WebGL only)
     * @param {PhotoEditorSDK} sdk
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_updateWebGLTexture',
    value: function _updateWebGLTexture(sdk) {
      if (typeof this._options.data === 'undefined') {
        throw new Error('LookupTable: No data specified.');
      }

      var data = new Uint8Array(this._options.data);

      var renderer = sdk.getRenderer();
      var id = renderer.id;

      this._renderers[id] = renderer;
      if (!this._textures[id]) {
        this._textures[id] = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].BaseTexture();
      }

      var texture = this._textures[id];
      var pixelArrayImage = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].PixelArrayImage(256, 1, data);
      texture.setSource(pixelArrayImage);
      texture.setGLUnit(this._options.textureGLUnit);

      /* istanbul ignore next */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        renderer.updateTexture(texture);
      }
    }

    /**
     * Cleans up this primitive
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(LookupTable.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTable.prototype), 'dispose', this).call(this);
      for (var id in this._textures) {
        this._textures[id].dispose();
        delete this._textures[id];
      }
      delete this._options.data;
    }
  }]);

  return LookupTable;
}(__WEBPACK_IMPORTED_MODULE_6__primitive__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (LookupTable);

/***/ }),
/* 175 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__brush_path__ = __webpack_require__(414);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__sprite__ = __webpack_require__(74);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__brush_brushes_brush__ = __webpack_require__(176);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__brush_brushes_radial_brush__ = __webpack_require__(416);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * A Brush that can be drawn by SpriteOperation. Should only be created via {@link PhotoEditorSDK.Operations.SpriteOperation#createBrush}
 * @class
 * @memberof PhotoEditorSDK.Operations.SpriteOperation
 */

var BrushSprite = function (_Sprite) {
  _inherits(BrushSprite, _Sprite);

  /**
   * Creates a new Sticker
   * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
   * @param  {Object} [options]
   */
  function BrushSprite() {
    var _ref;

    _classCallCheck(this, BrushSprite);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = BrushSprite.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite)).call.apply(_ref, [this].concat(args)));

    _this._persistedPaths = [];
    _this._outputCanvasDirty = true;
    _this._outputCanvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
    _this._outputContext = _this._outputCanvas.getContext('2d');
    _this._persistCanvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
    _this._persistContext = _this._persistCanvas.getContext('2d');
    _this._nextCanvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();

    _this._texture = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Texture.fromCanvas(_this._outputCanvas);
    _this._sprite.setTexture(_this._texture);

    _this._onPathUpdate = _this._onPathUpdate.bind(_this);
    return _this;
  }

  /**
   * Applies a flip in the given direction
   * @param  {String} direction
   */


  _createClass(BrushSprite, [{
    key: 'applyFlip',
    value: function applyFlip(direction) {
      this._options.paths.forEach(function (path) {
        path.forEachControlPoint(function (controlPoint) {
          var position = controlPoint.getPosition().clone();
          switch (direction) {
            case 'horizontal':
              position.x = 1 - position.x;
              break;
            case 'vertical':
              position.y = 1 - position.y;
              break;
          }
          controlPoint.setPosition(position);
        });
        path.setDirty(true);
      });

      this._reset();
    }

    /**
     * Applies a rotation with the given degrees
     * @param  {Number} degrees
     */

  }, {
    key: 'applyRotation',
    value: function applyRotation(degrees) {
      this._options.paths.forEach(function (path) {
        path.forEachControlPoint(function (controlPoint) {
          var position = controlPoint.getPosition().clone();
          if (degrees === 90) {
            position.flip();
            position.x = 1 - position.x;
          } else if (degrees === -90) {
            position.flip();
            position.y = 1 - position.y;
          }
          controlPoint.setPosition(position);
        });

        path.setDirty(true);
      });

      this._reset();
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'applyTransform',
    value: function applyTransform(transformChange) {
      var lastBrush = null;
      this._options.paths.forEach(function (path) {
        path.forEachControlPoint(function (controlPoint) {
          controlPoint.setPosition(transformChange.applyToRelativePoint(controlPoint.getPosition()));
        });

        // Brushes can be re-used across paths
        var brush = path.getBrush();
        if (brush !== lastBrush) {
          brush.setSize(transformChange.applyToRelativeSize(brush.getSize()));
          lastBrush = brush;
        }
        path.setDirty(true);
      });

      // Update
      this._reset();
    }

    /**
     * Clears the canvas
     */

  }, {
    key: 'clearCanvas',
    value: function clearCanvas() {
      if (!this._outputCanvas) {
        // `clearCanvas` is called when paths are set in Sprite's constructor. At this
        // point, `this._outputCanvas` does not exist yet.
        return;
      }

      this._outputCanvasDirty = true;

      var _outputCanvas = this._outputCanvas,
          width = _outputCanvas.width,
          height = _outputCanvas.height;

      this._outputContext.clearRect(0, 0, width, height);
    }

    /**
     * Clears the persist canvas
     */

  }, {
    key: 'clearPersistCanvas',
    value: function clearPersistCanvas() {
      if (!this._persistCanvas) {
        // `clearCanvas` is called when paths are set in Sprite's constructor. At this
        // point, `this._persistCanvas` does not exist yet.
        return;
      }

      var _persistCanvas = this._persistCanvas,
          width = _persistCanvas.width,
          height = _persistCanvas.height;

      this._persistContext.clearRect(0, 0, width, height);
    }

    /**
     * Returns a serialized version of this configurable
     * @param {String[]} keys
     * @param {Boolean} toObject = false
     * @return {Object}
     */

  }, {
    key: 'serializeOptions',
    value: function serializeOptions(keys) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var options = _get(BrushSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite.prototype), 'serializeOptions', this).call(this, keys, toObject);
      if (!keys) options.type = 'brush';
      return options;
    }

    /**
     * Returns a serialized version of the given option
     * @param {String} optionName
     * @param {Boolean} toObject = false
     * @return {*}
     */

  }, {
    key: 'serializeOption',
    value: function serializeOption(optionName) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      if (optionName === 'paths') {
        return this._options.paths.map(function (path) {
          return path.serializeOptions(undefined, toObject);
        });
      }

      return _get(BrushSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite.prototype), 'serializeOption', this).call(this, optionName, toObject);
    }

    /**
     * Creates and adds a new path
     * @param {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Brush} brush
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path}
     */

  }, {
    key: 'createPath',
    value: function createPath(brush) {
      var path = new __WEBPACK_IMPORTED_MODULE_6__brush_path__["a" /* default */](this._operation, { brush: brush }, this._nextCanvas);
      path.on('update', this._onPathUpdate);
      this._options.paths.push(path);
      this.setDirty(true);
      return path;
    }

    /**
     * Gets called when a path has been updated
     * @private
     */

  }, {
    key: '_onPathUpdate',
    value: function _onPathUpdate() {
      this._operation.setDirty(true);
      this.setDirty(true);
    }

    /**
     * Gets called when a path has been closed / persisted
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path} path
     * @private
     */

  }, {
    key: '_onPathPersist',
    value: function _onPathPersist(path) {
      path.renderToCanvas(this._persistCanvas);
      this._nextCanvas = path.getCanvas();

      var context = this._nextCanvas.getContext('2d');
      context.clearRect(0, 0, this._nextCanvas.width, this._nextCanvas.height);

      this._persistedPaths.push(path);
    }

    /**
     * Returns the Texture for the sprite that should be rendered
     * @return {PhotoEditorSDK.Engine.Texture}
     * @private
     * @abstract
     */

  }, {
    key: '_getTexture',
    value: function _getTexture() {
      return this._texture;
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {
      var dimensionsChanged = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

      _get(BrushSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite.prototype), 'setDirtyForRenderer', this).call(this, dirty, renderer, dimensionsChanged);
      if (dirty && dimensionsChanged) {
        this._persistedPaths = [];
        this.clearPersistCanvas();
        this._options.paths.forEach(function (path) {
          path.setDirty(true);
        });
      }
    }

    /**
     * Sets this brush to dirty
     * @param {Boolean} dirty
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirty',
    value: function setDirty(dirty) {
      var dimensionsChanged = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      for (var rendererId in this._dirtiness) {
        this.setDirtyForRenderer(dirty, this._renderers[rendererId], dimensionsChanged);
      }
    }

    /**
     * Renders all paths to the canvas
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'render',
    value: function render(inputDimensions) {
      var _this2 = this;

      var renderer = this._operation.getSDK().getRenderer();

      if (!this.isDirtyForRenderer(renderer)) {
        return;
      }

      __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(this._outputCanvas, inputDimensions);
      __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(this._persistCanvas, inputDimensions);

      // Make sure all paths are rendered to their canvases
      this._options.paths.forEach(function (path) {
        path.render(inputDimensions);

        if (path.getClosed() && _this2._persistedPaths.indexOf(path) === -1) {
          _this2._onPathPersist(path);
        }
      });

      // Render persisted paths to output in one go
      this.clearCanvas();
      this._outputContext.drawImage(this._persistCanvas, 0, 0);

      // Render unpersisted paths to output
      this._options.paths.forEach(function (path) {
        if (!path.getClosed()) {
          path.renderToCanvas(_this2._outputCanvas);
        }
      });

      this.setDirtyForRenderer(false, renderer);
    }

    /**
     * Updates this sprite
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'update',
    value: function update(sdk, inputDimensions) {
      if (inputDimensions) {
        __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(this._outputCanvas, inputDimensions);
        __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(this._persistCanvas, inputDimensions);

        // Update texture dimensions
        this._texture.getBaseTexture().update();
      }

      // Render paths and control points
      this.render(inputDimensions);

      // Upload canvas to texture
      var renderer = sdk.getRenderer();
      /* istanbul ignore next */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        renderer.updateTexture(this._texture.getBaseTexture());
      }

      _get(BrushSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite.prototype), 'update', this).call(this, sdk, inputDimensions);
    }

    /**
     * Resets this brush so that it can be re-rendered
     * @private
     */

  }, {
    key: '_reset',
    value: function _reset() {
      this._persistedPaths = [];
      if (this._operation) {
        this._operation.setDirty(true);
      }
      this.setDirty(true);
      this.clearCanvas();
      this.clearPersistCanvas();
    }

    // -------------------------------------------------------------------------- GETTERS / SETTERS

    /**
     * Returns the canvas we're rendering brushes to
     * @return {CanvasElement}
     */

  }, {
    key: 'getCanvas',
    value: function getCanvas() {
      return this._outputCanvas;
    }

    /**
     * Returns a new instance of the radial brush
     * (Used by the LegacyEngineAdapter)
     * @return {Brush}
     * @private
     */

  }, {
    key: '_createRadialBrush',
    value: function _createRadialBrush() {
      return new __WEBPACK_IMPORTED_MODULE_9__brush_brushes_radial_brush__["a" /* default */]();
    }

    /**
     * Returns the canvas that the current strokes are being rendered on.
     * (Used by the LegacyEngineAdapter)
     */

  }, {
    key: '_getTempCanvas',
    value: function _getTempCanvas() {
      return this._nextCanvas;
    }

    // -------------------------------------------------------------------------- DISPOSAL

    /**
     * Disposes this Brush
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(BrushSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BrushSprite.prototype), 'dispose', this).call(this);
      this._texture && this._texture.getBaseTexture().dispose();
    }
  }]);

  return BrushSprite;
}(__WEBPACK_IMPORTED_MODULE_7__sprite__["a" /* default */]);

BrushSprite.prototype.availableOptions = {
  id: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: function _default() {
      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].getUUID();
    } },
  position: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0) },
  scale: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1.0, 1.0) },
  anchor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.0, 0.0) },
  pivot: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.0, 0.0) },
  rotation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  paths: {
    type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY,
    default: [],
    setter: function setter(paths) {
      var _this3 = this;

      paths = paths.map(function (path) {
        if (path instanceof __WEBPACK_IMPORTED_MODULE_6__brush_path__["a" /* default */]) return path;

        var brush = path.brush,
            closed = path.closed;

        var newPath = new __WEBPACK_IMPORTED_MODULE_6__brush_path__["a" /* default */](_this3._operation, { brush: brush, closed: closed }, _this3._nextCanvas);
        path.controlPoints.forEach(function (position) {
          newPath.addControlPoint(position);
        });
        return newPath;
      });

      this._reset();
      return paths;
    }
  }
};

BrushSprite.type = 'brush';
BrushSprite.Brush = __WEBPACK_IMPORTED_MODULE_8__brush_brushes_brush__["a" /* default */];
BrushSprite.Path = __WEBPACK_IMPORTED_MODULE_6__brush_path__["a" /* default */];
BrushSprite.Brushes = {
  RadialBrush: __WEBPACK_IMPORTED_MODULE_9__brush_brushes_radial_brush__["a" /* default */]
};

/* harmony default export */ __webpack_exports__["a"] = (BrushSprite);

/***/ }),
/* 176 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

var Brush = function (_Configurable) {
  _inherits(Brush, _Configurable);

  function Brush() {
    var _ref;

    _classCallCheck(this, Brush);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = Brush.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Brush)).call.apply(_ref, [this].concat(args)));

    _this._lastOptions = {};
    _this._lastInputDimensions = new Vector2(0, 0);
    _this._brush = null;
    return _this;
  }

  /**
   * Returns the prepared brush image (colored and resized)
   * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
   * @return {HTMLImageElement|HTMLCanvasElement}
   */


  _createClass(Brush, [{
    key: 'getBrushImage',
    value: function getBrushImage(inputDimensions) {
      if (this._brush && this.optionsEqual(this._lastOptions) && inputDimensions.equals(this._lastInputDimensions)) {
        return this._brush;
      }

      var _options = this._options,
          image = _options.image,
          size = _options.size;

      image.width = image.height = Math.ceil(size * inputDimensions.min());

      var canvas = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].createCanvas();
      canvas.width = image.width;
      canvas.height = image.height;

      var context = canvas.getContext('2d');
      context.drawImage(image, 0, 0, canvas.width, canvas.height);

      var tintedBrush = this._tintImageData(context.getImageData(0, 0, canvas.width, canvas.height), canvas.width, canvas.height);
      context.putImageData(tintedBrush, 0, 0);

      this._lastOptions = this.serializeOptions(['size', 'color']);
      this._brush = canvas;
      this._lastInputDimensions = inputDimensions.clone();

      return canvas;
    }

    /**
     * Tints the given image data in the current color
     * @param  {ImageData} imageData
     * @return {ImageData}
     * @private
     */

  }, {
    key: '_tintImageData',
    value: function _tintImageData(imageData) {
      var color = this._options.color;


      for (var i = 0; i < imageData.data.length; i += 4) {
        imageData.data[i] += (color.r * 255 - imageData.data[i]) * color.a;
        imageData.data[i + 1] += (color.g * 255 - imageData.data[i + 1]) * color.a;
        imageData.data[i + 2] += (color.b * 255 - imageData.data[i + 2]) * color.a;
      }

      return imageData;
    }

    /**
     * Returns a clone of this brush
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Brush}
     */

  }, {
    key: 'clone',
    value: function clone() {
      var Constructor = this.constructor;
      return new Constructor(this._options);
    }
  }]);

  return Brush;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Configurable"]);

/* harmony default export */ __webpack_exports__["a"] = (Brush);


Brush.prototype.availableOptions = {
  identifier: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING },
  image: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].IMAGE },
  size: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.05 },
  color: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].RED }
};

/***/ }),
/* 177 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__text_splitter__ = __webpack_require__(178);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].Vector2;

var TextRenderer = function () {
  function TextRenderer(text, operation) {
    _classCallCheck(this, TextRenderer);

    this._text = text;
    this._operation = operation;
    this._textOptions = {};

    this.rotation = 0;

    this._createCanvas();
    this._createTexture();
  }

  /**
   * Creates the canvas and initializes the text splitter
   * @private
   */


  _createClass(TextRenderer, [{
    key: '_createCanvas',
    value: function _createCanvas() {
      this._canvas = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Utils"].createCanvas();
      this._context = this._canvas.getContext('2d');
      this._textSplitter = new __WEBPACK_IMPORTED_MODULE_2__text_splitter__["a" /* default */](this._context);

      this._finalCanvas = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Utils"].createCanvas();
      this._finalContext = this._finalCanvas.getContext('2d');
    }

    /**
     * Creates the texture
     * @private
     */

  }, {
    key: '_createTexture',
    value: function _createTexture() {
      this._texture = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Engine"].Texture.fromCanvas(this._canvas);
      this._finalTexture = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Engine"].Texture.fromCanvas(this._finalCanvas);
    }

    /**
     * Applies the text options on the given context
     * @param  {Object} textOptions
     * @param  {CanvasRenderingContext2D} context
     * @private
     */

  }, {
    key: '_applyTextOptions',
    value: function _applyTextOptions(textOptions, context) {
      context.font = this._text.getFontStyle() + ' ' + this._text.getFontWeight() + ' ' + textOptions.fontSize + 'px ' + '"' + this._text.getFontFamily() + '"';

      context.textBaseline = 'top';
      context.textAlign = this._text.getAlignment();
      context.fillStyle = this._text.getColor().toRGBA();

      context.strokeStyle = this._text.getOutlineColor().toRGBA();
      var outlineWidth = this._text.getOutlineWidth();
      if (outlineWidth > 0) {
        context.lineWidth = outlineWidth;
      }
    }

    /**
     * Iterate over all lines and split them into multiple lines, depending
     * on the width they need
     * @param {Number} maxWidth
     * @return {Array.<string>}
     * @private
     */

  }, {
    key: '_buildOutputLines',
    value: function _buildOutputLines(maxWidth) {
      this._textSplitter.setText(this._text.getText());
      this._textSplitter.setMaxWidth(maxWidth);
      return this._textSplitter.getLines().map(function (line) {
        // We don't want to render trailing spaces
        return line.replace(/\s+$/i, '');
      });
    }

    /**
     * Draws the given line onto context at the given Y position
     * @param  {String} text
     * @param  {Number} y
     * @private
     */

  }, {
    key: '_renderTextLine',
    value: function _renderTextLine(text, y) {
      var textAlignment = this._text.getAlignment();
      var drawPosition = new Vector2(0, y); // Left alignment

      switch (textAlignment) {
        case 'center':
          drawPosition.x = this._canvas.width / 2;
          break;
        case 'right':
          drawPosition.x = this._canvas.width;
          break;
      }

      this._context.fillText(text, drawPosition.x, drawPosition.y);
      var outlineWidth = this._text.getOutlineWidth();
      if (outlineWidth > 0) {
        this._context.miterLimit = 2;
        this._context.strokeText(text, drawPosition.x, drawPosition.y);
      }
    }

    /**
     * Renders this sprite
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'update',
    value: function update(sdk, inputDimensions) {
      var textOptions = this.calculateFontStyles(sdk, inputDimensions);
      if (textOptions) {
        var _calculateText2 = this._calculateText(sdk, textOptions, inputDimensions),
            dimensions = _calculateText2.dimensions,
            lines = _calculateText2.lines;

        this._renderText(sdk, dimensions, lines, textOptions, inputDimensions);
        this._updateFinalTexture();
      }
    }

    /**
     * Renders the rotated text on the final texture
     * @private
     */

  }, {
    key: '_updateFinalTexture',
    value: function _updateFinalTexture() {
      var _canvas = this._canvas,
          width = _canvas.width,
          height = _canvas.height;

      var rotation = this.rotation;
      var cos = Math.cos(rotation);
      var sin = Math.sin(rotation);

      var finalDimensions = new Vector2(Math.abs(width * cos) + Math.abs(height * sin), Math.abs(width * sin) + Math.abs(height * cos));

      this._finalCanvas.width = finalDimensions.x;
      this._finalCanvas.height = finalDimensions.y;

      this._finalContext.save();
      this._finalContext.translate(this._finalCanvas.width / 2, this._finalCanvas.height / 2);
      this._finalContext.rotate(rotation);
      this._finalContext.drawImage(this._canvas, -width / 2, -height / 2);
      this._finalContext.restore();
    }

    /**
     * Renders the text
     * @param  {PhotoEditorSDK} sdk
     * @param  {Vector2} dimensions
     * @param  {Array.<String>} lines
     * @param  {Object} textOptions
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @private
     */

  }, {
    key: '_renderText',
    value: function _renderText(sdk, dimensions, lines, textOptions, inputDimensions) {
      // Resize the canvas
      this._canvas.width = dimensions.x;
      this._canvas.height = dimensions.y;

      if (this._text.getMaxHeight()) {
        this._canvas.height = Math.min(this._text.getMaxHeight() * inputDimensions.y, this._canvas.height);
      }

      // Update the context
      this._context = this._canvas.getContext('2d');

      // Render background color
      this._context.fillStyle = this._text.getBackgroundColor().toRGBA();
      this._context.fillRect(0, 0, dimensions.x, dimensions.y);

      // Apply text options
      this._applyTextOptions(textOptions, this._context);

      // Draw lines
      for (var lineNum = 0; lineNum < lines.length; lineNum++) {
        var line = lines[lineNum];
        this._renderTextLine(line, textOptions.topPadding + textOptions.lineHeight * lineNum);
      }
    }

    /**
     * Calculates the actual font size and line height
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'calculateFontStyles',
    value: function calculateFontStyles(sdk, inputDimensions) {
      var fontFamily = this._text.getFontFamily();
      var fontSize = this._text.getFontSize() * inputDimensions.y;
      var textHeight = this._text.getAbsoluteTextHeight(inputDimensions);
      var lineHeight = textHeight * this._text.getLineHeight();
      var topPadding = textHeight * (this._text.getLineHeight() - 1.0) / 2.0;

      var textOptions = { fontFamily: fontFamily, fontSize: fontSize, lineHeight: lineHeight, topPadding: topPadding };
      if (this._textOptions.fontFamily !== fontFamily || this._textOptions.fontSize !== fontSize || this._textOptions.lineHeight !== lineHeight) {
        this._textOptions = textOptions;
      }

      return textOptions;
    }

    /**
     * Calculates the dimensions and new lines according to max width
     * @param  {PhotoEditorSDK} sdk
     * @param  {Object} textOptions
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {Object}
     * @private
     */

  }, {
    key: '_calculateText',
    value: function _calculateText(sdk, textOptions, inputDimensions) {
      // Calculate max width
      var maxWidth = this._text.getMaxWidth() * inputDimensions.x;

      // Apply text options
      this._applyTextOptions(textOptions, this._context);

      // Calculate bounding box
      var dimensions = new Vector2();
      var lines = this._text.getText().split('\n');
      if (typeof maxWidth !== 'undefined') {
        // Calculate the bounding box
        dimensions.x = maxWidth;
        lines = this._buildOutputLines(maxWidth);
      } else {
        for (var lineNum = 0; lineNum < lines.length; lineNum++) {
          var line = lines[lineNum];
          dimensions.x = Math.max(dimensions.x, this._context.measureText(line).width);
        }
      }

      // Calculate boundingbox height
      var lineHeight = textOptions.lineHeight;

      dimensions.y = lines.length * lineHeight;

      return { dimensions: dimensions, lines: lines };
    }

    /**
     * Returns this renderer's texture
     * @return {Engine.Texture}
     */

  }, {
    key: 'getTexture',
    value: function getTexture() {
      return this._texture;
    }

    /**
     * Returns this renderer's final texture containing the rotated text
     * @return {Engine.Texture}
     */

  }, {
    key: 'getFinalTexture',
    value: function getFinalTexture() {
      return this._finalTexture;
    }

    /**
     * Returns the dimensions for this text
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions(sdk, inputDimensions) {
      var textOptions = this.calculateFontStyles(sdk, inputDimensions);

      var _calculateText3 = this._calculateText(sdk, textOptions, inputDimensions),
          dimensions = _calculateText3.dimensions;

      return dimensions;
    }

    /**
     * Disposes this text renderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      if (this._measurementElement) {
        document.body.removeChild(this._measurementElement);
      }

      if (this._texture) {
        this._texture.dispose();
        this._texture = null;
      }

      if (this._finalTexture) {
        this._finalTexture.dispose();
        this._finalTexture = null;
      }
    }
  }]);

  return TextRenderer;
}();

/* harmony default export */ __webpack_exports__["a"] = (TextRenderer);

/***/ }),
/* 178 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

var TextSplitter = function () {
  function TextSplitter(context) {
    _classCallCheck(this, TextSplitter);

    this._context = context;
    this._lastFontStyle = {};
  }

  /**
   * Returns the lines that fit the maxWidth
   * @return {Array.<String>}
   */


  _createClass(TextSplitter, [{
    key: 'getLines',
    value: function getLines() {
      var _this = this;

      var lines = [];
      var newLineWords = [];

      // Iterate over lines
      var linesCount = this._lines.length;
      for (var l = 0; l < linesCount; l++) {
        var line = this._lines[l];

        // Iterate over words
        var words = this._buildWords(line);
        var wordsCount = words.length;
        for (var w = 0; w < wordsCount; w++) {
          var word = words[w];

          // Check if line is too wide for the maxwidth
          var currentLine = newLineWords.concat(word).join('').replace(/\s+$/i, '');
          var width = this._getWidth(currentLine);
          if (width > this._maxWidth) {
            // If there have been words before this one, start
            // a new line
            if (newLineWords.length > 0) {
              // Line too long -> line ended
              lines.push(newLineWords.join(''));

              // Start a new line with the word
              newLineWords = [word];
            }

            // If the next word is too long (without trailing spaces), split it up
            var _word = word.replace(/\s+$/i, '');
            if (this._getWidth(_word) > this._maxWidth) {
              var splitWord = this._splitWord(word);
              lines = lines.concat(splitWord.lines);
              if (splitWord.rest) {
                newLineWords = [splitWord.rest];
              }
            }
          } else {
            newLineWords.push(word);
          }
        }

        lines.push(newLineWords.join(''));

        newLineWords = [];
      }

      return lines.map(function (line) {
        return _this._trimLine(line, _this._context.textAlign);
      });
    }

    /**
     * Removes whitespaces based on alignment.
     * If the newline ends or begins with one or more whitespaces than remove the first/last depending on the aligment.
     * @param {String} line
     * @param {String} alignment
     * @return {String} line
     */

  }, {
    key: '_trimLine',
    value: function _trimLine(line, alignment) {
      return line; // FIXME: not supported by textarea yet. Enable later
      // switch (alignment) {
      //   case 'right':
      //     return line.replace(/\s{1}$/, '')
      //   case 'left':
      //     return line.replace(/^\s{1}/, '')
      //   case 'center':
      //   default:
      //     return line
      // }
    }

    /**
     * Builds an array of words from the given line
     * @param  {String} line
     * @return {Array.<String>}
     * @private
     */

  }, {
    key: '_buildWords',
    value: function _buildWords(line) {
      var words = [];
      var word = '';

      var len = line.length;
      for (var i = 0; i < len; i++) {
        var char = line[i];
        word += char;
        if (char === ' ' || char === '-' || i === len - 1) {
          words.push(word);
          word = '';
        }
      }

      return words;
    }

    /**
     * Splits up the given word to fit the max width
     * @param  {String} word
     * @return {Object}
     * @private
     */

  }, {
    key: '_splitWord',
    value: function _splitWord(word) {
      var response = {
        lines: [],
        rest: null
      };

      var wordLength = word.length;
      var chars = [];
      for (var c = 0; c < wordLength; c++) {
        var char = word[c];
        if (this._getWidth(chars.concat(char).join('')) > this._maxWidth) {
          if (chars.length > 0) {
            response.lines.push(chars.join(''));
          }
          chars = [char];
        } else {
          chars.push(char);
        }

        if (c === wordLength - 1 && chars.length > 0) {
          response.rest = chars.join('');
        }
      }

      return response;
    }

    /**
     * Checks if the font style changed from the last call
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_fontStyleChanged',
    value: function _fontStyleChanged() {
      if (this._context.font !== this._lastFontStyle) {
        this._lastFontStyle = this._context.font;
        return true;
      }
      return false;
    }

    /**
     * Returns the measured width for the given string
     * @param  {String} string
     * @return {Number}
     * @private
     */

  }, {
    key: '_getWidth',
    value: function _getWidth(string) {
      return this._context.measureText(string).width;
    }

    /**
     * Sets the text
     * @param {String} text
     */

  }, {
    key: 'setText',
    value: function setText(text) {
      this._text = text;
      this._lines = text.split('\n');
    }

    /**
     * Sets the max width
     * @param {Number} maxWidth
     */

  }, {
    key: 'setMaxWidth',
    value: function setMaxWidth(maxWidth) {
      this._maxWidth = maxWidth;
    }
  }]);

  return TextSplitter;
}();

/* harmony default export */ __webpack_exports__["a"] = (TextSplitter);

/***/ }),
/* 179 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignBlocksLight; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_design_blocks__ = __webpack_require__(75);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__models_rows_shearing_text_design_row_form__ = __webpack_require__(180);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__models_rows_default_text_design_row_single__ = __webpack_require__(26);








var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var TextDesignBlocksLight = function (_TextDesignBlocks) {
  _inherits(TextDesignBlocksLight, _TextDesignBlocks);

  function TextDesignBlocksLight() {
    _classCallCheck(this, TextDesignBlocksLight);

    return _possibleConstructorReturn(this, (TextDesignBlocksLight.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignBlocksLight)).apply(this, arguments));
  }

  _createClass(TextDesignBlocksLight, [{
    key: '_layoutRow',
    value: function _layoutRow(words, width, attributes, isMasked) {
      return new __WEBPACK_IMPORTED_MODULE_10__models_rows_default_text_design_row_single__["a" /* TextDesignRowSingle */]({ words: words, width: width, attributes: attributes });
    }
  }, {
    key: '_layoutRows',
    value: function _layoutRows(lines, width) {
      var elements = _get(TextDesignBlocksLight.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignBlocksLight.prototype), '_layoutRows', this).call(this, lines, width);

      var firstFormHeight = 0.032 * width;
      var lastFormHeight = 0.080 * width;

      var firstRow = new __WEBPACK_IMPORTED_MODULE_9__models_rows_shearing_text_design_row_form__["a" /* TextDesignRowForm */]({
        width: width,
        height: firstFormHeight,
        type: __WEBPACK_IMPORTED_MODULE_9__models_rows_shearing_text_design_row_form__["a" /* TextDesignRowForm */].FormType.LongLine,
        shearingAngle: 0
      }).layout();

      var lastRow = new __WEBPACK_IMPORTED_MODULE_9__models_rows_shearing_text_design_row_form__["a" /* TextDesignRowForm */]({
        width: width,
        height: lastFormHeight,
        type: __WEBPACK_IMPORTED_MODULE_9__models_rows_shearing_text_design_row_form__["a" /* TextDesignRowForm */].FormType.LongAndShortLine,
        shearingAngle: 0
      }).layout();

      return [firstRow].concat(_toConsumableArray(elements), [lastRow]);
    }
  }]);

  return TextDesignBlocksLight;
}(__WEBPACK_IMPORTED_MODULE_8__text_design_blocks__["a" /* TextDesignBlocks */]);

TextDesignBlocksLight.defaultFontIdentifiers = ['imgly_font_summer_font_light'];
TextDesignBlocksLight.identifier = 'imgly_text_design_blocks_light';
TextDesignBlocksLight.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_8__text_design_blocks__["a" /* TextDesignBlocks */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignBlocksLight.defaultFontIdentifiers }
});

/***/ }),
/* 180 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignRowForm; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_element__ = __webpack_require__(52);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__default_text_design_row__ = __webpack_require__(92);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__size_value__ = __webpack_require__(33);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__utils_canvas__ = __webpack_require__(48);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







var Rectangle = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Rectangle;


var TextDesignRowForm = function (_TextDesignRow) {
  _inherits(TextDesignRowForm, _TextDesignRow);

  function TextDesignRowForm() {
    var _ref;

    _classCallCheck(this, TextDesignRowForm);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignRowForm.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRowForm)).call.apply(_ref, [this].concat(args)));

    _this.setSize(new __WEBPACK_IMPORTED_MODULE_8__size_value__["a" /* SizeValue */](_this.getWidth(), _this.getHeight()));
    return _this;
  }

  _createClass(TextDesignRowForm, [{
    key: '_calculateLayoutElements',
    value: function _calculateLayoutElements() {
      return [new __WEBPACK_IMPORTED_MODULE_6__text_design_element__["a" /* TextDesignElement */]({ frame: this._getTextFrame() })];
    }
  }, {
    key: 'render',
    value: function render(context) {
      var frame = this._getFrame();
      var type = this.getType();
      var attributes = this.getAttributes();
      var color = attributes.getTextColor();

      var rectHeight = frame.height / 3;
      var firstRect = new Rectangle(frame.x, frame.y, frame.width, rectHeight);
      var secondRect = new Rectangle(frame.x, frame.y + rectHeight * 2, frame.width, rectHeight);

      switch (type) {
        case TextDesignRowForm.FormType.Rect:
          Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["d" /* fillRect */])(context, frame, color);
          break;

        case TextDesignRowForm.FormType.DoubleRect:
          Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["d" /* fillRect */])(context, firstRect, color);
          Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["d" /* fillRect */])(context, secondRect, color);
          break;

        case TextDesignRowForm.FormType.DoubleRectFirstPunctuated:
          Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["e" /* fillRectPunctuated */])(context, firstRect, color);
          Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["d" /* fillRect */])(context, secondRect, color);
          break;

        case TextDesignRowForm.FormType.DoubleRectSecondPunctuated:
          Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["d" /* fillRect */])(context, firstRect, color);
          Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["e" /* fillRectPunctuated */])(context, secondRect, color);
          break;

        case TextDesignRowForm.FormType.LongLine:
          var lineHeight = frame.height / 2;
          var rect = new Rectangle(frame.x, frame.y, frame.width, lineHeight);
          Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["c" /* drawRoundedRect */])(context, rect, rect.height * 0.5, color);
          break;

        case TextDesignRowForm.FormType.LongAndShortLine:
          var firstLineHeight = frame.height * 0.2;
          var secondLineHeight = firstLineHeight * 0.75;
          firstRect = new Rectangle(frame.x, frame.y + firstLineHeight, frame.width, firstLineHeight);
          var secondRectX = frame.x + frame.width * 0.25;
          var secondRectY = frame.y + frame.height - secondLineHeight;
          secondRect = new Rectangle(secondRectX, secondRectY, frame.width * 0.5, secondLineHeight);
          Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["c" /* drawRoundedRect */])(context, firstRect, firstRect.height * 0.5, color);
          Object(__WEBPACK_IMPORTED_MODULE_9__utils_canvas__["c" /* drawRoundedRect */])(context, secondRect, secondRect.height * 0.5, color);
          break;
      }
    }
  }]);

  return TextDesignRowForm;
}(__WEBPACK_IMPORTED_MODULE_7__default_text_design_row__["a" /* TextDesignRow */]);

TextDesignRowForm.FormType = {
  Rect: 'RECT',
  DoubleRect: 'DOUBLE_RECT',
  DoubleRectFirstPunctuated: 'DOUBLE_RECT_FIRST_PUNCTUATED',
  DoubleRectSecondPunctuated: 'DOUBLE_RECT_SECOND_PUNCTUATED',
  LongLine: 'LONG_LINE',
  LongAndShortLine: 'LONG_AND_SHORT_LINE'
};
TextDesignRowForm.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_7__default_text_design_row__["a" /* TextDesignRow */].prototype.availableOptions, {
  height: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 100 },
  type: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: TextDesignRowForm.FormType.Rect, available: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].values(TextDesignRowForm.FormType) }
});

/***/ }),
/* 181 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignCelebrate; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design_blocks__ = __webpack_require__(75);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__models_rows_default_text_design_row_single__ = __webpack_require__(26);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__models_text_design_banderole__ = __webpack_require__(123);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__text_words__ = __webpack_require__(47);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__models_rows_image_text_design_row_image__ = __webpack_require__(125);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








var TextDesignCelebrate = function (_TextDesignBlocks) {
  _inherits(TextDesignCelebrate, _TextDesignBlocks);

  function TextDesignCelebrate() {
    _classCallCheck(this, TextDesignCelebrate);

    return _possibleConstructorReturn(this, (TextDesignCelebrate.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignCelebrate)).apply(this, arguments));
  }

  _createClass(TextDesignCelebrate, [{
    key: '_fontForRow',
    value: function _fontForRow(index, words) {
      var fonts = this.getFontIdentifiers();
      return fonts[index % fonts.length];
    }
  }, {
    key: '_minimumNumberOfLines',
    value: function _minimumNumberOfLines(words) {
      return Math.max(Math.floor(_get(TextDesignCelebrate.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignCelebrate.prototype), '_minimumNumberOfLines', this).call(this, words) * 0.7), 1);
    }
  }, {
    key: '_maximumNumberOfLines',
    value: function _maximumNumberOfLines(words) {
      return Math.max(Math.floor(words.countNumberOfCharacters() / 5), 1);
    }
  }, {
    key: '_randomLayoutRow',
    value: function _randomLayoutRow(words, index, width, attributes) {
      return this._createSingleRow(TextDesignCelebrate.RowType.Single, words, width, attributes);
    }
  }, {
    key: '_createSingleRow',
    value: function _createSingleRow(rowType, words, width, attributes) {
      var fontIdentifier = attributes.getFontIdentifier();

      var updatedWords = fontIdentifier === 'imgly_font_amberlight' || fontIdentifier === 'imgly_font_handycheera_regular' ? new __WEBPACK_IMPORTED_MODULE_10__text_words__["a" /* Words */]().set(words.getLowerCase()) : words;

      // TODO: SingleImage
      switch (rowType) {
        case TextDesignCelebrate.RowType.Single:
          return new __WEBPACK_IMPORTED_MODULE_8__models_rows_default_text_design_row_single__["a" /* TextDesignRowSingle */]({ words: updatedWords, width: width, attributes: attributes });
        case TextDesignCelebrate.RowType.SingleImage:
          return new __WEBPACK_IMPORTED_MODULE_11__models_rows_image_text_design_row_image__["a" /* TextDesignRowImage */]({ words: updatedWords, width: width, attributes: attributes });
        default:
          __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Log"].warn('TextDesignCelebrate#_createSingleRow: Invalid row type \'' + rowType + '\'');
          return null;
      }
    }
  }]);

  return TextDesignCelebrate;
}(__WEBPACK_IMPORTED_MODULE_7__text_design_blocks__["a" /* TextDesignBlocks */]);

TextDesignCelebrate.defaultFontIdentifiers = ['imgly_font_handycheera_regular', 'imgly_font_rasa_regular'];
TextDesignCelebrate.defaultBanderoles = [__WEBPACK_IMPORTED_MODULE_9__models_text_design_banderole__["a" /* TextDesignBanderole */].Celebrate1, __WEBPACK_IMPORTED_MODULE_9__models_text_design_banderole__["a" /* TextDesignBanderole */].Celebrate2];
TextDesignCelebrate.identifier = 'imgly_text_design_celebrate';
TextDesignCelebrate.RowType = {
  Single: 'SINGLE',
  SingleImage: 'SINGLE_IMAGE'
};
TextDesignCelebrate.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_7__text_design_blocks__["a" /* TextDesignBlocks */].prototype.availableOptions, {
  relativeLineSpacing: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.01875 },
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignCelebrate.defaultFontIdentifiers },
  banderoles: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignCelebrate.defaultBanderoles }
});

/***/ }),
/* 182 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignEqualWidth; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design__ = __webpack_require__(76);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__models_rows_default_text_design_row_single__ = __webpack_require__(26);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__models_rectangle_insets__ = __webpack_require__(21);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__models_background_text_design_equal_width_background__ = __webpack_require__(433);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__text_words__ = __webpack_require__(47);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__models_randomizer__ = __webpack_require__(20);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */









var TextDesignEqualWidth = function (_TextDesign) {
  _inherits(TextDesignEqualWidth, _TextDesign);

  function TextDesignEqualWidth() {
    var _ref;

    _classCallCheck(this, TextDesignEqualWidth);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignEqualWidth.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignEqualWidth)).call.apply(_ref, [this].concat(args)));

    _this._relativeInsets = new __WEBPACK_IMPORTED_MODULE_9__models_rectangle_insets__["a" /* RectangleInsets */](0.1, 0.1, 0.1, 0.1);
    _this._alreadyContainsARowWithScriptFont = false;

    _this._backgroundsRandomizer = new __WEBPACK_IMPORTED_MODULE_12__models_randomizer__["a" /* Randomizer */](0);

    _this._seedPool.push(_this._backgroundsRandomizer);
    return _this;
  }

  _createClass(TextDesignEqualWidth, [{
    key: 'getImagePaths',
    value: function getImagePaths() {
      return __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].Array.flatten(__WEBPACK_IMPORTED_MODULE_10__models_background_text_design_equal_width_background__["a" /* TextDesignEqualWidthBackground */].Backgrounds.map(function (b) {
        return b.getImagePaths();
      }));
    }
  }, {
    key: '_getBackground',
    value: function _getBackground() {
      return this._backgroundsRandomizer.pickNext(__WEBPACK_IMPORTED_MODULE_10__models_background_text_design_equal_width_background__["a" /* TextDesignEqualWidthBackground */].Backgrounds);
    }
  }, {
    key: 'generateLayoutData',
    value: function generateLayoutData(text, width) {
      this._alreadyContainsARowWithScriptFont = false;
      this._background = this._getBackground();
      return _get(TextDesignEqualWidth.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignEqualWidth.prototype), 'generateLayoutData', this).call(this, text, width);
    }
  }, {
    key: '_modifiedText',
    value: function _modifiedText(text) {
      return _get(TextDesignEqualWidth.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignEqualWidth.prototype), '_modifiedText', this).call(this, text).toUpperCase();
    }
  }, {
    key: '_fontForRow',
    value: function _fontForRow(index, words) {
      var fontIdentifier = _get(TextDesignEqualWidth.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignEqualWidth.prototype), '_fontForRow', this).call(this, index, words);

      if (fontIdentifier === 'imgly_font_petit_formal_script') {
        if (this._alreadyContainsARowWithScriptFont) {
          fontIdentifier = 'imgly_font_bungee_inline';
        }
        this._alreadyContainsARowWithScriptFont = true;
      }

      return fontIdentifier;
    }
  }, {
    key: '_randomLayoutRow',
    value: function _randomLayoutRow(words, index, width, attributes) {
      var lowercase = attributes.getFontIdentifier() === 'imgly_font_petit_formal_script';

      return new __WEBPACK_IMPORTED_MODULE_8__models_rows_default_text_design_row_single__["a" /* TextDesignRowSingle */]({
        words: lowercase ? new __WEBPACK_IMPORTED_MODULE_11__text_words__["a" /* Words */]().set(words.getLowerCase()) : words,
        width: width,
        attributes: attributes
      });
    }
  }]);

  return TextDesignEqualWidth;
}(__WEBPACK_IMPORTED_MODULE_7__text_design__["a" /* TextDesign */]);

TextDesignEqualWidth.identifier = 'imgly_text_design_equal_width';
TextDesignEqualWidth.defaultFontIdentifiers = ['imgly_font_ultra', 'imgly_font_bungee_inline', 'imgly_font_petit_formal_script'];
TextDesignEqualWidth.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_7__text_design__["a" /* TextDesign */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignEqualWidth.defaultFontIdentifiers },
  relativeLineSpacing: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 }
});

/***/ }),
/* 183 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignBackground; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var TextDesignBackground = function (_Configurable) {
  _inherits(TextDesignBackground, _Configurable);

  function TextDesignBackground() {
    _classCallCheck(this, TextDesignBackground);

    return _possibleConstructorReturn(this, (TextDesignBackground.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignBackground)).apply(this, arguments));
  }

  _createClass(TextDesignBackground, [{
    key: 'render',
    value: function render(context, size, relativeInsets, color, randomizer) {
      __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Log"].warn('TextDesignBackground#render: Abstract class');
    }
  }]);

  return TextDesignBackground;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Configurable"]);

TextDesignBackground.prototype.availableOptions = {};

/***/ }),
/* 184 */
/***/ (function(module, exports, __webpack_require__) {

var isObject = __webpack_require__(23);
module.exports = function (it, TYPE) {
  if (!isObject(it) || it._t !== TYPE) throw TypeError('Incompatible receiver, ' + TYPE + ' required!');
  return it;
};


/***/ }),
/* 185 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__tensor_filter__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Expects a 2D input shape representing an RGBA encoded image. The
 * values will be expanded from the RGB to the R channel by forming the logical
 * shape of [1, height, width, 3], which can then be used as an input
 * for neural network structures.
 * To ease implementation, we require the texture dimensions to match
 * the inputs logical shape
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var UnpackRGBAFilter = function (_TensorFilter) {
  _inherits(UnpackRGBAFilter, _TensorFilter);

  function UnpackRGBAFilter() {
    _classCallCheck(this, UnpackRGBAFilter);

    return _possibleConstructorReturn(this, (UnpackRGBAFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(UnpackRGBAFilter)).apply(this, arguments));
  }

  _createClass(UnpackRGBAFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      var inputInfo = this._getInputWithName('x');
      var inputShape = inputInfo.logicalShape;
      if (inputShape.length !== 2) {
        throw new Error('UnpackRGBAFilter expects 2D inputs');
      }

      return [1, inputShape[0], inputShape[1], 3];
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      return '\n      void main ()\n      {\n        //       x, y, z, w\n        // e.g. [0, 4, 3, 2] (which is the blue channel of the pixel at x: 3, y: 4)\n        ivec4 outputCoords = getOutputCoords();\n        \n        int row = outputCoords.y;\n        int col = outputCoords.z;\n        int offset = outputCoords.w;\n\n        int index = row * int(x_sizeRC.y) + col;\n        int logR = index / int(x_sizeRC.y);\n        int logC = index - logR * int(x_sizeRC.y);\n        vec2 uv = (vec2(logC, logR) + halfCR) / x_texRC.yx;\n        vec4 color = texture2D(x, uv);\n\n        float component = 0.0;\n        if (offset == 0) {\n          component = color.r;\n        } else if (offset == 1) {\n          component = color.g;\n        } else if (offset == 2) {\n          component = color.b;\n        }\n        gl_FragColor = vec4(component, 0.0, 0.0, 1.0);\n      }\n    ';
    }
  }, {
    key: 'requiresFloatTextures',
    value: function requiresFloatTextures() {
      return true;
    }
  }]);

  return UnpackRGBAFilter;
}(__WEBPACK_IMPORTED_MODULE_4__tensor_filter__["b" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (UnpackRGBAFilter);

/***/ }),
/* 186 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__tensor_filter__ = __webpack_require__(13);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Blends two inputs and feathers the outer border by linearly blending
 * between both inputs within the given `blendRadius`. The `blendLeftTopRightBottom`
 * parameter controls which sides of the input should be blended.
 *
 * Inputs: - x: 2D tensor
 *         - y: 2D tensor
 * BlendRadius: Which portion of the input should be blended
 * BlendLeftTopRightBottom: An array of four integers, 0/1 controlling which sides to blend
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var FeatheredMaskingFilter = function (_TensorFilter) {
  _inherits(FeatheredMaskingFilter, _TensorFilter);

  function FeatheredMaskingFilter() {
    var _ref;

    _classCallCheck(this, FeatheredMaskingFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = FeatheredMaskingFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(FeatheredMaskingFilter)).call.apply(_ref, [this].concat(args)));

    _this._uniforms['blendLeftTopRightBottom'] = {
      type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT4,
      value: _this.availableOptions.blendLeftTopRightBottom.default
    };
    _this._uniforms['blendRadius'] = {
      type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT,
      value: _this.availableOptions.blendRadius.default

      // This filter is not a part of the conventional filter graph
    };_this.prepareUniforms();
    return _this;
  }

  _createClass(FeatheredMaskingFilter, [{
    key: 'requiresFloatTextures',
    value: function requiresFloatTextures() {
      return false;
    }
  }, {
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      var xInput = this._getInputWithName('x');
      var yInput = this._getInputWithName('y');

      if (xInput.logicalShape[0] !== yInput.logicalShape[0] || xInput.logicalShape[1] !== yInput.logicalShape[1]) {
        throw new Error('X and Y inputs of ' + this.constructor.name + ' must have same shape.');
      }

      return xInput.logicalShape;
    }
  }, {
    key: '_updateAdditionalUniforms',
    value: function _updateAdditionalUniforms(shader) {
      shader.setUniform('blendLeftTopRightBottom', this.getBlendLeftTopRightBottom());
      shader.setUniform('blendRadius', this.getBlendRadius());
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      return '\n      uniform vec4 blendLeftTopRightBottom;\n      uniform float blendRadius;\n\n      void main() {\n        vec2 coords = vec2(getOutputCoords());\n\n        vec2 blendVertical = vec2(coords.x, x_sizeRC.x - coords.x) / vec2(x_sizeRC.x * blendRadius); // topBlend, bottomBlend\n        vec2 blendHorizontal = vec2(coords.y, x_sizeRC.y - coords.y) / vec2(x_sizeRC.y * blendRadius); // leftBlend, rightBlend\n        vec4 factorLeftTopRightBottom = clamp(vec4(blendHorizontal.x, blendVertical.x, blendHorizontal.y, blendVertical.y), vec4(0.0), vec4(1.0));\n        vec4 maskVector = (vec4(1.0) - blendLeftTopRightBottom) * vec4(2.0); // [0, 1, 1, 1] becomes [2, 0, 0, 0]\n        vec4 maskedFactorLeftTopRightBottom = factorLeftTopRightBottom + maskVector; // [0.25, 0.5, 1.0, 1.0] becomes [2.25, 1.0, 1.0]\n        float factor = min(min(maskedFactorLeftTopRightBottom.x, maskedFactorLeftTopRightBottom.y), min(maskedFactorLeftTopRightBottom.z, maskedFactorLeftTopRightBottom.w)); // Choose the smallest blending factor\n        \n        vec2 uv = UVfrom2D(x_texRC, x_sizeRC, int(x_sizeRC.y), int(coords.x), int(coords.y));\n        vec4 xColor = texture2D(x, uv);\n        vec4 yColor = texture2D(y, uv);\n\n        gl_FragColor = mix(yColor, xColor, factor);\n      }\n    ';
    }
  }]);

  return FeatheredMaskingFilter;
}(__WEBPACK_IMPORTED_MODULE_6__tensor_filter__["b" /* default */]);

FeatheredMaskingFilter.prototype.availableOptions = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({
  blendLeftTopRightBottom: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: [1, 1, 1, 1] },
  blendRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.2 }
}, __WEBPACK_IMPORTED_MODULE_6__tensor_filter__["b" /* default */].prototype.availableOptions);

/* harmony default export */ __webpack_exports__["a"] = (FeatheredMaskingFilter);

/***/ }),
/* 187 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Checks environment for art filter requirements and determines ideal
 * WebGL configuration for best performance.
 *
 * @class
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.Managers
 */

var EnvironmentManager = function () {
  function EnvironmentManager() {
    _classCallCheck(this, EnvironmentManager);
  }

  _createClass(EnvironmentManager, null, [{
    key: 'determineSupportedConfiguration',

    /**
     * Evaluate the given WebGL context for StyleTransfer specific features.
     * Results are cached.
     * @param {WebGLContext} gl
     */
    value: function determineSupportedConfiguration(gl) {
      var log = false;
      if (!EnvironmentManager._cachedConfigs) {
        EnvironmentManager._cachedConfigs = {};
        log = true;
      }

      if (EnvironmentManager._cachedConfigs[gl.id]) {
        return EnvironmentManager._cachedConfigs[gl.id];
      }

      var floatExtension = gl.getExtension('OES_texture_float');
      var floatType = gl.FLOAT;
      var halfFloatExtension = gl.getExtension('OES_texture_half_float');
      var halfFloatType = halfFloatExtension !== null ? halfFloatExtension.HALF_FLOAT_OES : null;

      var floatTexturesSupported = floatExtension !== null;
      var floatLuminanceTexturesSupported = EnvironmentManager._canCreateTexture(gl, floatType, gl.LUMINANCE);
      var halfFloatTexturesSupported = halfFloatExtension !== null && EnvironmentManager._canCreateTexture(gl, halfFloatType, gl.RGBA);
      var halfFloatLuminanceTexturesSupported = EnvironmentManager._canCreateTexture(gl, halfFloatType, gl.LUMINANCE);

      // @TODO: Rendering using Float16 speeds up inference significantly but yields very different results. To
      // maintain the same result, we'd have to train a seperate model, which would then cause the per-
      // style asset footprint to double. So, we've disabled this option for now.
      // const renderToHalfFloatRGBASupported = halfFloatTexturesSupported && EnvironmentManager._canBindBuffer(gl, halfFloatType, gl.RGBA)
      var renderToFloatRGBASupported = floatTexturesSupported && (gl.getExtension('WEBGL_color_buffer_float') || EnvironmentManager._canBindBuffer(gl, floatType, gl.RGBA));

      var renderToFloatLuminanceSupported = EnvironmentManager._canBindBuffer(gl, floatType, gl.LUMINANCE);
      var renderToHalfFloatLuminanceSupported = EnvironmentManager._canBindBuffer(gl, halfFloatType, gl.LUMINANCE);

      var weightTextureType = gl.FLOAT;
      var weightTextureFormat = gl.RGBA;
      var weightTextureDescription = '?';
      if (halfFloatLuminanceTexturesSupported) {
        weightTextureDescription = 'Float16 Luminance';
        weightTextureType = halfFloatType;
        weightTextureFormat = gl.LUMINANCE;
      } else if (halfFloatTexturesSupported) {
        weightTextureDescription = 'Float16 RGBA';
        weightTextureType = halfFloatType;
      } else if (floatLuminanceTexturesSupported) {
        weightTextureDescription = 'Float32 Luminance';
        weightTextureFormat = gl.LUMINANCE;
      } else {
        weightTextureDescription = 'Float32 RGBA';
      }

      var renderTextureType = floatType;
      var renderTextureFormat = gl.RGBA;
      var renderTextureDescription = '?';
      if (renderToHalfFloatLuminanceSupported) {
        renderTextureDescription = 'Float16 Luminance';
        renderTextureType = halfFloatType;
        renderTextureFormat = gl.LUMINANCE;
      } else if (renderToFloatLuminanceSupported) {
        renderTextureDescription = 'Float32 Luminance';
        renderTextureType = floatType;
        renderTextureFormat = gl.LUMINANCE;
        // } else if (renderToHalfFloatRGBASupported) {
        //   renderTextureDescription = 'Float16 RGBA'
        //   renderTextureType = halfFloatType
      } else {
        renderTextureDescription = 'Float32 RGBA';
      }

      if (log) {
        __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Log"].info('\nArt Filter configuration:\nWeight Textures: ' + weightTextureDescription + '\nRender Textures: ' + renderTextureDescription);
      }

      var config = {
        environmentSupported: renderToFloatRGBASupported,
        weightTextureType: weightTextureType,
        weightTextureFormat: weightTextureFormat,
        renderTextureType: renderTextureType,
        renderTextureFormat: renderTextureFormat
      };
      EnvironmentManager._cachedConfigs[gl.id] = config;

      return config;
    }
  }, {
    key: '_canCreateTexture',
    value: function _canCreateTexture(gl, type, format) {
      var testTexture = gl.createTexture();
      gl.bindTexture(gl.TEXTURE_2D, testTexture);
      var length = format === gl.RGBA ? 4 : 1;
      var data = new Uint16Array(length);
      if (type === gl.FLOAT) data = new Float32Array(length);
      if (length === 1) gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);
      gl.texImage2D(gl.TEXTURE_2D, 0, format, 1, 1, 0, format, type, data);
      gl.pixelStorei(gl.UNPACK_ALIGNMENT, 4);

      var status = gl.isTexture(testTexture);
      var threwError = gl.getError() !== gl.NO_ERROR;

      gl.deleteTexture(testTexture);

      return status && !threwError;
    }
  }, {
    key: '_canBindBuffer',
    value: function _canBindBuffer(gl, type, format) {
      var testTexture = gl.createTexture();
      gl.bindTexture(gl.TEXTURE_2D, testTexture);
      gl.texImage2D(gl.TEXTURE_2D, 0, format, 1, 1, 0, format, type, null);

      var testFramebuffer = gl.createFramebuffer();
      gl.bindFramebuffer(gl.FRAMEBUFFER, testFramebuffer);
      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, testTexture, 0);

      var status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);

      gl.deleteTexture(testTexture);
      gl.deleteFramebuffer(testFramebuffer);

      return status === gl.FRAMEBUFFER_COMPLETE;
    }
  }]);

  return EnvironmentManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (EnvironmentManager);

/***/ }),
/* 188 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__tensor_filter__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__tensor_utils__ = __webpack_require__(54);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Performs addition of two tensors, requires both tensors to have
 * the same shape. NO BROADCASTING.
 *
 * Inputs: x & y (both 4D shapes)
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var AddFilter = function (_TensorFilter) {
  _inherits(AddFilter, _TensorFilter);

  function AddFilter() {
    _classCallCheck(this, AddFilter);

    return _possibleConstructorReturn(this, (AddFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(AddFilter)).apply(this, arguments));
  }

  _createClass(AddFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      if (this.getInputs().length !== 2) {
        throw Error('AddFilter requires two inputs: x and y.');
      }

      var xInputInfo = this._getInputWithName('x');
      var yInputInfo = this._getInputWithName('y');
      if (!__WEBPACK_IMPORTED_MODULE_5__tensor_utils__["a" /* default */].isSameShape(xInputInfo.logicalShape, yInputInfo.logicalShape)) {
        throw Error('AddFilter inputs must have matching input shapes (' + xInputInfo.logicalShape + ' vs. ' + yInputInfo.logicalShape + ').');
      }

      return xInputInfo.logicalShape;
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      return '\n      void main() {\n        ivec4 coords = getOutputCoords();\n        float xVal = getX(coords.x, coords.y, coords.z, coords.w);\n        float yVal = getY(coords.x, coords.y, coords.z, coords.w);\n        \n        float result = xVal + yVal;\n        setOutput(result);\n      }\n    ';
    }
  }]);

  return AddFilter;
}(__WEBPACK_IMPORTED_MODULE_4__tensor_filter__["b" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (AddFilter);

/***/ }),
/* 189 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__tensor_filter__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Last style transfer transform step consisting of scaling
 * to ~[0, 255] using (tanh * 150) + 127.5 and clamping the result.
 *
 * Inputs: - x: 4D tensor
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var FinalizeStyleFilter = function (_TensorFilter) {
  _inherits(FinalizeStyleFilter, _TensorFilter);

  function FinalizeStyleFilter() {
    _classCallCheck(this, FinalizeStyleFilter);

    return _possibleConstructorReturn(this, (FinalizeStyleFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(FinalizeStyleFilter)).apply(this, arguments));
  }

  _createClass(FinalizeStyleFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      return this._getInputWithName('x').logicalShape;
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      return '\n      void main() {\n        ivec4 coords = getOutputCoords();\n        float x = getX(coords.x, coords.y, coords.z, coords.w);\n\n        // WebGL doesn\'t offer tanh, taken from TFJS\n        float e2x = exp(-2.0 * abs(x));\n        float tanh = sign(x) * (1.0 - e2x) / (1.0 + e2x);\n\n        float rgbValue = (tanh * 150.0) + 127.5;\n        float clamped = clamp(rgbValue, 0.0, 255.0);\n        setOutput(clamped / 255.0);\n      }\n    ';
    }
  }]);

  return FinalizeStyleFilter;
}(__WEBPACK_IMPORTED_MODULE_4__tensor_filter__["b" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (FinalizeStyleFilter);

/***/ }),
/* 190 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__tensor_filter__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__pad_utils__ = __webpack_require__(133);








var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * A conventional 2D convolution filter.
 *
 * Inputs: - x: [batch, height, width, channels]
 *         - w: [filterHeight, filterWidth, inChannels, outChannels]
 * Stride: number (1 or 2 for our use case)
 * Padding: 'same' or 'valid'
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var Conv2DFilter = function (_TensorFilter) {
  _inherits(Conv2DFilter, _TensorFilter);

  function Conv2DFilter() {
    _classCallCheck(this, Conv2DFilter);

    return _possibleConstructorReturn(this, (Conv2DFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(Conv2DFilter)).apply(this, arguments));
  }

  _createClass(Conv2DFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      if (this._options.inputs.length !== 2) {
        throw Error('Conv2DFilter requires two inputs: x and w.');
      }

      // Calculate output shape for given input and filter
      var xInputInfo = this._getInputWithName('x');
      var filterInputInfo = this._getInputWithName('w');

      var _xInputInfo$logicalSh = _slicedToArray(xInputInfo.logicalShape, 4),
          batchSize = _xInputInfo$logicalSh[0],
          inHeight = _xInputInfo$logicalSh[1],
          inWidth = _xInputInfo$logicalSh[2],
          inChannels = _xInputInfo$logicalSh[3];

      var _filterInputInfo$logi = _slicedToArray(filterInputInfo.logicalShape, 4),
          filterHeight = _filterInputInfo$logi[0],
          filterWidth = _filterInputInfo$logi[1],
          filterChannels = _filterInputInfo$logi[3];

      var strideHeight = this._options.stride;
      var strideWidth = this._options.stride;

      // We're ommiting any dilation parameters, therefore our
      // effectiveFilterSize is equal to the actual filterSize

      var _PadUtils$calculatePa = __WEBPACK_IMPORTED_MODULE_9__pad_utils__["a" /* default */].calculatePadding(this._options.padding, inHeight, inWidth, strideHeight, strideWidth, filterHeight, filterWidth),
          padInfo = _PadUtils$calculatePa.padInfo,
          outHeight = _PadUtils$calculatePa.outHeight,
          outWidth = _PadUtils$calculatePa.outWidth;

      this._outChannels = filterChannels;
      this._padInfo = padInfo;

      return [batchSize, outHeight, outWidth, this._outChannels];
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      var xInputInfo = this._getInputWithName('x');
      var inChannels = xInputInfo.logicalShape[3];
      var padTop = this._padInfo.top;
      var padLeft = this._padInfo.left;

      var inputDepthNearestVec4 = Math.floor(inChannels / 4) * 4;
      var inputDepthVec4Remainder = inChannels % 4;
      var stride = this._options.stride;

      return '\n    const ivec2 strides = ivec2(' + stride + ', ' + stride + ');\n    const ivec2 pads = ivec2(' + padTop + ', ' + padLeft + ');\n\n    const int max_filter_iterations = 9; // Required to achieve fixed size loop\n\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int batch = coords[0];\n      int d2 = coords[3];\n\n      ivec2 xRCCorner = coords.yz * strides - pads;\n      int xRCorner = xRCCorner.x;\n      int xCCorner = xRCCorner.y;\n\n      // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n      // ? = to be determined. : = across all values in that axis.\n      float dotProd = 0.0;\n      for (int wR = 0; wR < max_filter_iterations; wR++) {\n        if (wR >= w_shape[0]) { break; }\n        int xR = xRCorner + wR;\n        if (xR < 0 || xR >= x_shape[1]) {\n          continue;\n        }\n\n        for (int wC = 0; wC < max_filter_iterations; wC++) {\n          if (wC >= w_shape[1]) { break; }\n          int xC = xCCorner + wC;\n\n          if (xC < 0 || xC >= x_shape[2]) {\n            continue;\n          }\n\n          for (int d1 = 0; d1 < ' + inputDepthNearestVec4 + '; d1 += 4) {\n            vec4 xValues = vec4(\n              getX(batch, xR, xC, d1),\n              getX(batch, xR, xC, d1 + 1),\n              getX(batch, xR, xC, d1 + 2),\n              getX(batch, xR, xC, d1 + 3)\n            );\n            vec4 wValues = vec4(\n              getW(wR, wC, d1, d2),\n              getW(wR, wC, d1 + 1, d2),\n              getW(wR, wC, d1 + 2, d2),\n              getW(wR, wC, d1 + 3, d2)\n            );\n\n            dotProd += dot(xValues, wValues);\n          }\n\n          if (' + (inputDepthVec4Remainder === 1) + ') {\n            dotProd +=\n              getX(batch, xR, xC, ' + inputDepthNearestVec4 + ') *\n              getW(wR, wC, ' + inputDepthNearestVec4 + ', d2);\n          } else if (' + (inputDepthVec4Remainder === 2) + ') {\n            vec2 xValues = vec2(\n              getX(batch, xR, xC, ' + inputDepthNearestVec4 + '),\n              getX(batch, xR, xC, ' + inputDepthNearestVec4 + ' + 1)\n            );\n            vec2 wValues = vec2(\n              getW(wR, wC, ' + inputDepthNearestVec4 + ', d2),\n              getW(wR, wC, ' + inputDepthNearestVec4 + ' + 1, d2)\n            );\n            dotProd += dot(xValues, wValues);\n          } else if (' + (inputDepthVec4Remainder === 3) + ') {\n            vec3 xValues = vec3(\n              getX(batch, xR, xC, ' + inputDepthNearestVec4 + '),\n              getX(batch, xR, xC, ' + inputDepthNearestVec4 + ' + 1),\n              getX(batch, xR, xC, ' + inputDepthNearestVec4 + ' + 2)\n            );\n            vec3 wValues = vec3(\n              getW(wR, wC, ' + inputDepthNearestVec4 + ', d2),\n              getW(wR, wC, ' + inputDepthNearestVec4 + ' + 1, d2),\n              getW(wR, wC, ' + inputDepthNearestVec4 + ' + 2, d2)\n            );\n            dotProd += dot(xValues, wValues);\n          }\n        }\n      }\n      setOutput(dotProd);\n    }';
    }
  }]);

  return Conv2DFilter;
}(__WEBPACK_IMPORTED_MODULE_8__tensor_filter__["b" /* default */]);

Conv2DFilter.prototype.availableOptions = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({
  stride: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  padding: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].STRING, default: 'same' }
}, __WEBPACK_IMPORTED_MODULE_8__tensor_filter__["b" /* default */].prototype.availableOptions);

/* harmony default export */ __webpack_exports__["a"] = (Conv2DFilter);

/***/ }),
/* 191 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__tensor_filter__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__pad_utils__ = __webpack_require__(133);








var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * A depthwise convolution filter which applies weights to the inputs
 * channels.
 *
 * Inputs: - x: [batch, height, width, channels]
 *         - w: [filterHeight, filterWidth, inChannels, channelMultiplier]
 * Stride: number (1 or 2 for our use case)
 * Padding: 'same' or 'valid'
 * PadMethod: 'zero' or 'edge' - zero: Fill with 0, edge: Repeat outer boundary of input
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var Conv2DDepthwiseFilter = function (_TensorFilter) {
  _inherits(Conv2DDepthwiseFilter, _TensorFilter);

  function Conv2DDepthwiseFilter() {
    _classCallCheck(this, Conv2DDepthwiseFilter);

    return _possibleConstructorReturn(this, (Conv2DDepthwiseFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(Conv2DDepthwiseFilter)).apply(this, arguments));
  }

  _createClass(Conv2DDepthwiseFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      if (this.getInputs().length !== 2) {
        throw Error('DepthwiseConv2DFilter requires two inputs: x and w.');
      }

      // Calculate output shape for given input and filter
      var xInputInfo = this._getInputWithName('x');
      var filterInputInfo = this._getInputWithName('w');

      var _xInputInfo$logicalSh = _slicedToArray(xInputInfo.logicalShape, 4),
          batchSize = _xInputInfo$logicalSh[0],
          inHeight = _xInputInfo$logicalSh[1],
          inWidth = _xInputInfo$logicalSh[2],
          inChannels = _xInputInfo$logicalSh[3];

      var _filterInputInfo$logi = _slicedToArray(filterInputInfo.logicalShape, 4),
          filterHeight = _filterInputInfo$logi[0],
          filterWidth = _filterInputInfo$logi[1],
          filterChannels = _filterInputInfo$logi[3];

      if (filterHeight > 9 || filterWidth > 9) {
        throw new Error('Filter heights are limited to 9. Change shader source if larger ones are required.');
      }
      var strideHeight = this._options.stride;
      var strideWidth = this._options.stride;

      // We're ommiting any dilation parameters, therefore our
      // effectiveFilterSize is equal to the actual filterSize

      var _PadUtils$calculatePa = __WEBPACK_IMPORTED_MODULE_9__pad_utils__["a" /* default */].calculatePadding(this._options.padding, inHeight, inWidth, strideHeight, strideWidth, filterHeight, filterWidth),
          padInfo = _PadUtils$calculatePa.padInfo,
          outHeight = _PadUtils$calculatePa.outHeight,
          outWidth = _PadUtils$calculatePa.outWidth;

      this._outChannels = filterChannels * inChannels;
      this._padInfo = padInfo;

      return [batchSize, outHeight, outWidth, this._outChannels];
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      var padTop = this._padInfo.top;
      var padLeft = this._padInfo.left;
      var _options = this._options,
          stride = _options.stride,
          padMethod = _options.padMethod;

      // 'Edge' padding constraints the coordinates to the outer bounds
      // when reading from x. 'Zero' edge padding simply doesn't read said values,
      // leading

      var body;
      switch (padMethod) {
        case 'zero':
          body = 'return coords;';
          break;
        case 'edge':
          body = 'return ivec4(clamp(vec4(coords), vec4(0.0), vec4(x_shape - 1)));';
          break;
      }
      var convertCoordinatesForPaddingFn = '\n    ivec4 convertCoordinatesForPadding(ivec4 coords) {\n      ' + body + '\n    }\n    ';
      var xROverflowCheck = padMethod === 'zero' ? 'if (xR < 0 || xR >= x_shape[1]) { continue; }' : '';
      var xCOverflowCheck = padMethod === 'zero' ? 'if (xC < 0 || xC >= x_shape[2]) { continue; }' : '';

      /**
       * Originally, we'd need to calculate a channel multiplier, but in our case it
       * always ends up being 1 anyway:
       *  float channelMul = float(outChannels) / float(x_shape[3]);
       *  int d1 = d2 / channelMul; // currently probed channel
       *  int q = d2 - d1 * channelMul; // current filter index
       */
      return '\n      const ivec2 strides = ivec2(' + stride + ', ' + stride + ');\n      const ivec2 pads = ivec2(' + padTop + ', ' + padLeft + ');\n      const int max_filter_iterations = 9; // Required to achieve fixed size loop\n\n      ' + convertCoordinatesForPaddingFn + '\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads; // current coordinates in x\n        int d2 = coords.w; // current channel index\n        int outChannels = w_shape[3] * x_shape[3];\n        int d1 = d2; // currently probed channel\n        int q = d2 - d1; // current filter index\n\n        int xRCorner = xRCCorner.x; // row index\n        int xCCorner = xRCCorner.y; // column index\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < max_filter_iterations; wR++) {\n          if (wR >= w_shape[0]) { break; }\n\n          int xR = xRCorner + wR; // x row index = current index + offset * y dilation\n          ' + xROverflowCheck + '\n\n          for (int wC = 0; wC < max_filter_iterations; wC++) {\n            if (wC >= w_shape[1]) { break; }\n\n            int xC = xCCorner + wC; // x column index = current index + offset * x dilation\n            ' + xCOverflowCheck + '\n\n            float xVal = getX(convertCoordinatesForPadding(ivec4(batch, xR, xC, d1))); // Get value at current [batch, y, x, channel]\n            float wVal = getW(wR, wC, d1, q); // Get kernel value at current \n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ';
    }
  }]);

  return Conv2DDepthwiseFilter;
}(__WEBPACK_IMPORTED_MODULE_8__tensor_filter__["b" /* default */]);

Conv2DDepthwiseFilter.prototype.availableOptions = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({
  stride: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER },
  padding: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].STRING, default: 'same' },
  padMethod: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].STRING, default: 'zero' }
}, __WEBPACK_IMPORTED_MODULE_8__tensor_filter__["b" /* default */].prototype.availableOptions);

/* harmony default export */ __webpack_exports__["a"] = (Conv2DDepthwiseFilter);

/***/ }),
/* 192 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__tensor_filter__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__tensor_utils__ = __webpack_require__(54);








var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * To efficiently calculate the mean along a set of axes for a tensor with any number of channels,
 * we divide the values by their count and sum up the result. The 'reduceSum' operation is performed
 * by recursively applying the reduce filter, which sums up values in a certain window. This window
 * is limited to a maximum size of 30x30 pixels. This allows making use of parallelism even though
 * we're actually just calculating the mean of a large vector. To do so, the input is reshaped to
 * a [inSize, batchSize] format and then fed to the GPU.
 *
 * As we need to build up our filter stack prior to evaluation, we'll have to calculate the input shape
 * and resulting number of iterations for the ReduceSumFilter beforehand. To do this, we query the reduce
 * filter for the required stack of filters and add them to the graph. Using a ReduceSumFilter directly
 * is not recommended.
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var ReduceSumFilter = function (_TensorFilter) {
  _inherits(ReduceSumFilter, _TensorFilter);

  function ReduceSumFilter() {
    _classCallCheck(this, ReduceSumFilter);

    return _possibleConstructorReturn(this, (ReduceSumFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(ReduceSumFilter)).apply(this, arguments));
  }

  _createClass(ReduceSumFilter, [{
    key: '_calculateOutputShape',


    /* TensorFilter */

    value: function _calculateOutputShape() {
      var inSize = this._getInputWithName('x').logicalShape[0];
      var _options = this._options,
          batchSize = _options.batchSize,
          windowSize = _options.windowSize;

      var outSize = Math.ceil(inSize / windowSize);

      return [outSize, batchSize];
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      var windowSize = this._options.windowSize;

      var inSize = this._getInputWithName('x').logicalShape[0];
      var windowSizeNearestVec4 = Math.floor(windowSize / 4) * 4;
      var windowSizeVec4Remainder = windowSize % 4;
      var checkOutOfBounds = '';

      if (inSize % windowSize > 0) {
        checkOutOfBounds = '\n      if (inIdx < 0 || inIdx >= x_shape[0]) {\n        return initalizationValue;\n      }\n      ';
      }

      return '\n      const float initializationValue = 0.0;\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ' + checkOutOfBounds + '\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        // row, col\n        ivec2 coords = getOutputCoords();\n        int batch = coords[1];\n        int outIdx = coords[0];\n        int inOffset = outIdx * ' + windowSize + ';\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ' + windowSizeNearestVec4 + '; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            // row, col\n            getValue(inIdx, batch),\n            getValue(inIdx + 1, batch),\n            getValue(inIdx + 2, batch),\n            getValue(inIdx + 3, batch)\n          );\n\n          sumValue += dot(values, ones);\n        }\n\n        int inIdx = inOffset + ' + windowSizeNearestVec4 + ';\n        if (' + (windowSizeVec4Remainder === 1) + ') {\n          vec4 values = vec4(\n            getValue(inIdx, batch),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          sumValue += dot(values, ones);\n        } else if (' + (windowSizeVec4Remainder === 2) + ') {\n          vec4 values = vec4(\n            getValue(inIdx, batch),\n            getValue(inIdx + 1, batch),\n            initializationValue,\n            initializationValue\n          );\n\n          sumValue += dot(values, ones);\n        } else if (' + (windowSizeVec4Remainder === 3) + ') {\n          vec4 values = vec4(\n            getValue(inIdx, batch),\n            getValue(inIdx + 1, batch),\n            getValue(inIdx + 2, batch),\n            initializationValue\n          );\n\n          sumValue += dot(values, ones);\n        }\n        setOutput(sumValue);\n      }\n    ';
    }
  }], [{
    key: 'addFiltersForReduceSumOperationToGraph',

    /**
     * Creates a stack of ReduceSumFilters that calculate the sum along the given axes for the filter
     * at the given index and adds them to the given graph.
     * @param {TensorFilterGraph} graph
     * @param {Number} inputIndex
     * @param {Number[]} axes
     */
    value: function addFiltersForReduceSumOperationToGraph(graph, inputIndex) {
      var axes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [1, 2];

      var inputShape = graph.getLogicalShapeAtIndex(inputIndex);

      // outShape: Final dimensions (e.g. [1, 16] when reducing [1, 8, 8, 16])
      // reduceShape: The dimensions to reduce [8, 8] for the example above

      var _ReduceSumFilter$_com = ReduceSumFilter._computeOutAndReduceShape(inputShape, axes),
          _ReduceSumFilter$_com2 = _slicedToArray(_ReduceSumFilter$_com, 2),
          _ = _ReduceSumFilter$_com2[0],
          reduceShape = _ReduceSumFilter$_com2[1];

      // The size of a single batch


      var inSize = __WEBPACK_IMPORTED_MODULE_9__tensor_utils__["a" /* default */].getSizeOfLogicalShape(reduceShape);
      var batchSize = __WEBPACK_IMPORTED_MODULE_9__tensor_utils__["a" /* default */].getSizeOfLogicalShape(inputShape) / inSize;
      var flattenedShape = [inSize, batchSize];

      // This is the shape we'll use for applying our shader to the input.
      // We'll repeat this filter, until inSize reaches 1
      var inputIsLastFilter = inputIndex === graph.getLastIndex();
      var firstFilterInputInfo = {
        name: 'x',
        logicalShape: flattenedShape,
        type: inputIsLastFilter ? __WEBPACK_IMPORTED_MODULE_8__tensor_filter__["a" /* InputType */].PREVIOUS : __WEBPACK_IMPORTED_MODULE_8__tensor_filter__["a" /* InputType */].INDEX
      };
      if (!inputIsLastFilter) {
        firstFilterInputInfo.data = inputIndex;
      }

      var filter = ReduceSumFilter._buildReduceFilter(firstFilterInputInfo);
      graph.addFilter(filter, false);

      // Add additional filters if needed
      var lastOutputShape = filter.outputLogicalShape();
      while (lastOutputShape[0] !== 1) {
        var nextInputInfo = {
          name: 'x',
          type: __WEBPACK_IMPORTED_MODULE_8__tensor_filter__["a" /* InputType */].PREVIOUS,
          logicalShape: filter.outputLogicalShape()
        };
        filter = ReduceSumFilter._buildReduceFilter(nextInputInfo);
        lastOutputShape = filter.outputLogicalShape();
        graph.addFilter(filter);
      }

      return graph.getLastIndex();
    }

    /* Helpers */

    /**
     * Create a ReduceFilter with the given inputInfo.
     * @param {Object} inputInfo
     * @private
     */

  }, {
    key: '_buildReduceFilter',
    value: function _buildReduceFilter(inputInfo) {
      var _inputInfo$logicalSha = _slicedToArray(inputInfo.logicalShape, 2),
          inSize = _inputInfo$logicalSha[0],
          batchSize = _inputInfo$logicalSha[1];

      var windowSize = ReduceSumFilter._computeWindowSize(inSize);

      return new ReduceSumFilter({
        inputs: [inputInfo],
        windowSize: windowSize,
        batchSize: batchSize
      });
    }

    /**
     * Find the best window size for the given input size.
     * @param {Number} inSize
     * @private
     */

  }, {
    key: '_computeWindowSize',
    value: function _computeWindowSize(inSize) {
      if (inSize <= 30) {
        return inSize;
      }

      var start = Math.floor(Math.sqrt(inSize));
      for (var i = start; i < inSize; ++i) {
        if (inSize % i === 0) {
          return i;
        }
      }

      return inSize;
    }

    /**
     * Determine the shape of the final output and the shape of the to be
     * reduced tensor for an input shape and reduction axes.
     * @param {Number[]} inShape
     * @param {Number[]} axes
     * @private
     */

  }, {
    key: '_computeOutAndReduceShape',
    value: function _computeOutAndReduceShape(inShape, axes) {
      var outShape = [];
      var rank = inShape.length;
      for (var dim = 0; dim < rank; dim++) {
        if (axes.indexOf(dim) === -1) {
          outShape.push(inShape[dim]);
        }
      }
      var reduceShape = axes.map(function (dim) {
        return inShape[dim];
      });
      return [outShape, reduceShape];
    }
  }]);

  return ReduceSumFilter;
}(__WEBPACK_IMPORTED_MODULE_8__tensor_filter__["b" /* default */]);

ReduceSumFilter.prototype.availableOptions = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({
  // Which axes to calculate the mean for
  axes: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].ARRAY, default: [1, 2] },
  windowSize: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER },
  batchSize: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER }
}, __WEBPACK_IMPORTED_MODULE_8__tensor_filter__["b" /* default */].prototype.availableOptions);

/* harmony default export */ __webpack_exports__["a"] = (ReduceSumFilter);

/***/ }),
/* 193 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__tensor_filter__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * This filter takes two inputs, 'x' and 'sum' and prepares the variation calculation by
 * calculating: sqrt(x - (sum / x.size)). It's result can then be fed to a sum filter, which yields
 * the variance of x.
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var VariancePreparationFilter = function (_TensorFilter) {
  _inherits(VariancePreparationFilter, _TensorFilter);

  function VariancePreparationFilter() {
    _classCallCheck(this, VariancePreparationFilter);

    return _possibleConstructorReturn(this, (VariancePreparationFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(VariancePreparationFilter)).apply(this, arguments));
  }

  _createClass(VariancePreparationFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      var xInput = this._getInputWithName('x');
      return xInput.logicalShape;
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      return '\n      void main ()\n      {\n        ivec4 coords = getOutputCoords();\n        float numValuesPerChannel = float(x_shape[1] * x_shape[2]);\n\n        // \'Sum\' input consists of a single value which holds the sum of all elements in x\n        float xSum = getSumFlat(coords.w);\n\n        // \'X\' is a 4D tensor holding arbitrary float values\n        float x = getX(coords.x, coords.y, coords.z, coords.w);\n\n        // Calculate the mean\n        float mean = xSum / numValuesPerChannel;\n\n        // Calculate a single variance component (x_i - mean)^2\n        float result = pow((x - mean), 2.0);\n        setOutput(result);\n      }\n    ';
    }
  }]);

  return VariancePreparationFilter;
}(__WEBPACK_IMPORTED_MODULE_4__tensor_filter__["b" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (VariancePreparationFilter);

/***/ }),
/* 194 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__tensor_filter__ = __webpack_require__(13);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Uses 'x', 'variance' and 'sum' inputs to perform instance normalization. 'variance' and 'sum' are
 * previously executed filters which hold the variance of x and the sum of all values in x.
 *
 * Inputs: - x: 4D tensor
 *         - variance: 2D tensor of shape [1, <channels in x>]
 *         - sum: 2D tensor of shape [1, <channels in x>]
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var InstanceNormReluFilter = function (_TensorFilter) {
  _inherits(InstanceNormReluFilter, _TensorFilter);

  function InstanceNormReluFilter() {
    _classCallCheck(this, InstanceNormReluFilter);

    return _possibleConstructorReturn(this, (InstanceNormReluFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(InstanceNormReluFilter)).apply(this, arguments));
  }

  _createClass(InstanceNormReluFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      var xInput = this._getInputWithName('x');
      var varianceInput = this._getInputWithName('variance');
      var sumInput = this._getInputWithName('sum');

      var xChannels = xInput.logicalShape[3];
      if (!(varianceInput.logicalShape[1] === xChannels) || !(sumInput.logicalShape[1] === xChannels)) {
        throw new Error('Variance and sum input depth must match x inputs channels for InstanceNormReluFilter.');
      }

      return xInput.logicalShape;
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      var outputSnippet = this.getAddRelu() ? '\n      if (isNaN(result)) {\n        setOutput(result);\n      } else {\n        float relu = (result < 0.0) ? 0.0 : result;\n        setOutput(relu);\n      }\n    ' : 'setOutput(result);';
      return '\n      void main ()\n      {\n        float numValuesPerChannel = float(x_shape[1] * x_shape[2]);\n        ivec4 coords = getOutputCoords();\n        float x = getX(coords.x, coords.y, coords.z, coords.w);\n\n        // \'variance\' input consists of a single value per channel which holds the sum of all values in x reduced by it\'s mean and squared afterwards\n        float nonMeanedVariance = getVarianceFlat(coords.w);\n        float variance = nonMeanedVariance / numValuesPerChannel;\n\n        // \'sum\' input consists of a single value per channel which holds the sum of all elements in x\n        float xSum = getSumFlat(coords.w);\n        float mean = xSum / numValuesPerChannel;\n\n        float netmu = x - mean;\n        float sigmaEpsilonSqrt = sqrt(variance + 0.001);\n\n        float normalized = netmu / sigmaEpsilonSqrt;\n        \n        // Calculate the instance normalized value of x\n        float shift = getShiftFlat(coords.w);\n        float scale = getScaleFlat(coords.w);\n        float result = (scale * normalized) + shift;\n\n        // If it\'s not NaN, calculate relu\n        ' + outputSnippet + '\n      }\n    ';
    }
  }]);

  return InstanceNormReluFilter;
}(__WEBPACK_IMPORTED_MODULE_6__tensor_filter__["b" /* default */]);

InstanceNormReluFilter.prototype.availableOptions = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({
  shift: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER },
  scale: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER },
  addRelu: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: true }
}, __WEBPACK_IMPORTED_MODULE_6__tensor_filter__["b" /* default */].prototype.availableOptions);

/* harmony default export */ __webpack_exports__["a"] = (InstanceNormReluFilter);

/***/ }),
/* 195 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__tensor_filter__ = __webpack_require__(13);








var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * A bilinear resizing filter.
 *
 * Inputs: - x: 4D tensor
 * size: number[] - The target size as a [height, width] array.
 * alignCorners: boolean - If true, the centers of the 4 corner pixels of the input and output tensors are aligned, preserving the values at the corner pixels. Defaults to true.
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var ResizeBilinearFilter = function (_TensorFilter) {
  _inherits(ResizeBilinearFilter, _TensorFilter);

  function ResizeBilinearFilter() {
    var _ref;

    _classCallCheck(this, ResizeBilinearFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = ResizeBilinearFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(ResizeBilinearFilter)).call.apply(_ref, [this].concat(args)));

    _this._uniforms['sourceSizeRC'] = {
      type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["UniformType"].FLOAT2,
      value: [0, 0]
    };
    _this._uniforms['targetSizeRC'] = {
      type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["UniformType"].FLOAT2,
      value: [0, 0]
    };
    return _this;
  }

  _createClass(ResizeBilinearFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      var xInputInfo = this._getInputWithName('x');

      var _xInputInfo$logicalSh = _slicedToArray(xInputInfo.logicalShape, 4),
          batchSize = _xInputInfo$logicalSh[0],
          channels = _xInputInfo$logicalSh[3];

      var _options$size = _slicedToArray(this._options.size, 2),
          newHeight = _options$size[0],
          newWidth = _options$size[1];

      return [batchSize, newHeight, newWidth, channels];
    }
  }, {
    key: '_updateAdditionalUniforms',
    value: function _updateAdditionalUniforms(shader) {
      var _getInputWithName$log = _slicedToArray(this._getInputWithName('x').logicalShape, 3),
          _ = _getInputWithName$log[0],
          height = _getInputWithName$log[1],
          width = _getInputWithName$log[2];

      var uniforms = {
        'targetSizeRC': this.getSize(),
        'sourceSizeRC': [height, width]
      };
      shader.setUniforms(uniforms);
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      var source = '\n      uniform vec2 sourceSizeRC;\n      uniform vec2 targetSizeRC;\n\n      void main() {\n        vec2 effectiveInSize = sourceSizeRC - vec2(1.0, 1.0);\n        vec2 effectiveOutSize = targetSizeRC - vec2(1.0, 1.0);\n        vec2 effectiveInputOverOutputRatioRC = effectiveInSize / effectiveOutSize;\n\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(min(sourceSizeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getX(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getX(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getX(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getX(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ';

      return source;
    }
  }]);

  return ResizeBilinearFilter;
}(__WEBPACK_IMPORTED_MODULE_8__tensor_filter__["b" /* default */]);

ResizeBilinearFilter.prototype.availableOptions = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({
  size: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].ARRAY, required: true },
  alignCorners: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].BOOLEAN, default: true }
}, __WEBPACK_IMPORTED_MODULE_8__tensor_filter__["b" /* default */].prototype.availableOptions);

/* harmony default export */ __webpack_exports__["a"] = (ResizeBilinearFilter);

/***/ }),
/* 196 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__tensor_filter__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * This filter performs 'edge' padding, e.g.
 * [1, 2, 3] with paddings [2, 1] (before, after) becomes
 * [1, 1, 1, 2, 3, 3]. This is much simpler to implement
 * than mirrored padding and yields the same results for
 * style transfer.
 *
 * Inputs:
 *  x: <1,2,4>D tensor
 *  paddings: number[[number, number]] - Before/after pad for each dim
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var EdgePadFilter = function (_TensorFilter) {
  _inherits(EdgePadFilter, _TensorFilter);

  function EdgePadFilter() {
    _classCallCheck(this, EdgePadFilter);

    return _possibleConstructorReturn(this, (EdgePadFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(EdgePadFilter)).apply(this, arguments));
  }

  _createClass(EdgePadFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      var paddings = this._options.paddings;

      // Ensure single input

      if (!this.getInputs().length === 1 || this.getInputs().length === 0) {
        throw new Error('ReflectionPadFilter requires single input.');
      }
      var inputShape = this.getInputs()[0].logicalShape;

      // Ensure paddings match input dimensions
      if (paddings.length !== inputShape.length) {
        throw new Error('Not enough or too many paddings for input shape ' + inputShape);
      }

      return paddings.map(function (dim, i) {
        return dim[0] + inputShape[i] + dim[1];
      });
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      var inputShape = this.getInputs()[0].logicalShape;

      var dims = inputShape.length;
      var start = this._options.paddings.map(function (p) {
        return p[0];
      }).join(','); // [1, 4, 3, 1] BeforePad in dim 0 to 3
      var type = 'vec' + dims;
      var coordsSpread = ['coords[0]', 'coords[1]', 'coords[2]', 'coords[3]'].slice(0, dims).join(',');

      return '\n      i' + type + ' start = i' + type + '(' + start + ');\n\n      void main () {\n        i' + type + ' outC = getOutputCoords();\n        ' + type + ' coordsInInput = ' + type + '(outC - start);\n        i' + type + ' coords = i' + type + '(clamp(coordsInInput, ' + type + '(0.0), ' + type + '(x_shape - 1)));\n        setOutput(getX(' + coordsSpread + '));\n      }\n    ';
    }
  }]);

  return EdgePadFilter;
}(__WEBPACK_IMPORTED_MODULE_5__tensor_filter__["b" /* default */]);

EdgePadFilter.prototype.availableOptions = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({
  paddings: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, required: true // e.g. 2D [[0-before, 0-after], [1-before, 1-after]]
  } }, __WEBPACK_IMPORTED_MODULE_5__tensor_filter__["b" /* default */].prototype.availableOptions);

/* harmony default export */ __webpack_exports__["a"] = (EdgePadFilter);

/***/ }),
/* 197 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__tensor_filter__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var SharpenFilter = function (_TensorFilter) {
  _inherits(SharpenFilter, _TensorFilter);

  function SharpenFilter() {
    _classCallCheck(this, SharpenFilter);

    return _possibleConstructorReturn(this, (SharpenFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(SharpenFilter)).apply(this, arguments));
  }

  _createClass(SharpenFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      var inputInfo = this._getInputWithName('x');
      return inputInfo.logicalShape;
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      return '\n      float kernel[9];\n      vec2 offset[9];\n      float factor = 0.1;\n    \n      void main ()\n      {\n        kernel[0] = 0.;\n        kernel[1] = -1. * factor;\n        kernel[2] = 0.;\n        kernel[3] = -1. * factor;\n        kernel[4] = 1. + 4. * factor;\n        kernel[5] = -1. * factor;\n        kernel[6] = 0.;\n        kernel[7] = -1. * factor;\n        kernel[8] = 0.;\n\n        float step_w = 1.0 / float(x_sizeRC.y);\n        float step_h = 1.0 / float(x_sizeRC.x);\n\n        offset[0] = vec2(-step_w, -step_h);\n        offset[1] = vec2(0.0, -step_h);\n        offset[2] = vec2(step_w, -step_h);\n        offset[3] = vec2(-step_w, 0.0);\n        offset[4] = vec2(0.0, 0.0);\n        offset[5] = vec2(step_w, 0.0);\n        offset[6] = vec2(-step_w, step_h);\n        offset[7] = vec2(0.0, step_h);\n        offset[8] = vec2(step_w, step_h);\n\n        vec2 uv = (gl_FragCoord.xy + halfCR) / x_texRC.yx;\n        vec4 sum = vec4(0.0);\n        for (int i = 0; i < 9; i++) {\n          vec4 color = texture2D(x, uv.xy + offset[i]);\n          sum += color * kernel[i];\n        }\n\n        gl_FragColor = sum;\n      }\n    ';
    }
  }, {
    key: 'requiresFloatTextures',
    value: function requiresFloatTextures() {
      return false;
    }
  }]);

  return SharpenFilter;
}(__WEBPACK_IMPORTED_MODULE_4__tensor_filter__["b" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (SharpenFilter);

/***/ }),
/* 198 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FileDownloader = function () {
  function FileDownloader() {
    _classCallCheck(this, FileDownloader);
  }

  _createClass(FileDownloader, null, [{
    key: 'downloadDataURL',

    /**
     * Exports the given data url
     * @param  {String} data
     * @param  {String} baseName = 'photoeditorsdk-export'
     */
    value: function downloadDataURL(data) {
      var baseName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'photoeditorsdk-export';

      var url = this.createBlobURLFromDataURL(data);
      var extension = this.getExtensionFromDataURL(data);

      var link = document.createElement('a');
      link.download = baseName + '.' + extension;
      link.href = url;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    /**
     * Exports the given data url using msBlob
     * @param  {String} data
     * @param  {String} baseName = 'photoeditorsdk-export'
     */

  }, {
    key: 'downloadMSBlob',
    value: function downloadMSBlob(data) {
      var baseName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'photoeditorsdk-export';

      if (navigator.msSaveBlob) {
        navigator.msSaveBlob(data, baseName + '.png');
      }
    }

    /**
     * Returns the file extension by reading the given data url
     * @param  {String} data
     * @return {String}
     */

  }, {
    key: 'getExtensionFromDataURL',
    value: function getExtensionFromDataURL(data) {
      var mimeString = data.split(',')[0].split(':')[1].split(';')[0];
      return mimeString.split('/').pop();
    }

    /**
     * Creates a Blob URI from the given Data URI
     * @param {String} data
     */

  }, {
    key: 'createBlobURLFromDataURL',
    value: function createBlobURLFromDataURL(data) {
      if (!window.Blob || !window.URL || !ArrayBuffer || !Uint8Array) {
        return data;
      }

      var rawData = __WEBPACK_IMPORTED_MODULE_1_globals__["a" /* Base64 */].decode(data.split(',')[1]);
      var mimeString = data.split(',')[0].split(':')[1].split(';')[0];

      // write the bytes of the string to an ArrayBuffer
      var arrayBuffer = new ArrayBuffer(rawData.length);
      var intArray = new Uint8Array(arrayBuffer);
      for (var i = 0; i < rawData.length; i++) {
        intArray[i] = rawData[i];
      }

      // write the ArrayBuffer to a blob, and you're done
      var blob = new window.Blob([arrayBuffer], {
        type: mimeString
      });
      return window.URL.createObjectURL(blob);
    }
  }]);

  return FileDownloader;
}();

/* harmony default export */ __webpack_exports__["a"] = (FileDownloader);

/***/ }),
/* 199 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__ = __webpack_require__(31);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FONT_WEIGHTS = {
  100: 'Extra Light',
  200: 'Light',
  300: 'Book',
  400: 'Regular',
  500: 'Medium',
  600: 'Semibold',
  700: 'Bold',
  800: 'Black',
  900: 'Extra Black',
  bold: 'Bold',
  normal: 'Regular'
};

var FontVariation = function (_Configurable) {
  _inherits(FontVariation, _Configurable);

  function FontVariation() {
    _classCallCheck(this, FontVariation);

    return _possibleConstructorReturn(this, (FontVariation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(FontVariation)).apply(this, arguments));
  }

  _createClass(FontVariation, [{
    key: 'getLabel',

    /**
     * Returns the label for this variation
     * @return {String}
     */
    value: function getLabel() {
      var label = FONT_WEIGHTS[this._options.fontWeight];

      switch (this._options.fontStyle) {
        case 'italic':
          label += ' Italic';
          break;
      }

      return label;
    }
  }]);

  return FontVariation;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["Configurable"]);

/**
 * Specifies the available options for the FontVariation class
 * @type {Object}
 * @ignore
 */


/* harmony default export */ __webpack_exports__["a"] = (FontVariation);
FontVariation.prototype.availableOptions = {
  identifier: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].STRING, required: true },
  fontFamily: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].STRING, required: true },
  fontWeight: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].ALL, default: 400 },
  fontStyle: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].STRING, default: 'normal' },
  textMetrics: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].OBJECT, default: null },
  provider: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].STRING, available: ['google', 'file'] },
  filePath: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].STRING },
  default: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].BOOLEAN, default: false },
  font: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk__["OptionType"].OBJECT }
};

/***/ }),
/* 200 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_globals__ = __webpack_require__(9);



var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var TWICE_PI = Math.PI * 2;

var v100Serializer = function () {
  function v100Serializer(editor) {
    _classCallCheck(this, v100Serializer);

    this._editor = editor;

    this._serializeOperations = this._serializeOperations.bind(this);
  }

  // -------------------------------------------------------------------------- SERIALIZATION

  /**
   * Serializes the editor state
   * @param {Object} options = {}
   * @return {Promise}
   */


  _createClass(v100Serializer, [{
    key: 'serialize',
    value: function serialize() {
      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      this._options = __WEBPACK_IMPORTED_MODULE_2_globals__["k" /* SDKUtils */].defaults(options, {
        image: true
      });

      var data = {
        version: this.constructor.version
      };

      return this._serializeInputImage(data).then(this._serializeOperations);
    }

    /**
     * Serializes the input image as base64 and attaches it to `data`
     * @param  {Object} data
     * @return {Promise}
     * @private
     */

  }, {
    key: '_serializeInputImage',
    value: function _serializeInputImage(data) {
      var image = this._editor.getImage();
      var width = image.width,
          height = image.height;


      if (!this._options.image) {
        data.inputImage = { width: width, height: height };
        return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve(data);
      }

      var canvas = __WEBPACK_IMPORTED_MODULE_2_globals__["k" /* SDKUtils */].createCanvas();
      canvas.width = image.width;
      canvas.height = image.height;
      var context = canvas.getContext('2d');
      context.drawImage(image, 0, 0);

      var dataUrl = canvas.toDataURL(__WEBPACK_IMPORTED_MODULE_2_globals__["e" /* ImageFormat */].PNG);
      data.inputImage = {
        type: __WEBPACK_IMPORTED_MODULE_2_globals__["e" /* ImageFormat */].PNG,
        data: dataUrl.replace(/^data:image\/(.*?);base64,/, ''),
        width: width,
        height: height
      };
      return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve(data);
    }

    /**
     * Serializes the operations and attaches them to `data`
     * @param  {Object} data
     * @return {Promise}
     * @private
     */

  }, {
    key: '_serializeOperations',
    value: function _serializeOperations(data) {
      var _this = this;

      var operations = [];
      var stack = this._editor.operations.getStack();
      stack.forEach(function (operation) {
        var data = _this._serializeOperation(operation, operations);
        if (data) {
          operations.push(data);
        }
      });
      data.operations = operations.filter(function (o) {
        return o;
      }); // Remove possible `null` operations
      return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve(data);
    }

    /**
     * Serializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operation[]} operations
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeOperation',
    value: function _serializeOperation(operation, operations) {
      switch (operation.constructor.identifier) {
        case 'transform':
          return this._serializeTransformOperation(operation);
        case 'orientation':
          return this._serializeOrientationOperation(operation);
        case 'filter':
          return this._serializeFilterOperation(operation);
        case 'adjustments':
          return this._serializeAdjustmentsOperation(operation);
        case 'sprite':
          return this._serializeSpriteOperation(operation, operations);
        case 'radial-focus':
          return this._serializeRadialFocusOperation(operation);
        case 'mirrored-focus':
          return this._serializeLinearFocusOperation(operation);
        default:
          __WEBPACK_IMPORTED_MODULE_2_globals__["g" /* Log */].warn('Unable to serialize operation of type ' + operation.constructor.identifier);
      }
    }

    /**
     * Serializes the given transform operation
     * @param  {PhotoEditorSDK.Operation.TransformOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeTransformOperation',
    value: function _serializeTransformOperation(operation) {
      var options = operation.serializeOptions(['start', 'end', 'rotation'], true);
      options.rotation = (options.rotation + TWICE_PI) % TWICE_PI;
      return {
        type: 'crop',
        options: options
      };
    }

    /**
     * Serializes the given orientation operation
     * @param  {PhotoEditorSDK.Operation.OrientationOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeOrientationOperation',
    value: function _serializeOrientationOperation(operation) {
      return {
        type: 'orientation',
        options: operation.serializeOptions(['flipVertically', 'flipHorizontally', 'rotation'], true)
      };
    }

    /**
     * Serializes the given filter operation
     * @param  {PhotoEditorSDK.Operations.FilterOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeFilterOperation',
    value: function _serializeFilterOperation(operation) {
      if (operation.getIdentifier() === 'identity') return null;

      return {
        type: 'filter',
        options: {
          intensity: operation.getIntensity(),
          name: operation.getIdentifier()
        }
      };
    }

    /**
     * Serializes the given adjustments operation
     * @param  {PhotoEditorSDK.Operations.AdjustmentsOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeAdjustmentsOperation',
    value: function _serializeAdjustmentsOperation(operation) {
      var availableOptions = operation.availableOptions;


      var optionNames = ['brightness', 'saturation', 'contrast', 'exposure', 'shadows', 'highlights', 'clarity'];
      var options = {};
      optionNames.forEach(function (optionName) {
        var option = availableOptions[optionName];
        var value = operation.getOption(optionName);
        var minValue = option.minValue,
            midValue = option.midValue,
            maxValue = option.maxValue;

        options[optionName] = value <= midValue ? (value - minValue) / (midValue - minValue) - 1 : (value - midValue) / (maxValue - midValue);
      });
      return {
        type: 'adjustments',
        options: options
      };
    }

    /**
     * Serializes the given sprite operation
     * @return {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @private
     */

  }, {
    key: '_serializeSpriteOperation',
    value: function _serializeSpriteOperation(operation, operations) {
      var _this2 = this;

      var spriteOperations = operations.filter(function (o) {
        return o.type === 'sprite';
      });
      var spriteOperation = void 0;
      var returnOperation = true;
      if (spriteOperations.length) {
        spriteOperation = spriteOperations.pop();
        returnOperation = false;
      } else {
        // No sprite operation exists, create a new one
        spriteOperation = {
          type: 'sprite',
          options: {
            sprites: []
          }
        };
      }

      operation.getSprites().forEach(function (sprite) {
        var spriteItem = null;
        if (sprite instanceof operation.constructor.StickerSprite) {
          spriteItem = _this2._serializeSticker(operation, sprite);
        } else if (sprite instanceof operation.constructor.TextSprite) {
          spriteItem = _this2._serializeText(operation, sprite);
        } else if (sprite instanceof operation.constructor.BrushSprite) {
          spriteItem = _this2._serializeBrush(operation, sprite);
        } else if (sprite instanceof operation.constructor.TextDesignSprite) {
          spriteItem = _this2._serializeTextDesign && _this2._serializeTextDesign(operation, sprite);
        }

        if (spriteItem) {
          spriteOperation.options.sprites.push(spriteItem);
        }
      });

      if (returnOperation) {
        return spriteOperation;
      }
    }

    /**
     * Serializes the given sticker
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeSticker',
    value: function _serializeSticker(operation, sprite) {
      var adjustments = sprite.getAdjustments();

      var options = sprite.serializeOptions(['identifier', 'position', 'dimensions', 'flipVertically', 'flipHorizontally', 'rotation'], true);

      options.name = options.identifier;
      delete options.identifier;

      options.rotation = (options.rotation + TWICE_PI) % TWICE_PI;

      var adjustmentsOptions = adjustments.availableOptions;
      options.adjustments = {
        brightness: adjustments.getBrightness() - adjustmentsOptions.brightness.default,
        saturation: adjustments.getSaturation() - adjustmentsOptions.saturation.default,
        contrast: adjustments.getContrast() - adjustmentsOptions.contrast.default
      };

      return {
        type: 'sticker',
        options: options
      };
    }

    /**
     * Serializes the given text sprite
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.TextSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeText',
    value: function _serializeText(operation, sprite) {
      var options = sprite.serializeOptions(['fontSize', 'lineHeight', 'fontFamily', 'fontWeight', 'alignment', 'color', 'backgroundColor', 'position', 'rotation', 'text', 'maxWidth'], true);
      options.rotation = (options.rotation + TWICE_PI) % TWICE_PI;

      return {
        type: 'text',
        options: options
      };
    }

    /**
     * Serializes the given brush sprite
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeBrush',
    value: function _serializeBrush(operation, sprite) {
      var _this3 = this;

      return {
        type: 'brush',
        options: {
          paths: sprite.getPaths().map(function (path) {
            return _this3._serializePath(path);
          })
        }
      };
    }

    /**
     * Serializes the given path
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path} path
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializePath',
    value: function _serializePath(path) {
      var options = path.getBrush().serializeOptions(['color', 'size'], true);

      options.points = path.getControlPoints().map(function (point) {
        return point.getPosition().toObject();
      });
      return options;
    }

    /**
     * Serializes the given radial focus operation
     * @param  {PhotoEditorSDK.Operations.RadialFocusOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeRadialFocusOperation',
    value: function _serializeRadialFocusOperation(operation) {
      return {
        type: 'focus',
        options: {
          type: 'radial',
          options: operation.serializeOptions(['position', 'radius', 'gradientRadius', 'blurRadius'], true)
        }
      };
    }

    /**
     * Serializes the given linear focus operation
     * @param  {PhotoEditorSDK.Operations.MirroredFocusOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeLinearFocusOperation',
    value: function _serializeLinearFocusOperation(operation) {
      return {
        type: 'focus',
        options: {
          type: 'linear',
          options: operation.serializeOptions(['start', 'end', 'blurRadius', 'size', 'gradientSize'], true)
        }
      };
    }

    /**
     * Returns the input dimensions for the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {PhotoEditorSDK.Math.Vector2}
     * @private
     */

  }, {
    key: '_getInputDimensionsForOperation',
    value: function _getInputDimensionsForOperation(operation) {
      var operationFound = false;
      var inputDimensions = this._editor.getInputDimensions();

      this._editor.operations.getStack().forEach(function (op) {
        if (op === operation) operationFound = true;
        if (operationFound) return;
        inputDimensions = op.getNewDimensions(inputDimensions);
      });

      return inputDimensions;
    }
  }]);

  return v100Serializer;
}();

/* harmony default export */ __webpack_exports__["a"] = (v100Serializer);


v100Serializer.version = '1.0.0';

/***/ }),
/* 201 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_regenerator__ = __webpack_require__(79);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_regenerator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_shared_managers_filter_manager__ = __webpack_require__(202);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_shared_managers_sticker_manager__ = __webpack_require__(134);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_shared_managers_brush_manager__ = __webpack_require__(492);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_shared_managers_font_manager__ = __webpack_require__(41);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_lib_font_loader__ = __webpack_require__(135);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve(value).then(function (value) { step("next", value); }, function (err) { step("throw", err); }); } } return step("next"); }); }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








var Brush = void 0;
if (typeof __WEBPACK_IMPORTED_MODULE_6_globals__["j" /* SDK */].Operations.SpriteOperation !== 'undefined') {
  Brush = __WEBPACK_IMPORTED_MODULE_6_globals__["j" /* SDK */].Operations.SpriteOperation.BrushSprite;
}

var v100Deserializer = function () {
  function v100Deserializer(editor, data) {
    _classCallCheck(this, v100Deserializer);

    this._editor = editor;
    this._ui = this._editor.getUI();
    this._data = data;

    this._filterManager = new __WEBPACK_IMPORTED_MODULE_7_shared_managers_filter_manager__["a" /* default */](this._ui, this._getOptions('filter'));
    this._stickerManager = new __WEBPACK_IMPORTED_MODULE_8_shared_managers_sticker_manager__["a" /* default */](this._ui, this._getOptions('sticker'));
    this._brushManager = new __WEBPACK_IMPORTED_MODULE_9_shared_managers_brush_manager__["a" /* default */](this._ui, this._getOptions('brush'));
    this._fontManager = new __WEBPACK_IMPORTED_MODULE_10_shared_managers_font_manager__["a" /* default */](this._ui, this._getOptions('text'));
  }

  _createClass(v100Deserializer, [{
    key: '_getOptions',
    value: function _getOptions(control) {
      var controls = this._editor.controls;

      var defaultOptions = {};
      if (controls && controls.get(control)) {
        defaultOptions = controls.get(control).defaultOptions;
      }

      var editorOptions = this._editor.getOptions();
      return __WEBPACK_IMPORTED_MODULE_6_globals__["k" /* SDKUtils */].deepDefaults({}, editorOptions.editor.controlsOptions[control] || {}, defaultOptions);
    }

    /**
     * Deserializes the given data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize() {
      var _this = this;

      return this._validateVersion().then(function () {
        return _this._deserializeInputImage();
      }).then(function () {
        return _this._deserializeOperations();
      });
    }

    /**
     * Validates the version
     * @return {Promise}
     */

  }, {
    key: '_validateVersion',
    value: function _validateVersion() {
      if (this._data.version !== this.constructor.version) {
        return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.reject(new Error('Invalid version ' + this._data.version + ', expected ' + this.constructor.version));
      }
      return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve();
    }

    /**
     * Deserializes the input image (if present)
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeInputImage',
    value: function _deserializeInputImage() {
      var _this2 = this;

      return new __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var _data$inputImage = _this2._data.inputImage,
            data = _data$inputImage.data,
            type = _data$inputImage.type;

        if (data && type) {
          var image = new window.Image();
          image.addEventListener('load', function () {
            _this2._editor.setImage(image);
            resolve();
          });
          image.src = 'data:' + type + ';base64,' + data;
        } else {
          resolve();
        }
      });
    }

    /**
     * Deserializes the operations
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeOperations',
    value: function () {
      var _ref = _asyncToGenerator( /*#__PURE__*/__WEBPACK_IMPORTED_MODULE_4_babel_runtime_regenerator___default.a.mark(function _callee() {
        var operations, instances, i, operation, instance;
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_regenerator___default.a.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                operations = this._data.operations;
                instances = [];
                i = 0;

              case 3:
                if (!(i < operations.length)) {
                  _context.next = 12;
                  break;
                }

                operation = operations[i];
                _context.next = 7;
                return this._deserializeOperation(operation);

              case 7:
                instance = _context.sent;

                instances.push(instance);

              case 9:
                i++;
                _context.next = 3;
                break;

              case 12:
                return _context.abrupt('return', instances);

              case 13:
              case 'end':
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function _deserializeOperations() {
        return _ref.apply(this, arguments);
      }

      return _deserializeOperations;
    }()

    /**
     * Deserializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeOperation',
    value: function _deserializeOperation(operation) {
      switch (operation.type) {
        case 'crop':
          return this._deserializeCropOperation(operation);
        case 'orientation':
          return this._deserializeOrientationOperation(operation);
        case 'filter':
          return this._deserializeFilterOperation(operation);
        case 'adjustments':
          return this._deserializeAdjustmentsOperation(operation);
        case 'sprite':
          return this._deserializeSpriteOperation(operation);
        case 'focus':
          return this._deserializeFocusOperation(operation);
      }
    }

    /**
     * Deserializes the given crop operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeCropOperation',
    value: function _deserializeCropOperation(operation) {
      var options = operation.options;
      var rotation = options.rotation;

      var start = __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.start);
      var end = __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.end);

      // Normalize rotation
      if (rotation > Math.PI) {
        rotation -= Math.PI * 2;
      }

      var cropOptions = { start: start, end: end };
      if (typeof rotation !== 'undefined') {
        cropOptions.rotation = rotation;
      }

      var transformOperation = this._editor.operations.getOrCreate('transform');
      this._editor.broadcastTransform(transformOperation, cropOptions);
      transformOperation.set(cropOptions);
      return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve(transformOperation);
    }

    /**
     * Deserializes the given orientation operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeOrientationOperation',
    value: function _deserializeOrientationOperation(operation) {
      var options = operation.options;

      var orientationOperation = this._editor.operations.getOrCreate('orientation');
      if (!orientationOperation) return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve();
      orientationOperation.set(options);
      return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve(orientationOperation);
    }

    /**
     * Deserializes the given filter operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFilterOperation',
    value: function _deserializeFilterOperation(operation) {
      var _this3 = this;

      var options = operation.options;


      if (!this._filterManager.getFilterByIdentifier(options.name)) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Deserializer', 'Unknown filter `' + options.name + '`');
        return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve();
      }

      return this._filterManager.instantiateFilterWithIdentifier(options.name).then(function (filter) {
        var filterOperation = _this3._editor.operations.getOrCreate('filter');
        filterOperation.set({
          identifier: options.name,
          filter: filter,
          intensity: options.intensity
        });
        return filterOperation;
      });
    }

    /**
     * Deserializes the given adjustments operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeAdjustmentsOperation',
    value: function _deserializeAdjustmentsOperation(operation) {
      var AdjustmentsOperation = __WEBPACK_IMPORTED_MODULE_6_globals__["j" /* SDK */].Operations.AdjustmentsOperation;
      var options = operation.options;


      var knownOptions = ['brightness', 'saturation', 'contrast', 'exposure', 'shadows', 'highlights', 'clarity'];

      var operationOptions = {};

      knownOptions.forEach(function (optionName) {
        if (typeof options[optionName] === 'undefined') return;

        var _AdjustmentsOperation = AdjustmentsOperation.prototype.availableOptions[optionName],
            minValue = _AdjustmentsOperation.minValue,
            midValue = _AdjustmentsOperation.midValue,
            maxValue = _AdjustmentsOperation.maxValue;

        var value = options[optionName];

        value = value < 0 ? midValue + (midValue - minValue) * value : midValue + (maxValue - midValue) * value;
        operationOptions[optionName] = value;
      });

      return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('adjustments', operationOptions));
    }

    /**
     * Deserializes the given sprite operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeSpriteOperation',
    value: function _deserializeSpriteOperation(operation) {
      var _this4 = this;

      var options = operation.options;

      var spriteOperation = this._editor.operations.getOrCreate('sprite');
      if (!spriteOperation) return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve();

      var promises = options.sprites.map(function (sprite) {
        return _this4._deserializeSprite(spriteOperation, sprite);
      }).filter(function (p) {
        return p;
      });
      return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.all(promises).then(function (sprites) {
        spriteOperation.setSprites(sprites.filter(function (s) {
          return s;
        }));
        return spriteOperation;
      });
    }

    /**
     * Deserializes the given sprite
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} spriteOperation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprite} sprite
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeSprite',
    value: function _deserializeSprite(spriteOperation, sprite) {
      switch (sprite.type) {
        case 'sticker':
          return this._deserializeSticker(spriteOperation, sprite);
        case 'text':
          return this._deserializeText(spriteOperation, sprite);
        case 'brush':
          return this._deserializeBrush(spriteOperation, sprite);
        case 'textdesign':
          return this._deserializeTextDesign && this._deserializeTextDesign(spriteOperation, sprite);
      }
    }

    /**
     * Deserializes the given sticker for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} sprite
     * @return {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite}
     * @private
     */

  }, {
    key: '_deserializeSticker',
    value: function _deserializeSticker(operation, sprite) {
      var _this5 = this;

      var SpriteOperation = __WEBPACK_IMPORTED_MODULE_6_globals__["j" /* SDK */].Operations.SpriteOperation;
      var options = sprite.options;


      var sticker = this._stickerManager.getStickerByIdentifier(options.name);
      var url = this._stickerManager.getURLForSticker(sticker);
      if (!sticker) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Deserializer', 'Unknown sticker \'' + options.name + '\'. Skipping sprite.');
        return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve();
      }
      return new __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var image = new window.Image();
        image.addEventListener('load', function () {
          var adjustments = SpriteOperation.StickerSprite.prototype.availableOptions.adjustments.structure;
          var rotation = options.rotation,
              flipHorizontally = options.flipHorizontally,
              flipVertically = options.flipVertically;

          var stickerOptions = {
            identifier: options.name,
            image: image,
            position: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.position),
            dimensions: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.dimensions),
            rotation: rotation,
            flipHorizontally: flipHorizontally,
            flipVertically: flipVertically,
            adjustments: {}
          };

          if (typeof options.adjustments !== 'undefined') {
            ['brightness', 'contrast', 'saturation'].forEach(function (option) {
              if (typeof options.adjustments[option] !== 'undefined') {
                stickerOptions.adjustments[option] = options.adjustments[option] + adjustments[option].default;
              }
            });
          }

          resolve(operation.createSticker(stickerOptions));
        });
        image.crossOrigin = _this5._editor.getCrossOrigin();
        image.src = _this5._editor.getUI().getAssetPath(url);
      });
    }

    /**
     * Deserializes the given text for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} text
     * @return {PhotoEditorSDK.Operations.SpriteOperation.TextSprite}
     * @private
     */

  }, {
    key: '_deserializeText',
    value: function _deserializeText(operation, text) {
      var options = text.options;
      var fontSize = options.fontSize,
          lineHeight = options.lineHeight,
          fontFamily = options.fontFamily,
          fontWeight = options.fontWeight,
          alignment = options.alignment,
          rotation = options.rotation,
          maxWidth = options.maxWidth,
          color = options.color,
          backgroundColor = options.backgroundColor;


      var fontLoader = new __WEBPACK_IMPORTED_MODULE_11_lib_font_loader__["a" /* default */](this._ui);
      var font = this._fontManager.getFontByFontFamily(fontFamily);
      if (!font) font = this._fontManager.getDefaultFont();
      fontLoader.setFonts([font]);
      return fontLoader.load().then(function () {
        var sprite = operation.createText({
          fontSize: fontSize,
          lineHeight: lineHeight,
          fontFamily: fontFamily,
          fontWeight: fontWeight,
          alignment: alignment,
          rotation: rotation,
          maxWidth: maxWidth,
          text: options.text,
          color: __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(color),
          backgroundColor: __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(backgroundColor),
          position: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.position)
        });
        sprite._edited = true;
        return sprite;
      });
    }

    /**
     * Deserializes the given brush for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} brush
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite}
     * @private
     */

  }, {
    key: '_deserializeBrush',
    value: function _deserializeBrush(operation, brush) {
      var _this6 = this;

      var options = brush.options;
      var paths = options.paths;


      var brushSprite = operation.createBrush();
      paths.forEach(function (path) {
        _this6._deserializeBrushPath(brushSprite, path);
      });
      return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve(brushSprite);
    }
  }, {
    key: '_deserializeBrushPath',
    value: function _deserializeBrushPath(brushSprite, path) {
      var points = path.points;


      var brushInstance = this._createBrushForPath(path);
      var pathObject = brushSprite.createPath(brushInstance);
      pathObject.setClosed(true);
      points.forEach(function (point) {
        pathObject.addControlPoint(__WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(point));
      });
    }

    /**
     * Creates a brush face with the given options
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Path} path
     * @return {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Brush}
     */

  }, {
    key: '_createBrushForPath',
    value: function _createBrushForPath(path) {
      var color = path.color,
          size = path.size;

      var colorObject = __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(color);

      var brushOptions = {
        color: colorObject,
        size: size
      };

      var rawBrush = this._brushManager.getFirstBrush();
      if (rawBrush.prototype && rawBrush.prototype instanceof Brush) {
        // Custom Brush instance, used for special brushes such as radial brush, which has
        // an additional hardness option
        var BrushClass = rawBrush;
        return new BrushClass(brushOptions);
      } else {
        var _brush = __WEBPACK_IMPORTED_MODULE_6_globals__["k" /* SDKUtils */].extend({}, rawBrush);
        delete _brush.image;

        var _BrushClass = function (_Brush) {
          _inherits(_BrushClass, _Brush);

          function _BrushClass() {
            _classCallCheck(this, _BrushClass);

            return _possibleConstructorReturn(this, (_BrushClass.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(_BrushClass)).apply(this, arguments));
          }

          return _BrushClass;
        }(Brush);

        _BrushClass.identifier = rawBrush.identifier;

        // Plain JS object, used for simple image brushes
        return new _BrushClass(__WEBPACK_IMPORTED_MODULE_6_globals__["k" /* SDKUtils */].extend({}, _brush, brushOptions));
      }
    }

    /**
     * Deserializes the given focus operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFocusOperation',
    value: function _deserializeFocusOperation(operation) {
      var options = operation.options.options;

      switch (operation.options.type) {
        case 'radial':
          {
            var position = options.position,
                radius = options.radius,
                gradientRadius = options.gradientRadius,
                blurRadius = options.blurRadius;

            return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('radial-focus', {
              position: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(position),
              radius: radius,
              gradientRadius: gradientRadius,
              blurRadius: blurRadius
            }));
          }
        case 'linear':
          {
            var start = options.start,
                end = options.end,
                size = options.size,
                gradientSize = options.gradientSize,
                _blurRadius = options.blurRadius;

            return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('mirrored-focus', {
              start: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(start),
              end: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(end),
              size: size,
              gradientSize: gradientSize,
              blurRadius: _blurRadius
            }));
          }
      }
    }

    /**
     * Returns the input dimensions for the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {PhotoEditorSDK.Math.Vector2}
     * @private
     */

  }, {
    key: '_getInputDimensionsForOperation',
    value: function _getInputDimensionsForOperation(operation) {
      var operationFound = false;
      var inputDimensions = this._editor.getInputDimensions();

      this._editor.operations.getStack().forEach(function (op) {
        if (op === operation) operationFound = true;
        if (operationFound) return;
        inputDimensions = op.getNewDimensions(inputDimensions);
      });

      return inputDimensions;
    }
  }]);

  return v100Deserializer;
}();

/* harmony default export */ __webpack_exports__["a"] = (v100Deserializer);


v100Deserializer.version = '1.0.0';

/***/ }),
/* 202 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_globals__ = __webpack_require__(9);



var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FilterManager = function () {
  function FilterManager(ui, options) {
    var isPreloading = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

    _classCallCheck(this, FilterManager);

    this._ui = ui;
    this._options = options;
    this._categoriesById = {};
    this._filtersByIdentifier = {
      identity: __WEBPACK_IMPORTED_MODULE_2_globals__["j" /* SDK */].Operations.FilterOperation.Filters.IdentityFilter
    };

    this._categories = __WEBPACK_IMPORTED_MODULE_2_globals__["m" /* Utils */].wrapFiltersInCategories(__WEBPACK_IMPORTED_MODULE_2_globals__["l" /* SharedConstants */].DEFAULTS.FILTERS.slice(0), FilterManager.CATEGORY_ITEMS_PROPERTY);

    this._customAssetsAllowed = isPreloading || ui.getEditor().getSDK()._l.areCustomAssetsAllowed();

    if (this._customAssetsAllowed && this._options.categories) {
      this._options.categories = __WEBPACK_IMPORTED_MODULE_2_globals__["m" /* Utils */].wrapFiltersInCategories(this._options.categories, FilterManager.CATEGORY_ITEMS_PROPERTY);
    }

    this._initCategories();
  }

  _createClass(FilterManager, [{
    key: 'instantiateFilterWithIdentifier',
    value: function instantiateFilterWithIdentifier(identifier) {
      var _this = this;

      var crossOrigin = { value: this._ui._options.crossOrigin, cors: true };
      var Filter = this.getFilterByIdentifier(identifier);
      if (!Filter) {
        return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.reject(new Error('Unknown filter with identifier `' + identifier + '`!'));
      }

      if (!(Filter.prototype instanceof __WEBPACK_IMPORTED_MODULE_2_globals__["j" /* SDK */].Operations.FilterOperation.Filter)) {
        var lutImage = Filter.lutImage,
            resolution = Filter.resolution,
            horizontalTileCount = Filter.horizontalTileCount,
            verticalTileCount = Filter.verticalTileCount;
        var lightColor = Filter.lightColor,
            darkColor = Filter.darkColor;


        if (lightColor && darkColor) {
          // DuoToneFilter
          lightColor = __WEBPACK_IMPORTED_MODULE_2_globals__["b" /* Color */].fromHex(lightColor);
          darkColor = __WEBPACK_IMPORTED_MODULE_2_globals__["b" /* Color */].fromHex(darkColor);

          return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve(new __WEBPACK_IMPORTED_MODULE_2_globals__["j" /* SDK */].Operations.FilterOperation.Filters.DuoToneFilter({
            lightColor: lightColor, darkColor: darkColor
          }));
        } else {
          // ThreeDLUTFilter
          var preloadedImage = void 0;
          if (this._ui.getPreloader) {
            preloadedImage = this._ui.getPreloader().getAsset(lutImage);
          }
          var loadPromise = void 0;
          if (preloadedImage) {
            loadPromise = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve(preloadedImage);
          } else {
            loadPromise = __WEBPACK_IMPORTED_MODULE_2_globals__["f" /* ImageLoader */].loadImage(this._ui.getAssetPath(lutImage), crossOrigin);
          }

          return loadPromise.then(function () {
            return __WEBPACK_IMPORTED_MODULE_2_globals__["f" /* ImageLoader */].loadImage(_this._ui.getAssetPath(lutImage), crossOrigin).then(function (image) {
              return new __WEBPACK_IMPORTED_MODULE_2_globals__["j" /* SDK */].Operations.FilterOperation.Filters.ThreeDLUTFilter({
                image: image, resolution: resolution, horizontalTileCount: horizontalTileCount, verticalTileCount: verticalTileCount
              });
            });
          });
        }
      } else {
        return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve(new Filter());
      }
    }

    /**
     * Initializes the categories
     * @private
     */

  }, {
    key: '_initCategories',
    value: function _initCategories() {
      var _this2 = this;

      // Should the categories passed in by the user replace the existing ones?
      if (this._customAssetsAllowed && this._options.categories) {
        if (this._options.replaceCategories) {
          this._categories = __WEBPACK_IMPORTED_MODULE_2_globals__["m" /* Utils */].wrapFiltersInCategories(this._options.categories, FilterManager.CATEGORY_ITEMS_PROPERTY);
        } else {
          this._categories = __WEBPACK_IMPORTED_MODULE_2_globals__["m" /* Utils */].mergeCategories(this._categories, this._options.categories, FilterManager.CATEGORY_ITEMS_PROPERTY);
        }
      }

      // Remove filters that should not be selectable
      if (this._customAssetsAllowed && this._options.availableFilters) {
        var newCategories = [];
        this._categories.forEach(function (category) {
          var filters = category.filters.filter(function (f) {
            return _this2._options.availableFilters.indexOf(f.identifier) !== -1;
          });
          if (filters.length > 0) {
            newCategories.push({
              identifier: category.identifier,
              defaultName: category.defaultName,
              filters: filters
            });
          }
        });
        this._categories = newCategories;
      }

      var allCategory = {
        identifier: 'all',
        defaultName: 'All',
        visible: false,
        filters: this._categories.length <= 0 ? [] : this._categories.map(function (c) {
          return c.filters;
        }).reduce(function (a, b) {
          return a.concat(b);
        })
      };
      this._categories.unshift(allCategory);
      this._categoriesById.all = allCategory;
      this._categories.forEach(function (c) {
        _this2._categoriesById[c.identifier] = c;
      });
      allCategory.filters.forEach(function (filter) {
        _this2._filtersByIdentifier[filter.identifier] = filter;
      });
    }

    /**
     * Returns the filters for the category with the given name
     * @param  {String} categoryIdentifier
     * @return {Object[]}
     */

  }, {
    key: 'getFiltersForCategory',
    value: function getFiltersForCategory(categoryIdentifier) {
      if (!this._categoriesById[categoryIdentifier]) {
        throw new Error('Unknown filter category \'' + categoryIdentifier + '\'');
      }
      return this._categoriesById[categoryIdentifier].filters;
    }

    /**
     * Returns the items for a specific category.
     * This is just a unified method for other components like the categories-component and wraps the getFiltersForCategory method
     * @param  {String} categoryIdentifier
     * @return {Object[]}
     * @public
     */

  }, {
    key: 'getItemsByCategory',
    value: function getItemsByCategory(categoryIdentifier) {
      return this.getFiltersForCategory(categoryIdentifier);
    }

    /**
     * Returns the filter with the given identifier
     * @param  {String} identifier
     * @return {PhotoEditorSDK.Operations.FilterOperation.Filter}
     */

  }, {
    key: 'getFilterByIdentifier',
    value: function getFilterByIdentifier(identifier) {
      return this._filtersByIdentifier[identifier];
    }

    /**
     * Returns the categories
     * @return {Object[]}
     */

  }, {
    key: 'getCategories',
    value: function getCategories() {
      return this._categories;
    }

    /**
     * Returns the category with the given identifier
     * @param  {String} identifier
     * @return {Object}
     */

  }, {
    key: 'getCategoryByIdentifier',
    value: function getCategoryByIdentifier(identifier) {
      return this._categoriesById[identifier];
    }
  }]);

  return FilterManager;
}();

FilterManager.CATEGORY_ITEMS_PROPERTY = 'filters';
/* harmony default export */ __webpack_exports__["a"] = (FilterManager);

/***/ }),
/* 203 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__font_observer__ = __webpack_require__(494);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__ = __webpack_require__(31);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__);



var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var BaseFontLoader = function () {
  function BaseFontLoader(ui) {
    _classCallCheck(this, BaseFontLoader);

    this._ui = ui;
    this._fonts = [];
    this._observers = [];
  }

  /**
   * Adds the given font to the list of fonts to load
   * @param {Object} variation
   */


  _createClass(BaseFontLoader, [{
    key: 'add',
    value: function add(variation) {
      this._fonts.push(variation);
    }

    /**
     * Loads the fonts
     */

  }, {
    key: 'load',
    value: function load() {
      var _this = this;

      if (this._fonts.length === 0) {
        return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.resolve();
      }

      this._observers = [];
      this._fonts.forEach(function (variation) {
        _this._observers.push(new __WEBPACK_IMPORTED_MODULE_2__font_observer__["a" /* default */](variation));
      });

      return __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["Utils"].executePromises(this._observers.map(function (observer) {
        return observer.observe();
      }));

      // return Promise.all(
      //   this._observers.map(observer => observer.observe())
      // )
    }

    /**
     * Disposes the observers
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._observers.forEach(function (observer) {
        return observer.dispose();
      });
    }
  }]);

  return BaseFontLoader;
}();

/* harmony default export */ __webpack_exports__["a"] = (BaseFontLoader);

/***/ }),
/* 204 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__1_0_0_serializer__ = __webpack_require__(200);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var TWICE_PI = Math.PI * 2;

var v101Serializer = function (_PreviousSerializer) {
  _inherits(v101Serializer, _PreviousSerializer);

  function v101Serializer() {
    _classCallCheck(this, v101Serializer);

    return _possibleConstructorReturn(this, (v101Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(v101Serializer)).apply(this, arguments));
  }

  _createClass(v101Serializer, [{
    key: '_serializeTransformOperation',

    /**
     * Serializes the given transform operation
     * @param  {PhotoEditorSDK.Operation.TransformOperation} operation
     * @return {Object}
     * @private
     */
    value: function _serializeTransformOperation(operation) {
      var options = operation.serializeOptions(['start', 'end', 'rotation', 'textureScale'], true);
      options.rotation = (options.rotation + TWICE_PI) % TWICE_PI;
      if (options.textureScale !== 1) {
        options.dimensions = operation.getNewDimensions(operation.getInputDimensions(false));
      }

      delete options.textureScale;
      return {
        type: 'crop',
        options: options
      };
    }
  }]);

  return v101Serializer;
}(__WEBPACK_IMPORTED_MODULE_4__1_0_0_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v101Serializer);


v101Serializer.version = '1.0.1';

/***/ }),
/* 205 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__1_0_0_deserializer__ = __webpack_require__(201);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var v101Deserializer = function (_PreviousDeserializer) {
  _inherits(v101Deserializer, _PreviousDeserializer);

  function v101Deserializer() {
    _classCallCheck(this, v101Deserializer);

    return _possibleConstructorReturn(this, (v101Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v101Deserializer)).apply(this, arguments));
  }

  _createClass(v101Deserializer, [{
    key: '_deserializeOperation',

    /**
     * Deserializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {Promise}
     * @private
     */
    value: function _deserializeOperation(operation) {
      if (operation.type === 'selective-blur') {
        return this._deserializeSelectiveBlurOperation(operation);
      }
      return _get(v101Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v101Deserializer.prototype), '_deserializeOperation', this).call(this, operation);
    }

    /**
     * Deserializes the given crop operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeCropOperation',
    value: function _deserializeCropOperation(operation) {
      // New in 1.0.1: `dimensions` option
      var options = operation.options;
      var rotation = options.rotation;

      var start = __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.start);
      var end = __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.end);
      var dimensions = options.dimensions ? __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.dimensions) : null;

      if (end.x - start.x <= 0 || end.y - start.y <= 0) {
        throw new Error('A crop should not result in negative or zero dimensions - start: ' + start + ' - end: ' + end);
      }

      // Normalize rotation
      if (rotation > Math.PI) {
        rotation -= Math.PI * 2;
      }

      var cropOptions = {
        start: start, end: end
      };

      if (typeof rotation !== 'undefined') cropOptions.rotation = rotation;

      var transformOperation = this._editor.operations.getOrCreate('transform');
      if (!transformOperation) return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();

      this._editor.broadcastTransform(transformOperation, cropOptions);
      transformOperation.set(cropOptions);

      if (dimensions) {
        var size = end.clone().subtract(start);
        var transformDimensions = transformOperation.getInputDimensions(false).multiply(size);
        transformOperation.setTextureScale(dimensions.x / transformDimensions.x);
      }

      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(transformOperation);
    }
  }]);

  return v101Deserializer;
}(__WEBPACK_IMPORTED_MODULE_7__1_0_0_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v101Deserializer);


v101Deserializer.version = '1.0.1';

/***/ }),
/* 206 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__1_0_1_serializer__ = __webpack_require__(204);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__blend_modes__ = __webpack_require__(93);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var v200Serializer = function (_PreviousSerializer) {
  _inherits(v200Serializer, _PreviousSerializer);

  function v200Serializer() {
    _classCallCheck(this, v200Serializer);

    return _possibleConstructorReturn(this, (v200Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer)).apply(this, arguments));
  }

  _createClass(v200Serializer, [{
    key: '_serializeSticker',

    /**
     * Serializes the given sticker
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite} sprite
     * @return {Object}
     * @private
     */
    value: function _serializeSticker(operation, sprite) {
      var inputDimensions = operation.getInputDimensions(false);
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeSticker', this).call(this, operation, sprite);

      // New in 2.0.0: `tintColor`
      if (sprite.getTintMode() !== 'none') {
        response.options.tintColor = sprite.serializeOption('tintColor', true);
      }

      // Dimensions are relative, not absolute anymore
      response.options.dimensions = sprite.getDimensions().clone().divide(inputDimensions.min()).toObject();

      // `name` is now `identifier`
      response.options.identifier = response.options.name;
      delete response.options.name;

      return response;
    }

    /**
     * Serializes the given path
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path} path
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializePath',
    value: function _serializePath(path) {
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializePath', this).call(this, path);

      var brush = path.getBrush();
      if (brush.hasOption('hardness')) {
        response.hardness = brush.getOption('hardness');
      }

      return response;
    }

    /**
     * Serializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operation[]} operations
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeOperation',
    value: function _serializeOperation(operation, operations) {
      if (operation.constructor.identifier === 'frame') {
        this._serializeFrameOperation(operation, operations);
        return null;
      }

      if (operation.constructor.identifier === 'overlay') {
        this._serializeOverlayOperation(operation, operations);
        return null;
      }

      return _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeOperation', this).call(this, operation, operations);
    }

    /**
     * Serializes the frame operation
     * @param {PhotoEditorSDK.Operation.FrameOperation} operation
     * @param {PhotoEditorSDK.Operation[]} operations
     * @private
     */

  }, {
    key: '_serializeFrameOperation',
    value: function _serializeFrameOperation(operation, operations) {
      // Since serialization 2.0.0 stores frames as part of the SpriteOperation, we need
      // to check if a sprite operation is present and extend its `sprites` option
      var spriteOperations = operations.filter(function (o) {
        return o.type === 'sprite';
      });
      var spriteOperation = void 0;
      if (spriteOperations.length) {
        spriteOperation = spriteOperations.pop();
      } else {
        // No sprite operation exists, create a new one
        spriteOperation = {
          type: 'sprite',
          options: {
            sprites: []
          }
        };
        operations.push(spriteOperation);
      }

      spriteOperation.options.sprites.push({
        type: 'frame',
        options: this._getFrameOptions(operation)
      });
    }

    /**
     * Serializes the overlay operation
     * @param {PhotoEditorSDK.Operation.OverlayOperation} operation
     * @param {PhotoEditorSDK.Operation[]} operations
     * @private
     */

  }, {
    key: '_serializeOverlayOperation',
    value: function _serializeOverlayOperation(operation, operations) {
      if (!operation.getIdentifier()) return;

      // Since serialization 2.0.0 stores overlays as part of the SpriteOperation, we need
      // to check if a sprite operation is present and extend its `sprites` option
      var spriteOperations = operations.filter(function (o) {
        return o.type === 'sprite';
      });
      var spriteOperation = void 0;
      if (spriteOperations.length) {
        spriteOperation = spriteOperations.pop();
      } else {
        // No sprite operation exists, create a new one
        spriteOperation = {
          type: 'sprite',
          options: {
            sprites: []
          }
        };
        operations.push(spriteOperation);
      }

      spriteOperation.options.sprites.push({
        type: 'overlay',
        options: {
          identifier: operation.getIdentifier(),
          intensity: operation.getAlpha(),
          blendMode: __WEBPACK_IMPORTED_MODULE_6__blend_modes__["a" /* default */][operation.getBlendMode()]
        }
      });
    }

    /**
     * Returns the options object for the given FrameOperation
     * @param  {PhotoEditorSDK.Operations.FrameOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_getFrameOptions',
    value: function _getFrameOptions(operation) {
      return {
        identifier: operation.getFrame().identifier
      };
    }
  }, {
    key: '_serializeOrientationOperation',
    value: function _serializeOrientationOperation(operation) {
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeOrientationOperation', this).call(this, operation);

      // For some unknown reason, we start this "first rotate, then flip" thing with 2.0.0
      if (response.options.rotation === 90 || response.options.rotation === 270) {
        response.options.flipHorizontally = !response.options.flipHorizontally;
        response.options.flipVertically = !response.options.flipVertically;
      }

      return response;
    }

    /**
     * Serializes the given transform operation
     * @param  {PhotoEditorSDK.Operation.TransformOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeTransformOperation',
    value: function _serializeTransformOperation(operation) {
      var operations = this._editor.operations;

      // Version 2.0 and up has different operation order: First transform, then orientation.

      if (operations.exists('orientation')) {
        // Updating the original operation will mess up the editor state
        operation = operation.clone();

        // Undo orientation that has been applied to the transforms
        var orientationOperation = operations.get('orientation');
        operation.rotate(-orientationOperation.getRotation());
        if (orientationOperation.getFlipVertically()) {
          operation.flip('vertical');
          operation.setRotation(operation.getRotation() * -1);
        }
        if (orientationOperation.getFlipHorizontally()) {
          operation.flip('horizontal');
          operation.setRotation(operation.getRotation() * -1);
        }
      }

      // Version 2.0 and up: Crop operation is now called transform operation
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeTransformOperation', this).call(this, operation);

      response.type = 'transform';
      return response;
    }

    /**
     * Serializes the given text sprite
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.TextSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeText',
    value: function _serializeText(operation, sprite) {
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeText', this).call(this, operation, sprite);

      var inputDimensions = operation.getInputDimensions(false);
      response.options.fontIdentifier = sprite.getFontIdentifier();

      // For whatever reason, max width is relative to shortest side, while font size isn't
      response.options.maxWidth = response.options.maxWidth * inputDimensions.x / inputDimensions.min();
      delete response.options.fontFamily;

      return response;
    }

    /**
     * Serializes the given filter operation
     * @param  {PhotoEditorSDK.Operations.FilterOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeFilterOperation',
    value: function _serializeFilterOperation(operation) {
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeFilterOperation', this).call(this, operation);
      if (!response) return null;

      response.options.identifier = response.options.name;
      delete response.options.name;

      return response;
    }

    /**
     * Serializes the given radial focus operation
     * @param  {PhotoEditorSDK.Operations.RadialFocusOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeRadialFocusOperation',
    value: function _serializeRadialFocusOperation(operation) {
      var response = _get(v200Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v200Serializer.prototype), '_serializeRadialFocusOperation', this).call(this, operation);

      var focusOptions = response.options.options;
      focusOptions.start = focusOptions.position;
      delete focusOptions.position;
      focusOptions.end = {
        x: focusOptions.start.x + focusOptions.radius,
        y: focusOptions.start.y
      };
      delete focusOptions.radius;

      return response;
    }
  }]);

  return v200Serializer;
}(__WEBPACK_IMPORTED_MODULE_5__1_0_1_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v200Serializer);


v200Serializer.version = '2.0.0';

/***/ }),
/* 207 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__1_0_1_deserializer__ = __webpack_require__(205);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_shared_managers_frame_manager__ = __webpack_require__(499);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_shared_managers_overlay_manager__ = __webpack_require__(500);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_shared_managers_sticker_manager__ = __webpack_require__(134);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_lib_frame__ = __webpack_require__(501);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_lib_font_loader__ = __webpack_require__(135);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_shared_loaders_image_loader__ = __webpack_require__(72);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__blend_modes__ = __webpack_require__(93);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */












var blendModeByName = __WEBPACK_IMPORTED_MODULE_6_globals__["k" /* SDKUtils */].flipObject(__WEBPACK_IMPORTED_MODULE_14__blend_modes__["a" /* default */]);

var v200Deserializer = function (_PreviousDeserializer) {
  _inherits(v200Deserializer, _PreviousDeserializer);

  function v200Deserializer() {
    var _ref;

    _classCallCheck(this, v200Deserializer);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = v200Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer)).call.apply(_ref, [this].concat(args)));

    _this._frameManager = new __WEBPACK_IMPORTED_MODULE_8_shared_managers_frame_manager__["a" /* default */](_this._ui, _this._getOptions('frame'));

    var overlayOptions = _this._getOptions('overlay');
    if (overlayOptions) {
      _this._overlayManager = new __WEBPACK_IMPORTED_MODULE_9_shared_managers_overlay_manager__["a" /* default */](_this._ui, overlayOptions);
    }
    return _this;
  }

  /**
   * Deserializes the given sprite
   * @param  {PhotoEditorSDK.Operations.SpriteOperation} spriteOperation
   * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprite} sprite
   * @return {Promise}
   * @private
   */


  _createClass(v200Deserializer, [{
    key: '_deserializeSprite',
    value: function _deserializeSprite(spriteOperation, sprite) {
      if (sprite.type === 'frame') {
        return this._deserializeFrame(spriteOperation, sprite);
      }
      if (sprite.type === 'overlay') {
        return this._deserializeOverlay(spriteOperation, sprite);
      }
      return _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_deserializeSprite', this).call(this, spriteOperation, sprite);
    }

    /**
     * Deserializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeOperation',
    value: function _deserializeOperation(operation) {
      if (operation.type === 'transform') {
        return this._deserializeTransformOperation(operation);
      }
      return _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_deserializeOperation', this).call(this, operation);
    }
  }, {
    key: '_deserializeOrientationOperation',
    value: function _deserializeOrientationOperation(operationData) {
      // Only the HTML SDK was writing out inverted flipHorizontally
      // and flipVertically values starting with 2.0.0 up to 3.4.0
      // If we can determine that the serialization platform definitely wasn't
      // HTML5, we should not invert those values when reading them back in.
      // https://github.com/imgly/pesdk-html5/pull/309
      if (this._data.meta && this._data.meta.platform !== 'html5') {
        return _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_deserializeOrientationOperation', this).call(this, operationData);
      }

      var _operationData$option = operationData.options,
          rotation = _operationData$option.rotation,
          flipHorizontally = _operationData$option.flipHorizontally,
          flipVertically = _operationData$option.flipVertically;

      // The old implementation wasn't respecting the cross-platform convention
      // of first rotate then flip. This has been fixed now which means that
      // there are four combinations of legacy serializations that require an extra
      // inversion when deserializing

      var shouldFlip = rotation === 90 && !flipHorizontally && !flipVertically;
      shouldFlip |= rotation === 90 && flipHorizontally && flipVertically;
      shouldFlip |= rotation === 270 && !flipHorizontally && !flipVertically;
      shouldFlip |= rotation === 270 && flipHorizontally && flipVertically;

      if (shouldFlip) {
        operationData.options.flipHorizontally = !operationData.options.flipHorizontally;
        operationData.options.flipVertically = !operationData.options.flipVertically;
      }

      return _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_deserializeOrientationOperation', this).call(this, operationData);
    }

    /**
     * Deserializes the given transform operation
     * @param  {Object} operationData
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeTransformOperation',
    value: function _deserializeTransformOperation(operationData) {
      var _this2 = this;

      // Version 2.0 and up: Crop operation is now called transform operation
      return _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_deserializeCropOperation', this).call(this, operationData).then(function (operation) {
        if (!operation) return;

        var orientationData = __WEBPACK_IMPORTED_MODULE_6_globals__["k" /* SDKUtils */].Array.find(_this2._data.operations, function (op) {
          return op.type === 'orientation';
        });
        if (orientationData) {
          var options = orientationData.options;
          var rotation = options.rotation,
              flipHorizontally = options.flipHorizontally,
              flipVertically = options.flipVertically;


          if (rotation === 90 || rotation === 270) {
            if (!flipHorizontally && flipVertically || flipHorizontally && !flipVertically) {
              flipHorizontally = !flipHorizontally;
              flipVertically = !flipVertically;
            }
          }

          operation.rotate(options.rotation);
          if (flipHorizontally) {
            operation.flip('horizontal');
            operation.setRotation(operation.getRotation() * -1);
          }
          if (flipVertically) {
            operation.flip('vertical');
            operation.setRotation(operation.getRotation() * -1);
          }
        }

        return operation;
      });
    }

    /**
     * Deserializes the given frame sprite
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} spriteOperation
     * @param  {Object} frame
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFrame',
    value: function _deserializeFrame(spriteOperation, frame) {
      var _this3 = this;

      var identifier = frame.options.identifier;


      var frameData = this._frameManager.getFrameByIdentifier(identifier);
      if (!frameData) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Deserializer', 'Unknown frame `' + identifier + '`. Skipping frame.');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }
      var frameInstance = new __WEBPACK_IMPORTED_MODULE_11_lib_frame__["a" /* default */](this._ui, frameData);
      return frameInstance.load().then(function () {
        _this3._editor.operations.getOrCreate('frame', {
          frame: frameInstance.getFrame()
        });
      });
    }

    /**
     * Deserializes the given overlay sprite
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} spriteOperation
     * @param  {Object} overlay
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeOverlay',
    value: function _deserializeOverlay(spriteOperation, overlay) {
      var _this4 = this;

      var _overlay$options = overlay.options,
          blendMode = _overlay$options.blendMode,
          intensity = _overlay$options.intensity,
          identifier = _overlay$options.identifier;


      var overlayData = this._overlayManager.getOverlayByIdentifier(identifier);
      if (!overlayData) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Deserializer', 'Unknown overlay `' + identifier + '`. Skipping overlay.');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }

      var overlayPath = this._editor.getUI().getAssetPath(overlayData.image);
      return __WEBPACK_IMPORTED_MODULE_13_shared_loaders_image_loader__["a" /* default */].load(overlayPath).then(function (image) {
        _this4._editor.operations.getOrCreate('overlay', {
          alpha: intensity,
          identifier: identifier,
          blendMode: parseInt(blendModeByName[blendMode || overlayData.blendMode], 10),
          image: image
        });
      });
    }

    /**
     * Creates a brush face with the given options
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Path} path
     * @return {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Brush}
     */

  }, {
    key: '_createBrushForPath',
    value: function _createBrushForPath(path) {
      var brush = _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_createBrushForPath', this).call(this, path);
      if (typeof path.hardness !== 'undefined' && brush.hasOption('hardness')) {
        brush.setHardness(path.hardness);
      }
      return brush;
    }

    /**
     * Deserializes the given sticker for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} sprite
     * @return {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite}
     * @private
     */

  }, {
    key: '_deserializeSticker',
    value: function _deserializeSticker(operation, sprite) {
      var _this5 = this;

      var SpriteOperation = __WEBPACK_IMPORTED_MODULE_6_globals__["j" /* SDK */].Operations.SpriteOperation;
      var options = sprite.options;

      var sticker = this._stickerManager.getStickerByIdentifier(options.identifier);
      var url = __WEBPACK_IMPORTED_MODULE_10_shared_managers_sticker_manager__["a" /* default */].getURLForSticker(sticker, 'base');
      if (!sticker) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Deserializer', 'Unknown sticker `' + options.identifier + '`. Skipping sprite.');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }
      var inputDimensions = operation.getInputDimensions(false);
      return new __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var image = new window.Image();
        image.addEventListener('load', function () {
          var adjustments = SpriteOperation.StickerSprite.prototype.availableOptions.adjustments.structure;
          var rotation = options.rotation,
              flipHorizontally = options.flipHorizontally,
              flipVertically = options.flipVertically;

          var stickerOptions = {
            identifier: options.identifier,
            image: image,
            position: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.position),
            dimensions: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.dimensions).multiply(inputDimensions.min()),
            rotation: rotation,
            flipHorizontally: flipHorizontally,
            flipVertically: flipVertically,
            adjustments: {}
          };

          if (typeof options.adjustments !== 'undefined') {
            ['brightness', 'contrast', 'saturation'].forEach(function (option) {
              if (typeof options.adjustments[option] !== 'undefined') {
                stickerOptions.adjustments[option] = options.adjustments[option] + adjustments[option].default;
              }
            });
          }

          if (typeof options.tintColor !== 'undefined' && typeof sticker.tintMode !== 'undefined') {
            stickerOptions.tintColor = __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(options.tintColor);
            stickerOptions.tintMode = sticker.tintMode;
          }
          resolve(operation.createSticker(stickerOptions));
        });
        image.crossOrigin = _this5._editor.getCrossOrigin();
        image.src = _this5._editor.getUI().getAssetPath(url);
      });
    }

    /**
     * Deserializes the given filter operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFilterOperation',
    value: function _deserializeFilterOperation(operation) {
      var _this6 = this;

      var options = operation.options;


      if (!this._filterManager.getFilterByIdentifier(options.identifier)) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Deserializer', 'Unknown filter `' + options.identifier + '`');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }

      return this._filterManager.instantiateFilterWithIdentifier(options.identifier).then(function (filter) {
        var filterOperation = _this6._editor.operations.getOrCreate('filter');
        if (!filterOperation) return;
        filterOperation.set({
          identifier: options.identifier,
          filter: filter,
          intensity: options.intensity
        });
        return filterOperation;
      });
    }

    /**
     * Deserializes the given focus operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFocusOperation',
    value: function _deserializeFocusOperation(operation) {
      var _operation$options = operation.options,
          options = _operation$options.options,
          type = _operation$options.type;

      if (type !== 'radial') return _get(v200Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v200Deserializer.prototype), '_deserializeFocusOperation', this).call(this, operation);

      var image = this._editor.getImage();
      var imageAspect = image.width / image.height;
      var start = options.start,
          end = options.end,
          gradientRadius = options.gradientRadius,
          blurRadius = options.blurRadius;

      var radius = __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(end).subtract(__WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(start)).multiply(imageAspect, 1).len();
      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('radial-focus', {
        position: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(start),
        radius: radius,
        gradientRadius: gradientRadius,
        blurRadius: blurRadius
      }));
    }

    /**
     * Deserializes the given text for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} text
     * @return {PhotoEditorSDK.Operations.SpriteOperation.TextSprite}
     * @private
     */

  }, {
    key: '_deserializeText',
    value: function _deserializeText(operation, text) {
      var options = text.options;
      var fontSize = options.fontSize,
          lineHeight = options.lineHeight,
          fontIdentifier = options.fontIdentifier,
          alignment = options.alignment,
          rotation = options.rotation,
          maxWidth = options.maxWidth,
          color = options.color,
          backgroundColor = options.backgroundColor;


      var fontLoader = new __WEBPACK_IMPORTED_MODULE_12_lib_font_loader__["a" /* default */](this._ui);
      var variation = this._fontManager.getVariationByIdentifier(fontIdentifier);
      if (!variation) {
        variation = this._fontManager.getDefaultFont();
      } else {
        fontLoader.setFonts([variation.getFont()]);
      }
      return fontLoader.load().then(function () {
        var inputDimensions = operation.getInputDimensions(false);

        // For whatever reason, max width is relative to shortest side, while font size isn't
        var fixedMaxWidth = maxWidth * inputDimensions.min() / inputDimensions.x;
        var sprite = operation.createText({
          fontSize: fontSize,
          lineHeight: lineHeight,
          fontFamily: variation.getFontFamily(),
          fontWeight: variation.getFontWeight(),
          fontIdentifier: variation.getIdentifier(),
          alignment: alignment,
          rotation: rotation,
          maxWidth: fixedMaxWidth,
          text: options.text,
          color: __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(color),
          backgroundColor: __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */].fromArray(backgroundColor),
          position: __WEBPACK_IMPORTED_MODULE_6_globals__["n" /* Vector2 */].fromObject(options.position)
        });
        sprite._edited = true;
        return sprite;
      });
    }
  }]);

  return v200Deserializer;
}(__WEBPACK_IMPORTED_MODULE_7__1_0_1_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v200Deserializer);


v200Deserializer.version = '2.0.0';

/***/ }),
/* 208 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__2_0_0_serializer__ = __webpack_require__(206);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__assets_transform_ratio__ = __webpack_require__(503);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var v300Serializer = function (_PreviousSerializer) {
  _inherits(v300Serializer, _PreviousSerializer);

  function v300Serializer() {
    _classCallCheck(this, v300Serializer);

    return _possibleConstructorReturn(this, (v300Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer)).apply(this, arguments));
  }

  _createClass(v300Serializer, [{
    key: 'serialize',

    /**
     * Serializes the editor state
     * @param {Object} options = {}
     * @return {Promise}
     */
    value: function serialize() {
      var _this2 = this;

      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      return _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), 'serialize', this).call(this, options).then(function (data) {
        data.meta = {
          platform: 'html5',
          version: _this2._editor.getSDK().version,
          createdAt: __WEBPACK_IMPORTED_MODULE_6_globals__["k" /* SDKUtils */].ISODateString(new Date())
        };
        data.image = data.inputImage;
        delete data.inputImage;
        return data;
      });
    }

    /**
     * Serializes the given sticker
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeSticker',
    value: function _serializeSticker(operation, sprite) {
      var response = _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeSticker', this).call(this, operation, sprite);
      response.options.alpha = sprite.getAlpha();

      if (response.options.tintColor) {
        response.options.tintColor = {
          rgba: response.options.tintColor
        };
      }

      return response;
    }

    /**
     * Serializes the given text sprite
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.TextSprite} sprite
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeText',
    value: function _serializeText(operation, sprite) {
      var response = _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeText', this).call(this, operation, sprite);
      response.options.color = {
        rgba: response.options.color
      };
      response.options.backgroundColor = {
        rgba: response.options.backgroundColor
      };
      response.options.flipHorizontally = false;
      response.options.flipVertically = false;
      delete response.options.fontWeight;
      return response;
    }

    /**
     * Serializes the given path
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path} path
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializePath',
    value: function _serializePath(path) {
      var response = _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializePath', this).call(this, path);

      delete response.hardness;
      delete response.size;
      delete response.color;

      var brush = path.getBrush();
      response.brush = brush.serializeOptions(['identifier', 'size', 'color'], true);
      if (typeof response.brush.identifier === 'undefined') {
        delete response.brush.identifier;
      }
      response.brush.color = {
        rgba: response.brush.color
      };

      var hardness = brush.getOption('hardness');
      if (hardness !== 'undefined') {
        response.brush.hardness = hardness;
      }
      return response;
    }

    /**
     * Serializes the frame operation
     * @param {PhotoEditorSDK.Operation.FrameOperation} operation
     * @param {PhotoEditorSDK.Operation[]} operations
     * @private
     */

  }, {
    key: '_serializeFrameOperation',
    value: function _serializeFrameOperation(operation, operations) {
      _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeFrameOperation', this).call(this, operation, operations);

      // Find sprite operation and frame sprite from serialized data
      var spriteOperations = operations.filter(function (o) {
        return o.type === 'sprite';
      });
      var spriteOperation = void 0;
      if (spriteOperations.length) {
        spriteOperation = spriteOperations.pop();
        var frame = spriteOperation.options.sprites.filter(function (s) {
          return s.type === 'frame';
        })[0];

        var tintColor = operation.getTintColor();
        if (!tintColor.equals(new __WEBPACK_IMPORTED_MODULE_6_globals__["b" /* Color */](1, 1, 1, 0))) {
          frame.options.tintColor = {
            rgba: operation.serializeOption('tintColor', true)
          };
        }

        var options = operation.serializeOptions(['scale', 'alpha'], true);
        frame.options = __WEBPACK_IMPORTED_MODULE_6_globals__["k" /* SDKUtils */].extend(frame.options, options);
        frame.options.size = frame.options.scale;
        delete frame.options.scale;
      }
    }

    /**
     * Serializes the given transform operation
     * @param  {PhotoEditorSDK.Operation.TransformOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeTransformOperation',
    value: function _serializeTransformOperation(operation) {
      var response = _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeTransformOperation', this).call(this, operation);

      if (operation._ratio) {
        var identifier = void 0;
        if (operation._ratio instanceof __WEBPACK_IMPORTED_MODULE_8__assets_transform_ratio__["a" /* default */]) {
          identifier = operation._ratio.getIdentifier();
        } else {
          identifier = operation._ratio.identifier;
        }

        response.options.meta = {
          identifier: identifier
        };
      }
      delete response.options.scale;

      return response;
    }

    /**
     * Serializes the given adjustments operation
     * @param  {PhotoEditorSDK.Operations.AdjustmentsOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeAdjustmentsOperation',
    value: function _serializeAdjustmentsOperation(operation) {
      var response = _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeAdjustmentsOperation', this).call(this, operation);

      var optionNames = ['gamma', 'whites', 'blacks', 'temperature'];

      var availableOptions = operation.availableOptions;

      var options = {};
      optionNames.forEach(function (optionName) {
        var option = availableOptions[optionName];
        var value = operation.getOption(optionName);
        var minValue = option.minValue,
            midValue = option.midValue,
            maxValue = option.maxValue;

        options[optionName] = value <= midValue ? (value - minValue) / (midValue - minValue) - 1 : (value - midValue) / (maxValue - midValue);
      });

      response.options = _extends({}, response.options, options);

      return response;
    }

    /**
     * Serializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operation[]} operations
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeOperation',
    value: function _serializeOperation(operation, operations) {
      switch (operation.constructor.identifier) {
        case 'mirrored-focus':
          return this._serializeMirroredFocusOperation(operation);
        case 'linear-focus':
          return this._serializeLinearFocusOperation(operation);
        case 'blur':
          return this._serializeBlurOperation(operation);
        default:
          return _get(v300Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v300Serializer.prototype), '_serializeOperation', this).call(this, operation, operations);
      }
    }

    /**
     * Serializes the given mirrored focus operation
     * @param  {PhotoEditorSDK.Operations.MirroredFocusOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeMirroredFocusOperation',
    value: function _serializeMirroredFocusOperation(operation) {
      return {
        type: 'focus',
        options: {
          type: 'mirrored',
          options: operation.serializeOptions(['start', 'end', 'blurRadius', 'size', 'gradientSize'], true)
        }
      };
    }

    /**
     * Serializes the given linear focus operation
     * @param  {PhotoEditorSDK.Operations.LinearFocusOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeLinearFocusOperation',
    value: function _serializeLinearFocusOperation(operation) {
      var options = operation.serializeOptions(['controlPoint1', 'controlPoint2', 'blurRadius'], true);
      options.start = options.controlPoint1;
      delete options.controlPoint1;
      options.end = options.controlPoint2;
      delete options.controlPoint2;

      return {
        type: 'focus',
        options: {
          type: 'linear',
          options: options
        }
      };
    }

    /**
     * Serializes the given blur operation
     * @param  {PhotoEditorSDK.Operations.BlurOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeBlurOperation',
    value: function _serializeBlurOperation(operation) {
      return {
        type: 'focus',
        options: {
          type: 'gaussian',
          options: operation.serializeOptions(['blurRadius'], true)
        }
      };
    }
  }]);

  return v300Serializer;
}(__WEBPACK_IMPORTED_MODULE_7__2_0_0_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v300Serializer);


v300Serializer.version = '3.0.0';

/***/ }),
/* 209 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__2_0_0_deserializer__ = __webpack_require__(207);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_shared_managers_sticker_manager__ = __webpack_require__(134);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_shared_managers_text_design_manager__ = __webpack_require__(55);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_shared_loaders_image_loader__ = __webpack_require__(72);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_shared_managers_font_manager__ = __webpack_require__(41);








var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








var Brush = void 0;
if (typeof __WEBPACK_IMPORTED_MODULE_7_globals__["j" /* SDK */].Operations.SpriteOperation !== 'undefined') {
  Brush = __WEBPACK_IMPORTED_MODULE_7_globals__["j" /* SDK */].Operations.SpriteOperation.BrushSprite.Brush;
}

var v300Deserializer = function (_PreviousDeserializer) {
  _inherits(v300Deserializer, _PreviousDeserializer);

  function v300Deserializer() {
    _classCallCheck(this, v300Deserializer);

    return _possibleConstructorReturn(this, (v300Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(v300Deserializer)).apply(this, arguments));
  }

  _createClass(v300Deserializer, [{
    key: '_deserializeSticker',

    /**
     * Deserializes the given sticker for the given operation
     * @param  {Object} operation
     * @param  {Object} sprite
     * @return {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite}
     * @private
     */
    value: function _deserializeSticker(operation, sprite) {
      var SpriteOperation = __WEBPACK_IMPORTED_MODULE_7_globals__["j" /* SDK */].Operations.SpriteOperation;
      var options = sprite.options;

      var sticker = this._stickerManager.getStickerByIdentifier(options.identifier);
      if (!sticker) {
        __WEBPACK_IMPORTED_MODULE_7_globals__["g" /* Log */].warn('Deserializer', 'Unknown sticker `' + options.identifier + '`. Skipping sprite.');
        return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve();
      }

      var mediaBase = sticker.images.mediaBase;

      var url = __WEBPACK_IMPORTED_MODULE_9_shared_managers_sticker_manager__["a" /* default */].getURLForSticker(sticker, 'base');
      var resolvedUrl = mediaBase.rawData ? mediaBase.uris[0] : this._editor.getUI().getAssetPath(url);
      var inputDimensions = operation.getInputDimensions(false);
      return __WEBPACK_IMPORTED_MODULE_11_shared_loaders_image_loader__["a" /* default */].load(resolvedUrl).then(function (image) {
        var adjustments = SpriteOperation.StickerSprite.prototype.availableOptions.adjustments.structure;
        var rotation = options.rotation,
            flipHorizontally = options.flipHorizontally,
            flipVertically = options.flipVertically;

        var stickerOptions = {
          identifier: options.identifier,
          image: image,
          position: __WEBPACK_IMPORTED_MODULE_7_globals__["n" /* Vector2 */].fromObject(options.position),
          dimensions: __WEBPACK_IMPORTED_MODULE_7_globals__["n" /* Vector2 */].fromObject(options.dimensions).multiply(inputDimensions.min()),
          rotation: rotation || 0,
          flipHorizontally: flipHorizontally,
          flipVertically: flipVertically,
          resizeMode: sticker.resizeMode || 'keepAspect',
          adjustments: {}
        };

        if (typeof options.adjustments !== 'undefined') {
          ['brightness', 'contrast', 'saturation'].forEach(function (option) {
            if (typeof options.adjustments[option] !== 'undefined') {
              stickerOptions.adjustments[option] = options.adjustments[option] + adjustments[option].default;
            }
          });
        }

        // Use the serialized tint mode and color value if there is one, otherwise
        // look for the default value of the corresponding asset
        if (typeof options.tintMode !== 'undefined' && typeof options.tintColor !== 'undefined') {
          stickerOptions.tintColor = __WEBPACK_IMPORTED_MODULE_7_globals__["b" /* Color */].fromArray(options.tintColor.rgba);
          stickerOptions.tintMode = options.tintMode;
        } else if (typeof options.tintColor !== 'undefined' && typeof sticker.tintMode !== 'undefined') {
          stickerOptions.tintColor = __WEBPACK_IMPORTED_MODULE_7_globals__["b" /* Color */].fromArray(options.tintColor.rgba);
          stickerOptions.tintMode = sticker.tintMode;
        }

        if (typeof options.alpha !== 'undefined') {
          stickerOptions.alpha = options.alpha;
        }

        return operation.createSticker(stickerOptions);
      });
    }

    /**
     * Deserializes the given transform operation
     * @param  {Object} operationData
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeTransformOperation',
    value: function _deserializeTransformOperation(operationData) {
      return _get(v300Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(v300Deserializer.prototype), '_deserializeTransformOperation', this).call(this, operationData).then(function (operation) {
        if (!operation) return;

        // TODO: Get correct ratio
        operation._ratio = null;
        return operation;
      });
    }

    /**
     * Deserializes the input image (if present)
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeInputImage',
    value: function _deserializeInputImage() {
      var _this2 = this;

      var _data$image = this._data.image,
          data = _data$image.data,
          type = _data$image.type,
          uri = _data$image.uri;


      if (data && type) {
        uri = 'data:' + type + ';base64,' + data;
      }

      if (uri) {
        return __WEBPACK_IMPORTED_MODULE_11_shared_loaders_image_loader__["a" /* default */].load(uri).then(function (image) {
          _this2._editor.setImage(image);
        });
      } else {
        return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve();
      }
    }

    /**
     * Deserializes the given adjustments operation
     * @param  {Object} operationData
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeAdjustmentsOperation',
    value: function _deserializeAdjustmentsOperation(operationData) {
      var AdjustmentsOperation = __WEBPACK_IMPORTED_MODULE_7_globals__["j" /* SDK */].Operations.AdjustmentsOperation;

      return _get(v300Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(v300Deserializer.prototype), '_deserializeAdjustmentsOperation', this).call(this, operationData).then(function (operation) {
        if (!operation) return null;

        var options = operationData.options;

        var knownOptions = ['gamma', 'whites', 'blacks', 'temperature'];
        var operationOptions = {};

        knownOptions.forEach(function (optionName) {
          if (typeof options[optionName] === 'undefined') return;

          var _AdjustmentsOperation = AdjustmentsOperation.prototype.availableOptions[optionName],
              minValue = _AdjustmentsOperation.minValue,
              midValue = _AdjustmentsOperation.midValue,
              maxValue = _AdjustmentsOperation.maxValue;

          var value = options[optionName];

          value = value < 0 ? midValue + (midValue - minValue) * value : midValue + (maxValue - midValue) * value;
          operationOptions[optionName] = value;
        });

        operation.set(operationOptions);

        return operation;
      });
    }

    /**
     * Deserializes the given focus operation
     * @param  {Object} operationData
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFocusOperation',
    value: function _deserializeFocusOperation(operationData) {
      var options = operationData.options.options;

      switch (operationData.options.type) {
        case 'radial':
          return _get(v300Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(v300Deserializer.prototype), '_deserializeFocusOperation', this).call(this, operationData);
        case 'linear':
          {
            var start = options.start,
                end = options.end,
                blurRadius = options.blurRadius;

            return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('linear-focus', {
              controlPoint1: __WEBPACK_IMPORTED_MODULE_7_globals__["n" /* Vector2 */].fromObject(start),
              controlPoint2: __WEBPACK_IMPORTED_MODULE_7_globals__["n" /* Vector2 */].fromObject(end),
              blurRadius: blurRadius
            }));
          }
        case 'mirrored':
          {
            var _start = options.start,
                _end = options.end,
                size = options.size,
                gradientSize = options.gradientSize,
                _blurRadius = options.blurRadius;

            return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('mirrored-focus', {
              start: __WEBPACK_IMPORTED_MODULE_7_globals__["n" /* Vector2 */].fromObject(_start),
              end: __WEBPACK_IMPORTED_MODULE_7_globals__["n" /* Vector2 */].fromObject(_end),
              size: size,
              gradientSize: gradientSize,
              blurRadius: _blurRadius
            }));
          }
        case 'gaussian':
          {
            var _blurRadius2 = options.blurRadius;

            return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_promise___default.a.resolve(this._editor.operations.getOrCreate('blur', {
              blurRadius: _blurRadius2
            }));
          }
      }
    }

    /**
     * Deserializes the given text for the given operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
     * @param  {Object} text
     * @return {PhotoEditorSDK.Operations.SpriteOperation.TextSprite}
     * @private
     */

  }, {
    key: '_deserializeText',
    value: function _deserializeText(operation, text) {
      var options = text.options;
      var fontSize = options.fontSize,
          lineHeight = options.lineHeight,
          fontIdentifier = options.fontIdentifier,
          alignment = options.alignment,
          rotation = options.rotation,
          maxWidth = options.maxWidth,
          color = options.color,
          backgroundColor = options.backgroundColor;


      var fontLoader = this._ui.getFontLoader();
      var variation = this._fontManager.getVariationByIdentifier(fontIdentifier);
      if (!variation) {
        variation = this._fontManager.getDefaultVariation();
      } else {
        fontLoader.setFonts([variation.getFont()]);
      }
      return fontLoader.load().then(function () {
        var inputDimensions = operation.getInputDimensions(false);

        // For whatever reason, max width is relative to shortest side, while font size isn't
        var fixedMaxWidth = maxWidth * inputDimensions.min() / inputDimensions.x;
        var sprite = operation.createText({
          fontSize: fontSize,
          lineHeight: lineHeight,
          fontFamily: variation.getFontFamily(),
          fontWeight: variation.getFontWeight(),
          fontIdentifier: variation.getIdentifier(),
          textMetrics: variation.getTextMetrics(),
          alignment: alignment,
          rotation: rotation,
          maxWidth: fixedMaxWidth,
          text: options.text,
          color: __WEBPACK_IMPORTED_MODULE_7_globals__["b" /* Color */].fromArray(color.rgba),
          backgroundColor: __WEBPACK_IMPORTED_MODULE_7_globals__["b" /* Color */].fromArray(backgroundColor.rgba),
          position: __WEBPACK_IMPORTED_MODULE_7_globals__["n" /* Vector2 */].fromObject(options.position)
        });
        sprite._edited = true;
        return sprite;
      });
    }

    /**
     * Creates a brush face with the given options
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Path} path
     * @return {PhotoEditorSDK.Operations.SpriteOperation.Sprites.BrushSprite.Brush}
     */

  }, {
    key: '_createBrushForPath',
    value: function _createBrushForPath(path) {
      var _path$brush = path.brush,
          identifier = _path$brush.identifier,
          color = _path$brush.color,
          size = _path$brush.size,
          hardness = _path$brush.hardness;

      var colorObject = __WEBPACK_IMPORTED_MODULE_7_globals__["b" /* Color */].fromArray(color.rgba);

      var brushOptions = {
        color: colorObject,
        size: size
      };

      if (typeof hardness !== 'undefined') {
        brushOptions.hardness = hardness;
      }

      var rawBrush = this._brushManager.getBrushByIdentifier(identifier);
      if (!rawBrush) {
        rawBrush = this._brushManager.getFirstBrush();
      }

      if (rawBrush.prototype && rawBrush.prototype instanceof Brush) {
        // Custom Brush instance, used for special brushes such as radial brush, which has
        // an additional hardness option
        var BrushClass = rawBrush;
        return new BrushClass(brushOptions);
      } else {
        var _brush = __WEBPACK_IMPORTED_MODULE_7_globals__["k" /* SDKUtils */].extend({}, rawBrush);
        delete _brush.image;

        var _BrushClass = function (_Brush) {
          _inherits(_BrushClass, _Brush);

          function _BrushClass() {
            _classCallCheck(this, _BrushClass);

            return _possibleConstructorReturn(this, (_BrushClass.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(_BrushClass)).apply(this, arguments));
          }

          return _BrushClass;
        }(Brush);

        _BrushClass.identifier = rawBrush.identifier;

        // Plain JS object, used for simple image brushes
        return new _BrushClass(__WEBPACK_IMPORTED_MODULE_7_globals__["k" /* SDKUtils */].extend({}, _brush, brushOptions));
      }
    }

    /**
     * Deserializes the given frame sprite
     * @param  {PhotoEditorSDK.Operations.SpriteOperation}
     * @param  {Object} framespriteOperation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeFrame',
    value: function _deserializeFrame(spriteOperation, frame) {
      var _this4 = this;

      return _get(v300Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(v300Deserializer.prototype), '_deserializeFrame', this).call(this, spriteOperation, frame).then(function () {
        var frameOperation = _this4._editor.operations.get('frame');

        var _frame$options = frame.options,
            size = _frame$options.size,
            alpha = _frame$options.alpha,
            tintColor = _frame$options.tintColor;

        var options = {};
        if (typeof size !== 'undefined') {
          options.scale = size;
        }
        if (typeof alpha !== 'undefined') {
          options.alpha = alpha;
        }
        if (typeof tintColor !== 'undefined') {
          options.tintColor = __WEBPACK_IMPORTED_MODULE_7_globals__["b" /* Color */].fromArray(tintColor.rgba);
        }
        frameOperation.set(options);
      });
    }
  }, {
    key: '_deserializeTextDesign',
    value: function _deserializeTextDesign(operation, sprite) {
      var _this5 = this;

      var options = sprite.options;
      var position = options.position,
          rotation = options.rotation,
          flipHorizontally = options.flipHorizontally,
          flipVertically = options.flipVertically,
          text = options.text,
          color = options.color,
          width = options.width,
          seed = options.seed,
          inverted = options.inverted;
      var identifier = options.identifier;


      if (identifier === __WEBPACK_IMPORTED_MODULE_7_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier) {
        identifier = __WEBPACK_IMPORTED_MODULE_7_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier;
      } else if (identifier === __WEBPACK_IMPORTED_MODULE_7_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier) {
        identifier = __WEBPACK_IMPORTED_MODULE_7_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier;
      }

      var textDesignManager = new __WEBPACK_IMPORTED_MODULE_10_shared_managers_text_design_manager__["a" /* default */](this._ui, this._getOptions('textdesign'));
      var fontManager = new __WEBPACK_IMPORTED_MODULE_12_shared_managers_font_manager__["a" /* default */](this._ui, { fonts: __WEBPACK_IMPORTED_MODULE_7_globals__["c" /* Constants */].DEFAULTS.TEXT_DESIGN_FONTS, replaceFonts: true });
      var AssetManager = operation.constructor.TextDesignSprite.AssetManager;
      var fontLoader = this._ui.getFontLoader();

      var Layout = textDesignManager.getLayoutByIdentifier(identifier);

      var layout = new Layout();

      fontLoader.setFonts(fontManager.getFonts());

      AssetManager.setFonts(_extends({}, AssetManager.getFonts(), fontManager.getVariationsByIdentifier()));

      return fontLoader.load().then(function () {
        var images = layout.getImagePaths().map(function (path) {
          return { path: path, fullPath: _this5._ui.getAssetPath(path), image: null };
        });
        return AssetManager.loadImages(images).then(function () {
          layout.onImagesLoaded();

          return operation.createTextDesign({
            position: position,
            rotation: rotation,
            flipHorizontally: flipHorizontally,
            flipVertically: flipVertically,
            text: text,
            color: __WEBPACK_IMPORTED_MODULE_7_globals__["b" /* Color */].fromArray(color.rgba),
            width: width,
            seed: seed,
            inverted: inverted,
            layout: layout
          });
        });
      });
    }
  }]);

  return v300Deserializer;
}(__WEBPACK_IMPORTED_MODULE_8__2_0_0_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v300Deserializer);


v300Deserializer.version = '3.0.0';

/***/ }),
/* 210 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__3_0_0_serializer__ = __webpack_require__(208);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var v310Serializer = function (_PreviousSerializer) {
  _inherits(v310Serializer, _PreviousSerializer);

  function v310Serializer() {
    _classCallCheck(this, v310Serializer);

    return _possibleConstructorReturn(this, (v310Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(v310Serializer)).apply(this, arguments));
  }

  _createClass(v310Serializer, [{
    key: '_serializeTextDesign',
    value: function _serializeTextDesign(operation, sprite) {
      var options = sprite.serializeOptions(['position', 'rotation', 'flipHorizontally', 'flipVertically', 'text', 'color', 'width', 'seed', 'inverted'], true);

      options.color = {
        rgba: options.color
      };

      var layout = sprite.getLayout();

      if (layout) {
        options.identifier = layout.constructor.identifier;
      }

      return {
        type: 'textdesign',
        options: options
      };
    }
  }]);

  return v310Serializer;
}(__WEBPACK_IMPORTED_MODULE_5__3_0_0_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v310Serializer);


v310Serializer.version = '3.1.0';

/***/ }),
/* 211 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__3_0_0_deserializer__ = __webpack_require__(209);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_shared_managers_text_design_manager__ = __webpack_require__(55);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_shared_managers_font_manager__ = __webpack_require__(41);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var v310Deserializer = function (_PreviousDeserializer) {
  _inherits(v310Deserializer, _PreviousDeserializer);

  function v310Deserializer() {
    _classCallCheck(this, v310Deserializer);

    return _possibleConstructorReturn(this, (v310Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v310Deserializer)).apply(this, arguments));
  }

  _createClass(v310Deserializer, [{
    key: '_deserializeTextDesign',
    value: function _deserializeTextDesign(operation, sprite) {
      var _this2 = this;

      var options = sprite.options;
      var position = options.position,
          rotation = options.rotation,
          flipHorizontally = options.flipHorizontally,
          flipVertically = options.flipVertically,
          text = options.text,
          color = options.color,
          width = options.width,
          seed = options.seed,
          inverted = options.inverted;
      var identifier = options.identifier;


      if (identifier === __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier) {
        identifier = __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier;
      } else if (identifier === __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier) {
        identifier = __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier;
      }

      var textDesignManager = new __WEBPACK_IMPORTED_MODULE_7_shared_managers_text_design_manager__["a" /* default */](this._ui, this._getOptions('textdesign'));
      var fontManager = new __WEBPACK_IMPORTED_MODULE_8_shared_managers_font_manager__["a" /* default */](this._ui, { fonts: __WEBPACK_IMPORTED_MODULE_5_globals__["c" /* Constants */].DEFAULTS.TEXT_DESIGN_FONTS, replaceFonts: true });
      var AssetManager = operation.constructor.TextDesignSprite.AssetManager;
      var fontLoader = this._ui.getFontLoader();

      var Layout = textDesignManager.getLayoutByIdentifier(identifier);

      var layout = new Layout();

      fontLoader.setFonts(fontManager.getFonts());

      AssetManager.setFonts(_extends({}, AssetManager.getFonts(), fontManager.getVariationsByIdentifier()));

      return fontLoader.load().then(function () {
        var images = layout.getImagePaths().map(function (path) {
          return { path: path, fullPath: _this2._ui.getAssetPath(path), image: null };
        });
        return AssetManager.loadImages(images).then(function () {
          layout.onImagesLoaded();

          return operation.createTextDesign({
            position: position,
            rotation: rotation,
            flipHorizontally: flipHorizontally,
            flipVertically: flipVertically,
            text: text,
            color: __WEBPACK_IMPORTED_MODULE_5_globals__["b" /* Color */].fromArray(color.rgba),
            width: width,
            seed: seed,
            inverted: inverted,
            layout: layout
          });
        });
      });
    }
  }]);

  return v310Deserializer;
}(__WEBPACK_IMPORTED_MODULE_6__3_0_0_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v310Deserializer);


v310Deserializer.version = '3.1.0';

/***/ }),
/* 212 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__3_1_0_serializer__ = __webpack_require__(210);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var v320Serializer = function (_PreviousSerializer) {
  _inherits(v320Serializer, _PreviousSerializer);

  function v320Serializer() {
    _classCallCheck(this, v320Serializer);

    return _possibleConstructorReturn(this, (v320Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(v320Serializer)).apply(this, arguments));
  }

  _createClass(v320Serializer, [{
    key: '_serializeTextDesign',
    value: function _serializeTextDesign(operation, sprite) {
      var options = sprite.serializeOptions(['position', 'rotation', 'flipHorizontally', 'flipVertically', 'text', 'color', 'width', 'seed', 'inverted', 'padding'], true);

      options.color = {
        rgba: options.color
      };

      var layout = sprite.getLayout();

      if (layout) {
        options.identifier = layout.constructor.identifier;
      }

      options.padding *= options.width;

      return {
        type: 'textdesign',
        options: options
      };
    }
  }]);

  return v320Serializer;
}(__WEBPACK_IMPORTED_MODULE_4__3_1_0_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v320Serializer);


v320Serializer.version = '3.2.0';

/***/ }),
/* 213 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__3_1_0_deserializer__ = __webpack_require__(211);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_shared_managers_text_design_manager__ = __webpack_require__(55);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_shared_managers_font_manager__ = __webpack_require__(41);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var v320Deserializer = function (_PreviousDeserializer) {
  _inherits(v320Deserializer, _PreviousDeserializer);

  function v320Deserializer() {
    _classCallCheck(this, v320Deserializer);

    return _possibleConstructorReturn(this, (v320Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v320Deserializer)).apply(this, arguments));
  }

  _createClass(v320Deserializer, [{
    key: '_deserializeTextDesign',
    value: function _deserializeTextDesign(operation, sprite) {
      var _this2 = this;

      var options = sprite.options;
      var position = options.position,
          rotation = options.rotation,
          flipHorizontally = options.flipHorizontally,
          flipVertically = options.flipVertically,
          text = options.text,
          color = options.color,
          width = options.width,
          seed = options.seed,
          inverted = options.inverted;
      var identifier = options.identifier;

      // Update Legacy identifiers

      if (identifier === __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier) {
        identifier = __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier;
      } else if (identifier === __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier) {
        identifier = __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier;
      }

      var padding = 'padding' in options ? options.padding / width : -1;

      var textDesignManager = new __WEBPACK_IMPORTED_MODULE_7_shared_managers_text_design_manager__["a" /* default */](this._ui, this._getOptions('textdesign'));
      var fontManager = new __WEBPACK_IMPORTED_MODULE_8_shared_managers_font_manager__["a" /* default */](this._ui, { fonts: __WEBPACK_IMPORTED_MODULE_5_globals__["c" /* Constants */].DEFAULTS.TEXT_DESIGN_FONTS, replaceFonts: true });
      var AssetManager = operation.constructor.TextDesignSprite.AssetManager;
      var fontLoader = this._ui.getFontLoader();

      var Layout = textDesignManager.getLayoutByIdentifier(identifier);

      var layout = new Layout();

      fontLoader.setFonts(fontManager.getFonts());

      AssetManager.setFonts(_extends({}, AssetManager.getFonts(), fontManager.getVariationsByIdentifier()));

      return fontLoader.load().then(function () {
        var images = layout.getImagePaths().map(function (path) {
          return { path: path, fullPath: _this2._ui.getAssetPath(path), image: null };
        });
        return AssetManager.loadImages(images).then(function () {
          layout.onImagesLoaded();

          return operation.createTextDesign({
            position: position,
            rotation: rotation,
            flipHorizontally: flipHorizontally,
            flipVertically: flipVertically,
            text: text,
            color: __WEBPACK_IMPORTED_MODULE_5_globals__["b" /* Color */].fromArray(color.rgba),
            width: width,
            seed: seed,
            inverted: inverted,
            layout: layout,
            padding: padding
          });
        });
      });
    }
  }]);

  return v320Deserializer;
}(__WEBPACK_IMPORTED_MODULE_6__3_1_0_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v320Deserializer);


v320Deserializer.version = '3.2.0';

/***/ }),
/* 214 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__3_2_0_serializer__ = __webpack_require__(212);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__2_0_0_blend_modes__ = __webpack_require__(93);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var v340Serializer = function (_PreviousSerializer) {
  _inherits(v340Serializer, _PreviousSerializer);

  function v340Serializer() {
    _classCallCheck(this, v340Serializer);

    return _possibleConstructorReturn(this, (v340Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v340Serializer)).apply(this, arguments));
  }

  _createClass(v340Serializer, [{
    key: '_serializeOperation',

    /**
     * Serializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operation[]} operations
     * @return {Object}
     * @private
     */
    value: function _serializeOperation(operation, operations) {
      switch (operation.constructor.identifier) {
        case 'artfilter':
          return this._serializeStyle(operation);
        default:
          return _get(v340Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v340Serializer.prototype), '_serializeOperation', this).call(this, operation, operations);
      }
    }

    /**
     * Serializes the given orientation operation
     * @param  {PhotoEditorSDK.Operation.OrientationOperation} operation
     * @return {Object}
     * @private
     */

  }, {
    key: '_serializeOrientationOperation',
    value: function _serializeOrientationOperation(operation) {
      return {
        type: 'orientation',
        options: operation.serializeOptions(['flipVertically', 'flipHorizontally', 'rotation'], true)
      };
    }
  }, {
    key: '_serializeStyle',
    value: function _serializeStyle(operation) {
      var _operation$getOptions = operation.getOptions(),
          identifier = _operation$getOptions.identifier,
          intensity = _operation$getOptions.intensity,
          blendMode = _operation$getOptions.blendMode;

      var _operation$getStyleTr = operation.getStyleTransferModel().getOptions(),
          tileEdgeLength = _operation$getStyleTr.tileEdgeLength,
          overlappingFactor = _operation$getStyleTr.overlappingFactor;

      return {
        type: 'artFilter',
        options: {
          identifier: identifier,
          intensity: intensity,
          blendMode: __WEBPACK_IMPORTED_MODULE_6__2_0_0_blend_modes__["a" /* default */][blendMode],
          tileEdgeLength: tileEdgeLength,
          overlappingFactor: overlappingFactor
        }
      };
    }
  }]);

  return v340Serializer;
}(__WEBPACK_IMPORTED_MODULE_5__3_2_0_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v340Serializer);


v340Serializer.version = '3.4.0';

/***/ }),
/* 215 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__3_2_0_deserializer__ = __webpack_require__(213);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_shared_managers_text_design_manager__ = __webpack_require__(55);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_shared_managers_font_manager__ = __webpack_require__(41);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__managers_art_filter_manager__ = __webpack_require__(511);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__2_0_0_blend_modes__ = __webpack_require__(93);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







var blendModeByName = __WEBPACK_IMPORTED_MODULE_6_globals__["k" /* SDKUtils */].flipObject(__WEBPACK_IMPORTED_MODULE_11__2_0_0_blend_modes__["a" /* default */]);
var ArtFilterOperation = __WEBPACK_IMPORTED_MODULE_6_globals__["j" /* SDK */].Operations.ArtFilterOperation;

var v340Deserializer = function (_PreviousDeserializer) {
  _inherits(v340Deserializer, _PreviousDeserializer);

  function v340Deserializer() {
    _classCallCheck(this, v340Deserializer);

    return _possibleConstructorReturn(this, (v340Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v340Deserializer)).apply(this, arguments));
  }

  _createClass(v340Deserializer, [{
    key: '_deserializeOperation',

    /**
     * Deserializes the given operation
     * @param  {PhotoEditorSDK.Operation} operation
     * @return {Promise}
     * @private
     */
    value: function _deserializeOperation(operation) {
      if (operation.type === 'artFilter') {
        return this._deserializeStyle(operation);
      }
      return _get(v340Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v340Deserializer.prototype), '_deserializeOperation', this).call(this, operation);
    }

    /**
     * Deserializes the given orientation operation
     * @param  {Object} operation
     * @return {Promise}
     * @private
     */

  }, {
    key: '_deserializeOrientationOperation',
    value: function _deserializeOrientationOperation(operation) {
      var options = operation.options;

      var orientationOperation = this._editor.operations.getOrCreate('orientation');
      if (!orientationOperation) return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      orientationOperation.set(options);
      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(orientationOperation);
    }

    /**
     * Deserializes an 'artFilter' operation.
     * @TODO
     * This approach has some issues, which we need to resolve for the final release:
     * - We're completely ignoring at which resolution the style was originally
     *   rendered. This data is stored in the `image` portion of the serialization,
     *   but even if we check if it matches the current image, we can't really do anything
     *   if it doesn't. Especially as this is only a problem, if we're rerendering
     *   the same image at a higher resolution (in that case the style would look different).
     * - Once we restore a serialization, we'll never switch to the default style render
     *   parameters (tileEdgeLength & overlappingFactor), as long as the operation isn't
     *   completely removed. This is not yet a problem, as this is the only platform creating
     *   serialisations and there is currently no way to alter the defaults. Might cause
     *   issues in the future though.
     * @param {Object} operation
     */

  }, {
    key: '_deserializeStyle',
    value: function _deserializeStyle(operation) {
      var _this2 = this;

      var _operation$options = operation.options,
          identifier = _operation$options.identifier,
          intensity = _operation$options.intensity,
          blendMode = _operation$options.blendMode,
          tileEdgeLength = _operation$options.tileEdgeLength,
          overlappingFactor = _operation$options.overlappingFactor;


      if (!identifier) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Found invalid Art Filter serialization.');
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }

      if (!ArtFilterOperation.isSupported(this._editor.getSDK())) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn("Can't restore Art Filters, as they're not supported on this platform.");
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve();
      }

      var artFilterManager = new __WEBPACK_IMPORTED_MODULE_10__managers_art_filter_manager__["a" /* default */](this._ui, this._getOptions('artfilter'));
      return artFilterManager.instantiateStyleTransferModelForArtFilterWithIdentifier(identifier, {
        tileEdgeLength: tileEdgeLength,
        overlappingFactor: overlappingFactor
      }).catch(function (error) {
        __WEBPACK_IMPORTED_MODULE_6_globals__["g" /* Log */].warn('Could not deserialize art filter: ' + error);
      }).then(function (model) {
        _this2._editor.operations.getOrCreate('artfilter', {
          identifier: identifier,
          styleTransferModel: model,
          intensity: intensity,
          blendMode: parseInt(blendModeByName[blendMode || blendMode], 10)
        });
      });
    }
  }]);

  return v340Deserializer;
}(__WEBPACK_IMPORTED_MODULE_7__3_2_0_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v340Deserializer);


v340Deserializer.version = '3.4.0';

/***/ }),
/* 216 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__3_4_0_serializer__ = __webpack_require__(214);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var v350Serializer = function (_PreviousSerializer) {
  _inherits(v350Serializer, _PreviousSerializer);

  function v350Serializer() {
    _classCallCheck(this, v350Serializer);

    return _possibleConstructorReturn(this, (v350Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(v350Serializer)).apply(this, arguments));
  }

  return v350Serializer;
}(__WEBPACK_IMPORTED_MODULE_3__3_4_0_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v350Serializer);


v350Serializer.version = '3.5.0';

/***/ }),
/* 217 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__3_4_0_deserializer__ = __webpack_require__(215);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_shared_managers_text_design_manager__ = __webpack_require__(55);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_shared_managers_font_manager__ = __webpack_require__(41);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var v350Deserializer = function (_PreviousDeserializer) {
  _inherits(v350Deserializer, _PreviousDeserializer);

  function v350Deserializer() {
    _classCallCheck(this, v350Deserializer);

    return _possibleConstructorReturn(this, (v350Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v350Deserializer)).apply(this, arguments));
  }

  _createClass(v350Deserializer, [{
    key: '_deserializeTextDesign',
    value: function _deserializeTextDesign(operation, sprite) {
      var _this2 = this;

      var options = sprite.options;
      var position = options.position,
          rotation = options.rotation,
          flipHorizontally = options.flipHorizontally,
          flipVertically = options.flipVertically,
          text = options.text,
          color = options.color,
          width = options.width,
          seed = options.seed,
          inverted = options.inverted,
          identifier = options.identifier;


      var padding = 'padding' in options ? options.padding / width : -1;

      var textDesignManager = new __WEBPACK_IMPORTED_MODULE_7_shared_managers_text_design_manager__["a" /* default */](this._ui, this._getOptions('textdesign'));
      var fontManager = new __WEBPACK_IMPORTED_MODULE_8_shared_managers_font_manager__["a" /* default */](this._ui, { fonts: __WEBPACK_IMPORTED_MODULE_5_globals__["c" /* Constants */].DEFAULTS.TEXT_DESIGN_FONTS, replaceFonts: true });
      var AssetManager = operation.constructor.TextDesignSprite.AssetManager;
      var fontLoader = this._ui.getFontLoader();

      var Layout = textDesignManager.getLayoutByIdentifier(identifier);

      var layout = new Layout();

      fontLoader.setFonts(fontManager.getFonts());

      AssetManager.setFonts(_extends({}, AssetManager.getFonts(), fontManager.getVariationsByIdentifier()));

      return fontLoader.load().then(function () {
        var images = layout.getImagePaths().map(function (path) {
          return { path: path, fullPath: _this2._ui.getAssetPath(path), image: null };
        });
        return AssetManager.loadImages(images).then(function () {
          layout.onImagesLoaded();

          return operation.createTextDesign({
            position: position,
            rotation: rotation,
            flipHorizontally: flipHorizontally,
            flipVertically: flipVertically,
            text: text,
            color: __WEBPACK_IMPORTED_MODULE_5_globals__["b" /* Color */].fromArray(color.rgba),
            width: width,
            seed: seed,
            inverted: inverted,
            layout: layout,
            padding: padding
          });
        });
      });
    }
  }]);

  return v350Deserializer;
}(__WEBPACK_IMPORTED_MODULE_6__3_4_0_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v350Deserializer);


v350Deserializer.version = '3.5.0';

/***/ }),
/* 218 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__3_5_0_serializer__ = __webpack_require__(216);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var v360Serializer = function (_PreviousSerializer) {
  _inherits(v360Serializer, _PreviousSerializer);

  function v360Serializer() {
    _classCallCheck(this, v360Serializer);

    return _possibleConstructorReturn(this, (v360Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v360Serializer)).apply(this, arguments));
  }

  _createClass(v360Serializer, [{
    key: '_serializeAdjustmentsOperation',

    /**
     * Serializes the given adjustments operation
     * @param  {PhotoEditorSDK.Operations.AdjustmentsOperation} operation
     * @return {Object}
     * @private
     */
    value: function _serializeAdjustmentsOperation(operation) {
      var response = _get(v360Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v360Serializer.prototype), '_serializeAdjustmentsOperation', this).call(this, operation);

      var optionName = 'sharpness';
      var availableOptions = operation.availableOptions;

      var options = {};

      var option = availableOptions[optionName];
      var value = operation.getOption(optionName);
      var minValue = option.minValue,
          midValue = option.midValue,
          maxValue = option.maxValue;

      options[optionName] = value <= midValue ? (value - minValue) / (midValue - minValue) - 1 : (value - midValue) / (maxValue - midValue);

      response.options = _extends({}, response.options, options);

      return response;
    }
  }]);

  return v360Serializer;
}(__WEBPACK_IMPORTED_MODULE_6__3_5_0_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v360Serializer);


v360Serializer.version = '3.6.0';

/***/ }),
/* 219 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__3_5_0_deserializer__ = __webpack_require__(217);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var v360Deserializer = function (_PreviousDeserializer) {
  _inherits(v360Deserializer, _PreviousDeserializer);

  function v360Deserializer() {
    _classCallCheck(this, v360Deserializer);

    return _possibleConstructorReturn(this, (v360Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v360Deserializer)).apply(this, arguments));
  }

  _createClass(v360Deserializer, [{
    key: '_deserializeAdjustmentsOperation',

    /**
     * Deserializes the given adjustments operation
     * @param  {Object} operationData
     * @return {Promise}
     * @private
     */
    value: function _deserializeAdjustmentsOperation(operationData) {
      var AdjustmentsOperation = __WEBPACK_IMPORTED_MODULE_5_globals__["j" /* SDK */].Operations.AdjustmentsOperation;

      return _get(v360Deserializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v360Deserializer.prototype), '_deserializeAdjustmentsOperation', this).call(this, operationData).then(function (operation) {
        if (!operation) return null;

        var options = operationData.options;

        var optionName = 'sharpness';
        var operationOptions = {};

        if (typeof options[optionName] === 'undefined') return;

        var _AdjustmentsOperation = AdjustmentsOperation.prototype.availableOptions[optionName],
            minValue = _AdjustmentsOperation.minValue,
            midValue = _AdjustmentsOperation.midValue,
            maxValue = _AdjustmentsOperation.maxValue;

        var value = options[optionName];

        value = value < 0 ? midValue + (midValue - minValue) * value : midValue + (maxValue - midValue) * value;
        operationOptions[optionName] = value;

        operation.set(operationOptions);

        return operation;
      });
    }
  }]);

  return v360Deserializer;
}(__WEBPACK_IMPORTED_MODULE_6__3_5_0_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v360Deserializer);


v360Deserializer.version = '3.6.0';

/***/ }),
/* 220 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__3_6_0_serializer__ = __webpack_require__(218);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var v370Serializer = function (_PreviousSerializer) {
  _inherits(v370Serializer, _PreviousSerializer);

  function v370Serializer() {
    _classCallCheck(this, v370Serializer);

    return _possibleConstructorReturn(this, (v370Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v370Serializer)).apply(this, arguments));
  }

  _createClass(v370Serializer, [{
    key: 'serialize',
    value: function serialize() {
      var _this2 = this;

      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      return _get(v370Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(v370Serializer.prototype), 'serialize', this).call(this, options).then(function (data) {
        return _this2._serializeAssetLibrary(data).then(function (data) {
          return data;
        });
      });
    }

    /**
     * Serializes all custom assets. Must be called after all operations
     * have already been serialized in order to not serialize any unused
     * assets
     *
     * @param {Object} data
     * @returns {Promise}
     * @private
     */

  }, {
    key: '_serializeAssetLibrary',
    value: function _serializeAssetLibrary(data) {
      if (!this._editor.getDynamicAssetsLibrary) {
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(data);
      }

      var assetLibrary = this._editor.getDynamicAssetsLibrary();
      var serializedStickers = this._serializeCustomStickerAssets(data, assetLibrary);

      if (serializedStickers.length === 0) {
        return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(data);
      }

      // Serialize custom stickers
      data.assetLibrary = {
        assets: {
          stickers: serializedStickers
        }
      };

      return __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_promise___default.a.resolve(data);
    }

    /**
     * Serializes all custom stickers
     * @param {Object} assetLibrary
     * @returns {Array}
     */

  }, {
    key: '_serializeCustomStickerAssets',
    value: function _serializeCustomStickerAssets(data, assetLibrary) {
      var customStickers = assetLibrary.getAssets('sticker');
      if (customStickers.length === 0) {
        return [];
      }

      // Only serialize custom stickers that have actually been
      // placed on the image
      var usedStickerIDs = data.operations.filter(function (operation) {
        return operation.type === 'sprite';
      }).flatMap(function (operation) {
        return operation.options.sprites;
      }).filter(function (sprite) {
        return sprite.type === 'sticker';
      }).map(function (sprite) {
        return sprite.options.identifier;
      });

      var usedIDMap = {};
      usedStickerIDs.forEach(function (id) {
        usedIDMap[id] = true;
      });

      var usedCustomStickers = customStickers.filter(function (sticker) {
        return usedIDMap[sticker.identifier];
      });

      return usedCustomStickers.map(function (sticker) {
        var identifier = sticker.identifier,
            name = sticker.defaultName,
            images = sticker.images;

        var data = images.mediaBase.uris[0];
        var isSVG = images.mediaBase.isSVG;

        var regex = /^data:(image\/(jpeg|png));base64,(.*)$/g;
        var matches = regex.exec(data);
        var rasterType = matches[1];
        var onlyBase64 = matches[3];

        var serialized = {
          identifier: identifier,
          name: name,
          raster: {
            type: rasterType,
            data: onlyBase64
          }
        };
        if (name) {
          serialized.name = name;
        }
        if (isSVG) {
          serialized.svg = {
            data: images.mediaBase.uris[1].replace(/^data:image\/svg\+xml;base64,/g, '')
          };
        }

        return serialized;
      });
    }
  }]);

  return v370Serializer;
}(__WEBPACK_IMPORTED_MODULE_6__3_6_0_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v370Serializer);


v370Serializer.version = '3.7.0';

/***/ }),
/* 221 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk__ = __webpack_require__(31);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__3_6_0_deserializer__ = __webpack_require__(219);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* global HTMLCanvasElement */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var v370Deserializer = function (_PreviousDeserializer) {
  _inherits(v370Deserializer, _PreviousDeserializer);

  function v370Deserializer() {
    _classCallCheck(this, v370Deserializer);

    return _possibleConstructorReturn(this, (v370Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v370Deserializer)).apply(this, arguments));
  }

  _createClass(v370Deserializer, [{
    key: 'deserialize',

    /**
     * Deserializes the given data
     * @returns {Promise}
     */
    value: function deserialize() {
      var _this2 = this;

      return this._validateVersion().then(function () {
        return _this2._deserializeAssetLibrary();
      }).then(function () {
        return _this2._deserializeInputImage();
      }).then(function () {
        return _this2._deserializeOperations();
      });
    }

    /**
     * Deserializes the dynamic assets library (if present)
     */

  }, {
    key: '_deserializeAssetLibrary',
    value: function _deserializeAssetLibrary() {
      var _this3 = this;

      return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var data = _this3._data;
        if (!data.assetLibrary) {
          resolve();
          return;
        }

        var assets = data.assetLibrary.assets;

        var promises = [];
        for (var assetType in assets) {
          promises.push(_this3._deserializeCustomAssets(assetType, assets[assetType]));
        }
        return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.all(promises).then(function () {
          resolve();
        }).catch(function (err) {
          console.error(err);
          reject(err);
        });
      });
    }

    /**
     *
     * @param {string} type
     * @param {Object} data
     *
     */

  }, {
    key: '_deserializeCustomAssets',
    value: function _deserializeCustomAssets(type, data) {
      switch (type) {
        case 'stickers':
          return this._deserializeCustomStickerAssets(data);
        default:
          return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.reject(new Error('Unknown asset type: ' + type));
      }
    }
  }, {
    key: '_deserializeCustomStickerAssets',
    value: function _deserializeCustomStickerAssets(serializedStickers) {
      var _this4 = this;

      var defaultTintMode = 'none';
      var editorOptions = this._editor.getOptions().editor;
      if (editorOptions && editorOptions.controlsOptions && editorOptions.controlsOptions.sticker) {
        defaultTintMode = editorOptions.controlsOptions.sticker.customStickerTintMode || 'none';
      }

      var promises = serializedStickers.map(function (serializedSticker) {
        return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
          var identifier = serializedSticker.identifier,
              raster = serializedSticker.raster;

          var isSVG = serializedSticker.svg !== undefined;

          var rasterBase64 = 'data:' + raster.type + ';base64,' + raster.data;

          var image = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk__["Image"]();
          image.onload = function () {
            var sdk = _this4._editor.getSDK();
            image = sdk.correctExifOrientation(image);
            if (image.toDataURL) {
              rasterBase64 = image.toDataURL();
            }

            var thumb = { data: '', width: 1, height: 1 };
            {
              thumb = _this4._stickerManager.renderStickerThumbnailFromImage(image);
            }

            var customSticker = {
              identifier: identifier,
              defaultName: serializedSticker.name || '',
              tintMode: defaultTintMode,
              images: {
                mediaBase: {
                  uris: [rasterBase64],
                  rawData: true,
                  isSVG: isSVG,
                  width: image.width,
                  height: image.height
                },
                mediaThumb: {
                  uris: [thumb.data],
                  rawData: true,
                  width: thumb.width,
                  height: thumb.height
                }
              }
            };

            if (isSVG) {
              var svgBase64 = 'data:image/svg+xml;base64,' + serializedSticker.svg.data;
              customSticker.images.mediaBase.uris.push(svgBase64);
            }

            resolve(customSticker);
          };
          image.onerror = function () {
            reject(new Error('Invalid base64 data: ' + rasterBase64));
          };
          image.src = rasterBase64;
        });
      });

      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.all(promises).then(function (stickers) {
        var assetsLibrary = _this4._editor.getDynamicAssetsLibrary();
        assetsLibrary.setAssets('sticker', stickers);
        _this4._stickerManager.reload();
      });
    }
  }]);

  return v370Deserializer;
}(__WEBPACK_IMPORTED_MODULE_6__3_6_0_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v370Deserializer);


v370Deserializer.version = '3.7.0';

/***/ }),
/* 222 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__engine_wrapper__ = __webpack_require__(223);
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Constants", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_wrapper__["b"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Utils", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_wrapper__["f"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "JSONLoader", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_wrapper__["d"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "PhotoEditorSDK", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_wrapper__["e"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "EngineWrapper", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_wrapper__["c"]; });
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "Color", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_wrapper__["a"]; });


/***/ }),
/* 223 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return EngineWrapper; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__lib_editor__ = __webpack_require__(485);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_shared_loaders_json_loader__ = __webpack_require__(71);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__lib_font_loader__ = __webpack_require__(135);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_shared_managers_filter_manager__ = __webpack_require__(202);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_shared_managers_font_manager__ = __webpack_require__(41);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_shared_managers_text_design_manager__ = __webpack_require__(55);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return __WEBPACK_IMPORTED_MODULE_4_globals__["c"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return __WEBPACK_IMPORTED_MODULE_4_globals__["m"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return __WEBPACK_IMPORTED_MODULE_6_shared_loaders_json_loader__["a"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return __WEBPACK_IMPORTED_MODULE_4_globals__["j"]; });
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return __WEBPACK_IMPORTED_MODULE_4_globals__["b"]; });





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/*!
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








var bd = function bd(str) {
  return __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].byteArrayToString(__WEBPACK_IMPORTED_MODULE_4_globals__["a" /* Base64 */].decode(str));
};

/**
 * The Headless Engine Wrapper
 * @class
 * @alias EngineWrapper
 * @extends PhotoEditorSDK.EventEmitter
 * @memberof PhotoEditorSDK
 *
 * @param  {Object} options
 * @param  {String} options.license - Your license
 * @param  {DOMElement} options.container - The container that the UI should be rendered to
 * @param  {String} [options.language = 'en'] - Currently `en` and `de` are supported
 * @param  {String} [options.logLevel] - `trace`, `info`, `warn`, `error` or `log`
 * @param  {Boolean} [options.responsive = false] - Should the editor re-render on window resize?
 * @param {Boolean} [options.preloader = true] - Enables or disables the preloader
 * @param  {String} [options.crossOrigin = 'anonymous'] - 'anonymous', 'use-credentials' or 'none'
 * @param  {Object} [options.editor]
 * @param  {Image|string} [options.editor.image] - The image that the user can edit
 * @param  {Image} [options.editor.watermarkImage] - An image that should be placed on top as a watermark
 * @param  {String} [options.editor.preferredRenderer = 'webgl'] - `webgl` or `canvas`
 * @param  {Number} [options.editor.pixelRatio = 1] - If none is given, PhotoEditorSDK automatically
 *   detects the current device's pixel ratio
 * @param  {Boolean} [options.editor.enableDrag = true] - Should dragging the canvas be enabled?
 * @param  {Boolean} [options.editor.enableZoom = true] - Should zooming be enabled?
 * @param  {Boolean} [options.editor.enableExport = true] - Should zooming be enabled?
 * @param  {Boolean} [options.editor.enableKeyboardControls = true] - Should keyboard controls be enabled?
 * @param  {Boolean} [options.editor.enablePositionSnapping = true] - Should snapping be enabled when positioning sprites?
 * @param  {Boolean} [options.editor.enableRotationSnapping = true] - Should snapping be enabled when rotating sprites?
 * @param  {Boolean} [options.editor.enableSave = false] - Should zooming be enabled?
 * @param  {Boolean} [options.editor.enableLoad = false] - Should zooming be enabled?
 * @param  {Boolean} [options.editor.smoothDownscaling = false] - Toggles smooth downscaling
 * @param  {Boolean} [options.editor.smoothUpscaling = false] - Toggles smooth upscaling
 * @param  {Boolean} [options.editor.displayResizeMessage = true] - Should a message be displayed
 *                                                       when the image has been scaled down
 *                                                       for performance?
 * @param  {String}  [options.editor.defaultControl = 'filter'] - The tool that is initially loaded
 * @param  {(String[]|Array[])} [options.editor.controlsOrder] - The order in which the controls are displayed.
 *                                           Available are `transform`, `filter`,
 *                                           `adjustments`, `text`, `sticker`, `brush`, `focus`,
 *                                           `frame`. Can be grouped in arrays which will be
 *                                           displayed with separators.
 * @param  {String[]} [options.editor.operationsOrder] - The order in which operations are added to
 *                                              the stack. Changing this may affect the
 *                                              performance.
 * @param  {Object} [options.editor.controlsOptions] - Options that are passed to specific controls, with the controls identifiers as keys. See
 *                                            the documentation for each control to learn more
 *                                            about available values.
 * @param {Object[]} [options.editor.forceCrop] - If true, the editor will lauch to the transform tool
 *                                                for cropping, before any other tool is allowed.
 * @param  {Object} [options.editor.maxMegaPixels] - Maximum amount of megapixels per device type
 * @param  {Number} [options.editor.maxMegaPixels.desktop = 10]
 * @param  {Number} [options.editor.maxMegaPixels.mobile = 5]
 * @param  {Boolean} [options.editor.transparent = true]
 * @param  {Array|String|PhotoEditorSDK.Color} [options.editor.clearColor = [0, 0, 0, 0]]
 *
 * @param  {Object} [options.editor.snappingOptions] - Options that control the snapping behaviour of sprites
 * @param  {Object} [options.editor.snappingOptions.position] - Options that control the positional snapping of sprites
 * @param  {Number} [options.editor.snappingOptions.position.threshold = 20] - At which threshold should sprites snap to the canvas snapping guides? (value in px)
 * @param  {Object} [options.editor.snappingOptions.position.padding] - Defines the inset between the canvas frame and the corresponding snapping guides.
 *                                                            The values are specified relative to the smaller side of the image. Setting `left`, `right`, `top` and `bottom`
 *                                                            to 0 allows sprites to snap to the edges of the canvas.
 * @param  {Number} [options.editor.snappingOptions.position.padding.left = 0.1]
 * @param  {Number} [options.editor.snappingOptions.position.padding.right = 0.1]
 * @param  {Number} [options.editor.snappingOptions.position.padding.top = 0.1]
 * @param  {Number} [options.editor.snappingOptions.position.padding.left = 0.1]
 *
 * @param  {Object} [options.editor.snappingOptions.rotation] - Options that control the rotational snapping of sprites
 * @param  {Number[]} [options.editor.snappingOptions.rotation.angles = [0, 45, 90, 135, 180, 225, 270, 315]] - Angles to snap to while rotating a sprite
 * @param  {Number} [options.editor.snappingOptions.rotation.threshold = 20] - At which threshold should the sprites snap to the next rotation snap point (value in pixels)
 *
 * @param  {Object} [options.editor.export]
 * @param  {String} [options.editor.export.format = 'image/png'] - The export format. Available formats
 * @param  {PhotoEditorSDK.RenderType} [options.editor.export.type] - The export type (image or data url)
 * @param  {Boolean} [options.editor.export.download] - Should the result be presented as a download?
 * @param  {String} [options.editor.export.fileBasename = 'photoeditorsdk-export'] - The basename
 *                                                      of the exported file (file extension will
 *                                                      be added automatically)
 * @param {Number} [options.editor.export.quality = 0.8] - The export quality (0...1, only supported
 *                                                for JPG images)
 * @param  {Object} [options.editor.save]
 * @param  {String} [options.editor.save.format = 'text/jsom'] - The export format. Available formats
 * @param  {Boolean} [options.editor.save.download] - Should the result be presented as a download?
 * @param  {String} [options.editor.save.fileBasename = 'photoeditorsdk-save'] - The basename
 *                                                      of the exported file (file extension will
 *                                                      be added automatically)
 * @param  {Object} [options.assets]
 * @param  {String} [options.assets.baseUrl = '/assets'] - Path that is prepended to all asset paths
 * @param  {Function} [options.assets.resolver] - A function resolving a path to another path.
 */

var EngineWrapper = function (_EventEmitter) {
  _inherits(EngineWrapper, _EventEmitter);

  function EngineWrapper() {
    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

    _classCallCheck(this, EngineWrapper);

    var _this = _possibleConstructorReturn(this, (EngineWrapper.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(EngineWrapper)).call(this));

    _this._mediator = new __WEBPACK_IMPORTED_MODULE_4_globals__["d" /* EventEmitter */]();
    _this._fontLoader = new __WEBPACK_IMPORTED_MODULE_7__lib_font_loader__["a" /* default */](_this);
    _this._options = options;
    _this._initOptions();
    // this._initLanguage()
    _this._initEvents();
    _this._disposed = false;

    _this._isReady = false;

    _this._editor = new __WEBPACK_IMPORTED_MODULE_5__lib_editor__["a" /* default */](_this, _this._options, _this._mediator);
    if (_this._options.editor.image) {
      _this._editor.setImage(_this._options.editor.image);
    }

    _this._mediator.once(__WEBPACK_IMPORTED_MODULE_4_globals__["c" /* Constants */].EVENTS.EDITOR_READY, function () {
      _this._isReady = true;
    });

    __WEBPACK_IMPORTED_MODULE_4_globals__["g" /* Log */].setLevel(_this._options.logLevel);

    _this._v();
    return _this;
  }

  /**
   * Exports an image
   * @param {Boolean} download = false
   * @return {Promise}
   */


  _createClass(EngineWrapper, [{
    key: 'export',
    value: function _export() {
      var _editor;

      return (_editor = this._editor).export.apply(_editor, arguments);
    }

    /**
     * Serializes the editor state
     * @return {Promise}
     */

  }, {
    key: 'serialize',
    value: function serialize() {
      var _editor2;

      return (_editor2 = this._editor).serialize.apply(_editor2, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      return this._editor.deserialize(data);
    }

    /**
     * Returns the editor
     * @return {PhotoEditorSDK.EngineWrapper.Editor}
     */

  }, {
    key: 'getEditor',
    value: function getEditor() {
      return this._editor;
    }

    /**
     * Returns true if the editor is ready for doing operations, e.g.,
     * serializing, deserializing and exporting.
     *
     * @returns {Boolean}
     */

  }, {
    key: 'isReady',
    value: function isReady() {
      return this._isReady;
    }

    /**
     * Calls a callback when the editor is ready, or immeditially if it's already
     * in a ready state.
     *
     * @param {Function} cb
     */

  }, {
    key: 'onReady',
    value: function onReady(cb) {
      if (!this._isReady) {
        this._mediator.once(__WEBPACK_IMPORTED_MODULE_4_globals__["c" /* Constants */].EVENTS.EDITOR_READY, cb);
      } else {
        cb();
      }
    }

    /**
     *
     * @param {string} identifier
     * @returns {Promise<Filter>}
     */

  }, {
    key: 'createFilter',
    value: function createFilter(identifier) {
      var filterManager = new __WEBPACK_IMPORTED_MODULE_8_shared_managers_filter_manager__["a" /* default */](this, this._getOptions('filter'));
      return filterManager.instantiateFilterWithIdentifier(identifier);
    }
  }, {
    key: 'getTextDesignLayoutByID',
    value: function getTextDesignLayoutByID(identifier) {
      var textDesignManager = new __WEBPACK_IMPORTED_MODULE_10_shared_managers_text_design_manager__["a" /* default */](this, this._getOptions('textDesign'));
      return new (textDesignManager.getLayoutByIdentifier(identifier))();
    }
  }, {
    key: 'getTextDesignAssetManager',
    value: function getTextDesignAssetManager() {
      return __WEBPACK_IMPORTED_MODULE_4_globals__["j" /* SDK */].Operations.SpriteOperation.TextDesignSprite.AssetManager;
    }
  }, {
    key: 'getTextDesignFontManager',
    value: function getTextDesignFontManager() {
      var fontManager = new __WEBPACK_IMPORTED_MODULE_9_shared_managers_font_manager__["a" /* default */](this, {
        fonts: __WEBPACK_IMPORTED_MODULE_4_globals__["c" /* Constants */].DEFAULTS.TEXT_DESIGN_FONTS,
        replaceFonts: true
      });
      return fontManager;
    }
  }, {
    key: '_getOptions',
    value: function _getOptions(control) {
      var editor = this.getEditor();
      var controls = editor.controls;

      var defaultOptions = {};
      if (controls && controls.get(control)) {
        defaultOptions = controls.get(control).defaultOptions;
      }

      var editorOptions = editor.getOptions();
      return __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].deepDefaults({}, editorOptions.editor.controlsOptions[control] || {}, defaultOptions);
    }

    // -------------------------------------------------------------------------- INITIALIZATION

    /**
     * Initializes the default options
     * @private
     */

  }, {
    key: '_initOptions',
    value: function _initOptions() {
      this._options = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options, {
        language: 'en',
        logLevel: 'warn',
        crossOrigin: 'anonymous',

        editor: {},
        assets: {},
        responsive: false,
        preloader: true,
        autoRun: true
      });

      this._options.editor = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.editor || {}, {
        enableZoom: true,
        enableDrag: true,
        enableExport: true,
        enableKeyboardControls: true,
        enablePositionSnapping: true,
        enableRotationSnapping: true,
        enableSave: false,
        enableLoad: false,

        pixelRatio: typeof window !== 'undefined' && window.devicePixelRatio || 1,
        preferredRenderer: 'webgl',
        transparent: true,
        clearColor: [0, 0, 0, 0],
        displayResizeMessage: true,
        maxMegaPixels: {},
        displayCloseButton: false,
        undoMode: 'global',
        defaultControl: 'filter',
        forceCrop: false,
        snappingOptions: {},
        tools: ['transform', 'filter', 'adjustments', 'focus', 'text', 'textdesign', 'sticker', 'brush', 'frame', 'overlay', 'library', 'artfilter'],
        controlsOrder: [['library'], ['artfilter', 'transform', 'filter', 'adjustments', 'focus'], ['text', 'textdesign', 'sticker', 'brush', 'frame', 'overlay']],
        operationsOrder: [
        // First, all operations that affect the image dimensions
        'exif-orientation', // Automatically created by SDK
        'artfilter', 'orientation', 'transform',

        // Then color operations (first style and filter, then fine-tuning)
        'filter', 'adjustments',

        // Then post-processing
        'radial-focus', 'mirrored-focus', 'linear-focus', 'blur', 'selective-blur', 'overlay', 'sprite', 'frame', 'watermark'],
        controlsOptions: {
          focus: {
            highQualityCanvasBlur: false
          }
        }
      });

      this._options.editor.snappingOptions = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.editor.snappingOptions, {
        position: {},
        rotation: {}
      });

      this._options.editor.snappingOptions.position = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.editor.snappingOptions.position, {
        padding: {},
        threshold: 20
      });

      this._options.editor.snappingOptions.position.padding = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.editor.snappingOptions.position.padding, {
        left: 0.1,
        right: 0.1,
        top: 0.1,
        bottom: 0.1
      });

      this._options.editor.snappingOptions.rotation = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.editor.snappingOptions.rotation, {
        angles: [0, 45, 90, 135, 180, 225, 270, 315],
        threshold: 20
      });

      this._options.editor.controlsOptions.focus = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.editor.controlsOptions.focus, {
        highQualityCanvasBlur: false
      });

      this._options.editor.maxMegaPixels = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.editor.maxMegaPixels, {
        mobile: 5,
        desktop: 10
      });

      this._options.editor.export = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.editor.export || {}, {
        format: 'image/png',
        type: __WEBPACK_IMPORTED_MODULE_4_globals__["i" /* RenderType */].IMAGE,
        download: true,
        fileBasename: 'photoeditorsdk-export',
        quality: 0.8
      });

      this._options.editor.save = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.editor.save || {}, {
        format: 'text/json',
        download: true,
        fileBasename: 'photoeditorsdk-save'
      });

      this._options.extensions = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.extensions || {}, {
        languages: {},
        operations: [],
        controls: []
      });

      this._options.assets = __WEBPACK_IMPORTED_MODULE_4_globals__["k" /* SDKUtils */].defaults(this._options.assets || {}, {
        baseUrl: 'assets',
        resolver: null
      });

      if (!(this._options.editor.image instanceof window.Image)) {
        var image = new window.Image();
        if (this._options.editor.image) {
          image.src = this._options.editor.image;
          this._options.editor.image = image;
        }
      }
    }

    /**
     * Validates presence of the API key
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_v',
    value: function _v() {
      if (!this[bd('X29wdGlvbnM=')][bd('bGljZW5zZQ==')]) {
        __WEBPACK_IMPORTED_MODULE_4_globals__["g" /* Log */].error(bd('TGljZW5zaW5n'), bd('Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbg=='));
        __WEBPACK_IMPORTED_MODULE_4_globals__["g" /* Log */].error(bd('TGljZW5zaW5n'), bd('SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg=='));
        return false;
      }
      return true;
    }

    // -------------------------------------------------------------------------- EVENTS

    /**
     * Catches mediator events and emits them here
     * @private
     */

  }, {
    key: '_initEvents',
    value: function _initEvents() {
      this._mediator.pipeEvents(this);
    }

    /**
     * Unpipes the vents
     * @private
     */

  }, {
    key: '_disposeEvents',
    value: function _disposeEvents() {
      this._mediator.unpipeEvents(this);
    }

    /**
     * Sets the image to the given one
     * @param {Image} image
     */

  }, {
    key: 'setImage',
    value: function setImage(image) {
      this._editor.setImage(image);
    }

    /**
     * Returns the resolved asset path for the given asset name
     * @param  {String} asset
     * @param  {Boolean} uiAsset = false
     * @param  {Boolean} disableRetina = false
     * @return {String}
     */

  }, {
    key: 'getAssetPath',
    value: function getAssetPath(asset) {
      var _options$assets = this._options.assets,
          baseUrl = _options$assets.baseUrl,
          resolver = _options$assets.resolver;

      var path = baseUrl + '/' + asset;

      resolver = resolver || function (path) {
        return path;
      };

      // Don't prepend baseUrl to absolute urls
      if (asset.match(/(ftp|http|https):\/\//)) {
        path = asset;
      }

      // if (uiAsset) {
      //   if (!disableRetina) {
      //     // Append @2x if device's pixel ratio > 1
      //     const pixelRatio = (typeof window !== 'undefined' && window.devicePixelRatio) || 1
      //     if (pixelRatio > 1) {
      //       const regex = /\.[\w?=]+$/
      //       asset = asset.replace(regex, (match) => '@2x' + match)
      //     }
      //   }

      //   path = `${baseUrl}/ui/desktop/${asset}`
      // }

      // Do a little bit more work here to make life a bit easier for
      // the engine adapter
      var parts = asset.replace(/assets\//, '').split('/');
      var tool = parts[0];
      var assetInfo = {};
      switch (tool) {
        case 'art-filters':
          assetInfo = {
            identifier: parts[1], // e.g. imgly_hive
            type: parts[2].split('.')[0] // 'thumbnail' or 'weights'
          };
          return resolver('art-filter', assetInfo);

        case 'filters':
          assetInfo = {
            identifier: parts[1].replace(/\.png$/g, '')
          };
          return resolver('filter', assetInfo);

        case 'fonts':
          assetInfo = {
            identifier: parts[1].replace(/\.(woff|otf|ttf)$/g, '')
          };
          return resolver('font', assetInfo);

        case 'frames':
          assetInfo = {
            identifier: parts[1],
            filename: parts[2]
          };
          return resolver('frame', assetInfo);

        case 'overlays':
          assetInfo = {
            identifier: parts[1].replace(/\.(png|jpg|jpeg)$/g, '')
          };
          return resolver('overlay', assetInfo);

        case 'stickers':
          // Assumption: We should never be asking for the category backgroundImage
          // here anyway, since this is a headless bundle
          var svg = parts[3].endsWith('.svg');
          var thumb = parts[3] === 'thumbs';
          assetInfo = {
            category: parts[1],
            identifier: (svg ? parts[3] : parts[4]).replace(/\.(png|svg)$/g, ''),
            variant: svg ? 'svg' : thumb ? 'thumb' : 'base'
          };
          return resolver('sticker', assetInfo);

        case 'text-design':
          assetInfo = {
            type: parts[1] === 'fonts' ? 'font' : 'image',
            identifier: parts[2].replace(/\.(png|otf|ttf|woff2?)$/g, '')
          };
          return resolver('text-design', assetInfo);
      }

      if (typeof resolver !== 'undefined' && resolver !== null) {
        path = resolver(path);
      }

      return path;
    }

    /**
     * Returns the font loader
     * @return {PhotoEditorSDK.EngineWrapper.FontLoader}
     */

  }, {
    key: 'getFontLoader',
    value: function getFontLoader() {
      return this._fontLoader;
    }

    /**
     * Disposes the UI
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      if (this._disposed) {
        throw new Error('This instance of PhotoEditorSDK is already disposed.');
      }
      this._disposed = true;
      this._disposeEvents();
    }

    /** Render image given the configuration
     * @param {Object} config
     * @returns {Promise}
     **/

  }, {
    key: 'render',
    value: function render(config) {
      var _this2 = this;

      return this.deserialize(config).then(function () {
        return _this2.export();
      });
    }
  }]);

  return EngineWrapper;
}(__WEBPACK_IMPORTED_MODULE_4_globals__["d" /* EventEmitter */]);

/**
 * A unique string that represents this
 * @type {String}
 */


EngineWrapper.prototype.identifier = 'engine-wrapper';

// Export extendable stuff
EngineWrapper.Constants = __WEBPACK_IMPORTED_MODULE_4_globals__["c" /* Constants */];
EngineWrapper.Events = __WEBPACK_IMPORTED_MODULE_4_globals__["c" /* Constants */].EVENTS;
EngineWrapper.Utils = __WEBPACK_IMPORTED_MODULE_4_globals__["m" /* Utils */];
EngineWrapper.JSONLoader = __WEBPACK_IMPORTED_MODULE_6_shared_loaders_json_loader__["a" /* default */];
EngineWrapper.SDK = __WEBPACK_IMPORTED_MODULE_4_globals__["j" /* SDK */];



/***/ }),
/* 224 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(225);
var $Object = __webpack_require__(11).Object;
module.exports = function defineProperty(it, key, desc) {
  return $Object.defineProperty(it, key, desc);
};


/***/ }),
/* 225 */
/***/ (function(module, exports, __webpack_require__) {

var $export = __webpack_require__(14);
// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)
$export($export.S + $export.F * !__webpack_require__(19), 'Object', { defineProperty: __webpack_require__(22).f });


/***/ }),
/* 226 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(227);
module.exports = __webpack_require__(11).Object.setPrototypeOf;


/***/ }),
/* 227 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.3.19 Object.setPrototypeOf(O, proto)
var $export = __webpack_require__(14);
$export($export.S, 'Object', { setPrototypeOf: __webpack_require__(228).set });


/***/ }),
/* 228 */
/***/ (function(module, exports, __webpack_require__) {

// Works with __proto__ only. Old v8 can't work with null proto objects.
/* eslint-disable no-proto */
var isObject = __webpack_require__(23);
var anObject = __webpack_require__(28);
var check = function (O, proto) {
  anObject(O);
  if (!isObject(proto) && proto !== null) throw TypeError(proto + ": can't set as prototype!");
};
module.exports = {
  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line
    function (test, buggy, set) {
      try {
        set = __webpack_require__(30)(Function.call, __webpack_require__(96).f(Object.prototype, '__proto__').set, 2);
        set(test, []);
        buggy = !(test instanceof Array);
      } catch (e) { buggy = true; }
      return function setPrototypeOf(O, proto) {
        check(O, proto);
        if (buggy) O.__proto__ = proto;
        else set(O, proto);
        return O;
      };
    }({}, false) : undefined),
  check: check
};


/***/ }),
/* 229 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(230);
var $Object = __webpack_require__(11).Object;
module.exports = function create(P, D) {
  return $Object.create(P, D);
};


/***/ }),
/* 230 */
/***/ (function(module, exports, __webpack_require__) {

var $export = __webpack_require__(14);
// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])
$export($export.S, 'Object', { create: __webpack_require__(81) });


/***/ }),
/* 231 */
/***/ (function(module, exports, __webpack_require__) {

var dP = __webpack_require__(22);
var anObject = __webpack_require__(28);
var getKeys = __webpack_require__(49);

module.exports = __webpack_require__(19) ? Object.defineProperties : function defineProperties(O, Properties) {
  anObject(O);
  var keys = getKeys(Properties);
  var length = keys.length;
  var i = 0;
  var P;
  while (length > i) dP.f(O, P = keys[i++], Properties[P]);
  return O;
};


/***/ }),
/* 232 */
/***/ (function(module, exports, __webpack_require__) {

// false -> Array#indexOf
// true  -> Array#includes
var toIObject = __webpack_require__(35);
var toLength = __webpack_require__(82);
var toAbsoluteIndex = __webpack_require__(233);
module.exports = function (IS_INCLUDES) {
  return function ($this, el, fromIndex) {
    var O = toIObject($this);
    var length = toLength(O.length);
    var index = toAbsoluteIndex(fromIndex, length);
    var value;
    // Array#includes uses SameValueZero equality algorithm
    // eslint-disable-next-line no-self-compare
    if (IS_INCLUDES && el != el) while (length > index) {
      value = O[index++];
      // eslint-disable-next-line no-self-compare
      if (value != value) return true;
    // Array#indexOf ignores holes, Array#includes - not
    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {
      if (O[index] === el) return IS_INCLUDES || index || 0;
    } return !IS_INCLUDES && -1;
  };
};


/***/ }),
/* 233 */
/***/ (function(module, exports, __webpack_require__) {

var toInteger = __webpack_require__(99);
var max = Math.max;
var min = Math.min;
module.exports = function (index, length) {
  index = toInteger(index);
  return index < 0 ? max(index + length, 0) : min(index, length);
};


/***/ }),
/* 234 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(235);
module.exports = __webpack_require__(11).Object.getPrototypeOf;


/***/ }),
/* 235 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.9 Object.getPrototypeOf(O)
var toObject = __webpack_require__(44);
var $getPrototypeOf = __webpack_require__(139);

__webpack_require__(103)('getPrototypeOf', function () {
  return function getPrototypeOf(it) {
    return $getPrototypeOf(toObject(it));
  };
});


/***/ }),
/* 236 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk__ = __webpack_require__(31);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_photoeditorsdk__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_shared_log__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_browser__ = __webpack_require__(477);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_shared_loaders_json_loader__ = __webpack_require__(71);


function _defineProperty(obj, key, value) { if (key in obj) { __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var SDKUtils = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk___default.a.Utils;
var Vector2 = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk___default.a.Math.Vector2;


var UIUtils = {
  /**
   * Returns the inner dimensions (size - padding) of the given
   * DOM element
   * @param  {HTMLElement} element
   * @return {Vector2}
   */
  getInnerDimensionsForElement: function getInnerDimensionsForElement(element) {
    var size = new Vector2(element.offsetWidth, element.offsetHeight);
    var computedStyle = window.getComputedStyle(element, null);
    size.x -= parseInt(computedStyle.getPropertyValue('padding-left'), 10);
    size.x -= parseInt(computedStyle.getPropertyValue('padding-right'), 10);
    size.y -= parseInt(computedStyle.getPropertyValue('padding-top'), 10);
    size.y -= parseInt(computedStyle.getPropertyValue('padding-bottom'), 10);
    return size;
  },


  /**
   * Gets the x and y position for the given event.
   * @param {Event} e
   * @return {Vector2}
   */
  getEventPosition: function getEventPosition(e) {
    var x = e.clientX;
    var y = e.clientY;
    if (e.type.indexOf('touch') !== -1) {
      if (!e.touches.length) return;

      x = e.touches[0].clientX;
      y = e.touches[0].clientY;
    }
    return new Vector2(x, y);
  },


  /**
   * Creates a canvas with a transparency pattern
   * @return {Canvas}
   */
  createTransparentPatternCanvas: function createTransparentPatternCanvas() {
    var canvas = document.createElement('canvas');
    var context = canvas.getContext('2d');

    canvas.width = 10;
    canvas.height = 10;

    context.fillStyle = 'white';
    context.fillRect(0, 0, canvas.width, canvas.height);
    context.fillStyle = '#cccccc';
    context.fillRect(0, 0, canvas.width / 2, canvas.height / 2);
    context.fillRect(canvas.width / 2, canvas.height / 2, canvas.width, canvas.height);

    return canvas;
  },


  /**
   * Checks if the browser supports canvas.msToBlob
   * @return {Boolean}
   */
  supportsMSBlob: function supportsMSBlob() {
    var canvas = document.createElement('canvas');
    return typeof canvas.msToBlob !== 'undefined';
  },


  /**
   * Translates the given key using the given options
   * @param  {Object} phrases
   * @param  {String} key
   * @param  {Object} interpolationOptions = {}
   * @return {String}
   */
  translate: function translate(phrases, key) {
    var interpolationOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

    var response = this.fetch(phrases, key);
    if (!response) {
      __WEBPACK_IMPORTED_MODULE_2_shared_log__["a" /* default */].info('Utils#translate', 'Unable to translate `' + key + '`');

      // ------------------------------------------------------------------------------------------
      // Remove this part in the next major version update
      var newToOldLocalizationKeyMap = __webpack_require__(478);
      var oldKey = newToOldLocalizationKeyMap[key];
      if (oldKey != null) {
        __WEBPACK_IMPORTED_MODULE_2_shared_log__["a" /* default */].warn('Utils#translate', 'Trying to find localized string for old key: `' + oldKey + '`. Please update your localization to use the new key as soon as possible. Support for the old, deprecated key will be dropped with the next major version update.');
        return this.translate(phrases, oldKey, interpolationOptions);
      }
      // ------------------------------------------------------------------------------------------

      return null;
    }
    for (var _key in interpolationOptions) {
      response = response.replace('${' + _key + '}', interpolationOptions[_key]);
    }
    return response;
  },


  /**
   * Gets the property value at `path` of `object`
   * @param  {Object} object
   * @param  {String} path
   * @param  {?} [defaultValue]
   * @return {?}
   */
  fetch: function fetch(object, path, defaultValue) {
    // Replace indexes with property accessors
    path = path.replace(/\[(\w+)]/g, '.$1');
    // Strip leading dot (when path begins with [0] for example)
    path = path.replace(/^\./, '');

    var pathSegments = path.split('.');
    for (var i = 0; i < pathSegments.length; i++) {
      var segment = pathSegments[i];
      object = object[segment];
      if (!object) {
        break;
      }
    }

    if (typeof object === 'undefined') {
      return false;
    }

    return object;
  },


  /**
   * Checks whether the user agent represents a mobile device
   * @return {Boolean}
   */
  isMobile: function isMobile() {
    var a = navigator.userAgent || navigator.vendor || window.opera;
    /* eslint-disable */
    return (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))
    );
    /* eslint-enable */
  },


  /**
   * Selects the `selectedItems` from `items`. `selector` is called for every item, return value
   * is matched against `selectedItems`
   * @param  {Array} items
   * @param  {Array} selectedItems
   * @param  {Function} [selector = null]
   * @return {Array}
   */
  select: function select(items, selectedItems) {
    var selector = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;

    if (!selector) selector = function selector(i) {
      return i;
    };

    var newItems = [];
    selectedItems.forEach(function (selectedItem) {
      items.forEach(function (item) {
        var itemIdentifier = selector(item);
        if (itemIdentifier === selectedItem) {
          newItems.push(item);
        }
      });
    });
    return newItems;
  },


  /**
   * Gets the given URL using JSON(P)
   * @param  {String} url
   * @return {Promise}
   */
  getJSONP: function getJSONP(url) {
    var loader = new __WEBPACK_IMPORTED_MODULE_4_shared_loaders_json_loader__["a" /* default */](url);
    return loader.load();
  },


  /**
   * Clones the given `categories` array
   * @param  {Object[]} categories
   * @param {String} itemsProperty
   * @return {Object[]}
   */
  cloneCategories: function cloneCategories(categories, itemsProperty) {
    return categories.map(function (category) {
      category = SDKUtils.clone(category);
      category[itemsProperty] = category[itemsProperty].slice(0);
      return category;
    });
  },


  /**
   * Merges the given `newCategories` into the given `categories`
   * @param  {Object[]} categories
   * @param  {Object[]} newCategories
   * @param  {String} itemsProperty
   * @private
   */
  mergeCategories: function mergeCategories(categories, newCategories, itemsProperty) {
    categories = this.cloneCategories(categories, itemsProperty);

    var existingCategory = null;
    newCategories.forEach(function (newCategory) {
      categories.forEach(function (category) {
        if (newCategory.identifier === category.identifier) {
          existingCategory = category;
        }
      });

      if (!existingCategory) {
        categories.push(newCategory);
      } else {
        existingCategory[itemsProperty] = existingCategory[itemsProperty].concat(newCategory[itemsProperty]);
      }
    });

    return categories;
  },


  /**
   * Returns an array with categories.
   * All filters defined in the root level of the given array are converted to 'hidden' categories
   * @param categories – Categories
   * @param {String} itemsProperty
   * @return {Array} – Converted categories and filters
   */
  wrapFiltersInCategories: function wrapFiltersInCategories(categories, itemsProperty) {
    return categories.map(function (item) {
      var category = item;

      if (!(itemsProperty in category)) {
        category = _defineProperty({
          identifier: 'imgly_filters_wrapped-' + item.identifier,
          displayFlat: true
        }, itemsProperty, [item]);
      }

      return category;
    });
  },


  /**
   * Returns a camelized style object for the given DOMElement
   * @param  {HTMLElement} el
   * @return {Object}
   */
  getStyleObject: function getStyleObject(el) {
    var styleProperties = window.getComputedStyle(el);
    var styleObject = {};
    for (var property in styleProperties) {
      var value = styleProperties.getPropertyValue(property);
      var camelizedAttr = property.replace(/-([a-z])/g, function (a, b) {
        return b.toUpperCase();
      });
      if (value !== '') {
        styleObject[camelizedAttr] = value;
      }
    }
    return styleObject;
  },


  /**
   * Applies the given styles to the given element
   * @param  {HTMLElement} element
   * @param  {Object} styles
   */
  styleElement: function styleElement(element, styles) {
    for (var prop in styles) {
      element.style[prop] = styles[prop];
    }
  },


  /**
   * Debounces the given function to trigger only every so often
   * @param  {Function} fn
   * @param  {Number} wait
   * @param  {Boolean} immediate
   * @return {Function}
   */
  debounce: function debounce(fn, wait, immediate) {
    var timeout;
    return function () {
      var _this = this;

      var args = arguments;
      var later = function later() {
        timeout = null;
        if (!immediate) fn.apply(_this, args);
      };
      var callNow = immediate && !timeout;
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
      if (callNow) fn.apply(this, args);
    };
  },


  /**
   * Finds the native scrollbar width for the current browser
   * @return {Number}
   */
  getScrollbarWidth: function getScrollbarWidth() {
    var outer = document.createElement('div');
    outer.style.visibility = 'hidden';
    outer.style.width = '100px';
    outer.style.msOverflowStyle = 'scrollbar';
    document.body.appendChild(outer);

    var widthNoScroll = outer.offsetWidth;
    outer.style.overflow = 'scroll';

    var inner = document.createElement('div');
    inner.style.width = '100%';
    outer.appendChild(inner);

    var widthWithScroll = inner.offsetWidth;
    outer.parentNode.removeChild(outer);

    return widthNoScroll - widthWithScroll;
  },


  /**
   * Finds the closest integer fraction for the given Number
   * @param  {Number} ratio
   * @param  {Number} maxIterations = 100
   * @return {Vector2}
   */
  findIntegerFraction: function findIntegerFraction(ratio) {
    var maxIterations = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100;

    var bestDelta = Number.MAX_VALUE;
    var bestX = 0;
    var bestY = 0;
    var x = 1;
    var y = 1;
    for (var iterations = 0; iterations < maxIterations; iterations++) {
      var delta = x / y - ratio;

      if (delta < 0) {
        x++;
      } else if (delta > 0) {
        y++;
      } else {
        return new Vector2(x, y);
      }

      var newDelta = Math.abs(x / y - ratio);
      if (newDelta < bestDelta) {
        bestDelta = newDelta;
        bestX = x;
        bestY = y;
      }
    }

    return new Vector2(bestX, bestY);
  },


  /**
   * Returns the given number with the given amount of decimals, but removes trailing
   * zeroes by casting it to a float
   * @param  {Number} number
   * @param  {Number} decimals
   * @return {Number}
   */
  toFixed: function toFixed(number) {
    var decimals = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;

    var fixed = number.toFixed(decimals);
    return parseFloat(fixed);
  },


  /**
   * Returns the given string with the first character uppercased
   * @param  {String} str
   * @return {String}
   */
  capitalize: function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
  },


  /**
   * Returns a new object with flipped values and keys
   * @param  {Object} obj
   * @return {Object}
   */
  flipObject: function flipObject(obj) {
    var newObj = {};
    for (var key in obj) {
      newObj[obj[key]] = key;
    }
    return newObj;
  },


  Browser: __WEBPACK_IMPORTED_MODULE_3__utils_browser__["a" /* default */]
};

/* harmony default export */ __webpack_exports__["a"] = (UIUtils);

/***/ }),
/* 237 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__sdk__ = __webpack_require__(140);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib_polyfills_js__ = __webpack_require__(318);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib_polyfills_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__lib_polyfills_js__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__lib_math___ = __webpack_require__(165);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__operations___ = __webpack_require__(166);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__engine___ = __webpack_require__(85);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__lib_color__ = __webpack_require__(66);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__operations_operation__ = __webpack_require__(167);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__lib_event_emitter__ = __webpack_require__(67);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__lib_utils__ = __webpack_require__(32);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__lib_env__ = __webpack_require__(319);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__lib_operations_stack__ = __webpack_require__(169);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__lib_exif__ = __webpack_require__(120);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__lib_image__ = __webpack_require__(89);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__shared_vendor_promise__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__lib_configurable__ = __webpack_require__(70);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__shared_log__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__shared_loaders__ = __webpack_require__(171);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__constants__ = __webpack_require__(40);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__lib_base64__ = __webpack_require__(65);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 * @license
 */

/* eslint-disable import/first */



/**
 * The current version of the SDK
 * @name PhotoEditorSDK.version
 * @internal Keep in sync with package.json
 */
__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].version = __webpack_require__(170).version;

// special polyfills for e.g. IE 11


// Namespaces

__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Math = __WEBPACK_IMPORTED_MODULE_2__lib_math___;


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Operations = __WEBPACK_IMPORTED_MODULE_3__operations___;


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Engine = __WEBPACK_IMPORTED_MODULE_4__engine___["a" /* default */];

// Classes

__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Color = __WEBPACK_IMPORTED_MODULE_5__lib_color__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Operation = __WEBPACK_IMPORTED_MODULE_6__operations_operation__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].EventEmitter = __WEBPACK_IMPORTED_MODULE_7__lib_event_emitter__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Utils = __WEBPACK_IMPORTED_MODULE_8__lib_utils__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Env = __WEBPACK_IMPORTED_MODULE_9__lib_env__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].OperationsStack = __WEBPACK_IMPORTED_MODULE_10__lib_operations_stack__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].EXIF = __WEBPACK_IMPORTED_MODULE_11__lib_exif__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Image = __WEBPACK_IMPORTED_MODULE_12__lib_image__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Promise = __WEBPACK_IMPORTED_MODULE_13__shared_vendor_promise__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Configurable = __WEBPACK_IMPORTED_MODULE_14__lib_configurable__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Log = __WEBPACK_IMPORTED_MODULE_15__shared_log__["a" /* default */];


__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Loaders = __WEBPACK_IMPORTED_MODULE_16__shared_loaders__;
// Constants

__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].RenderType = __WEBPACK_IMPORTED_MODULE_17__constants__["RenderType"];
__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].ImageFormat = __WEBPACK_IMPORTED_MODULE_17__constants__["ImageFormat"];
__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].OptionType = __WEBPACK_IMPORTED_MODULE_17__constants__["OptionType"];
__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].RendererType = __WEBPACK_IMPORTED_MODULE_17__constants__["RendererType"];
__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].UniformType = __WEBPACK_IMPORTED_MODULE_17__constants__["UniformType"];

// Libs

__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].Base64 = __WEBPACK_IMPORTED_MODULE_18__lib_base64__["a" /* default */];

__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */].UI = {};

/* harmony default export */ __webpack_exports__["default"] = (__WEBPACK_IMPORTED_MODULE_0__sdk__["a" /* default */]);

/***/ }),
/* 238 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(50);
__webpack_require__(62);
module.exports = __webpack_require__(105).f('iterator');


/***/ }),
/* 239 */
/***/ (function(module, exports, __webpack_require__) {

var toInteger = __webpack_require__(99);
var defined = __webpack_require__(98);
// true  -> String#at
// false -> String#codePointAt
module.exports = function (TO_STRING) {
  return function (that, pos) {
    var s = String(defined(that));
    var i = toInteger(pos);
    var l = s.length;
    var a, b;
    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;
    a = s.charCodeAt(i);
    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff
      ? TO_STRING ? s.charAt(i) : a
      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;
  };
};


/***/ }),
/* 240 */
/***/ (function(module, exports, __webpack_require__) {

var create = __webpack_require__(81);
var descriptor = __webpack_require__(57);
var setToStringTag = __webpack_require__(61);
var IteratorPrototype = {};

// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()
__webpack_require__(34)(IteratorPrototype, __webpack_require__(17)('iterator'), function () { return this; });

module.exports = function (Constructor, NAME, next) {
  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });
  setToStringTag(Constructor, NAME + ' Iterator');
};


/***/ }),
/* 241 */
/***/ (function(module, exports, __webpack_require__) {

var addToUnscopables = __webpack_require__(242);
var step = __webpack_require__(142);
var Iterators = __webpack_require__(51);
var toIObject = __webpack_require__(35);

// 22.1.3.4 Array.prototype.entries()
// 22.1.3.13 Array.prototype.keys()
// 22.1.3.29 Array.prototype.values()
// 22.1.3.30 Array.prototype[@@iterator]()
module.exports = __webpack_require__(104)(Array, 'Array', function (iterated, kind) {
  this._t = toIObject(iterated); // target
  this._i = 0;                   // next index
  this._k = kind;                // kind
// 22.1.5.2.1 %ArrayIteratorPrototype%.next()
}, function () {
  var O = this._t;
  var kind = this._k;
  var index = this._i++;
  if (!O || index >= O.length) {
    this._t = undefined;
    return step(1);
  }
  if (kind == 'keys') return step(0, index);
  if (kind == 'values') return step(0, O[index]);
  return step(0, [index, O[index]]);
}, 'values');

// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)
Iterators.Arguments = Iterators.Array;

addToUnscopables('keys');
addToUnscopables('values');
addToUnscopables('entries');


/***/ }),
/* 242 */
/***/ (function(module, exports) {

module.exports = function () { /* empty */ };


/***/ }),
/* 243 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(244);
__webpack_require__(109);
__webpack_require__(247);
__webpack_require__(248);
module.exports = __webpack_require__(11).Symbol;


/***/ }),
/* 244 */
/***/ (function(module, exports, __webpack_require__) {

// ECMAScript 6 symbols shim
var global = __webpack_require__(16);
var has = __webpack_require__(43);
var DESCRIPTORS = __webpack_require__(19);
var $export = __webpack_require__(14);
var redefine = __webpack_require__(141);
var META = __webpack_require__(106).KEY;
var $fails = __webpack_require__(42);
var shared = __webpack_require__(101);
var setToStringTag = __webpack_require__(61);
var uid = __webpack_require__(83);
var wks = __webpack_require__(17);
var wksExt = __webpack_require__(105);
var wksDefine = __webpack_require__(107);
var enumKeys = __webpack_require__(245);
var isArray = __webpack_require__(143);
var anObject = __webpack_require__(28);
var isObject = __webpack_require__(23);
var toObject = __webpack_require__(44);
var toIObject = __webpack_require__(35);
var toPrimitive = __webpack_require__(95);
var createDesc = __webpack_require__(57);
var _create = __webpack_require__(81);
var gOPNExt = __webpack_require__(246);
var $GOPD = __webpack_require__(96);
var $GOPS = __webpack_require__(108);
var $DP = __webpack_require__(22);
var $keys = __webpack_require__(49);
var gOPD = $GOPD.f;
var dP = $DP.f;
var gOPN = gOPNExt.f;
var $Symbol = global.Symbol;
var $JSON = global.JSON;
var _stringify = $JSON && $JSON.stringify;
var PROTOTYPE = 'prototype';
var HIDDEN = wks('_hidden');
var TO_PRIMITIVE = wks('toPrimitive');
var isEnum = {}.propertyIsEnumerable;
var SymbolRegistry = shared('symbol-registry');
var AllSymbols = shared('symbols');
var OPSymbols = shared('op-symbols');
var ObjectProto = Object[PROTOTYPE];
var USE_NATIVE = typeof $Symbol == 'function' && !!$GOPS.f;
var QObject = global.QObject;
// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173
var setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;

// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687
var setSymbolDesc = DESCRIPTORS && $fails(function () {
  return _create(dP({}, 'a', {
    get: function () { return dP(this, 'a', { value: 7 }).a; }
  })).a != 7;
}) ? function (it, key, D) {
  var protoDesc = gOPD(ObjectProto, key);
  if (protoDesc) delete ObjectProto[key];
  dP(it, key, D);
  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);
} : dP;

var wrap = function (tag) {
  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);
  sym._k = tag;
  return sym;
};

var isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {
  return typeof it == 'symbol';
} : function (it) {
  return it instanceof $Symbol;
};

var $defineProperty = function defineProperty(it, key, D) {
  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);
  anObject(it);
  key = toPrimitive(key, true);
  anObject(D);
  if (has(AllSymbols, key)) {
    if (!D.enumerable) {
      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));
      it[HIDDEN][key] = true;
    } else {
      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;
      D = _create(D, { enumerable: createDesc(0, false) });
    } return setSymbolDesc(it, key, D);
  } return dP(it, key, D);
};
var $defineProperties = function defineProperties(it, P) {
  anObject(it);
  var keys = enumKeys(P = toIObject(P));
  var i = 0;
  var l = keys.length;
  var key;
  while (l > i) $defineProperty(it, key = keys[i++], P[key]);
  return it;
};
var $create = function create(it, P) {
  return P === undefined ? _create(it) : $defineProperties(_create(it), P);
};
var $propertyIsEnumerable = function propertyIsEnumerable(key) {
  var E = isEnum.call(this, key = toPrimitive(key, true));
  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;
  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;
};
var $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {
  it = toIObject(it);
  key = toPrimitive(key, true);
  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;
  var D = gOPD(it, key);
  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;
  return D;
};
var $getOwnPropertyNames = function getOwnPropertyNames(it) {
  var names = gOPN(toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);
  } return result;
};
var $getOwnPropertySymbols = function getOwnPropertySymbols(it) {
  var IS_OP = it === ObjectProto;
  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);
  } return result;
};

// 19.4.1.1 Symbol([description])
if (!USE_NATIVE) {
  $Symbol = function Symbol() {
    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');
    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);
    var $set = function (value) {
      if (this === ObjectProto) $set.call(OPSymbols, value);
      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;
      setSymbolDesc(this, tag, createDesc(1, value));
    };
    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });
    return wrap(tag);
  };
  redefine($Symbol[PROTOTYPE], 'toString', function toString() {
    return this._k;
  });

  $GOPD.f = $getOwnPropertyDescriptor;
  $DP.f = $defineProperty;
  __webpack_require__(144).f = gOPNExt.f = $getOwnPropertyNames;
  __webpack_require__(58).f = $propertyIsEnumerable;
  $GOPS.f = $getOwnPropertySymbols;

  if (DESCRIPTORS && !__webpack_require__(60)) {
    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);
  }

  wksExt.f = function (name) {
    return wrap(wks(name));
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });

for (var es6Symbols = (
  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14
  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'
).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);

for (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);

$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {
  // 19.4.2.1 Symbol.for(key)
  'for': function (key) {
    return has(SymbolRegistry, key += '')
      ? SymbolRegistry[key]
      : SymbolRegistry[key] = $Symbol(key);
  },
  // 19.4.2.5 Symbol.keyFor(sym)
  keyFor: function keyFor(sym) {
    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');
    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;
  },
  useSetter: function () { setter = true; },
  useSimple: function () { setter = false; }
});

$export($export.S + $export.F * !USE_NATIVE, 'Object', {
  // 19.1.2.2 Object.create(O [, Properties])
  create: $create,
  // 19.1.2.4 Object.defineProperty(O, P, Attributes)
  defineProperty: $defineProperty,
  // 19.1.2.3 Object.defineProperties(O, Properties)
  defineProperties: $defineProperties,
  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,
  // 19.1.2.7 Object.getOwnPropertyNames(O)
  getOwnPropertyNames: $getOwnPropertyNames,
  // 19.1.2.8 Object.getOwnPropertySymbols(O)
  getOwnPropertySymbols: $getOwnPropertySymbols
});

// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives
// https://bugs.chromium.org/p/v8/issues/detail?id=3443
var FAILS_ON_PRIMITIVES = $fails(function () { $GOPS.f(1); });

$export($export.S + $export.F * FAILS_ON_PRIMITIVES, 'Object', {
  getOwnPropertySymbols: function getOwnPropertySymbols(it) {
    return $GOPS.f(toObject(it));
  }
});

// 24.3.2 JSON.stringify(value [, replacer [, space]])
$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {
  var S = $Symbol();
  // MS Edge converts symbol values to JSON as {}
  // WebKit converts symbol values to JSON as null
  // V8 throws on boxed symbols
  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';
})), 'JSON', {
  stringify: function stringify(it) {
    var args = [it];
    var i = 1;
    var replacer, $replacer;
    while (arguments.length > i) args.push(arguments[i++]);
    $replacer = replacer = args[1];
    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined
    if (!isArray(replacer)) replacer = function (key, value) {
      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);
      if (!isSymbol(value)) return value;
    };
    args[1] = replacer;
    return _stringify.apply($JSON, args);
  }
});

// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)
$Symbol[PROTOTYPE][TO_PRIMITIVE] || __webpack_require__(34)($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);
// 19.4.3.5 Symbol.prototype[@@toStringTag]
setToStringTag($Symbol, 'Symbol');
// 20.2.1.9 Math[@@toStringTag]
setToStringTag(Math, 'Math', true);
// 24.3.3 JSON[@@toStringTag]
setToStringTag(global.JSON, 'JSON', true);


/***/ }),
/* 245 */
/***/ (function(module, exports, __webpack_require__) {

// all enumerable object keys, includes symbols
var getKeys = __webpack_require__(49);
var gOPS = __webpack_require__(108);
var pIE = __webpack_require__(58);
module.exports = function (it) {
  var result = getKeys(it);
  var getSymbols = gOPS.f;
  if (getSymbols) {
    var symbols = getSymbols(it);
    var isEnum = pIE.f;
    var i = 0;
    var key;
    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);
  } return result;
};


/***/ }),
/* 246 */
/***/ (function(module, exports, __webpack_require__) {

// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window
var toIObject = __webpack_require__(35);
var gOPN = __webpack_require__(144).f;
var toString = {}.toString;

var windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames
  ? Object.getOwnPropertyNames(window) : [];

var getWindowNames = function (it) {
  try {
    return gOPN(it);
  } catch (e) {
    return windowNames.slice();
  }
};

module.exports.f = function getOwnPropertyNames(it) {
  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));
};


/***/ }),
/* 247 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(107)('asyncIterator');


/***/ }),
/* 248 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(107)('observable');


/***/ }),
/* 249 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(109);
__webpack_require__(50);
__webpack_require__(62);
__webpack_require__(250);
__webpack_require__(254);
__webpack_require__(255);
module.exports = __webpack_require__(11).Promise;


/***/ }),
/* 250 */
/***/ (function(module, exports, __webpack_require__) {

var LIBRARY = __webpack_require__(60);
var global = __webpack_require__(16);
var ctx = __webpack_require__(30);
var classof = __webpack_require__(84);
var $export = __webpack_require__(14);
var isObject = __webpack_require__(23);
var aFunction = __webpack_require__(56);
var anInstance = __webpack_require__(110);
var forOf = __webpack_require__(63);
var speciesConstructor = __webpack_require__(147);
var task = __webpack_require__(112).set;
var microtask = __webpack_require__(252)();
var newPromiseCapabilityModule = __webpack_require__(113);
var perform = __webpack_require__(148);
var userAgent = __webpack_require__(253);
var promiseResolve = __webpack_require__(149);
var PROMISE = 'Promise';
var TypeError = global.TypeError;
var process = global.process;
var versions = process && process.versions;
var v8 = versions && versions.v8 || '';
var $Promise = global[PROMISE];
var isNode = classof(process) == 'process';
var empty = function () { /* empty */ };
var Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;
var newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;

var USE_NATIVE = !!function () {
  try {
    // correct subclassing with @@species support
    var promise = $Promise.resolve(1);
    var FakePromise = (promise.constructor = {})[__webpack_require__(17)('species')] = function (exec) {
      exec(empty, empty);
    };
    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test
    return (isNode || typeof PromiseRejectionEvent == 'function')
      && promise.then(empty) instanceof FakePromise
      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables
      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565
      // we can't detect it synchronously, so just check versions
      && v8.indexOf('6.6') !== 0
      && userAgent.indexOf('Chrome/66') === -1;
  } catch (e) { /* empty */ }
}();

// helpers
var isThenable = function (it) {
  var then;
  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;
};
var notify = function (promise, isReject) {
  if (promise._n) return;
  promise._n = true;
  var chain = promise._c;
  microtask(function () {
    var value = promise._v;
    var ok = promise._s == 1;
    var i = 0;
    var run = function (reaction) {
      var handler = ok ? reaction.ok : reaction.fail;
      var resolve = reaction.resolve;
      var reject = reaction.reject;
      var domain = reaction.domain;
      var result, then, exited;
      try {
        if (handler) {
          if (!ok) {
            if (promise._h == 2) onHandleUnhandled(promise);
            promise._h = 1;
          }
          if (handler === true) result = value;
          else {
            if (domain) domain.enter();
            result = handler(value); // may throw
            if (domain) {
              domain.exit();
              exited = true;
            }
          }
          if (result === reaction.promise) {
            reject(TypeError('Promise-chain cycle'));
          } else if (then = isThenable(result)) {
            then.call(result, resolve, reject);
          } else resolve(result);
        } else reject(value);
      } catch (e) {
        if (domain && !exited) domain.exit();
        reject(e);
      }
    };
    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach
    promise._c = [];
    promise._n = false;
    if (isReject && !promise._h) onUnhandled(promise);
  });
};
var onUnhandled = function (promise) {
  task.call(global, function () {
    var value = promise._v;
    var unhandled = isUnhandled(promise);
    var result, handler, console;
    if (unhandled) {
      result = perform(function () {
        if (isNode) {
          process.emit('unhandledRejection', value, promise);
        } else if (handler = global.onunhandledrejection) {
          handler({ promise: promise, reason: value });
        } else if ((console = global.console) && console.error) {
          console.error('Unhandled promise rejection', value);
        }
      });
      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should
      promise._h = isNode || isUnhandled(promise) ? 2 : 1;
    } promise._a = undefined;
    if (unhandled && result.e) throw result.v;
  });
};
var isUnhandled = function (promise) {
  return promise._h !== 1 && (promise._a || promise._c).length === 0;
};
var onHandleUnhandled = function (promise) {
  task.call(global, function () {
    var handler;
    if (isNode) {
      process.emit('rejectionHandled', promise);
    } else if (handler = global.onrejectionhandled) {
      handler({ promise: promise, reason: promise._v });
    }
  });
};
var $reject = function (value) {
  var promise = this;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  promise._v = value;
  promise._s = 2;
  if (!promise._a) promise._a = promise._c.slice();
  notify(promise, true);
};
var $resolve = function (value) {
  var promise = this;
  var then;
  if (promise._d) return;
  promise._d = true;
  promise = promise._w || promise; // unwrap
  try {
    if (promise === value) throw TypeError("Promise can't be resolved itself");
    if (then = isThenable(value)) {
      microtask(function () {
        var wrapper = { _w: promise, _d: false }; // wrap
        try {
          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));
        } catch (e) {
          $reject.call(wrapper, e);
        }
      });
    } else {
      promise._v = value;
      promise._s = 1;
      notify(promise, false);
    }
  } catch (e) {
    $reject.call({ _w: promise, _d: false }, e); // wrap
  }
};

// constructor polyfill
if (!USE_NATIVE) {
  // 25.4.3.1 Promise(executor)
  $Promise = function Promise(executor) {
    anInstance(this, $Promise, PROMISE, '_h');
    aFunction(executor);
    Internal.call(this);
    try {
      executor(ctx($resolve, this, 1), ctx($reject, this, 1));
    } catch (err) {
      $reject.call(this, err);
    }
  };
  // eslint-disable-next-line no-unused-vars
  Internal = function Promise(executor) {
    this._c = [];             // <- awaiting reactions
    this._a = undefined;      // <- checked in isUnhandled reactions
    this._s = 0;              // <- state
    this._d = false;          // <- done
    this._v = undefined;      // <- value
    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled
    this._n = false;          // <- notify
  };
  Internal.prototype = __webpack_require__(114)($Promise.prototype, {
    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)
    then: function then(onFulfilled, onRejected) {
      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));
      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;
      reaction.fail = typeof onRejected == 'function' && onRejected;
      reaction.domain = isNode ? process.domain : undefined;
      this._c.push(reaction);
      if (this._a) this._a.push(reaction);
      if (this._s) notify(this, false);
      return reaction.promise;
    },
    // 25.4.5.1 Promise.prototype.catch(onRejected)
    'catch': function (onRejected) {
      return this.then(undefined, onRejected);
    }
  });
  OwnPromiseCapability = function () {
    var promise = new Internal();
    this.promise = promise;
    this.resolve = ctx($resolve, promise, 1);
    this.reject = ctx($reject, promise, 1);
  };
  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {
    return C === $Promise || C === Wrapper
      ? new OwnPromiseCapability(C)
      : newGenericPromiseCapability(C);
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });
__webpack_require__(61)($Promise, PROMISE);
__webpack_require__(150)(PROMISE);
Wrapper = __webpack_require__(11)[PROMISE];

// statics
$export($export.S + $export.F * !USE_NATIVE, PROMISE, {
  // 25.4.4.5 Promise.reject(r)
  reject: function reject(r) {
    var capability = newPromiseCapability(this);
    var $$reject = capability.reject;
    $$reject(r);
    return capability.promise;
  }
});
$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {
  // 25.4.4.6 Promise.resolve(x)
  resolve: function resolve(x) {
    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);
  }
});
$export($export.S + $export.F * !(USE_NATIVE && __webpack_require__(151)(function (iter) {
  $Promise.all(iter)['catch'](empty);
})), PROMISE, {
  // 25.4.4.1 Promise.all(iterable)
  all: function all(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var resolve = capability.resolve;
    var reject = capability.reject;
    var result = perform(function () {
      var values = [];
      var index = 0;
      var remaining = 1;
      forOf(iterable, false, function (promise) {
        var $index = index++;
        var alreadyCalled = false;
        values.push(undefined);
        remaining++;
        C.resolve(promise).then(function (value) {
          if (alreadyCalled) return;
          alreadyCalled = true;
          values[$index] = value;
          --remaining || resolve(values);
        }, reject);
      });
      --remaining || resolve(values);
    });
    if (result.e) reject(result.v);
    return capability.promise;
  },
  // 25.4.4.4 Promise.race(iterable)
  race: function race(iterable) {
    var C = this;
    var capability = newPromiseCapability(C);
    var reject = capability.reject;
    var result = perform(function () {
      forOf(iterable, false, function (promise) {
        C.resolve(promise).then(capability.resolve, reject);
      });
    });
    if (result.e) reject(result.v);
    return capability.promise;
  }
});


/***/ }),
/* 251 */
/***/ (function(module, exports) {

// fast apply, http://jsperf.lnkit.com/fast-apply/5
module.exports = function (fn, args, that) {
  var un = that === undefined;
  switch (args.length) {
    case 0: return un ? fn()
                      : fn.call(that);
    case 1: return un ? fn(args[0])
                      : fn.call(that, args[0]);
    case 2: return un ? fn(args[0], args[1])
                      : fn.call(that, args[0], args[1]);
    case 3: return un ? fn(args[0], args[1], args[2])
                      : fn.call(that, args[0], args[1], args[2]);
    case 4: return un ? fn(args[0], args[1], args[2], args[3])
                      : fn.call(that, args[0], args[1], args[2], args[3]);
  } return fn.apply(that, args);
};


/***/ }),
/* 252 */
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__(16);
var macrotask = __webpack_require__(112).set;
var Observer = global.MutationObserver || global.WebKitMutationObserver;
var process = global.process;
var Promise = global.Promise;
var isNode = __webpack_require__(59)(process) == 'process';

module.exports = function () {
  var head, last, notify;

  var flush = function () {
    var parent, fn;
    if (isNode && (parent = process.domain)) parent.exit();
    while (head) {
      fn = head.fn;
      head = head.next;
      try {
        fn();
      } catch (e) {
        if (head) notify();
        else last = undefined;
        throw e;
      }
    } last = undefined;
    if (parent) parent.enter();
  };

  // Node.js
  if (isNode) {
    notify = function () {
      process.nextTick(flush);
    };
  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339
  } else if (Observer && !(global.navigator && global.navigator.standalone)) {
    var toggle = true;
    var node = document.createTextNode('');
    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new
    notify = function () {
      node.data = toggle = !toggle;
    };
  // environments with maybe non-completely correct, but existent Promise
  } else if (Promise && Promise.resolve) {
    // Promise.resolve without an argument throws an error in LG WebOS 2
    var promise = Promise.resolve(undefined);
    notify = function () {
      promise.then(flush);
    };
  // for other environments - macrotask based on:
  // - setImmediate
  // - MessageChannel
  // - window.postMessag
  // - onreadystatechange
  // - setTimeout
  } else {
    notify = function () {
      // strange IE + webpack dev server bug - use .call(global)
      macrotask.call(global, flush);
    };
  }

  return function (fn) {
    var task = { fn: fn, next: undefined };
    if (last) last.next = task;
    if (!head) {
      head = task;
      notify();
    } last = task;
  };
};


/***/ }),
/* 253 */
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__(16);
var navigator = global.navigator;

module.exports = navigator && navigator.userAgent || '';


/***/ }),
/* 254 */
/***/ (function(module, exports, __webpack_require__) {
// https://github.com/tc39/proposal-promise-finally

var $export = __webpack_require__(14);
var core = __webpack_require__(11);
var global = __webpack_require__(16);
var speciesConstructor = __webpack_require__(147);
var promiseResolve = __webpack_require__(149);

$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {
  var C = speciesConstructor(this, core.Promise || global.Promise);
  var isFunction = typeof onFinally == 'function';
  return this.then(
    isFunction ? function (x) {
      return promiseResolve(C, onFinally()).then(function () { return x; });
    } : onFinally,
    isFunction ? function (e) {
      return promiseResolve(C, onFinally()).then(function () { throw e; });
    } : onFinally
  );
} });


/***/ }),
/* 255 */
/***/ (function(module, exports, __webpack_require__) {

// https://github.com/tc39/proposal-promise-try
var $export = __webpack_require__(14);
var newPromiseCapability = __webpack_require__(113);
var perform = __webpack_require__(148);

$export($export.S, 'Promise', { 'try': function (callbackfn) {
  var promiseCapability = newPromiseCapability.f(this);
  var result = perform(callbackfn);
  (result.e ? promiseCapability.reject : promiseCapability.resolve)(result.v);
  return promiseCapability.promise;
} });


/***/ }),
/* 256 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_context_performance_hook__ = __webpack_require__(157);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__base_renderer__ = __webpack_require__(158);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_canvas_render_target__ = __webpack_require__(87);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__managers_canvas_filter_manager__ = __webpack_require__(115);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







var RendererType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].RendererType;

/**
 * The renderer that is used for Canvas2D rendering
 * @class
 * @extends PhotoEditorSDK.Engine.BaseRenderer
 * @memberof PhotoEditorSDK.Engine
 */

var CanvasRenderer = function (_BaseRenderer) {
  _inherits(CanvasRenderer, _BaseRenderer);

  /**
   * Creates a CanvasRenderer
   * @override
   */
  function CanvasRenderer() {
    var _ref;

    _classCallCheck(this, CanvasRenderer);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = CanvasRenderer.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(CanvasRenderer)).call.apply(_ref, [this].concat(args)));

    _this._type = RendererType.CANVAS;

    _this.setCanvas(_this._options.canvas || _this._createCanvas());
    return _this;
  }

  /**
   * Creates a canvas element
   * @return {Canvas}
   * @private
   */


  _createClass(CanvasRenderer, [{
    key: '_createCanvas',
    value: function _createCanvas() {
      return __WEBPACK_IMPORTED_MODULE_4__globals__["i" /* Utils */].createCanvas();
    }

    /**
     * Gets the rendering context for this renderer
     * @returns {Object}
     * @private
     */

  }, {
    key: '_createContext',
    value: function _createContext() {
      var canvas = this._canvas;
      var ctx = canvas.getContext('2d');

      if (this._options.debug) {
        ctx = new __WEBPACK_IMPORTED_MODULE_5__utils_context_performance_hook__["a" /* default */](ctx);
      }

      this.id = ctx.id = CanvasRenderer.contextId++;
      this._context = ctx;
      ctx.renderer = this;

      this.emit('context', ctx);

      return ctx;
    }

    /**
     * Sets up the rendering context for this renderer
     * @private
     */

  }, {
    key: '_setupContext',
    value: function _setupContext() {
      var ctx = this._context;

      // Enable image smoothing if available
      if (!('imageSmoothingEnabled' in ctx)) {
        ['moz', 'webkit', 'ms'].forEach(function (prop) {
          if (ctx[prop]) {
            ctx[prop] = true;
          }
        });
      } else {
        ctx.imageSmoothingEnabled = true;
      }

      this._defaultRenderTarget = new __WEBPACK_IMPORTED_MODULE_7__utils_canvas_render_target__["a" /* default */](this._width, this._height, this._pixelRatio, this._canvas, this._context);
      this.setRenderTarget(this._defaultRenderTarget);

      this._filterManager = new __WEBPACK_IMPORTED_MODULE_8__managers_canvas_filter_manager__["a" /* default */](this);
    }

    /**
     * Renders the given DisplayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     */

  }, {
    key: 'render',
    value: function render(displayObject) {
      var ctx = this._renderTarget.getContext();

      // Since the given displayObject is the "root" object
      // right now, we need to give it a dummy / fake object
      // as parent with the default world transform and alpha
      var originalParent = displayObject.getParent();
      displayObject.setParent(this._fakeObject);

      // Update transforms and render this object
      displayObject.updateTransform();

      // Reset parent
      displayObject.setParent(originalParent);

      // Reset transform
      ctx.setTransform(1, 0, 0, 1, 0, 0);

      // Reset alpha
      ctx.globalAlpha = 1;

      // Clear the view
      var _canvas = this._canvas,
          width = _canvas.width,
          height = _canvas.height;

      ctx.clearRect(0, 0, width, height);
      if (this._clearColor.a !== 0) {
        ctx.save();
        ctx.fillStyle = this._clearColor.toRGBA();
        ctx.fillRect(0, 0, width, height);
        ctx.restore();
      }

      this.renderDisplayObject(displayObject, this._renderTarget);
    }

    /**
     * Renders the given DisplayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @param  {PhotoEditorSDK.Engine.RenderTarget} renderTarget
     */

  }, {
    key: 'renderDisplayObject',
    value: function renderDisplayObject(displayObject, renderTarget) {
      var originalRenderTarget = this._renderTarget;
      this._filterManager.setFilterStack(renderTarget.getFilterStack());
      this.setRenderTarget(renderTarget);
      displayObject.renderCanvas(this);
      this.setRenderTarget(originalRenderTarget);
    }

    /**
     * Returns the current render target
     * @return {PhotoEditorSDK.Engine.RenderTarget}
     */

  }, {
    key: 'getCurrentRenderTarget',
    value: function getCurrentRenderTarget() {
      return this._renderTarget;
    }

    /**
     * Sets the render target
     * @param {PhotoEditorSDK.Engine.RenderTarget} renderTarget
     */

  }, {
    key: 'setRenderTarget',
    value: function setRenderTarget(renderTarget) {
      this._renderTarget = renderTarget;
    }

    /**
     * Returns the current rendering context
     * @return {RenderingContext}
     */

  }, {
    key: 'getContext',
    value: function getContext() {
      return this._renderTarget.getContext();
    }

    /**
     * Disposes this Renderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._filterManager.dispose();
    }
  }]);

  return CanvasRenderer;
}(__WEBPACK_IMPORTED_MODULE_6__base_renderer__["a" /* default */]);

CanvasRenderer.contextId = 0;
CanvasRenderer.type = 'Canvas2D';

/* harmony default export */ __webpack_exports__["a"] = (CanvasRenderer);

/***/ }),
/* 257 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(50);
__webpack_require__(258);
module.exports = __webpack_require__(11).Array.from;


/***/ }),
/* 258 */
/***/ (function(module, exports, __webpack_require__) {

var ctx = __webpack_require__(30);
var $export = __webpack_require__(14);
var toObject = __webpack_require__(44);
var call = __webpack_require__(145);
var isArrayIter = __webpack_require__(146);
var toLength = __webpack_require__(82);
var createProperty = __webpack_require__(259);
var getIterFn = __webpack_require__(111);

$export($export.S + $export.F * !__webpack_require__(151)(function (iter) { }), 'Array', {
  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)
  from: function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {
    var O = toObject(arrayLike);
    var C = typeof this == 'function' ? this : Array;
    var aLen = arguments.length;
    var mapfn = aLen > 1 ? arguments[1] : undefined;
    var mapping = mapfn !== undefined;
    var index = 0;
    var iterFn = getIterFn(O);
    var length, result, step, iterator;
    if (mapping) mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);
    // if object isn't iterable or it's array with default iterator - use simple case
    if (iterFn != undefined && !(C == Array && isArrayIter(iterFn))) {
      for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {
        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);
      }
    } else {
      length = toLength(O.length);
      for (result = new C(length); length > index; index++) {
        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);
      }
    }
    result.length = index;
    return result;
  }
});


/***/ }),
/* 259 */
/***/ (function(module, exports, __webpack_require__) {

var $defineProperty = __webpack_require__(22);
var createDesc = __webpack_require__(57);

module.exports = function (object, index, value) {
  if (index in object) $defineProperty.f(object, index, createDesc(0, value));
  else object[index] = value;
};


/***/ }),
/* 260 */
/***/ (function(module, exports, __webpack_require__) {

var core = __webpack_require__(11);
var $JSON = core.JSON || (core.JSON = { stringify: JSON.stringify });
module.exports = function stringify(it) { // eslint-disable-line no-unused-vars
  return $JSON.stringify.apply($JSON, arguments);
};


/***/ }),
/* 261 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(262);
module.exports = __webpack_require__(11).Object.assign;


/***/ }),
/* 262 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.3.1 Object.assign(target, source)
var $export = __webpack_require__(14);

$export($export.S + $export.F, 'Object', { assign: __webpack_require__(263) });


/***/ }),
/* 263 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.1 Object.assign(target, source, ...)
var DESCRIPTORS = __webpack_require__(19);
var getKeys = __webpack_require__(49);
var gOPS = __webpack_require__(108);
var pIE = __webpack_require__(58);
var toObject = __webpack_require__(44);
var IObject = __webpack_require__(97);
var $assign = Object.assign;

// should work with symbols and should have deterministic property order (V8 bug)
module.exports = !$assign || __webpack_require__(42)(function () {
  var A = {};
  var B = {};
  // eslint-disable-next-line no-undef
  var S = Symbol();
  var K = 'abcdefghijklmnopqrst';
  A[S] = 7;
  K.split('').forEach(function (k) { B[k] = k; });
  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;
}) ? function assign(target, source) { // eslint-disable-line no-unused-vars
  var T = toObject(target);
  var aLen = arguments.length;
  var index = 1;
  var getSymbols = gOPS.f;
  var isEnum = pIE.f;
  while (aLen > index) {
    var S = IObject(arguments[index++]);
    var keys = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S);
    var length = keys.length;
    var j = 0;
    var key;
    while (length > j) {
      key = keys[j++];
      if (!DESCRIPTORS || isEnum.call(S, key)) T[key] = S[key];
    }
  } return T;
} : $assign;


/***/ }),
/* 264 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(265);
module.exports = __webpack_require__(11).Object.keys;


/***/ }),
/* 265 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.14 Object.keys(O)
var toObject = __webpack_require__(44);
var $keys = __webpack_require__(49);

__webpack_require__(103)('keys', function () {
  return function keys(it) {
    return $keys(toObject(it));
  };
});


/***/ }),
/* 266 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

var ArrayUtils = function () {
  function ArrayUtils() {
    _classCallCheck(this, ArrayUtils);
  }

  _createClass(ArrayUtils, null, [{
    key: "head",

    /**
     * Returns the first element in an array
     * @param {Array<A>} arr
     * @returns {A}
     */
    value: function head(arr) {
      return arr[0];
    }

    /**
     * Returns a shallow copy of the array excluding the first element
     * @param {Array<A>} arr
     * @returns {Array<A>}
     */

  }, {
    key: "tail",
    value: function tail(arr) {
      return arr.slice(1);
    }

    /**
     * Returns the last element of an array
     * @param {Array<A>} arr
     * @returns {A}
     */

  }, {
    key: "last",
    value: function last(arr) {
      return arr[arr.length - 1];
    }

    /**
     * Returns a shallow copy of the array excluding the last element
     * @param {Array<A>} arr
     * @returns {Array<A>}
     */

  }, {
    key: "init",
    value: function init(arr) {
      return arr.slice(0, arr.length - 1);
    }

    /**
     * Returns a shallow copy of the array with the elements tha pass
     * the test function removed.
     * @param {Array<A>} arr
     * @param {Function} func - A test function
     */

  }, {
    key: "remove",
    value: function remove(arr, func) {
      return arr.filter(function (v, i, arr) {
        return !func(v, i, arr);
      });
    }

    /**
     * Finds the index first element of the Array to which the supplied function returns
     * a true value. If the element is not found it returns -1.
     *
     * @param {Array} array
     * @param {Function} func
     * @returns {number}
     */

  }, {
    key: "findIndex",
    value: function findIndex(array, func) {
      for (var i = 0; i < array.length; i++) {
        if (func(array[i])) {
          return i;
        }
      }

      return -1;
    }

    /**
     * Finds the first element of the Array to which the supplied function returns
     * a true value and returns it. Otherwise it returns undefined.
     *
     * @param {Array} array
     * @param {Function} func
     * @returns {any}
     */

  }, {
    key: "find",
    value: function find(array, func) {
      for (var i = 0; i < array.length; i++) {
        if (func(array[i])) {
          return array[i];
        }
      }

      return undefined;
    }

    /**
     * Flattens the given multidimensional array
     *
     * @return {Array}
     */

  }, {
    key: "flatten",
    value: function flatten(array) {
      return array.reduce(function (flat, toFlatten) {
        return flat.concat(Array.isArray(toFlatten) ? ArrayUtils.flatten(toFlatten) : toFlatten);
      }, []);
    }

    /**
     * Returns and array containing the numbers going from `start` (inclusive) to
     * `end` (exclusive)
     *
     * @param {number} start
     * @param {number} end
     * @returns Array
     */

  }, {
    key: "range",
    value: function range(start, end) {
      var arr = [];

      if (end > start) {
        for (var i = start; i < end; i++) {
          arr.push(i);
        }
      }

      return arr;
    }

    /**
     * Returns an array consisting of the value `val` repeated `n` times.
     *
     * @param {any} val
     * @param {number} n
     * @returns {Array}
     */

  }, {
    key: "repeat",
    value: function repeat(val, n) {
      var arr = [];

      for (var i = 0; i < n; i++) {
        arr[i] = val;
      }

      return arr;
    }

    /**
     * Returns an array which is an array of arrays of equally positioned items in both arrays,
     * e.g, zip([1, 2, 3], [4, 5, 6]) = [[1, 4], [2, 5], [3, 6]]
     *
     * @param {Array} a
     * @param {Array} b
     * @returns {Array}
     */

  }, {
    key: "zip",
    value: function zip(a, b) {
      var len = Math.min(a.length, b.length);
      var arr = [];

      for (var i = 0; i < len; i++) {
        arr[i] = [a[i], b[i]];
      }

      return arr;
    }
  }]);

  return ArrayUtils;
}();

/* harmony default export */ __webpack_exports__["a"] = (ArrayUtils);

/***/ }),
/* 267 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(62);
__webpack_require__(50);
module.exports = __webpack_require__(268);


/***/ }),
/* 268 */
/***/ (function(module, exports, __webpack_require__) {

var classof = __webpack_require__(84);
var ITERATOR = __webpack_require__(17)('iterator');
var Iterators = __webpack_require__(51);
module.exports = __webpack_require__(11).isIterable = function (it) {
  var O = Object(it);
  return O[ITERATOR] !== undefined
    || '@@iterator' in O
    // eslint-disable-next-line no-prototype-builtins
    || Iterators.hasOwnProperty(classof(O));
};


/***/ }),
/* 269 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(62);
__webpack_require__(50);
module.exports = __webpack_require__(270);


/***/ }),
/* 270 */
/***/ (function(module, exports, __webpack_require__) {

var anObject = __webpack_require__(28);
var get = __webpack_require__(111);
module.exports = __webpack_require__(11).getIterator = function (it) {
  var iterFn = get(it);
  if (typeof iterFn != 'function') throw TypeError(it + ' is not iterable!');
  return anObject(iterFn.call(it));
};


/***/ }),
/* 271 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_RESULT__;/*!
 * UAParser.js v0.7.21
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright © 2012-2019 Faisal Salman <f@faisalman.com>
 * Licensed under MIT License
 */

(function (window, undefined$1) {

    //////////////
    // Constants
    /////////////


    var LIBVERSION  = '0.7.21',
        EMPTY       = '',
        UNKNOWN     = '?',
        FUNC_TYPE   = 'function',
        UNDEF_TYPE  = 'undefined',
        OBJ_TYPE    = 'object',
        STR_TYPE    = 'string',
        MAJOR       = 'major', // deprecated
        MODEL       = 'model',
        NAME        = 'name',
        TYPE        = 'type',
        VENDOR      = 'vendor',
        VERSION     = 'version',
        ARCHITECTURE= 'architecture',
        CONSOLE     = 'console',
        MOBILE      = 'mobile',
        TABLET      = 'tablet',
        SMARTTV     = 'smarttv',
        WEARABLE    = 'wearable',
        EMBEDDED    = 'embedded';


    ///////////
    // Helper
    //////////


    var util = {
        extend : function (regexes, extensions) {
            var mergedRegexes = {};
            for (var i in regexes) {
                if (extensions[i] && extensions[i].length % 2 === 0) {
                    mergedRegexes[i] = extensions[i].concat(regexes[i]);
                } else {
                    mergedRegexes[i] = regexes[i];
                }
            }
            return mergedRegexes;
        },
        has : function (str1, str2) {
          if (typeof str1 === "string") {
            return str2.toLowerCase().indexOf(str1.toLowerCase()) !== -1;
          } else {
            return false;
          }
        },
        lowerize : function (str) {
            return str.toLowerCase();
        },
        major : function (version) {
            return typeof(version) === STR_TYPE ? version.replace(/[^\d\.]/g,'').split(".")[0] : undefined$1;
        },
        trim : function (str) {
          return str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, '');
        }
    };


    ///////////////
    // Map helper
    //////////////


    var mapper = {

        rgx : function (ua, arrays) {

            var i = 0, j, k, p, q, matches, match;

            // loop through all regexes maps
            while (i < arrays.length && !matches) {

                var regex = arrays[i],       // even sequence (0,2,4,..)
                    props = arrays[i + 1];   // odd sequence (1,3,5,..)
                j = k = 0;

                // try matching uastring with regexes
                while (j < regex.length && !matches) {

                    matches = regex[j++].exec(ua);

                    if (!!matches) {
                        for (p = 0; p < props.length; p++) {
                            match = matches[++k];
                            q = props[p];
                            // check if given property is actually array
                            if (typeof q === OBJ_TYPE && q.length > 0) {
                                if (q.length == 2) {
                                    if (typeof q[1] == FUNC_TYPE) {
                                        // assign modified match
                                        this[q[0]] = q[1].call(this, match);
                                    } else {
                                        // assign given value, ignore regex match
                                        this[q[0]] = q[1];
                                    }
                                } else if (q.length == 3) {
                                    // check whether function or regex
                                    if (typeof q[1] === FUNC_TYPE && !(q[1].exec && q[1].test)) {
                                        // call function (usually string mapper)
                                        this[q[0]] = match ? q[1].call(this, match, q[2]) : undefined$1;
                                    } else {
                                        // sanitize match using given regex
                                        this[q[0]] = match ? match.replace(q[1], q[2]) : undefined$1;
                                    }
                                } else if (q.length == 4) {
                                        this[q[0]] = match ? q[3].call(this, match.replace(q[1], q[2])) : undefined$1;
                                }
                            } else {
                                this[q] = match ? match : undefined$1;
                            }
                        }
                    }
                }
                i += 2;
            }
        },

        str : function (str, map) {

            for (var i in map) {
                // check if array
                if (typeof map[i] === OBJ_TYPE && map[i].length > 0) {
                    for (var j = 0; j < map[i].length; j++) {
                        if (util.has(map[i][j], str)) {
                            return (i === UNKNOWN) ? undefined$1 : i;
                        }
                    }
                } else if (util.has(map[i], str)) {
                    return (i === UNKNOWN) ? undefined$1 : i;
                }
            }
            return str;
        }
    };


    ///////////////
    // String map
    //////////////


    var maps = {

        browser : {
            oldsafari : {
                version : {
                    '1.0'   : '/8',
                    '1.2'   : '/1',
                    '1.3'   : '/3',
                    '2.0'   : '/412',
                    '2.0.2' : '/416',
                    '2.0.3' : '/417',
                    '2.0.4' : '/419',
                    '?'     : '/'
                }
            }
        },

        device : {
            amazon : {
                model : {
                    'Fire Phone' : ['SD', 'KF']
                }
            },
            sprint : {
                model : {
                    'Evo Shift 4G' : '7373KT'
                },
                vendor : {
                    'HTC'       : 'APA',
                    'Sprint'    : 'Sprint'
                }
            }
        },

        os : {
            windows : {
                version : {
                    'ME'        : '4.90',
                    'NT 3.11'   : 'NT3.51',
                    'NT 4.0'    : 'NT4.0',
                    '2000'      : 'NT 5.0',
                    'XP'        : ['NT 5.1', 'NT 5.2'],
                    'Vista'     : 'NT 6.0',
                    '7'         : 'NT 6.1',
                    '8'         : 'NT 6.2',
                    '8.1'       : 'NT 6.3',
                    '10'        : ['NT 6.4', 'NT 10.0'],
                    'RT'        : 'ARM'
                }
            }
        }
    };


    //////////////
    // Regex map
    /////////////


    var regexes = {

        browser : [[

            // Presto based
            /(opera\smini)\/([\w\.-]+)/i,                                       // Opera Mini
            /(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,                      // Opera Mobi/Tablet
            /(opera).+version\/([\w\.]+)/i,                                     // Opera > 9.80
            /(opera)[\/\s]+([\w\.]+)/i                                          // Opera < 9.80
            ], [NAME, VERSION], [

            /(opios)[\/\s]+([\w\.]+)/i                                          // Opera mini on iphone >= 8.0
            ], [[NAME, 'Opera Mini'], VERSION], [

            /\s(opr)\/([\w\.]+)/i                                               // Opera Webkit
            ], [[NAME, 'Opera'], VERSION], [

            // Mixed
            /(kindle)\/([\w\.]+)/i,                                             // Kindle
            /(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,
                                                                                // Lunascape/Maxthon/Netfront/Jasmine/Blazer
            // Trident based
            /(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,
                                                                                // Avant/IEMobile/SlimBrowser
            /(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,                      // Baidu Browser
            /(?:ms|\()(ie)\s([\w\.]+)/i,                                        // Internet Explorer

            // Webkit/KHTML based
            /(rekonq)\/([\w\.]*)/i,                                             // Rekonq
            /(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i
                                                                                // Chromium/Flock/RockMelt/Midori/Epiphany/Silk/Skyfire/Bolt/Iron/Iridium/PhantomJS/Bowser/QupZilla/Falkon
            ], [NAME, VERSION], [

            /(konqueror)\/([\w\.]+)/i                                           // Konqueror
            ], [[NAME, 'Konqueror'], VERSION], [

            /(trident).+rv[:\s]([\w\.]+).+like\sgecko/i                         // IE11
            ], [[NAME, 'IE'], VERSION], [

            /(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i                          // Microsoft Edge
            ], [[NAME, 'Edge'], VERSION], [

            /(yabrowser)\/([\w\.]+)/i                                           // Yandex
            ], [[NAME, 'Yandex'], VERSION], [

            /(Avast)\/([\w\.]+)/i                                               // Avast Secure Browser
            ], [[NAME, 'Avast Secure Browser'], VERSION], [

            /(AVG)\/([\w\.]+)/i                                                 // AVG Secure Browser
            ], [[NAME, 'AVG Secure Browser'], VERSION], [

            /(puffin)\/([\w\.]+)/i                                              // Puffin
            ], [[NAME, 'Puffin'], VERSION], [

            /(focus)\/([\w\.]+)/i                                               // Firefox Focus
            ], [[NAME, 'Firefox Focus'], VERSION], [

            /(opt)\/([\w\.]+)/i                                                 // Opera Touch
            ], [[NAME, 'Opera Touch'], VERSION], [

            /((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i         // UCBrowser
            ], [[NAME, 'UCBrowser'], VERSION], [

            /(comodo_dragon)\/([\w\.]+)/i                                       // Comodo Dragon
            ], [[NAME, /_/g, ' '], VERSION], [

            /(windowswechat qbcore)\/([\w\.]+)/i                                // WeChat Desktop for Windows Built-in Browser
            ], [[NAME, 'WeChat(Win) Desktop'], VERSION], [

            /(micromessenger)\/([\w\.]+)/i                                      // WeChat
            ], [[NAME, 'WeChat'], VERSION], [

            /(brave)\/([\w\.]+)/i                                               // Brave browser
            ], [[NAME, 'Brave'], VERSION], [

            /(qqbrowserlite)\/([\w\.]+)/i                                       // QQBrowserLite
            ], [NAME, VERSION], [

            /(QQ)\/([\d\.]+)/i                                                  // QQ, aka ShouQ
            ], [NAME, VERSION], [

            /m?(qqbrowser)[\/\s]?([\w\.]+)/i                                    // QQBrowser
            ], [NAME, VERSION], [

            /(baiduboxapp)[\/\s]?([\w\.]+)/i                                    // Baidu App
            ], [NAME, VERSION], [

            /(2345Explorer)[\/\s]?([\w\.]+)/i                                   // 2345 Browser
            ], [NAME, VERSION], [

            /(MetaSr)[\/\s]?([\w\.]+)/i                                         // SouGouBrowser
            ], [NAME], [

            /(LBBROWSER)/i                                                      // LieBao Browser
            ], [NAME], [

            /xiaomi\/miuibrowser\/([\w\.]+)/i                                   // MIUI Browser
            ], [VERSION, [NAME, 'MIUI Browser']], [

            /;fbav\/([\w\.]+);/i                                                // Facebook App for iOS & Android
            ], [VERSION, [NAME, 'Facebook']], [

            /safari\s(line)\/([\w\.]+)/i,                                       // Line App for iOS
            /android.+(line)\/([\w\.]+)\/iab/i                                  // Line App for Android
            ], [NAME, VERSION], [

            /headlesschrome(?:\/([\w\.]+)|\s)/i                                 // Chrome Headless
            ], [VERSION, [NAME, 'Chrome Headless']], [

            /\swv\).+(chrome)\/([\w\.]+)/i                                      // Chrome WebView
            ], [[NAME, /(.+)/, '$1 WebView'], VERSION], [

            /((?:oculus|samsung)browser)\/([\w\.]+)/i
            ], [[NAME, /(.+(?:g|us))(.+)/, '$1 $2'], VERSION], [                // Oculus / Samsung Browser

            /android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i        // Android Browser
            ], [VERSION, [NAME, 'Android Browser']], [

            /(sailfishbrowser)\/([\w\.]+)/i                                     // Sailfish Browser
            ], [[NAME, 'Sailfish Browser'], VERSION], [

            /(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i
                                                                                // Chrome/OmniWeb/Arora/Tizen/Nokia
            ], [NAME, VERSION], [

            /(dolfin)\/([\w\.]+)/i                                              // Dolphin
            ], [[NAME, 'Dolphin'], VERSION], [

            /(qihu|qhbrowser|qihoobrowser|360browser)/i                         // 360
            ], [[NAME, '360 Browser']], [

            /((?:android.+)crmo|crios)\/([\w\.]+)/i                             // Chrome for Android/iOS
            ], [[NAME, 'Chrome'], VERSION], [

            /(coast)\/([\w\.]+)/i                                               // Opera Coast
            ], [[NAME, 'Opera Coast'], VERSION], [

            /fxios\/([\w\.-]+)/i                                                // Firefox for iOS
            ], [VERSION, [NAME, 'Firefox']], [

            /version\/([\w\.]+).+?mobile\/\w+\s(safari)/i                       // Mobile Safari
            ], [VERSION, [NAME, 'Mobile Safari']], [

            /version\/([\w\.]+).+?(mobile\s?safari|safari)/i                    // Safari & Safari Mobile
            ], [VERSION, NAME], [

            /webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i  // Google Search Appliance on iOS
            ], [[NAME, 'GSA'], VERSION], [

            /webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i                     // Safari < 3.0
            ], [NAME, [VERSION, mapper.str, maps.browser.oldsafari.version]], [

            /(webkit|khtml)\/([\w\.]+)/i
            ], [NAME, VERSION], [

            // Gecko based
            /(navigator|netscape)\/([\w\.-]+)/i                                 // Netscape
            ], [[NAME, 'Netscape'], VERSION], [
            /(swiftfox)/i,                                                      // Swiftfox
            /(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,
                                                                                // IceDragon/Iceweasel/Camino/Chimera/Fennec/Maemo/Minimo/Conkeror
            /(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,

                                                                                // Firefox/SeaMonkey/K-Meleon/IceCat/IceApe/Firebird/Phoenix
            /(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,                          // Mozilla

            // Other
            /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,
                                                                                // Polaris/Lynx/Dillo/iCab/Doris/Amaya/w3m/NetSurf/Sleipnir
            /(links)\s\(([\w\.]+)/i,                                            // Links
            /(gobrowser)\/?([\w\.]*)/i,                                         // GoBrowser
            /(ice\s?browser)\/v?([\w\._]+)/i,                                   // ICE Browser
            /(mosaic)[\/\s]([\w\.]+)/i                                          // Mosaic
            ], [NAME, VERSION]
        ],

        cpu : [[

            /(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i                     // AMD64
            ], [[ARCHITECTURE, 'amd64']], [

            /(ia32(?=;))/i                                                      // IA32 (quicktime)
            ], [[ARCHITECTURE, util.lowerize]], [

            /((?:i[346]|x)86)[;\)]/i                                            // IA32
            ], [[ARCHITECTURE, 'ia32']], [

            // PocketPC mistakenly identified as PowerPC
            /windows\s(ce|mobile);\sppc;/i
            ], [[ARCHITECTURE, 'arm']], [

            /((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i                           // PowerPC
            ], [[ARCHITECTURE, /ower/, '', util.lowerize]], [

            /(sun4\w)[;\)]/i                                                    // SPARC
            ], [[ARCHITECTURE, 'sparc']], [

            /((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i
                                                                                // IA64, 68K, ARM/64, AVR/32, IRIX/64, MIPS/64, SPARC/64, PA-RISC
            ], [[ARCHITECTURE, util.lowerize]]
        ],

        device : [[

            /\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i                        // iPad/PlayBook
            ], [MODEL, VENDOR, [TYPE, TABLET]], [

            /applecoremedia\/[\w\.]+ \((ipad)/                                  // iPad
            ], [MODEL, [VENDOR, 'Apple'], [TYPE, TABLET]], [

            /(apple\s{0,1}tv)/i                                                 // Apple TV
            ], [[MODEL, 'Apple TV'], [VENDOR, 'Apple'], [TYPE, SMARTTV]], [

            /(archos)\s(gamepad2?)/i,                                           // Archos
            /(hp).+(touchpad)/i,                                                // HP TouchPad
            /(hp).+(tablet)/i,                                                  // HP Tablet
            /(kindle)\/([\w\.]+)/i,                                             // Kindle
            /\s(nook)[\w\s]+build\/(\w+)/i,                                     // Nook
            /(dell)\s(strea[kpr\s\d]*[\dko])/i                                  // Dell Streak
            ], [VENDOR, MODEL, [TYPE, TABLET]], [

            /(kf[A-z]+)\sbuild\/.+silk\//i                                      // Kindle Fire HD
            ], [MODEL, [VENDOR, 'Amazon'], [TYPE, TABLET]], [
            /(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i                         // Fire Phone
            ], [[MODEL, mapper.str, maps.device.amazon.model], [VENDOR, 'Amazon'], [TYPE, MOBILE]], [
            /android.+aft([bms])\sbuild/i                                       // Fire TV
            ], [MODEL, [VENDOR, 'Amazon'], [TYPE, SMARTTV]], [

            /\((ip[honed|\s\w*]+);.+(apple)/i                                   // iPod/iPhone
            ], [MODEL, VENDOR, [TYPE, MOBILE]], [
            /\((ip[honed|\s\w*]+);/i                                            // iPod/iPhone
            ], [MODEL, [VENDOR, 'Apple'], [TYPE, MOBILE]], [

            /(blackberry)[\s-]?(\w+)/i,                                         // BlackBerry
            /(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,
                                                                                // BenQ/Palm/Sony-Ericsson/Acer/Asus/Dell/Meizu/Motorola/Polytron
            /(hp)\s([\w\s]+\w)/i,                                               // HP iPAQ
            /(asus)-?(\w+)/i                                                    // Asus
            ], [VENDOR, MODEL, [TYPE, MOBILE]], [
            /\(bb10;\s(\w+)/i                                                   // BlackBerry 10
            ], [MODEL, [VENDOR, 'BlackBerry'], [TYPE, MOBILE]], [
                                                                                // Asus Tablets
            /android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i
            ], [MODEL, [VENDOR, 'Asus'], [TYPE, TABLET]], [

            /(sony)\s(tablet\s[ps])\sbuild\//i,                                  // Sony
            /(sony)?(?:sgp.+)\sbuild\//i
            ], [[VENDOR, 'Sony'], [MODEL, 'Xperia Tablet'], [TYPE, TABLET]], [
            /android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i
            ], [MODEL, [VENDOR, 'Sony'], [TYPE, MOBILE]], [

            /\s(ouya)\s/i,                                                      // Ouya
            /(nintendo)\s([wids3u]+)/i                                          // Nintendo
            ], [VENDOR, MODEL, [TYPE, CONSOLE]], [

            /android.+;\s(shield)\sbuild/i                                      // Nvidia
            ], [MODEL, [VENDOR, 'Nvidia'], [TYPE, CONSOLE]], [

            /(playstation\s[34portablevi]+)/i                                   // Playstation
            ], [MODEL, [VENDOR, 'Sony'], [TYPE, CONSOLE]], [

            /(sprint\s(\w+))/i                                                  // Sprint Phones
            ], [[VENDOR, mapper.str, maps.device.sprint.vendor], [MODEL, mapper.str, maps.device.sprint.model], [TYPE, MOBILE]], [

            /(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,                        // HTC
            /(zte)-(\w*)/i,                                                     // ZTE
            /(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i
                                                                                // Alcatel/GeeksPhone/Nexian/Panasonic/Sony
            ], [VENDOR, [MODEL, /_/g, ' '], [TYPE, MOBILE]], [

            /(nexus\s9)/i                                                       // HTC Nexus 9
            ], [MODEL, [VENDOR, 'HTC'], [TYPE, TABLET]], [

            /d\/huawei([\w\s-]+)[;\)]/i,
            /(nexus\s6p|vog-l29|ane-lx1|eml-l29)/i                              // Huawei
            ], [MODEL, [VENDOR, 'Huawei'], [TYPE, MOBILE]], [

            /android.+(bah2?-a?[lw]\d{2})/i                                     // Huawei MediaPad
            ], [MODEL, [VENDOR, 'Huawei'], [TYPE, TABLET]], [

            /(microsoft);\s(lumia[\s\w]+)/i                                     // Microsoft Lumia
            ], [VENDOR, MODEL, [TYPE, MOBILE]], [

            /[\s\(;](xbox(?:\sone)?)[\s\);]/i                                   // Microsoft Xbox
            ], [MODEL, [VENDOR, 'Microsoft'], [TYPE, CONSOLE]], [
            /(kin\.[onetw]{3})/i                                                // Microsoft Kin
            ], [[MODEL, /\./g, ' '], [VENDOR, 'Microsoft'], [TYPE, MOBILE]], [

                                                                                // Motorola
            /\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,
            /mot[\s-]?(\w*)/i,
            /(XT\d{3,4}) build\//i,
            /(nexus\s6)/i
            ], [MODEL, [VENDOR, 'Motorola'], [TYPE, MOBILE]], [
            /android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i
            ], [MODEL, [VENDOR, 'Motorola'], [TYPE, TABLET]], [

            /hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i            // HbbTV devices
            ], [[VENDOR, util.trim], [MODEL, util.trim], [TYPE, SMARTTV]], [

            /hbbtv.+maple;(\d+)/i
            ], [[MODEL, /^/, 'SmartTV'], [VENDOR, 'Samsung'], [TYPE, SMARTTV]], [

            /\(dtv[\);].+(aquos)/i                                              // Sharp
            ], [MODEL, [VENDOR, 'Sharp'], [TYPE, SMARTTV]], [

            /android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,
            /((SM-T\w+))/i
            ], [[VENDOR, 'Samsung'], MODEL, [TYPE, TABLET]], [                  // Samsung
            /smart-tv.+(samsung)/i
            ], [VENDOR, [TYPE, SMARTTV], MODEL], [
            /((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,
            /(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,
            /sec-((sgh\w+))/i
            ], [[VENDOR, 'Samsung'], MODEL, [TYPE, MOBILE]], [

            /sie-(\w*)/i                                                        // Siemens
            ], [MODEL, [VENDOR, 'Siemens'], [TYPE, MOBILE]], [

            /(maemo|nokia).*(n900|lumia\s\d+)/i,                                // Nokia
            /(nokia)[\s_-]?([\w-]*)/i
            ], [[VENDOR, 'Nokia'], MODEL, [TYPE, MOBILE]], [

            /android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i                   // Acer
            ], [MODEL, [VENDOR, 'Acer'], [TYPE, TABLET]], [

            /android.+([vl]k\-?\d{3})\s+build/i                                 // LG Tablet
            ], [MODEL, [VENDOR, 'LG'], [TYPE, TABLET]], [
            /android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i                     // LG Tablet
            ], [[VENDOR, 'LG'], MODEL, [TYPE, TABLET]], [
            /(lg) netcast\.tv/i                                                 // LG SmartTV
            ], [VENDOR, MODEL, [TYPE, SMARTTV]], [
            /(nexus\s[45])/i,                                                   // LG
            /lg[e;\s\/-]+(\w*)/i,
            /android.+lg(\-?[\d\w]+)\s+build/i
            ], [MODEL, [VENDOR, 'LG'], [TYPE, MOBILE]], [

            /(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i             // Lenovo tablets
            ], [VENDOR, MODEL, [TYPE, TABLET]], [
            /android.+(ideatab[a-z0-9\-\s]+)/i                                  // Lenovo
            ], [MODEL, [VENDOR, 'Lenovo'], [TYPE, TABLET]], [
            /(lenovo)[_\s-]?([\w-]+)/i
            ], [VENDOR, MODEL, [TYPE, MOBILE]], [

            /linux;.+((jolla));/i                                               // Jolla
            ], [VENDOR, MODEL, [TYPE, MOBILE]], [

            /((pebble))app\/[\d\.]+\s/i                                         // Pebble
            ], [VENDOR, MODEL, [TYPE, WEARABLE]], [

            /android.+;\s(oppo)\s?([\w\s]+)\sbuild/i                            // OPPO
            ], [VENDOR, MODEL, [TYPE, MOBILE]], [

            /crkey/i                                                            // Google Chromecast
            ], [[MODEL, 'Chromecast'], [VENDOR, 'Google'], [TYPE, SMARTTV]], [

            /android.+;\s(glass)\s\d/i                                          // Google Glass
            ], [MODEL, [VENDOR, 'Google'], [TYPE, WEARABLE]], [

            /android.+;\s(pixel c)[\s)]/i                                       // Google Pixel C
            ], [MODEL, [VENDOR, 'Google'], [TYPE, TABLET]], [

            /android.+;\s(pixel( [23])?( xl)?)[\s)]/i                              // Google Pixel
            ], [MODEL, [VENDOR, 'Google'], [TYPE, MOBILE]], [

            /android.+;\s(\w+)\s+build\/hm\1/i,                                 // Xiaomi Hongmi 'numeric' models
            /android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,               // Xiaomi Hongmi
            /android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,    
                                                                                // Xiaomi Mi
            /android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i       // Redmi Phones
            ], [[MODEL, /_/g, ' '], [VENDOR, 'Xiaomi'], [TYPE, MOBILE]], [
            /android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i            // Mi Pad tablets
            ],[[MODEL, /_/g, ' '], [VENDOR, 'Xiaomi'], [TYPE, TABLET]], [
            /android.+;\s(m[1-5]\snote)\sbuild/i                                // Meizu
            ], [MODEL, [VENDOR, 'Meizu'], [TYPE, MOBILE]], [
            /(mz)-([\w-]{2,})/i
            ], [[VENDOR, 'Meizu'], MODEL, [TYPE, MOBILE]], [

            /android.+a000(1)\s+build/i,                                        // OnePlus
            /android.+oneplus\s(a\d{4})[\s)]/i
            ], [MODEL, [VENDOR, 'OnePlus'], [TYPE, MOBILE]], [

            /android.+[;\/]\s*(RCT[\d\w]+)\s+build/i                            // RCA Tablets
            ], [MODEL, [VENDOR, 'RCA'], [TYPE, TABLET]], [

            /android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i                      // Dell Venue Tablets
            ], [MODEL, [VENDOR, 'Dell'], [TYPE, TABLET]], [

            /android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i                         // Verizon Tablet
            ], [MODEL, [VENDOR, 'Verizon'], [TYPE, TABLET]], [

            /android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i     // Barnes & Noble Tablet
            ], [[VENDOR, 'Barnes & Noble'], MODEL, [TYPE, TABLET]], [

            /android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i                           // Barnes & Noble Tablet
            ], [MODEL, [VENDOR, 'NuVision'], [TYPE, TABLET]], [

            /android.+;\s(k88)\sbuild/i                                         // ZTE K Series Tablet
            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, TABLET]], [

            /android.+[;\/]\s*(gen\d{3})\s+build.*49h/i                         // Swiss GEN Mobile
            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, MOBILE]], [

            /android.+[;\/]\s*(zur\d{3})\s+build/i                              // Swiss ZUR Tablet
            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, TABLET]], [

            /android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i                         // Zeki Tablets
            ], [MODEL, [VENDOR, 'Zeki'], [TYPE, TABLET]], [

            /(android).+[;\/]\s+([YR]\d{2})\s+build/i,
            /android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i        // Dragon Touch Tablet
            ], [[VENDOR, 'Dragon Touch'], MODEL, [TYPE, TABLET]], [

            /android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i                            // Insignia Tablets
            ], [MODEL, [VENDOR, 'Insignia'], [TYPE, TABLET]], [

            /android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i                    // NextBook Tablets
            ], [MODEL, [VENDOR, 'NextBook'], [TYPE, TABLET]], [

            /android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i
            ], [[VENDOR, 'Voice'], MODEL, [TYPE, MOBILE]], [                    // Voice Xtreme Phones

            /android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i                     // LvTel Phones
            ], [[VENDOR, 'LvTel'], MODEL, [TYPE, MOBILE]], [

            /android.+;\s(PH-1)\s/i
            ], [MODEL, [VENDOR, 'Essential'], [TYPE, MOBILE]], [                // Essential PH-1

            /android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i          // Envizen Tablets
            ], [MODEL, [VENDOR, 'Envizen'], [TYPE, TABLET]], [

            /android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i          // Le Pan Tablets
            ], [VENDOR, MODEL, [TYPE, TABLET]], [

            /android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i                         // MachSpeed Tablets
            ], [MODEL, [VENDOR, 'MachSpeed'], [TYPE, TABLET]], [

            /android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i                // Trinity Tablets
            ], [VENDOR, MODEL, [TYPE, TABLET]], [

            /android.+[;\/]\s*TU_(1491)\s+build/i                               // Rotor Tablets
            ], [MODEL, [VENDOR, 'Rotor'], [TYPE, TABLET]], [

            /android.+(KS(.+))\s+build/i                                        // Amazon Kindle Tablets
            ], [MODEL, [VENDOR, 'Amazon'], [TYPE, TABLET]], [

            /android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i                      // Gigaset Tablets
            ], [VENDOR, MODEL, [TYPE, TABLET]], [

            /\s(tablet|tab)[;\/]/i,                                             // Unidentifiable Tablet
            /\s(mobile)(?:[;\/]|\ssafari)/i                                     // Unidentifiable Mobile
            ], [[TYPE, util.lowerize], VENDOR, MODEL], [

            /[\s\/\(](smart-?tv)[;\)]/i                                         // SmartTV
            ], [[TYPE, SMARTTV]], [

            /(android[\w\.\s\-]{0,9});.+build/i                                 // Generic Android Device
            ], [MODEL, [VENDOR, 'Generic']]
        ],

        engine : [[

            /windows.+\sedge\/([\w\.]+)/i                                       // EdgeHTML
            ], [VERSION, [NAME, 'EdgeHTML']], [

            /webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i                         // Blink
            ], [VERSION, [NAME, 'Blink']], [

            /(presto)\/([\w\.]+)/i,                                             // Presto
            /(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,     
                                                                                // WebKit/Trident/NetFront/NetSurf/Amaya/Lynx/w3m/Goanna
            /(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,                          // KHTML/Tasman/Links
            /(icab)[\/\s]([23]\.[\d\.]+)/i                                      // iCab
            ], [NAME, VERSION], [

            /rv\:([\w\.]{1,9}).+(gecko)/i                                       // Gecko
            ], [VERSION, NAME]
        ],

        os : [[

            // Windows based
            /microsoft\s(windows)\s(vista|xp)/i                                 // Windows (iTunes)
            ], [NAME, VERSION], [
            /(windows)\snt\s6\.2;\s(arm)/i,                                     // Windows RT
            /(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,                   // Windows Phone
            /(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i
            ], [NAME, [VERSION, mapper.str, maps.os.windows.version]], [
            /(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i
            ], [[NAME, 'Windows'], [VERSION, mapper.str, maps.os.windows.version]], [

            // Mobile/Embedded OS
            /\((bb)(10);/i                                                      // BlackBerry 10
            ], [[NAME, 'BlackBerry'], VERSION], [
            /(blackberry)\w*\/?([\w\.]*)/i,                                     // Blackberry
            /(tizen|kaios)[\/\s]([\w\.]+)/i,                                    // Tizen/KaiOS
            /(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i
                                                                                // Android/WebOS/Palm/QNX/Bada/RIM/MeeGo/Contiki/Sailfish OS
            ], [NAME, VERSION], [
            /(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i                  // Symbian
            ], [[NAME, 'Symbian'], VERSION], [
            /\((series40);/i                                                    // Series 40
            ], [NAME], [
            /mozilla.+\(mobile;.+gecko.+firefox/i                               // Firefox OS
            ], [[NAME, 'Firefox OS'], VERSION], [

            // Console
            /(nintendo|playstation)\s([wids34portablevu]+)/i,                   // Nintendo/Playstation

            // GNU/Linux based
            /(mint)[\/\s\(]?(\w*)/i,                                            // Mint
            /(mageia|vectorlinux)[;\s]/i,                                       // Mageia/VectorLinux
            /(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,
                                                                                // Joli/Ubuntu/Debian/SUSE/Gentoo/Arch/Slackware
                                                                                // Fedora/Mandriva/CentOS/PCLinuxOS/RedHat/Zenwalk/Linpus
            /(hurd|linux)\s?([\w\.]*)/i,                                        // Hurd/Linux
            /(gnu)\s?([\w\.]*)/i                                                // GNU
            ], [NAME, VERSION], [

            /(cros)\s[\w]+\s([\w\.]+\w)/i                                       // Chromium OS
            ], [[NAME, 'Chromium OS'], VERSION],[

            // Solaris
            /(sunos)\s?([\w\.\d]*)/i                                            // Solaris
            ], [[NAME, 'Solaris'], VERSION], [

            // BSD based
            /\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i                    // FreeBSD/NetBSD/OpenBSD/PC-BSD/DragonFly
            ], [NAME, VERSION],[

            /(haiku)\s(\w+)/i                                                   // Haiku
            ], [NAME, VERSION],[

            /cfnetwork\/.+darwin/i,
            /ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i             // iOS
            ], [[VERSION, /_/g, '.'], [NAME, 'iOS']], [

            /(mac\sos\sx)\s?([\w\s\.]*)/i,
            /(macintosh|mac(?=_powerpc)\s)/i                                    // Mac OS
            ], [[NAME, 'Mac OS'], [VERSION, /_/g, '.']], [

            // Other
            /((?:open)?solaris)[\/\s-]?([\w\.]*)/i,                             // Solaris
            /(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,                                // AIX
            /(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,
                                                                                // Plan9/Minix/BeOS/OS2/AmigaOS/MorphOS/RISCOS/OpenVMS/Fuchsia
            /(unix)\s?([\w\.]*)/i                                               // UNIX
            ], [NAME, VERSION]
        ]
    };


    /////////////////
    // Constructor
    ////////////////
    var UAParser = function (uastring, extensions) {

        if (typeof uastring === 'object') {
            extensions = uastring;
            uastring = undefined$1;
        }

        if (!(this instanceof UAParser)) {
            return new UAParser(uastring, extensions).getResult();
        }

        var ua = uastring || ((window && window.navigator && window.navigator.userAgent) ? window.navigator.userAgent : EMPTY);
        var rgxmap = extensions ? util.extend(regexes, extensions) : regexes;

        this.getBrowser = function () {
            var browser = { name: undefined$1, version: undefined$1 };
            mapper.rgx.call(browser, ua, rgxmap.browser);
            browser.major = util.major(browser.version); // deprecated
            return browser;
        };
        this.getCPU = function () {
            var cpu = { architecture: undefined$1 };
            mapper.rgx.call(cpu, ua, rgxmap.cpu);
            return cpu;
        };
        this.getDevice = function () {
            var device = { vendor: undefined$1, model: undefined$1, type: undefined$1 };
            mapper.rgx.call(device, ua, rgxmap.device);
            return device;
        };
        this.getEngine = function () {
            var engine = { name: undefined$1, version: undefined$1 };
            mapper.rgx.call(engine, ua, rgxmap.engine);
            return engine;
        };
        this.getOS = function () {
            var os = { name: undefined$1, version: undefined$1 };
            mapper.rgx.call(os, ua, rgxmap.os);
            return os;
        };
        this.getResult = function () {
            return {
                ua      : this.getUA(),
                browser : this.getBrowser(),
                engine  : this.getEngine(),
                os      : this.getOS(),
                device  : this.getDevice(),
                cpu     : this.getCPU()
            };
        };
        this.getUA = function () {
            return ua;
        };
        this.setUA = function (uastring) {
            ua = uastring;
            return this;
        };
        return this;
    };

    UAParser.VERSION = LIBVERSION;
    UAParser.BROWSER = {
        NAME    : NAME,
        MAJOR   : MAJOR, // deprecated
        VERSION : VERSION
    };
    UAParser.CPU = {
        ARCHITECTURE : ARCHITECTURE
    };
    UAParser.DEVICE = {
        MODEL   : MODEL,
        VENDOR  : VENDOR,
        TYPE    : TYPE,
        CONSOLE : CONSOLE,
        MOBILE  : MOBILE,
        SMARTTV : SMARTTV,
        TABLET  : TABLET,
        WEARABLE: WEARABLE,
        EMBEDDED: EMBEDDED
    };
    UAParser.ENGINE = {
        NAME    : NAME,
        VERSION : VERSION
    };
    UAParser.OS = {
        NAME    : NAME,
        VERSION : VERSION
    };

    ///////////
    // Export
    //////////


    // check js environment
    if (typeof(exports) !== UNDEF_TYPE) {
        // nodejs env
        if (typeof module !== UNDEF_TYPE && module.exports) {
            exports = module.exports = UAParser;
        }
        exports.UAParser = UAParser;
    } else {
        // requirejs env (optional)
        {
            !(__WEBPACK_AMD_DEFINE_RESULT__ = (function () {
                return UAParser;
            }).call(exports, __webpack_require__, exports, module),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined$1 && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
        }
    }

    // jQuery/Zepto specific (optional)
    // Note:
    //   In AMD env the global scope should be kept clean, but jQuery is an exception.
    //   jQuery always exports to global scope, unless jQuery.noConflict(true) is used,
    //   and we should catch that.
    var $ = window && (window.jQuery || window.Zepto);
    if ($ && !$.ua) {
        var parser = new UAParser();
        $.ua = parser.getResult();
        $.ua.get = function () {
            return parser.getUA();
        };
        $.ua.set = function (uastring) {
            parser.setUA(uastring);
            var result = parser.getResult();
            for (var prop in result) {
                $.ua[prop] = result[prop];
            }
        };
    }

})(typeof window === 'object' ? window : this);


/***/ }),
/* 272 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * A couple of utility functions
 * @type {Object}
 */
var Utils = {
  /**
   * Assigns own enumerable properties of source object(s) to the destination
   * object for all destination properties that resolve to undefined. Once a
   * property is set, additional values of the same property are ignored.
   * @param  {Object} object
   * @param  {Object} ...sources
   * @return {Object}
   */
  defaults: function defaults(object) {
    for (var _len = arguments.length, sources = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      sources[_key - 1] = arguments[_key];
    }

    // Shallow clone
    var newObject = {};
    for (var key in object) {
      newObject[key] = object[key];
    }

    // Clone sources
    for (var i = 0; i < sources.length; i++) {
      var source = sources[i];
      for (var _key2 in source) {
        if (typeof newObject[_key2] === 'undefined') {
          newObject[_key2] = source[_key2];
        }
      }
    }

    return newObject;
  },

  /**
   * Assigns own enumerable properties of source object(s) to the destination
   * object. Subsequent sources overwrite property assignments of previous
   * sources.
   * @param {Object} object
   * @param {Object} ...sources
   * @return {Object}
   */
  extend: function extend(object) {
    for (var _len2 = arguments.length, sources = Array(_len2 > 1 ? _len2 - 1 : 0), _key3 = 1; _key3 < _len2; _key3++) {
      sources[_key3 - 1] = arguments[_key3];
    }

    // Shallow clone
    var newObject = {};
    for (var key in object) {
      newObject[key] = object[key];
    }

    // Extend sources
    for (var i = 0; i < sources.length; i++) {
      var source = sources[i];
      for (var _key4 in source) {
        newObject[_key4] = source[_key4];
      }
    }

    return newObject;
  }
};

/* harmony default export */ __webpack_exports__["a"] = (Utils);

/***/ }),
/* 273 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__base_renderer__ = __webpack_require__(158);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_webgl_render_target__ = __webpack_require__(88);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__object_renderers_object_renderer__ = __webpack_require__(159);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__object_renderers_sprite_renderer__ = __webpack_require__(276);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__shaders_texture_shader__ = __webpack_require__(116);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__display_display_object__ = __webpack_require__(118);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__managers_webgl_filter_manager__ = __webpack_require__(119);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__utils_context_performance_hook__ = __webpack_require__(157);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__utils_webgl_webgl_memory_manager_js__ = __webpack_require__(279);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__utils_pixel_array_image__ = __webpack_require__(161);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* global WEBPACK */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */













var RendererType = __WEBPACK_IMPORTED_MODULE_5__globals__["c" /* Constants */].RendererType;

// For server-side environments

/**
 * The renderer that is used for WebGL rendering
 * @class
 * @extends PhotoEditorSDK.Engine.BaseRenderer
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var WebGLRenderer = function (_BaseRenderer) {
  _inherits(WebGLRenderer, _BaseRenderer);

  /**
   * Creates a WebGLRenderer
   * @override
   */
  function WebGLRenderer() {
    var _ref;

    _classCallCheck(this, WebGLRenderer);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = WebGLRenderer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(WebGLRenderer)).call.apply(_ref, [this].concat(args)));

    _this._type = RendererType.WEBGL;

    _this._fakeObject = new __WEBPACK_IMPORTED_MODULE_11__display_display_object__["a" /* default */]();
    _this._onContextLost = _this._onContextLost.bind(_this);
    _this._onContextRestored = _this._onContextRestored.bind(_this);

    _this.setCanvas(_this._options.canvas || __WEBPACK_IMPORTED_MODULE_5__globals__["i" /* Utils */].createCanvas());
    _this._cachedBlitCanvas = __WEBPACK_IMPORTED_MODULE_5__globals__["i" /* Utils */].createCanvas();

    _this.shaders = _this._initShaders();
    _this.renderers = _this._initRenderers();
    return _this;
  }

  // -------------------------------------------------------------------------- CONTEXT LOSS

  /**
   * Gets called when the WebGL context has been lost
   * @param  {Event} e
   * @private
   */


  _createClass(WebGLRenderer, [{
    key: '_onContextLost',
    value: function _onContextLost(e) {
      e.preventDefault();
      __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].warn(this.constructor.name, 'WebGL context has been lost - trying to restore.');
    }

    /**
     * Gets called when the WebGL context could not be created
     * @param  {Object} e
     * @private
     */

  }, {
    key: '_onContextCreationError',
    value: function _onContextCreationError(e) {
      e.preventDefault();
      __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].warn(this.constructor.name, 'Failed to create WebGL context: ' + (e.statusMessage || 'Unknown error'));
    }

    /**
     * Gets called when the WebGL context has been restored. Cleans up and resets everything.
     * @private
     */

  }, {
    key: '_onContextRestored',
    value: function _onContextRestored() {
      __WEBPACK_IMPORTED_MODULE_5__globals__["f" /* Log */].warn(this.constructor.name, 'WebGL context has been restored. Clearing all textures.');

      this._createContext();
      this._setupContext();
      this.emit('context-restored');
    }

    /**
     * Gets called before the context has been set up
     * @private
     */

  }, {
    key: '_onBeforeContext',
    value: function _onBeforeContext() {
      if (this._filterManager) {
        this._filterManager.dispose();
      }
      this._filterManager = new __WEBPACK_IMPORTED_MODULE_12__managers_webgl_filter_manager__["a" /* default */](this);
      this._currentObjectRenderer = new __WEBPACK_IMPORTED_MODULE_8__object_renderers_object_renderer__["a" /* default */](this);
    }

    /**
     * Sets the given shader to active
     * @param {PhotoEditorSDK.Engine.Shader} shader
     */

  }, {
    key: 'setShader',
    value: function setShader(shader) {
      this._currentShader = shader;
      this._context.useProgram(shader.getProgram());
      this._setAttributesForShader(shader);
    }

    /**
     * Sets the canvas to the given one
     * @param {HTMLCanvasElement} canvas
     */

  }, {
    key: 'setCanvas',
    value: function setCanvas(canvas) {
      if (this._canvas) {
        this._removeContextEventListeners();
      }

      _get(WebGLRenderer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(WebGLRenderer.prototype), 'setCanvas', this).call(this, canvas);

      if (this._canvas.addEventListener) {
        // node-canvas doesn't have events
        this._addContextEventListeners();
      }
    }

    /**
     * Adds the context lost / restored / creation error event handlers
     * @private
     */

  }, {
    key: '_addContextEventListeners',
    value: function _addContextEventListeners() {
      this._canvas.addEventListener('webglcontextlost', this._onContextLost);
      this._canvas.addEventListener('webglcontextrestored', this._onContextRestored);
      this._canvas.addEventListener('webglcontextcreationerror', this._onContextCreationError);
    }

    /**
     * Removes the context lost / restored / creation error event handlers
     * @private
     */

  }, {
    key: '_removeContextEventListeners',
    value: function _removeContextEventListeners() {
      this._canvas.removeEventListener('webglcontextlost', this._onContextLost);
      this._canvas.removeEventListener('webglcontextrestored', this._onContextRestored);
      this._canvas.removeEventListener('webglcontextcreationerror', this._onContextCreationError);
    }

    /**
     * Uploads the given shader's attributes to the GPU
     * @param {PhotoEditorSDK.Engine.Shader} shader
     */

  }, {
    key: '_setAttributesForShader',
    value: function _setAttributesForShader(shader) {
      var gl = this._context;
      var attributes = shader.getAttributes();
      var attributeLocations = shader.getAttributeLocations();

      attributes.forEach(function (attributeName) {
        var attributeLocation = attributeLocations[attributeName];
        gl.enableVertexAttribArray(attributeLocation);
      });
    }

    /**
     * Initializes the default shaders
     * @return {Object}
     * @private
     */

  }, {
    key: '_initShaders',
    value: function _initShaders() {
      return {
        default: new __WEBPACK_IMPORTED_MODULE_10__shaders_texture_shader__["a" /* default */](this)
      };
    }

    /**
     * Initializes the available object renderers
     * @return {Object}
     * @private
     */

  }, {
    key: '_initRenderers',
    value: function _initRenderers() {
      return {
        sprite: new __WEBPACK_IMPORTED_MODULE_9__object_renderers_sprite_renderer__["a" /* default */](this)
      };
    }

    /**
     * Gets the rendering context for this renderer
     * @returns {Object}
     * @private
     */

  }, {
    key: '_createContext',
    value: function _createContext() {
      var canvas = this._canvas;
      var gl = null;

      var contextOptions = {
        preserveDrawingBuffer: true
      };

      {
        gl = canvas.getContext('webgl', contextOptions) || canvas.getContext('experimental-webgl', contextOptions);
      }

      // Hook up WebGLDebugUtils if present
      if (typeof window !== 'undefined' && window.WebGLDebugUtils && this._options.debug) {
        var logGL = function logGL(functionName, args) {
          console.error('gl.' + functionName + '(' + window.WebGLDebugUtils.glFunctionArgsToString(functionName, args) + ')');
        };
        gl = window.WebGLDebugUtils.makeDebugContext(gl, null, logGL);
      }

      // Hook up ContextPerformanceHook if debug is enabled
      if (this._options.debug) {
        gl = new __WEBPACK_IMPORTED_MODULE_13__utils_context_performance_hook__["a" /* default */](gl);
        gl = new __WEBPACK_IMPORTED_MODULE_14__utils_webgl_webgl_memory_manager_js__["a" /* default */](gl);
      }

      this.id = gl.id = WebGLRenderer.contextId++;
      this._context = gl;
      gl.renderer = this;

      this._maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);

      this.emit('context', gl);

      return gl;
    }

    /**
     * Sets up the rendering context for this renderer
     * @private
     */

  }, {
    key: '_setupContext',
    value: function _setupContext() {
      var gl = this._context;

      gl.disable(gl.DEPTH_TEST);
      gl.disable(gl.CULL_FACE);
      gl.enable(gl.BLEND);
      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);

      this._defaultRenderTarget = new __WEBPACK_IMPORTED_MODULE_7__utils_webgl_render_target__["a" /* default */](this, this._width, this._height, this._pixelRatio, true);
      this.setRenderTarget(this._defaultRenderTarget);
      this._getMaxPrecision();
    }

    /**
     * Finds the maximum int / float precision for this device
     * @private
     */

  }, {
    key: '_getMaxPrecision',
    value: function _getMaxPrecision() {
      var gl = this._context;
      var highFloat = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);
      this._maxFloatPrecision = highFloat.precision !== 0 ? 'highp' : 'mediump';

      var highInt = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_INT);
      this._maxIntPrecision = highInt.rangeMax !== 0 ? 'highp' : 'lowp';
    }

    /**
     * Resizes the context and view to the given size
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @param  {Boolean} resizeCanvas = true
     */

  }, {
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      var resizeCanvas = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      _get(WebGLRenderer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(WebGLRenderer.prototype), 'resizeTo', this).call(this, dimensions, resizeCanvas);

      if (this._currentRenderTarget) {
        this._currentRenderTarget.resizeTo(dimensions);
      }
    }

    /**
     * Sets the current render target to the passed one and activates
     * it for rendering
     * @param {PhotoEditorSDK.Engine.RenderTarget} renderTarget
     */

  }, {
    key: 'setRenderTarget',
    value: function setRenderTarget() {
      var renderTarget = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._defaultRenderTarget;

      this._currentRenderTarget = renderTarget;
      this._currentRenderTarget.activate();
    }

    /**
     * Sets the current object renderer to the given one
     * @param {PhotoEditorSDK.Engine.ObjectRenderer} objectRenderer
     */

  }, {
    key: 'setObjectRenderer',
    value: function setObjectRenderer(objectRenderer) {
      this._currentObjectRenderer.stop();
      this._currentObjectRenderer = objectRenderer;
      this._currentObjectRenderer.start();
    }

    /**
     * Renders the given DisplayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     */

  }, {
    key: 'render',
    value: function render(displayObject) {
      this.setRenderTarget(this._defaultRenderTarget);
      this._defaultRenderTarget.clear(this._clearColor);

      // Since the given displayObject is the "root" object
      // right now, we need to give it a dummy / fake object
      // as parent with the default world transform and alpha
      var originalParent = displayObject.getParent();
      displayObject.setParent(this._fakeObject);

      // Update transforms and render this object
      displayObject.updateTransform();

      // Reset parent
      displayObject.setParent(originalParent);

      this.renderDisplayObject(displayObject, this._defaultRenderTarget);
    }

    /**
     * Renders the given DisplayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @param  {PhotoEditorSDK.Engine.RenderTarget} renderTarget
     */

  }, {
    key: 'renderDisplayObject',
    value: function renderDisplayObject(displayObject, renderTarget) {
      this.setRenderTarget(renderTarget);
      this._filterManager.setFilterStack(renderTarget.getFilterStack());
      displayObject.renderWebGL(this);
      this._currentObjectRenderer.flush();
    }

    /**
     * Clears the context
     */

  }, {
    key: 'clear',
    value: function clear() {
      var gl = this._context;

      gl.clearColor.apply(gl, this._clearColor.toGLColor());
      gl.clear(gl.COLOR_BUFFER_BIT);
    }

    /**
     * Saves the renderer state and returns the state object
     * @return {Object}
     */

  }, {
    key: 'save',
    value: function save() {
      return {
        renderTarget: this._currentRenderTarget,
        objectRenderer: this._currentObjectRenderer,
        filterStack: this._filterManager.getFilterStack()
      };
    }

    /**
     * Restores the given renderer state
     * @param  {Object} save
     */

  }, {
    key: 'restore',
    value: function restore(save) {
      this.setRenderTarget(save.renderTarget);
      this._filterManager.setFilterStack(save.filterStack);
      this._currentObjectRenderer = save.objectRenderer;
    }

    /**
     * Returns and/or creates a WebGLTexture for the given BaseTexture object
     * @param  {PhotoEditorSDK.Engine.BaseTexture} texture
     * @return {PhotoEditorSDK.Engine.WebGLTexture}
     */

  }, {
    key: 'getOrCreateGLTexture',
    value: function getOrCreateGLTexture(texture) {
      var gl = this._context;
      var glTexture = texture.getGLTextureForRenderer(this);
      if (!glTexture) {
        glTexture = gl.createTexture();
        texture.setGLTextureForRenderer(glTexture, this);
        // Hold reference to texture for easier disposal
      }
      return glTexture;
    }

    /**
     * Updates the given texture
     * @param  {PhotoEditorSDK.Engine.BaseTexture} texture
     * @param  {Boolean} [upload = true]
     */

  }, {
    key: 'updateTexture',
    value: function updateTexture(texture) {
      var upload = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      var source = texture.getSource();
      var hasSource = !!source;

      var gl = this._context;
      var glUnit = texture.getGLUnit();
      var glTexture = this.getOrCreateGLTexture(texture);

      gl.activeTexture(gl.TEXTURE0 + glUnit);
      gl.bindTexture(gl.TEXTURE_2D, glTexture);

      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);

      if (upload && hasSource) {
        if (source instanceof __WEBPACK_IMPORTED_MODULE_15__utils_pixel_array_image__["a" /* default */]) {
          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, source.width, source.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, source.data);
        } else {
          // Workaround fro non-RGB images. This should only be done
          var canvas = __WEBPACK_IMPORTED_MODULE_5__globals__["i" /* Utils */].convertHtmlImageToRGBACanvas(source, this._cachedBlitCanvas);
          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, canvas);
        }
      }

      if (texture.isMipMappingEnabled()) {
        gl.generateMipmap(gl.TEXTURE_2D);
      } else {
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, texture.getGLRepeat(gl, 'x'));
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, texture.getGLRepeat(gl, 'y'));
      }
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, texture.getGLFilter(gl, 'min'));
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, texture.getGLFilter(gl, 'mag'));
      gl.activeTexture(gl.TEXTURE0);
    }

    /**
     * Returns the maximum dimensions
     * @return {Number}
     */

  }, {
    key: 'getMaxDimensions',
    value: function getMaxDimensions() {
      // node-gl support
      var canvas = __WEBPACK_IMPORTED_MODULE_5__globals__["i" /* Utils */].createCanvas();
      var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
      if (!gl) {
        return null;
      } else {
        var maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);
        var loseContextExtension = gl.getExtension('WEBGL_lose_context');
        if (loseContextExtension) {
          loseContextExtension.loseContext();
        }
        return maxTextureSize;
      }
    }

    /**
     * Returns the current render target
     * @return {PhotoEditorSDK.Engine.RenderTarget}
     */

  }, {
    key: 'getCurrentRenderTarget',
    value: function getCurrentRenderTarget() {
      return this._currentRenderTarget;
    }

    /**
     * Returns the current object renderer
     * @return {PhotoEditorSDK.Engine.ObjectRenderer}
     */

  }, {
    key: 'getCurrentObjectRenderer',
    value: function getCurrentObjectRenderer() {
      return this._currentObjectRenderer;
    }

    /**
     * Checks if this renderer is supported on the current device and browser
     * @return {Boolean}
     */

  }, {
    key: 'getMaxFloatPrecision',


    /**
     * Returns the maximum float precision for this device (lowp/mediump/highp)
     * @return {String}
     */
    value: function getMaxFloatPrecision() {
      return this._maxFloatPrecision;
    }

    /**
     * Returns the maximum int precision for this device (lowp/mediump/highp)
     * @return {String}
     */

  }, {
    key: 'getMaxIntPrecision',
    value: function getMaxIntPrecision() {
      return this._maxIntPrecision;
    }

    /**
     * Disposes this Renderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._filterManager.dispose();
      this._currentObjectRenderer.dispose();
      this._defaultRenderTarget.dispose();

      for (var shader in this.shaders) {
        this.shaders[shader].dispose();
        delete this.shaders[shader];
      }

      this._removeContextEventListeners();

      var gl = this._context;
      var loseContextExtension = gl.getExtension('WEBGL_lose_context');
      if (loseContextExtension) {
        loseContextExtension.loseContext();
      }
    }
  }], [{
    key: 'isSupported',
    value: function isSupported() {
      var canvas = __WEBPACK_IMPORTED_MODULE_5__globals__["i" /* Utils */].createCanvas();
      canvas.addEventListener('webglcontextcreationerror', this.prototype._onContextCreationError);
      var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
      var hasWebGLSupport = !!gl;
      if (hasWebGLSupport) {
        var gpuName = __WEBPACK_IMPORTED_MODULE_5__globals__["e" /* GLUtils */].determineGPUName(gl);
        var isBlacklisted = __WEBPACK_IMPORTED_MODULE_5__globals__["e" /* GLUtils */].isGPUBlacklisted(gpuName);
        hasWebGLSupport &= !isBlacklisted;
      }
      canvas.removeEventListener('webglcontextcreationerror', this.prototype._onContextCreationError);
      return hasWebGLSupport;
    }
  }]);

  return WebGLRenderer;
}(__WEBPACK_IMPORTED_MODULE_6__base_renderer__["a" /* default */]);

WebGLRenderer.contextId = 0;
WebGLRenderer.type = 'WebGL';

/* harmony default export */ __webpack_exports__["a"] = (WebGLRenderer);

/***/ }),
/* 274 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(275);
var $Object = __webpack_require__(11).Object;
module.exports = function getOwnPropertyDescriptor(it, key) {
  return $Object.getOwnPropertyDescriptor(it, key);
};


/***/ }),
/* 275 */
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
var toIObject = __webpack_require__(35);
var $getOwnPropertyDescriptor = __webpack_require__(96).f;

__webpack_require__(103)('getOwnPropertyDescriptor', function () {
  return function getOwnPropertyDescriptor(it, key) {
    return $getOwnPropertyDescriptor(toIObject(it), key);
  };
});


/***/ }),
/* 276 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__object_renderer__ = __webpack_require__(159);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* eslint constructor-super: 0 */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * The ObjectRenderer that is responsible for rendering Sprite instances
 * @class
 * @extends PhotoEditorSDK.Engine.ObjectRenderer
 * @memberof PhotoEditorSDK.Engine
 */
/* istanbul ignore next */

var SpriteRenderer = function (_ObjectRenderer) {
  _inherits(SpriteRenderer, _ObjectRenderer);

  /**
   * Creates a SpriteRenderer
   * @override
   */
  function SpriteRenderer() {
    var _ref;

    _classCallCheck(this, SpriteRenderer);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = SpriteRenderer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(SpriteRenderer)).call.apply(_ref, [this].concat(args)));

    _this._maxBatchSize = __WEBPACK_IMPORTED_MODULE_5__globals__["a" /* BATCH_SIZE */];
    _this._vertices = new ArrayBuffer(__WEBPACK_IMPORTED_MODULE_5__globals__["a" /* BATCH_SIZE */] * 4 * __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* VERTEX_BYTE_SIZE */]);
    _this._positions = new Float32Array(_this._vertices);
    _this._colors = new Uint32Array(_this._vertices);
    _this._indices = new Uint16Array(__WEBPACK_IMPORTED_MODULE_5__globals__["a" /* BATCH_SIZE */] * 6);

    // Fill vertex position indices
    for (var i = 0, j = 0; i < __WEBPACK_IMPORTED_MODULE_5__globals__["a" /* BATCH_SIZE */] * 6; i += 6, j += 4) {
      _this._indices[i + 0] = j + 0;
      _this._indices[i + 1] = j + 1;
      _this._indices[i + 2] = j + 2;
      _this._indices[i + 3] = j + 0;
      _this._indices[i + 4] = j + 2;
      _this._indices[i + 5] = j + 3;
    }

    _this._shaders = [];
    _this._sprites = [];

    _this._currentBatchSize = 0;

    _this._onContextChange();
    return _this;
  }

  /**
   * Adds the given sprite to the batch
   * @param  {PhotoEditorSDK.Engine.Sprite} sprite
   */


  _createClass(SpriteRenderer, [{
    key: 'render',
    value: function render(sprite) {
      var texture = sprite.getTexture();
      var textureFrame = texture.getFrame();
      var baseTexture = texture.getBaseTexture();

      // Has the maximum batch size been reached? Flush!
      if (this._currentBatchSize >= this._maxBatchSize) {
        this.flush();
      }

      // No updated UVs => No rendering
      var uvs = texture.getUVs();
      if (!uvs) {
        return;
      }

      // Fill positions array
      var index = this._currentBatchSize * __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* VERTEX_BYTE_SIZE */];
      this._addVertexCoordinates(sprite, index, textureFrame);
      this._addTextureUVs(sprite, index, uvs);
      this._addColors(sprite, index);

      // Add the sprite to the list of sprites
      this._sprites[this._currentBatchSize] = sprite;
      this._currentBatchSize++;
    }

    /**
     * Adds the color to the positions array for the given sprite
     * @param {PhotoEditorSDK.Engine.Sprite} sprite
     * @param {Number} index
     * @private
     */

  }, {
    key: '_addColors',
    value: function _addColors(sprite, index) {
      var colors = this._colors;
      var tint = sprite.getTint();
      var color = (tint >> 16) + (tint & 0xff00) + ((tint & 0xff) << 16) + (sprite.getWorldAlpha() * 255 << 24);
      colors[index + 4] = colors[index + 9] = colors[index + 14] = colors[index + 19] = color;
    }

    /**
     * Adds the texture UV coordinates to the positions array for the given sprite
     * @param {PhotoEditorSDK.Engine.Sprite} sprite
     * @param {Number} index
     * @param {PhotoEditorSDK.Engine.TextureUVs} uvs
     * @private
     */

  }, {
    key: '_addTextureUVs',
    value: function _addTextureUVs(sprite, index, uvs) {
      var positions = this._positions;

      // Add UVs
      var uvCoords = uvs.getUVsAt(0);
      positions[index + 2] = uvCoords.x;
      positions[index + 3] = uvCoords.y;

      uvCoords = uvs.getUVsAt(1);
      positions[index + 7] = uvCoords.x;
      positions[index + 8] = uvCoords.y;

      uvCoords = uvs.getUVsAt(2);
      positions[index + 12] = uvCoords.x;
      positions[index + 13] = uvCoords.y;

      uvCoords = uvs.getUVsAt(3);
      positions[index + 17] = uvCoords.x;
      positions[index + 18] = uvCoords.y;
    }

    /**
     * Adds the vertex coordinates to the positions array for the given
     * sprite and texture frame
     * @param {PhotoEditorSDK.Engine.Sprite} sprite
     * @param {Number} index
     * @param {PhotoEditorSDK.Math.Rectangle} textureFrame
     * @private
     */

  }, {
    key: '_addVertexCoordinates',
    value: function _addVertexCoordinates(sprite, index, textureFrame) {
      var positions = this._positions;
      var worldTransform = sprite.getWorldTransform();

      // Transform sprite coords with anchor in mind
      var anchor = sprite.getAnchor();
      var rectPositions = worldTransform.rectangleToCoordinates(textureFrame, anchor);

      var stride = 5;
      for (var i = 0; i < 4; i++) {
        positions[index + i * stride] = rectPositions[i].x;
        positions[index + i * stride + 1] = rectPositions[i].y;
      }
    }

    /**
     * Gets called when the rendering context changes
     * @private
     */

  }, {
    key: '_onContextChange',
    value: function _onContextChange() {
      var gl = this._renderer.getContext();

      this._shader = this._renderer.shaders.default;
      if (this._vertexBuffer) {
        gl.deleteBuffer(this._vertexBuffer);
        this._vertexBuffer = null;
      }
      if (this._indexBuffer) {
        gl.deleteBuffer(this._indexBuffer);
        this._indexBuffer = null;
      }
      this._vertexBuffer = gl.createBuffer();
      this._indexBuffer = gl.createBuffer();

      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this._indexBuffer);
      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this._indices, gl.STATIC_DRAW);

      gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexBuffer);
      gl.bufferData(gl.ARRAY_BUFFER, this._vertices, gl.DYNAMIC_DRAW);
    }

    /**
     * Gets called when this object renderer is activated
     */

  }, {
    key: 'start',
    value: function start() {
      this._shader.setupBuffers(this._vertexBuffer, this._indexBuffer);
    }

    /**
     * Renders the queued sprites in batches, every time the base texture has changed,
     * it flushes the current batch to the graphics card
     */

  }, {
    key: 'flush',
    value: function flush() {
      var renderer = this._renderer;
      var gl = renderer.getContext();

      if (this._currentBatchSize === 0) {
        return;
      }

      if (this._currentBatchSize > __WEBPACK_IMPORTED_MODULE_5__globals__["a" /* BATCH_SIZE */] * 0.5) {
        // Upload whole ArrayBuffer
        gl.bufferSubData(gl.ARRAY_BUFFER, 0, this._vertices);
      } else {
        // Only upload sub array
        var subArray = this._positions.subarray(0, this._currentBatchSize * __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* VERTEX_BYTE_SIZE */]);
        gl.bufferSubData(gl.ARRAY_BUFFER, 0, subArray);
      }

      // Init variables
      var currentBatchSize = 0;
      var currentBaseTexture = null;
      var nextBaseTexture = null;
      var currentShader = null;
      var nextShader = null;
      var shaderChanged = false;
      var textureChanged = false;
      var sprite = null;
      var batchStartIndex = 0;

      for (var i = 0, j = this._currentBatchSize; i < j; i++) {
        sprite = this._sprites[i];

        nextBaseTexture = sprite.getTexture().getBaseTexture();
        nextShader = sprite.getShader() || this._shader;
        shaderChanged = currentShader !== nextShader;
        textureChanged = currentBaseTexture !== nextBaseTexture;

        if (textureChanged || shaderChanged) {
          this._renderBatch(currentBaseTexture, currentBatchSize, batchStartIndex);

          batchStartIndex = i;
          currentBatchSize = 0;
          currentBaseTexture = nextBaseTexture;

          // Shader has changed, set it
          if (shaderChanged) {
            currentShader = nextShader;
            renderer.setShader(currentShader);

            var renderTarget = renderer.getCurrentRenderTarget();
            var projectionMatrix = renderTarget.getProjectionMatrix().toArray();
            currentShader.setUniform('u_projMatrix', projectionMatrix);
            currentShader.syncUniforms();

            gl.activeTexture(gl.TEXTURE0);
          }
        }

        currentBatchSize++;
      }

      this._renderBatch(currentBaseTexture, currentBatchSize, batchStartIndex);

      // Reset the batch
      this._currentBatchSize = 0;
      this._sprites = [];
    }

    /**
     * Renders the current batch
     * @param  {PhotoEditorSDK.Engine.BaseTexture} baseTexture
     * @param  {Number} batchSize
     * @param  {Number} batchStartIndex
     * @private
     */

  }, {
    key: '_renderBatch',
    value: function _renderBatch(baseTexture, batchSize, batchStartIndex) {
      if (batchSize === 0) {
        return;
      }

      var renderer = this._renderer;
      var gl = renderer.getContext();

      var glTexture = baseTexture.getGLTextureForRenderer(renderer);
      if (!glTexture) {
        glTexture = renderer.getOrCreateGLTexture(baseTexture);
      }

      if (baseTexture.isDirty()) {
        renderer.updateTexture(baseTexture);
        baseTexture.setDirty(false);
      }

      gl.activeTexture(gl.TEXTURE0 + baseTexture.getGLUnit());
      gl.bindTexture(gl.TEXTURE_2D, glTexture);

      var verticesCount = batchSize * 6;
      var vertexOffset = batchStartIndex * 6 * 2;
      gl.drawElements(gl.TRIANGLES, verticesCount, gl.UNSIGNED_SHORT, vertexOffset);
    }

    /**
     * Disposes this ObjectRenderer
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var renderer = this._renderer;
      var gl = renderer.getContext();
      for (var sprite in this._sprites) {
        sprite.dispose();
      }
      if (this._vertexBuffer) {
        gl.deleteBuffer(this._vertexBuffer);
        this._vertexBuffer = null;
      }
      if (this._indexBuffer) {
        gl.deleteBuffer(this._indexBuffer);
        this._indexBuffer = null;
      }

      this._vertices = null;
      this._positions = null;
      this._colors = null;
      this._indices = null;

      _get(SpriteRenderer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(SpriteRenderer.prototype), 'dispose', this).call(this);
    }
  }]);

  return SpriteRenderer;
}(__WEBPACK_IMPORTED_MODULE_6__object_renderer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (SpriteRenderer);

/***/ }),
/* 277 */
/***/ (function(module, exports) {

module.exports = "attribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\nuniform mat3 u_projMatrix;\n\nvoid main() {\n  gl_Position = vec4((u_projMatrix * vec3(a_position, 1)).xy, 0, 1);\n  v_texCoord = a_texCoord;\n  v_color = vec4(a_color.rgb * a_color.a, a_color.a);\n}\n";

/***/ }),
/* 278 */
/***/ (function(module, exports) {

module.exports = "uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_texCoord) * v_color;\n}\n";

/***/ }),
/* 279 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_stats_js__ = __webpack_require__(280);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_stats_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_stats_js__);





var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


/**
 * This class hooks into WebGL calls and tracks the creation and
 * disposal of WebGL textures, shaders etc.
 * @ignore
 */

var WebGLMemoryManager = function () {
  function WebGLMemoryManager(context) {
    _classCallCheck(this, WebGLMemoryManager);

    this._context = context;
    this._domAvailable = typeof document !== 'undefined';
    this._hookIntoContext();
    this._textures = {};
    this._framebuffers = {};
    this._programs = {};
    this._shaders = {};
    this._buffers = {};
    this._boundTexture = null;
    this._id = 0;
    this._enums = {};

    this._setupStats();
    this._createEnumMap();

    this._updateMemoryStats = this._updateMemoryStats.bind(this);
    this._updateMemoryStats();
  }

  /**
   * Creates a value => key map of all WebGL enum values
   * @private
   */


  _createClass(WebGLMemoryManager, [{
    key: '_createEnumMap',
    value: function _createEnumMap() {
      for (var key in this._context) {
        var value = this._context[key];
        if (typeof value === 'number') {
          this._enums[value] = key;
        }
      }
    }

    /**
     * Returns the enum key for the given enum value
     * @param  {Number} value
     * @return {String}
     * @private
     */

  }, {
    key: '_enumValueToString',
    value: function _enumValueToString(value) {
      var key = this._enums[value];
      return typeof key === 'undefined' ? value : key;
    }

    /**
     * Sets up stats.js
     * @private
     */

  }, {
    key: '_setupStats',
    value: function _setupStats() {
      if (!this._domAvailable) return;

      this._stats = new __WEBPACK_IMPORTED_MODULE_4_stats_js___default.a();
      this._stats.showPanel(3);
      this._memPanel = this._stats.addPanel(new __WEBPACK_IMPORTED_MODULE_4_stats_js___default.a.Panel('MB [WebGL]', '#43ADEB', '#282828'));
      this._texPanel = this._stats.addPanel(new __WEBPACK_IMPORTED_MODULE_4_stats_js___default.a.Panel('Textures', '#43ADEB', '#282828'));
      this._bufPanel = this._stats.addPanel(new __WEBPACK_IMPORTED_MODULE_4_stats_js___default.a.Panel('Buffers', '#43ADEB', '#282828'));
      this._fboPanel = this._stats.addPanel(new __WEBPACK_IMPORTED_MODULE_4_stats_js___default.a.Panel('FBOs', '#43ADEB', '#282828'));
      this._prgPanel = this._stats.addPanel(new __WEBPACK_IMPORTED_MODULE_4_stats_js___default.a.Panel('Programs', '#43ADEB', '#282828'));
      this._shdPanel = this._stats.addPanel(new __WEBPACK_IMPORTED_MODULE_4_stats_js___default.a.Panel('Shaders', '#43ADEB', '#282828'));
    }

    /**
     * Updates the given panel
     * @param  {String} panel
     * @private
     */

  }, {
    key: '_updatePanel',
    value: function _updatePanel(panel) {
      if (!this._domAvailable) return;

      this._stats.begin();
      switch (panel) {
        case 'tex':
          this._texPanel.update(this.getTexturesCount(), 50);
          break;
        case 'buf':
          this._bufPanel.update(this.getBuffersCount(), 50);
          break;
        case 'fbo':
          this._fboPanel.update(this.getFBOCount(), 50);
          break;
        case 'prg':
          this._prgPanel.update(this.getProgramCount(), 50);
          break;
        case 'shd':
          this._shdPanel.update(this.getShaderCount(), 50);
          break;
      }
      this._stats.end();
    }
  }, {
    key: 'getTexturesCount',
    value: function getTexturesCount() {
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(this._textures).length;
    }
  }, {
    key: 'getBuffersCount',
    value: function getBuffersCount() {
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(this._buffers).length;
    }
  }, {
    key: 'getFBOCount',
    value: function getFBOCount() {
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(this._framebuffers).length;
    }
  }, {
    key: 'getProgramCount',
    value: function getProgramCount() {
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(this._programs).length;
    }
  }, {
    key: 'getShaderCount',
    value: function getShaderCount() {
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(this._shaders).length;
    }

    /**
     * Updates the memory chart
     * @private
     */

  }, {
    key: '_updateMemoryStats',
    value: function _updateMemoryStats() {
      if (!this._domAvailable) return;

      var memory = this._getMemoryUsage() / 1000 / 1000;
      this._memPanel.update(memory, 400);

      setTimeout(this._updateMemoryStats, 1000);
    }

    /**
     * Returns the estimated memory usage in bytes
     * @return {Number}
     * @private
     */

  }, {
    key: '_getMemoryUsage',
    value: function _getMemoryUsage() {
      var bytes = 0;
      for (var name in this._textures) {
        bytes += this._textures[name].memory;
      }
      for (var _name in this._buffers) {
        bytes += this._buffers[_name].memory;
      }
      return bytes;
    }

    /**
     * Replaces all WebGL functions with spy functions in order to track texture
     * creation and disposal
     * @private
     */

  }, {
    key: '_hookIntoContext',
    value: function _hookIntoContext() {
      var _this = this;

      var _loop = function _loop(key) {
        var value = _this._context[key];
        if (typeof value === 'function') {
          _this[key] = function () {
            var fn = this._context[key];

            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
              args[_key] = arguments[_key];
            }

            return this._trackGLCall(fn, key, args);
          };
        } else {
          _this._makePropertyWrapper(key);
        }
      };

      for (var key in this._context) {
        _loop(key);
      }
    }

    /**
     * Creates the getter and setter for the given property
     * @param  {String} property
     * @private
     */

  }, {
    key: '_makePropertyWrapper',
    value: function _makePropertyWrapper(property) {
      var insecureProperties = ['_context'];
      if (insecureProperties.indexOf(property) !== -1) return;

      var context = this._context;

      this.__defineGetter__(property, function () {
        return context[property];
      });

      this.__defineSetter__(property, function (value) {
        context[property] = value;
      });
    }

    /**
     * Gets called when a WebGL function is called
     * @param  {Function} fn
     * @param  {String} functionName
     * @param  {Array} args
     * @private
     */

  }, {
    key: '_trackGLCall',
    value: function _trackGLCall(fn, functionName, args) {
      var overrideFunctions = ['texImage2D', 'bindTexture', 'createTexture', 'deleteTexture', 'createBuffer', 'bindBuffer', 'bufferData', 'deleteBuffer', 'createFramebuffer', 'deleteFramebuffer', 'createProgram', 'deleteProgram', 'createShader', 'deleteShader'];

      var result = void 0;
      if (overrideFunctions.indexOf(functionName) !== -1) {
        result = this['_' + functionName](args);
      } else {
        result = fn.apply(this._context, args);
      }

      var err = this._context.getError();
      if (err !== 0) {
        var truncatedArgs = args.join(', ');
        if (truncatedArgs.length > 100) {
          truncatedArgs = truncatedArgs.substr(0, 100) + '...';
        }
        console.error(new Error('WebGL Error ' + this._enumValueToString(err) + ' in ' + functionName + '(' + truncatedArgs + ')'));
      }
      return result;
    }

    /**
     * Gets called when `createProgram` is called on the WebGL context
     * @private
     */

  }, {
    key: '_createProgram',
    value: function _createProgram() {
      var program = this._context.createProgram();
      program._wmmId = this._id++;

      this._programs[program._wmmId] = program;

      this._updatePanel('prg');

      return program;
    }

    /**
     * Deletes the given program
     * @param  {WebGLProgram} program
     * @private
     */

  }, {
    key: '_deleteProgram',
    value: function _deleteProgram(_ref) {
      var _ref2 = _slicedToArray(_ref, 1),
          program = _ref2[0];

      if (!program || !this._programs[program._wmmId]) return;

      delete this._programs[program._wmmId];
      this._context.deleteProgram(program);

      this._updatePanel('prg');
    }

    /**
     * Gets called when `createShader` is called on the WebGL context
     * @param {GLenum} type
     * @private
     */

  }, {
    key: '_createShader',
    value: function _createShader(_ref3) {
      var _ref4 = _slicedToArray(_ref3, 1),
          type = _ref4[0];

      var shader = this._context.createShader(type);
      shader._wmmId = this._id++;

      this._shaders[shader._wmmId] = shader;

      this._updatePanel('shd');

      return shader;
    }

    /**
     * Deletes the given shader
     * @param  {WebGLShader} shader
     * @private
     */

  }, {
    key: '_deleteShader',
    value: function _deleteShader(_ref5) {
      var _ref6 = _slicedToArray(_ref5, 1),
          shader = _ref6[0];

      if (!shader || !this._shaders[shader._wmmId]) return;

      delete this._shaders[shader._wmmId];
      this._context.deleteShader(shader);

      this._updatePanel('shd');
    }

    /**
     * Gets called when `createFramebuffer` is called on the WebGL context
     * @private
     */

  }, {
    key: '_createFramebuffer',
    value: function _createFramebuffer() {
      var framebuffer = this._context.createFramebuffer();
      framebuffer._wmmId = this._id++;

      this._framebuffers[framebuffer._wmmId] = framebuffer;

      this._updatePanel('fbo');

      return framebuffer;
    }

    /**
     * Deletes the given framebuffer
     * @param  {WebGLFramebuffer} framebuffer
     * @private
     */

  }, {
    key: '_deleteFramebuffer',
    value: function _deleteFramebuffer(_ref7) {
      var _ref8 = _slicedToArray(_ref7, 1),
          framebuffer = _ref8[0];

      if (!framebuffer || !this._framebuffers[framebuffer._wmmId]) return;

      delete this._framebuffers[framebuffer._wmmId];
      this._context.deleteFramebuffer(framebuffer);

      this._updatePanel('fbo');
    }

    /**
     * Gets called when `createBuffer` is called on the WebGL context
     * @private
     */

  }, {
    key: '_createBuffer',
    value: function _createBuffer() {
      var buffer = this._context.createBuffer();
      buffer._wmmId = this._id++;

      this._buffers[buffer._wmmId] = {
        buffer: buffer,
        memory: 0
      };

      this._updatePanel('buf');

      return buffer;
    }

    /**
     * Binds the given buffer
     * @param  {GLenum} target
     * @param  {WebGLBuffer} buffer
     * @private
     */

  }, {
    key: '_bindBuffer',
    value: function _bindBuffer(_ref9) {
      var _ref10 = _slicedToArray(_ref9, 2),
          target = _ref10[0],
          buffer = _ref10[1];

      this._context.bindBuffer(target, buffer);

      this._boundBuffer = buffer._wmmId;
    }

    /**
     * Initializes the buffer's data store
     * @param  {GLenum} target
     * @param  {GLsizeiptr|ArrayBuffer} sizeOrData
     * @param  {GLenum} usage
     * @private
     */

  }, {
    key: '_bufferData',
    value: function _bufferData(_ref11) {
      var _ref12 = _slicedToArray(_ref11, 3),
          target = _ref12[0],
          sizeOrData = _ref12[1],
          usage = _ref12[2];

      this._context.bufferData(target, sizeOrData, usage);

      var size = void 0;
      if (typeof sizeOrData === 'number') {
        size = sizeOrData; // size
      } else if ('byteLength' in sizeOrData) {
        size = sizeOrData.byteLength; // data
      } else if ('length' in sizeOrData) {
        size = sizeOrData.length; // data
      }

      this._buffers[this._boundBuffer].memory = size;
    }

    /**
     * Deletes the given buffer
     * @param  {WebGLBuffer} buffer
     * @private
     */

  }, {
    key: '_deleteBuffer',
    value: function _deleteBuffer(_ref13) {
      var _ref14 = _slicedToArray(_ref13, 1),
          buffer = _ref14[0];

      if (!buffer || !this._buffers[buffer._wmmId]) return;

      delete this._buffers[buffer._wmmId];
      this._context.deleteBuffer(buffer);

      this._updatePanel('buf');
    }

    /**
     * Gets called when `createTexture` is called on the WebGL context
     * @private
     */

  }, {
    key: '_createTexture',
    value: function _createTexture() {
      var texture = this._context.createTexture();
      texture._wmmId = this._id++;

      this._textures[texture._wmmId] = {
        texture: texture,
        memory: 0
      };

      this._updatePanel('tex');

      return texture;
    }

    /**
     * Deletes the given texture
     * @param  {WebGLTexture} texture
     * @private
     */

  }, {
    key: '_deleteTexture',
    value: function _deleteTexture(_ref15) {
      var _ref16 = _slicedToArray(_ref15, 1),
          texture = _ref16[0];

      if (!texture || !this._textures[texture._wmmId]) return;

      delete this._textures[texture._wmmId];
      this._context.deleteTexture(texture);

      this._updatePanel('tex');
    }

    /**
     * Gets called when `bindTexture` is called on the WebGL context
     * @param  {GLenum} target
     * @param  {WebGLTexture} texture
     * @private
     */

  }, {
    key: '_bindTexture',
    value: function _bindTexture(_ref17) {
      var _ref18 = _slicedToArray(_ref17, 2),
          target = _ref18[0],
          texture = _ref18[1];

      this._context.bindTexture(target, texture);

      this._boundTexture = texture._wmmId;
    }

    /**
     * Gets called when `texImage2D` is called on the WebGL context
     * @param  {GLEnum} target
     * @param  {GLint} level
     * @param  {GLint} internalformat
     * @param  {GLsizei} width
     * @param  {Glsizei} height
     * @param  {GLint} border
     * @param  {GLenum} format
     * @param  {GLenum} type
     * @param  {*} pixels
     */

  }, {
    key: '_texImage2D',
    value: function _texImage2D(args) {
      var _args = _slicedToArray(args, 9),
          internalformat = _args[2],
          width = _args[3],
          height = _args[4],
          border = _args[5],
          pixels = _args[8];

      if (typeof pixels === 'undefined') {
        pixels = border;
      }

      // Create texture
      this._context.texImage2D.apply(this._context, args);

      var byteCount = this._calculateByteCountForTexture(internalformat, width, height, pixels);
      this._textures[this._boundTexture].memory = byteCount;
    }

    /**
     * Calculates the byte count for the given texture information
     * @param  {GLint} format
     * @param  {GLsizei} width
     * @param  {GLsizei} height
     * @param  {*} pixels
     * @return {Number}
     * @private
     */

  }, {
    key: '_calculateByteCountForTexture',
    value: function _calculateByteCountForTexture(format, width, height, pixels) {
      if (pixels !== null) {
        if ('width' in pixels) {
          width = pixels.width;
          height = pixels.height;
        } else {
          return pixels.length;
        }
      }

      var bytesPerPixel = 1;
      switch (format) {
        case this._context.ALPHA:
          bytesPerPixel = 1;
          break;
        case this._context.RGB:
          bytesPerPixel = 3;
          break;
        case this._context.RGBA:
          bytesPerPixel = 4;
          break;
      }

      return width * height * bytesPerPixel;
    }
  }]);

  return WebGLMemoryManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (WebGLMemoryManager);

/***/ }),
/* 280 */
/***/ (function(module, exports) {

// stats.js - http://github.com/mrdoob/stats.js
var Stats=function(){function h(a){c.appendChild(a.dom);return a}function k(a){for(var d=0;d<c.children.length;d++)c.children[d].style.display=d===a?"block":"none";l=a;}var l=0,c=document.createElement("div");c.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000";c.addEventListener("click",function(a){a.preventDefault();k(++l%c.children.length);},!1);var g=(performance||Date).now(),e=g,a=0,r=h(new Stats.Panel("FPS","#0ff","#002")),f=h(new Stats.Panel("MS","#0f0","#020"));
if(self.performance&&self.performance.memory)var t=h(new Stats.Panel("MB","#f08","#201"));k(0);return {REVISION:16,dom:c,addPanel:h,showPanel:k,begin:function(){g=(performance||Date).now();},end:function(){a++;var c=(performance||Date).now();f.update(c-g,200);if(c>e+1E3&&(r.update(1E3*a/(c-e),100),e=c,a=0,t)){var d=performance.memory;t.update(d.usedJSHeapSize/1048576,d.jsHeapSizeLimit/1048576);}return c},update:function(){g=this.end();},domElement:c,setMode:k}};
Stats.Panel=function(h,k,l){var c=Infinity,g=0,e=Math.round,a=e(window.devicePixelRatio||1),r=80*a,f=48*a,t=3*a,u=2*a,d=3*a,m=15*a,n=74*a,p=30*a,q=document.createElement("canvas");q.width=r;q.height=f;q.style.cssText="width:80px;height:48px";var b=q.getContext("2d");b.font="bold "+9*a+"px Helvetica,Arial,sans-serif";b.textBaseline="top";b.fillStyle=l;b.fillRect(0,0,r,f);b.fillStyle=k;b.fillText(h,t,u);b.fillRect(d,m,n,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d,m,n,p);return {dom:q,update:function(f,
v){c=Math.min(c,f);g=Math.max(g,f);b.fillStyle=l;b.globalAlpha=1;b.fillRect(0,0,r,m);b.fillStyle=k;b.fillText(e(f)+" "+h+" ("+e(c)+"-"+e(g)+")",t,u);b.drawImage(q,d+a,m,n-a,p,d,m,n-a,p);b.fillRect(d+n-a,m,a,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d+n-a,m,a,e((1-f/v)*p));}}};"object"===typeof module&&(module.exports=Stats);


/***/ }),
/* 281 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(12);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Represents the UV coordinates of a texture
 * @class
 * @memberof PhotoEditorSDK.Engine
 */

var TextureUVs = function () {
  /**
   * Creates a TextureUVs instance
   */
  function TextureUVs() {
    _classCallCheck(this, TextureUVs);

    this._uvs = [new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](0, 0), new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](1, 0), new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](1, 1), new __WEBPACK_IMPORTED_MODULE_1__globals__["k" /* Vector2 */](0, 1)];
  }

  /**
   * Updates the UVs based on the given baseframe
   * @param  {Rectangle} frame
   * @param  {Rectangle} baseFrame
   */


  _createClass(TextureUVs, [{
    key: 'update',
    value: function update(frame, baseFrame) {
      // Upper left
      var uv = this._uvs[0];
      uv.x = frame.x / baseFrame.width;
      uv.y = frame.y / baseFrame.height;

      // Upper right
      uv = this._uvs[1];
      uv.x = (frame.x + frame.width) / baseFrame.width;
      uv.y = frame.y / baseFrame.height;

      // Lower right
      uv = this._uvs[2];
      uv.x = (frame.x + frame.width) / baseFrame.width;
      uv.y = (frame.y + frame.height) / baseFrame.height;

      // Lower left
      uv = this._uvs[3];
      uv.x = frame.x / baseFrame.width;
      uv.y = (frame.y + frame.height) / baseFrame.height;
    }

    /**
     * Returns the UV coordinates for the given index
     * @param  {Number} index
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getUVsAt',
    value: function getUVsAt(index) {
      return this._uvs[index];
    }

    /**
     * Returns the UV coordinates
     * @return {Array.<PhotoEditorSDK.Math.Vector2>}
     */

  }, {
    key: 'getUVs',
    value: function getUVs() {
      return this._uvs;
    }
  }]);

  return TextureUVs;
}();

/* harmony default export */ __webpack_exports__["a"] = (TextureUVs);

/***/ }),
/* 282 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__texture__ = __webpack_require__(163);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__base_texture__ = __webpack_require__(68);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__utils_webgl_render_target__ = __webpack_require__(88);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__utils_canvas_render_target__ = __webpack_require__(87);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__managers_webgl_filter_manager__ = __webpack_require__(119);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__managers_canvas_filter_manager__ = __webpack_require__(115);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */









var RendererType = __WEBPACK_IMPORTED_MODULE_5__globals__["c" /* Constants */].RendererType;

/**
 * A texture that you can render to
 * @class
 * @extends PhotoEditorSDK.Engine.Texture
 * @memberof PhotoEditorSDK.Engine
 */

var RenderTexture = function (_Texture) {
  _inherits(RenderTexture, _Texture);

  /**
   * Creates a RenderTexture
   * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
   * @param  {Number} [width = 100]
   * @param  {Number} [height = 100]
   * @param  {Number} [pixelRatio = 1]
   */
  function RenderTexture(renderer) {
    var width = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100;
    var height = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 100;
    var pixelRatio = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;

    _classCallCheck(this, RenderTexture);

    // RenderTexture is always loaded!
    var _this = _possibleConstructorReturn(this, (RenderTexture.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(RenderTexture)).call(this, new __WEBPACK_IMPORTED_MODULE_7__base_texture__["a" /* default */](), new __WEBPACK_IMPORTED_MODULE_5__globals__["h" /* Rectangle */](0, 0, width, height)));

    _this._loaded = true;
    _this._width = width;
    _this._height = height;
    _this._pixelRatio = pixelRatio;
    _this._renderer = renderer;

    _this._setupFilterManager();
    _this._setupBuffer();

    _this.setBaseTexture(_this._renderTarget.getBaseTexture());

    _this._updateUVs();
    return _this;
  }

  /**
   * Sets up the filter manager
   * @private
   */


  _createClass(RenderTexture, [{
    key: '_setupFilterManager',
    value: function _setupFilterManager() {
      if (this._filterManager) {
        this._filterManager.dispose();
      }
      /* istanbul ignore if */
      if (this._renderer.isOfType(RendererType.WEBGL)) {
        this._filterManager = new __WEBPACK_IMPORTED_MODULE_10__managers_webgl_filter_manager__["a" /* default */](this._renderer);
      } else if (this._renderer.isOfType(RendererType.CANVAS)) {
        this._filterManager = new __WEBPACK_IMPORTED_MODULE_11__managers_canvas_filter_manager__["a" /* default */](this._renderer);
      }

      this._filterManager.resizeTo(new __WEBPACK_IMPORTED_MODULE_5__globals__["k" /* Vector2 */](this._width, this._height));
    }

    /**
     * Sets up the buffer that we're rendering to
     * @private
     */

  }, {
    key: '_setupBuffer',
    value: function _setupBuffer() {
      /* istanbul ignore if */
      if (this._renderer.isOfType(RendererType.WEBGL)) {
        this._setupWebGLRenderTarget();
      } else if (this._renderer.isOfType(RendererType.CANVAS)) {
        this._setupCanvasRenderTarget();
      }
    }

    /**
     * Sets up the WebGLRenderTarget for this RenderTexture
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_setupWebGLRenderTarget',
    value: function _setupWebGLRenderTarget() {
      if (this._renderTarget) {
        this._renderTarget.dispose();
      }
      this._renderTarget = new __WEBPACK_IMPORTED_MODULE_8__utils_webgl_render_target__["a" /* default */](this._renderer, this._width, this._height, this._pixelRatio);
    }

    /**
     * Sets up the CanvasRenderTarget for this RenderTexture
     * @private
     */

  }, {
    key: '_setupCanvasRenderTarget',
    value: function _setupCanvasRenderTarget() {
      if (this._renderTarget) {
        this._renderTarget.dispose();
      }
      this._renderTarget = new __WEBPACK_IMPORTED_MODULE_9__utils_canvas_render_target__["a" /* default */](this._width, this._height, this._pixelRatio);
    }

    /**
     * Clears this texture's render buffer
     * @param {PhotoEditorSDK.Color} color
     */

  }, {
    key: 'clear',
    value: function clear(color) {
      this._renderTarget.clear(color);
    }

    /**
     * Resizes this RenderTexture to the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     */

  }, {
    key: 'resizeTo',
    value: function resizeTo(dimensions) {
      if (this._width === dimensions.x && this._height === dimensions.y) {
        return;
      }

      this._width = dimensions.x;
      this._height = dimensions.y;
      this._frame.width = dimensions.x;
      this._frame.height = dimensions.y;

      this._renderTarget.resizeTo(dimensions);
      this._filterManager.resizeTo(dimensions);
    }

    /**
     * Renders the given DisplayObject
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     */

  }, {
    key: 'render',
    value: function render(displayObject) {
      /* istanbul ignore if */
      if (this._renderer.isOfType(RendererType.WEBGL)) {
        this._renderWebGL(displayObject);
      } else if (this._renderer.isOfType(RendererType.CANVAS)) {
        this._renderCanvas(displayObject);
      } else {
        throw new Error('RenderTexture does not support rendering via ' + this._renderer.constructor.name);
      }
    }

    /**
     * Renders the given DisplayObject using WebGL
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(displayObject) {
      this._renderTarget.activate();

      displayObject.getWorldTransform().reset();
      displayObject.getChildren().forEach(function (child) {
        child.updateTransform();
      });

      var tempFilterManager = this._renderer.getFilterManager();
      this._renderer.setFilterManager(this._filterManager);
      this._renderer.renderDisplayObject(displayObject, this._renderTarget);
      // this._renderTarget.updateMipMap()
      this._renderer.setFilterManager(tempFilterManager);
    }

    /**
     * Renders the given DisplayObject using Canvas2D
     * @param  {PhotoEditorSDK.Engine.DisplayObject} displayObject
     * @private
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(displayObject) {
      displayObject.getWorldTransform().reset();
      displayObject.getChildren().forEach(function (child) {
        child.updateTransform();
      });

      var tempFilterManager = this._renderer.getFilterManager();
      this._renderer.setFilterManager(this._filterManager);
      this._renderer.renderDisplayObject(displayObject, this._renderTarget);
      this._renderer.setFilterManager(tempFilterManager);
    }

    /**
     * Returns the render target
     * @return {PhotoEditorSDK.Engine.WebGLRenderTarget}
     */

  }, {
    key: 'getRenderTarget',
    value: function getRenderTarget() {
      return this._renderTarget;
    }

    /**
     * Disposes this RenderTexture
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._renderTarget.dispose();
      this._filterManager.dispose();
      _get(RenderTexture.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(RenderTexture.prototype), 'dispose', this).call(this);
    }
  }]);

  return RenderTexture;
}(__WEBPACK_IMPORTED_MODULE_6__texture__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (RenderTexture);

/***/ }),
/* 283 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__display_container__ = __webpack_require__(162);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_pot_renderer__ = __webpack_require__(284);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * A drawable rectangle with a texture
 * @class
 * @extends PhotoEditorSDK.Engine.Container
 * @memberof PhotoEditorSDK.Engine
 */

var Sprite = function (_Container) {
  _inherits(Sprite, _Container);

  /**
   * Creates a Sprite
   * @param  {PhotoEditorSDK.Engine.Texture} texture
   */
  function Sprite(texture) {
    _classCallCheck(this, Sprite);

    var _this = _possibleConstructorReturn(this, (Sprite.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Sprite)).call(this));

    _this._onTextureUpdate = _this._onTextureUpdate.bind(_this);

    _this._texture = texture;
    _this._shader = null;

    // Cached dimensions
    _this._width = 0;
    _this._height = 0;

    _this._anchor = new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](0, 0);

    _this._canvasSmoothingEnabled = true;

    _this.setTexture(texture);
    return _this;
  }

  // -------------------------------------------------------------------------- EVENTS

  /**
   * Gets called when this sprite's texture has been updated
   * @private
   */


  _createClass(Sprite, [{
    key: '_onTextureUpdate',
    value: function _onTextureUpdate() {
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    // -------------------------------------------------------------------------- RENDERING

    /**
     * Renders the contents of this container
     * @param {WebGLRenderer} renderer
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(renderer) {
      var save = renderer.save();
      if (this._smoothDownscaling) {
        if (!this._potRenderer) {
          this._potRenderer = new __WEBPACK_IMPORTED_MODULE_6__lib_pot_renderer__["a" /* default */]();
        }

        this._potRenderer.render(renderer, this, this._texture);
      }
      renderer.restore(save);

      renderer.setObjectRenderer(renderer.renderers.sprite);
      renderer.renderers.sprite.render(this);
    }

    /**
     * Renders the contents of this container
     * @param  {CanvasRenderer} renderer
     * @private
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(renderer) {
      // @TODO Move this to SpriteRenderer
      var transform = this._worldTransform;
      var textureFrame = this._texture.getFrame();

      var width = textureFrame.width,
          height = textureFrame.height;

      var pixelRatio = renderer.getCurrentRenderTarget().getPixelRatio();

      // Apply transform
      var dx = this._anchor.x * -width | 0;
      var dy = this._anchor.y * -height | 0;
      var ctx = renderer.getContext();

      ctx.setTransform(transform.a, transform.b, transform.c, transform.d, transform.tx * pixelRatio, transform.ty * pixelRatio);

      ctx.globalAlpha = this.getWorldAlpha();

      var baseTexture = this._texture.getBaseTexture();
      var texturePixelRatio = baseTexture.getPixelRatio();
      var source = baseTexture.getSource();

      ctx.imageSmoothingEnabled = this._canvasSmoothingEnabled;

      ctx.drawImage(source,

      // Source x, y, width, height
      0, 0, (source.naturalWidth || width) * texturePixelRatio, (source.naturalHeight || height) * texturePixelRatio,

      // Destination x, y, width, height
      dx * pixelRatio, dy * pixelRatio, width * pixelRatio, height * pixelRatio);
    }

    // -------------------------------------------------------------------------- PUBLIC API

    /**
     * Checks if this sprite is located at the given position
     * @param  {PhotoEditorSDK.Math.Vector2}  position
     * @return {Boolean}
     */

  }, {
    key: 'isAtPosition',
    value: function isAtPosition(position) {
      var localPosition = this._worldTransform.applyInverseToVector(position);
      var textureFrame = this._texture.getFrame();
      var width = textureFrame.width,
          height = textureFrame.height;


      var upperLeft = new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](-width, -height);
      upperLeft.multiply(this._anchor);
      var lowerRight = upperLeft.clone().add(width, height);

      if (localPosition.x < upperLeft.x || localPosition.x > lowerRight.x || localPosition.y < upperLeft.y || localPosition.y > lowerRight.y) {
        return false;
      }

      return true;
    }

    /**
     * Returns the non-global bounds of this DisplayObject
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getLocalBounds',
    value: function getLocalBounds() {
      if (this._localBoundsNeedUpdate) {
        var bounds = this._localBounds;
        var textureFrame = this._texture.getFrame();

        bounds.x = -textureFrame.width * this._anchor.x;
        bounds.y = -textureFrame.height * this._anchor.y;
        bounds.width = textureFrame.width;
        bounds.height = textureFrame.height;

        this._localBoundsNeedUpdate = false;
      }
      return this._localBounds.clone();
    }

    /**
     * Returns the bounds for this DisplayObject
     * @return {PhotoEditorSDK.Math.Rectangle}
     */

  }, {
    key: 'getBounds',
    value: function getBounds() {
      if (this._boundsNeedUpdate) {
        var bounds = this._bounds;
        var textureFrame = this._texture.getFrame();

        // @TODO Optimize this (if necessary). We could skip matrix application
        //       when there's no rotation
        var worldTransform = this._worldTransform;
        var anchor = this._anchor;
        var positions = worldTransform.rectangleToCoordinates(textureFrame, anchor);

        var minX = positions[0].x;
        var minY = positions[0].y;
        var maxX = minX;
        var maxY = minY;

        positions.forEach(function (_ref) {
          var x = _ref.x,
              y = _ref.y;

          minX = Math.min(minX, x);
          minY = Math.min(minY, y);
          maxX = Math.max(maxX, x);
          maxY = Math.max(maxY, y);
        });

        bounds.x = minX;
        bounds.width = Math.abs(maxX - minX);
        bounds.y = minY;
        bounds.height = Math.abs(maxY - minY);

        this._boundsNeedUpdate = false;
      }
      return this._bounds.clone();
    }

    // -------------------------------------------------------------------------- GETTERS / SETTERS

    /**
     * Returns the current texture
     * @return {PhotoEditorSDK.Engine.Texture} [description]
     */

  }, {
    key: 'getTexture',
    value: function getTexture() {
      return this._texture;
    }

    /**
     * Clears the sprite's texture. If `dispose` is true, it disposes the
     * underlying texture from the context.
     *
     * @param {boolean} dispose
     */

  }, {
    key: 'clearTexture',
    value: function clearTexture() {
      var dispose = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

      if (!this._texture) {
        return;
      }

      this._texture.off('update', this._onTextureUpdate);
      dispose && this._texture.dispose();
      this._texture = null;

      if (this._potRenderer) {
        dispose && this._potRenderer.dispose();
        this._potRenderer = null;
      }
    }

    /**
     * Sets the texture
     * @param {PhotoEditorSDK.Engine.Texture} texture
     */

  }, {
    key: 'setTexture',
    value: function setTexture(texture) {
      if (!texture) {
        return;
      }

      if (this._texture) {
        this._texture.off('update', this._onTextureUpdate);
      }

      if (this._potRenderer) {
        this._potRenderer.getRenderTexture().getBaseTexture().setDirty(true);
      }

      this._texture = texture;
      if (texture.getBaseTexture().isLoaded()) {
        this._onTextureUpdate();
      }
      texture.on('update', this._onTextureUpdate);
    }

    /**
     * Returns the shader
     * @return {PhotoEditorSDK.Engine.Shader}
     */

  }, {
    key: 'getShader',
    value: function getShader() {
      return this._shader;
    }

    /**
     * Sets the shader
     * @param {PhotoEditorSDK.Engine.Shader} shader
     */

  }, {
    key: 'setShader',
    value: function setShader(shader) {
      this._shader = shader;
    }

    /**
     * Returns the width
     * @return {Number}
     */

  }, {
    key: 'getWidth',
    value: function getWidth() {
      return this._width;
    }

    /**
     * Sets the width
     * @param {Number} width
     */

  }, {
    key: 'setWidth',
    value: function setWidth(width) {
      this._scale.x = width / this._texture.getFrame().width;
      this._width = width;
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the height
     * @return {Number}
     */

  }, {
    key: 'getHeight',
    value: function getHeight() {
      return this._height;
    }

    /**
     * Sets the height
     * @param {Number} height
     */

  }, {
    key: 'setHeight',
    value: function setHeight(height) {
      this._scale.y = height / this._texture.getFrame().height;
      this._height = height;
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns the current width and height of this sprite
     * @return {PhotoEditor.Math.Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions() {
      return new __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */](this._width, this._height);
    }

    /**
     * Returns the anchor
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getAnchor',
    value: function getAnchor() {
      return this._anchor;
    }

    /**
     * Sets the anchor
     * @param {PhotoEditorSDK.Math.Vector2} anchor
     */

  }, {
    key: 'setAnchor',
    value: function setAnchor(anchor, y) {
      if (anchor instanceof __WEBPACK_IMPORTED_MODULE_4__globals__["k" /* Vector2 */]) {
        this._anchor.copy(anchor);
      } else {
        this._anchor.set(anchor, y);
      }
      this._boundsNeedUpdate = true;
      this._localBoundsNeedUpdate = true;
    }

    /**
     * Returns whether smooth downscaling is enabled
     * @return {Boolean}
     */

  }, {
    key: 'isSmoothDownscaling',
    value: function isSmoothDownscaling() {
      return this._smoothDownscaling;
    }

    /**
     * Sets the smooth downscaling flag
     * @param {Boolean} smoothDownscaling
     */

  }, {
    key: 'setSmoothDownscaling',
    value: function setSmoothDownscaling(smoothDownscaling) {
      this._smoothDownscaling = smoothDownscaling;
    }

    /**
     * Disposes this Sprite
     * @param {Boolean} texture = false - Should the texture be disposed?
     * @param {Boolean} baseTexture = false - Should the base texture be disposed?
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      var texture = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
      var baseTexture = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      if (this._texture) {
        this._texture.off('update', this._onTextureUpdate);
      }
      (texture || baseTexture) && this._texture.dispose(baseTexture);
      if (this._potRenderer) {
        this._potRenderer.dispose();
      }
    }
  }]);

  return Sprite;
}(__WEBPACK_IMPORTED_MODULE_5__display_container__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Sprite);

/***/ }),
/* 284 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(38);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/* istanbul ignore next */

var POTRenderer = function () {
  function POTRenderer() {
    _classCallCheck(this, POTRenderer);

    this._container = new __WEBPACK_IMPORTED_MODULE_1__globals__["Engine"].Container();
    this._sprite = new __WEBPACK_IMPORTED_MODULE_1__globals__["Engine"].Sprite();
    this._container.addChild(this._sprite);
  }

  /**
   * Renders the given input texture to a POT texture
   * @param  {PhotoEditorSDK.Engine.BaseRenderer} renderer
   * @param  {PhotoEditorSDK.Engine.Sprite} inputSprite
   * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
   */


  _createClass(POTRenderer, [{
    key: 'render',
    value: function render(renderer, inputSprite, inputTexture) {
      var textureDimensions = inputTexture.getDimensions();
      var nextPOT = this._getNextHighestPOT(textureDimensions);

      if (!this._renderTexture) {
        this._renderTexture = new __WEBPACK_IMPORTED_MODULE_1__globals__["Engine"].RenderTexture(renderer, nextPOT.x, nextPOT.y);
      } else {
        this._renderTexture.resizeTo(nextPOT);
      }

      var newDimensions = this._renderTexture.getDimensions();
      this._sprite.setTexture(inputTexture);
      this._sprite.updateTransform();
      this._renderTexture.clear();
      this._renderTexture.render(this._container);

      this._updateSprite(renderer, inputSprite, textureDimensions, newDimensions);
    }

    /**
     * Sets the input sprite's texture and makes sure only the relevant part of the
     * render texture is rendered
     * @param  {PhotoEditorSDK.Engine.Sprite} inputSprite
     * @param  {PhotoEditorSDK.Math.Vector2} initialDimensions
     * @param  {PhotoEditorSDK.Math.Vector2} newDimensions
     * @private
     */

  }, {
    key: '_updateSprite',
    value: function _updateSprite(renderer, inputSprite, initialDimensions, newDimensions) {
      inputSprite.setTexture(this._renderTexture);

      this._renderTexture.setFrame(new __WEBPACK_IMPORTED_MODULE_1__globals__["Rectangle"](0, 0, initialDimensions.x, initialDimensions.y));
    }

    /**
     * Returns the next highest POT dimensions for the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @private
     */

  }, {
    key: '_getNextHighestPOT',
    value: function _getNextHighestPOT(dimensions) {
      return new __WEBPACK_IMPORTED_MODULE_1__globals__["Vector2"](__WEBPACK_IMPORTED_MODULE_1__globals__["Utils"].nextHighestPOT(dimensions.x), __WEBPACK_IMPORTED_MODULE_1__globals__["Utils"].nextHighestPOT(dimensions.y));
    }

    /**
     * Returns the render texture
     * @return {PhotoEditorSDK.Engine.RenderTexture}
     */

  }, {
    key: 'getRenderTexture',
    value: function getRenderTexture() {
      return this._renderTexture;
    }

    /**
     * Disposes this POT renderers
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      if (!this._renderTexture) {
        return;
      }

      this._renderTexture.dispose();
      this._renderTexture = null;
    }
  }]);

  return POTRenderer;
}();

/* harmony default export */ __webpack_exports__["a"] = (POTRenderer);

/***/ }),
/* 285 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__texture_shader__ = __webpack_require__(116);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/* harmony default export */ __webpack_exports__["a"] = ({
  TextureShader: __WEBPACK_IMPORTED_MODULE_0__texture_shader__["a" /* default */]
});

/***/ }),
/* 286 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(287), __esModule: true };

/***/ }),
/* 287 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(288);
module.exports = __webpack_require__(11).setImmediate;


/***/ }),
/* 288 */
/***/ (function(module, exports, __webpack_require__) {

var $export = __webpack_require__(14);
var $task = __webpack_require__(112);
$export($export.G + $export.B, {
  setImmediate: $task.set,
  clearImmediate: $task.clear
});


/***/ }),
/* 289 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__unpremultiply_filter__ = __webpack_require__(290);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "UnpremultiplyFilter", function() { return __WEBPACK_IMPORTED_MODULE_0__unpremultiply_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__color_overlay_filter__ = __webpack_require__(292);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ColorOverlayFilter", function() { return __WEBPACK_IMPORTED_MODULE_1__color_overlay_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__tint_filter__ = __webpack_require__(294);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "TintFilter", function() { return __WEBPACK_IMPORTED_MODULE_2__tint_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__overlay_filter__ = __webpack_require__(296);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "OverlayFilter", function() { return __WEBPACK_IMPORTED_MODULE_3__overlay_filter__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * @namespace PhotoEditorSDK.Engine.Filters
 */





/***/ }),
/* 290 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(69);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/* istanbul ignore next */

var UnpremultiplyFilter = function (_Filter) {
  _inherits(UnpremultiplyFilter, _Filter);

  function UnpremultiplyFilter() {
    _classCallCheck(this, UnpremultiplyFilter);

    var _this = _possibleConstructorReturn(this, (UnpremultiplyFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(UnpremultiplyFilter)).call(this));

    _this._fragmentSource = __webpack_require__(291);
    return _this;
  }

  return UnpremultiplyFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (UnpremultiplyFilter);

/***/ }),
/* 291 */
/***/ (function(module, exports) {

module.exports = "uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(color.a > 0. ? color.rgb / color.a : vec3(0), color.a);\n}\n";

/***/ }),
/* 292 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__filter__ = __webpack_require__(69);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var OptionType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].OptionType,
    UniformType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].UniformType;

/* istanbul ignore next */

var ColorOverlayFilter = function (_Filter) {
  _inherits(ColorOverlayFilter, _Filter);

  function ColorOverlayFilter() {
    var _ref;

    _classCallCheck(this, ColorOverlayFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = ColorOverlayFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ColorOverlayFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(293);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(ColorOverlayFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();
      var color = this._options.color;


      var inputImageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var outputImageData = outputContext.getImageData(0, 0, canvas.width, canvas.height);
      var pixelCount = canvas.width * canvas.height;

      var inputColor = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */]();
      var outputColor = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */]();
      for (var i = 0; i < pixelCount * 4; i += 4) {
        inputColor.set(inputImageData.data[i] / 255, inputImageData.data[i + 1] / 255, inputImageData.data[i + 2] / 255, inputImageData.data[i + 3] / 255);
        outputColor.set(outputImageData.data[i] / 255, outputImageData.data[i + 1] / 255, outputImageData.data[i + 2] / 255, outputImageData.data[i + 3] / 255);

        var newR = outputColor.r + inputColor.a * (inputColor.r - outputColor.r);
        outputImageData.data[i] = (newR + inputColor.a * (color.r - newR)) * 255;

        var newG = outputColor.g + inputColor.a * (inputColor.g - outputColor.g);
        outputImageData.data[i + 1] = (newG + inputColor.a * (color.g - newG)) * 255;

        var newB = outputColor.b + inputColor.a * (inputColor.b - outputColor.b);
        outputImageData.data[i + 2] = (newB + inputColor.a * (color.b - newB)) * 255;
      }

      outputContext.putImageData(outputImageData, 0, 0);
    }
  }]);

  return ColorOverlayFilter;
}(__WEBPACK_IMPORTED_MODULE_5__filter__["a" /* default */]);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


ColorOverlayFilter.prototype.availableOptions = {
  color: { type: OptionType.COLOR, default: __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */].WHITE, uniformType: UniformType.FLOAT4 }
};

/* harmony default export */ __webpack_exports__["a"] = (ColorOverlayFilter);

/***/ }),
/* 293 */
/***/ (function(module, exports) {

module.exports = "uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec4 u_color;\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;\n}\n";

/***/ }),
/* 294 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__filter__ = __webpack_require__(69);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var OptionType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].OptionType,
    UniformType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].UniformType;

/* istanbul ignore next */

var TintFilter = function (_Filter) {
  _inherits(TintFilter, _Filter);

  function TintFilter() {
    var _ref;

    _classCallCheck(this, TintFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TintFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TintFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(295);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(TintFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var _options = this._options,
          mode = _options.mode,
          color = _options.color;
      var r = color.r,
          g = color.g,
          b = color.b,
          a = color.a;


      var W = [0.2125, 0.7154, 0.0721];

      switch (mode) {
        case TintFilter.MODES.SOLID:
          for (var i = 0; i < canvas.width * canvas.height; i++) {
            var index = i * 4;
            imageData.data[index] += (r * 255 - imageData.data[index]) * a;
            imageData.data[index + 1] += (g * 255 - imageData.data[index + 1]) * a;
            imageData.data[index + 2] += (b * 255 - imageData.data[index + 2]) * a;
          }
          break;
        case TintFilter.MODES.COLORIZED:
          for (var _i = 0; _i < canvas.width * canvas.height; _i++) {
            var _index = _i * 4;

            var luminance = imageData.data[_index] / 255 * W[0] + imageData.data[_index + 1] / 255 * W[1] + imageData.data[_index + 2] / 255 * W[2];
            var colorized = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */](luminance * r, luminance * g, luminance * b);
            imageData.data[_index] += (colorized.r * 255 - imageData.data[_index]) * a;
            imageData.data[_index + 1] += (colorized.g * 255 - imageData.data[_index + 1]) * a;
            imageData.data[_index + 2] += (colorized.b * 255 - imageData.data[_index + 2]) * a;
          }
          break;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return TintFilter;
}(__WEBPACK_IMPORTED_MODULE_5__filter__["a" /* default */]);

/**
 * Specifies the available tint modes
 * @type {Object}
 */


TintFilter.MODES = {
  NONE: 0,
  SOLID: 1,
  COLORIZED: 2

  /**
   * Specifies the available options for this filter
   * @type {Object}
   * @ignore
   */
};TintFilter.prototype.availableOptions = {
  color: { type: OptionType.COLOR, default: __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */].WHITE, uniformType: UniformType.FLOAT4 },
  mode: { type: OptionType.NUMBER, default: TintFilter.MODES.NONE, uniformType: UniformType.INT }
};

/* harmony default export */ __webpack_exports__["a"] = (TintFilter);

/***/ }),
/* 295 */
/***/ (function(module, exports) {

module.exports = "uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec4 u_color;\nuniform int u_mode;\n\nvec3 W = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  if (u_mode == 0) {\n    gl_FragColor = color * color.a;\n  } else if (u_mode == 1) {\n    gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;\n  } else if (u_mode == 2) {\n    float luminance = dot(color.rgb, W);\n    vec3 colorized = vec3(luminance) * u_color.rgb;\n    gl_FragColor = vec4(mix(color.rgb, colorized, u_color.a), color.a) * color.a;\n  }\n}\n";

/***/ }),
/* 296 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__filter__ = __webpack_require__(69);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var OptionType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].OptionType,
    UniformType = __WEBPACK_IMPORTED_MODULE_4__globals__["c" /* Constants */].UniformType;


var EPSILON = 0.000001;

/* istanbul ignore next */

var OverlayFilter = function (_Filter) {
  _inherits(OverlayFilter, _Filter);

  function OverlayFilter() {
    var _ref;

    _classCallCheck(this, OverlayFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = OverlayFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(OverlayFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(297);

    _this._lastImage = null;
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(OverlayFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      // @todo Add support for non-rendertextures (usual textures)
      var overlayContext = this._options.overlayTexture.getRenderTarget().getContext();

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var overlayImageData = overlayContext.getImageData(0, 0, canvas.width, canvas.height);
      var _options = this._options,
          blendMode = _options.blendMode,
          alpha = _options.alpha;


      var inputColor = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */]();
      var overlayColor = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */]();
      var outputColor = new __WEBPACK_IMPORTED_MODULE_4__globals__["b" /* Color */]();
      for (var i = 0; i < canvas.width * canvas.height * 4; i += 4) {
        inputColor.set(imageData.data[i] / 255, imageData.data[i + 1] / 255, imageData.data[i + 2] / 255, imageData.data[i + 3] / 255);
        overlayColor.set(overlayImageData.data[i] / 255, overlayImageData.data[i + 1] / 255, overlayImageData.data[i + 2] / 255, overlayImageData.data[i + 3] / 255);

        var rA = void 0,
            rB = void 0,
            newR = void 0;
        var gA = void 0,
            gB = void 0,
            newG = void 0;
        var bA = void 0,
            bB = void 0,
            newB = void 0;
        switch (blendMode) {
          case OverlayFilter.BLEND_MODES.NORMAL:
            outputColor.set(inputColor.r + overlayColor.a * alpha * (overlayColor.r - inputColor.r), inputColor.g + overlayColor.a * alpha * (overlayColor.g - inputColor.g), inputColor.b + overlayColor.a * alpha * (overlayColor.b - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.OVERLAY:
            rA = 1 - 2 * (1 - inputColor.r) * (1 - overlayColor.r);
            rB = 2 * inputColor.r * overlayColor.r;
            newR = rA + (inputColor.r < 0.5 ? 1 : 0) * (rB - rA);

            gA = 1 - 2 * (1 - inputColor.g) * (1 - overlayColor.g);
            gB = 2 * inputColor.g * overlayColor.g;
            newG = gA + (inputColor.g < 0.5 ? 1 : 0) * (gB - gA);

            bA = 1 - 2 * (1 - inputColor.b) * (1 - overlayColor.b);
            bB = 2 * inputColor.b * overlayColor.b;
            newB = bA + (inputColor.b < 0.5 ? 1 : 0) * (bB - bA);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.HARD_LIGHT:
            rA = 1 - 2 * (1 - overlayColor.r) * (1 - inputColor.r);
            rB = 2 * overlayColor.r * inputColor.r;
            newR = rA + (overlayColor.r < 0.5 ? 1 : 0) * (rB - rA);

            gA = 1 - 2 * (1 - overlayColor.g) * (1 - inputColor.g);
            gB = 2 * overlayColor.g * inputColor.g;
            newG = gA + (overlayColor.g < 0.5 ? 1 : 0) * (gB - gA);

            bA = 1 - 2 * (1 - overlayColor.b) * (1 - inputColor.b);
            bB = 2 * overlayColor.b * inputColor.b;
            newB = bA + (overlayColor.b < 0.5 ? 1 : 0) * (bB - bA);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.SOFT_LIGHT:
            rA = 2 * inputColor.r * (1 - overlayColor.r) + (2 * overlayColor.r - 1) * Math.sqrt(inputColor.r);
            rB = 2 * inputColor.r * overlayColor.r + inputColor.r * inputColor.r * (1 - 2 * overlayColor.r);
            newR = rA + (overlayColor.r < 0.5 ? 1 : 0) * (rB - rA);

            gA = 2 * inputColor.g * (1 - overlayColor.g) + (2 * overlayColor.g - 1) * Math.sqrt(inputColor.g);
            gB = 2 * inputColor.g * overlayColor.g + inputColor.g * inputColor.g * (1 - 2 * overlayColor.g);
            newG = gA + (overlayColor.g < 0.5 ? 1 : 0) * (gB - gA);

            bA = 2 * inputColor.b * (1 - overlayColor.b) + (2 * overlayColor.b - 1) * Math.sqrt(inputColor.b);
            bB = 2 * inputColor.b * overlayColor.b + inputColor.b * inputColor.b * (1 - 2 * overlayColor.b);
            newB = bA + (overlayColor.b < 0.5 ? 1 : 0) * (bB - bA);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.MULTIPLY:
            newR = inputColor.r * overlayColor.r;
            newG = inputColor.g * overlayColor.g;
            newB = inputColor.b * overlayColor.b;

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.DARKEN:
            newR = Math.min(inputColor.r, overlayColor.r);
            newG = Math.min(inputColor.g, overlayColor.g);
            newB = Math.min(inputColor.b, overlayColor.b);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.LIGHTEN:
            newR = Math.max(inputColor.r, overlayColor.r);
            newG = Math.max(inputColor.g, overlayColor.g);
            newB = Math.max(inputColor.b, overlayColor.b);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.SCREEN:
            newR = 1 - (1 - inputColor.r) * (1 - overlayColor.r);
            newG = 1 - (1 - inputColor.g) * (1 - overlayColor.g);
            newB = 1 - (1 - inputColor.b) * (1 - overlayColor.b);

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
          case OverlayFilter.BLEND_MODES.COLOR_BURN:
            newR = Math.max(0, Math.min(1, 1 - (1 - inputColor.r) / Math.max(overlayColor.r, EPSILON)));
            newG = Math.max(0, Math.min(1, 1 - (1 - inputColor.g) / Math.max(overlayColor.g, EPSILON)));
            newB = Math.max(0, Math.min(1, 1 - (1 - inputColor.b) / Math.max(overlayColor.b, EPSILON)));

            outputColor.set(inputColor.r + overlayColor.a * alpha * (newR - inputColor.r), inputColor.g + overlayColor.a * alpha * (newG - inputColor.g), inputColor.b + overlayColor.a * alpha * (newB - inputColor.b), inputColor.a);
            break;
        }

        imageData.data[i] = outputColor.r * 255;
        imageData.data[i + 1] = outputColor.g * 255;
        imageData.data[i + 2] = outputColor.b * 255;
        imageData.data[i + 3] = outputColor.a * 255;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return OverlayFilter;
}(__WEBPACK_IMPORTED_MODULE_5__filter__["a" /* default */]);

/**
 * Specifies the available tint modes
 * @type {Object}
 */


OverlayFilter.BLEND_MODES = {
  NORMAL: 0,
  OVERLAY: 1,
  HARD_LIGHT: 2,
  SOFT_LIGHT: 3,
  MULTIPLY: 4,
  DARKEN: 5,
  LIGHTEN: 6,
  SCREEN: 7,
  COLOR_BURN: 8

  /**
   * Specifies the available options for this filter
   * @type {Object}
   * @ignore
   */
};OverlayFilter.prototype.availableOptions = {
  blendMode: { type: OptionType.NUMBER, default: OverlayFilter.BLEND_MODES.NORMAL, uniformType: UniformType.INT },
  overlayImage: { type: OptionType.NUMBER, required: true, uniformType: UniformType.SAMPLER2D },
  overlayTexture: { type: OptionType.OBJECT, required: true },
  alpha: { type: OptionType.NUMBER, default: 1, uniformType: UniformType.FLOAT }
};

/* harmony default export */ __webpack_exports__["a"] = (OverlayFilter);

/***/ }),
/* 297 */
/***/ (function(module, exports) {

module.exports = "uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform sampler2D u_overlayImage;\nuniform int u_blendMode;\nuniform float u_alpha;\n\nconst float EPSILON = 0.000001;\n\nvec4 overlay(vec4 a, vec4 b) {\n    vec3 result = mix(\n          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),\n          2.0 * a.rgb * b.rgb,\n          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)\n      );\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 hardLight(vec4 b, vec4 a) {\n    vec3 result = mix(\n          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),\n          2.0 * a.rgb * b.rgb,\n          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)\n      );\n    return mix(b, vec4(result, b.a), u_alpha * a.a);\n}\n\nvec4 softLight(vec4 a, vec4 b) {\n    vec3 result = mix(\n          2.0 * a.rgb * (1.0 - b.rgb) + (2.0 * b.rgb - 1.0) * sqrt(a.rgb),\n          2.0 * a.rgb * b.rgb + a.rgb * a.rgb * (1.0 - 2.0 * b.rgb),\n          vec3(b.r < 0.5, b.g < 0.5, b.b < 0.5)\n      );\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 multiply(vec4 a, vec4 b) {\n    vec3 result = a.rgb * b.rgb;\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 darken(vec4 a, vec4 b) {\n    vec3 result = min(a.rgb, b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 lighten(vec4 a, vec4 b) {\n    vec3 result = max(a.rgb, b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 screen(vec4 a, vec4 b) {\n    vec3 result = 1.0 - (1.0 - a.rgb) * (1.0 - b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 colorBurn(vec4 a, vec4 b) {\n    vec3 result = clamp(1.0 - (1.0 - a.rgb) / max(b.rgb, EPSILON), 0.0, 1.0);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 normal(vec4 a, vec4 b) {\n    return mix(a, vec4(b.rgb, a.a), u_alpha * b.a);\n}\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  vec4 overlayColor = texture2D(u_overlayImage, v_texCoord);\n\n  vec4 resultColor;\n  if (u_blendMode == 0) {\n    resultColor = normal(color, overlayColor);\n  } else if (u_blendMode == 1) {\n    resultColor = overlay(color, overlayColor);\n  } else if (u_blendMode == 2) {\n    resultColor = hardLight(color, overlayColor);\n  } else if (u_blendMode == 3) {\n    resultColor = softLight(color, overlayColor);\n  } else if (u_blendMode == 4) {\n    resultColor = multiply(color, overlayColor);\n  } else if (u_blendMode == 5) {\n    resultColor = darken(color, overlayColor);\n  } else if (u_blendMode == 6) {\n    resultColor = lighten(color, overlayColor);\n  } else if (u_blendMode == 7) {\n    resultColor = screen(color, overlayColor);\n  } else if (u_blendMode == 8) {\n    resultColor = colorBurn(color, overlayColor);\n  }\n  gl_FragColor = vec4(resultColor.rgb * resultColor.a, resultColor.a);\n}\n";

/***/ }),
/* 298 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony default export */ __webpack_exports__["a"] = ([{
  defaultName: 'Natasha Wescoat',
  identifier: 'imgly_art_filter_june_tree',
  rootPath: 'art-filters/imgly_june_tree',
  thumbnail: 'art-filters/imgly_june_tree/thumbnail.jpg'
}, {
  defaultName: 'Hive',
  identifier: 'imgly_art_filter_hive',
  rootPath: 'art-filters/imgly_hive',
  thumbnail: 'art-filters/imgly_hive/thumbnail.jpg'
}, {
  defaultName: 'Udnie',
  identifier: 'imgly_art_filter_udnie',
  rootPath: 'art-filters/imgly_udnie',
  thumbnail: 'art-filters/imgly_udnie/thumbnail.jpg'
}, {
  defaultName: 'Vince Low',
  identifier: 'imgly_art_filter_vince_low',
  rootPath: 'art-filters/imgly_vince_low',
  thumbnail: 'art-filters/imgly_vince_low/thumbnail.jpg'
}, {
  defaultName: 'Mosaic',
  identifier: 'imgly_art_filter_mosaic',
  rootPath: 'art-filters/imgly_mosaic',
  thumbnail: 'art-filters/imgly_mosaic/thumbnail.jpg'
}, {
  defaultName: 'Wave',
  identifier: 'imgly_art_filter_wave',
  rootPath: 'art-filters/imgly_wave',
  thumbnail: 'art-filters/imgly_wave/thumbnail.jpg'
}, {
  defaultName: 'Malikova Darya',
  identifier: 'imgly_art_filter_watercolor',
  rootPath: 'art-filters/imgly_watercolor',
  thumbnail: 'art-filters/imgly_watercolor/thumbnail.jpg'
}]);

/***/ }),
/* 299 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return FreeLicenseChecker; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils__ = __webpack_require__(32);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__lib_semantic_version__ = __webpack_require__(300);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__vendor_jsbn__ = __webpack_require__(301);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__lib_base64__ = __webpack_require__(65);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_loaders_json_loader__ = __webpack_require__(71);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__vendor_sha256__ = __webpack_require__(309);





var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







var bd = function bd(str) {
  return __WEBPACK_IMPORTED_MODULE_4__utils__["a" /* default */].byteArrayToString(__WEBPACK_IMPORTED_MODULE_7__lib_base64__["a" /* default */].decode(str));
};

function byteArraytoHexString(byteArray) {
  return byteArray.map(function (byte) {
    return ('0' + (byte & 0xFF).toString(16)).slice(-2);
  }).join('');
}

// /track?apiKey= (hashed twice)
var TRACK_PATH = 'TDNSeVlXTnJQMkZ3YVV0bGVUMD0=';
var ENTERPRISE_LICENSE = 'ZW50ZXJwcmlzZV9saWNlbnNl';
var APP_IDENTIFIERS = 'YXBwX2lkZW50aWZpZXJz';
var PLATFORM = 'cGxhdGZvcm0=';
var FEATURES = 'ZmVhdHVyZXM=';
var EXPIRES_AT = 'ZXhwaXJlc19hdA==';
var DOMAINS = 'ZG9tYWlucw==';
var API_TOKEN = 'YXBpX3Rva2Vu';
var SIGNATURE = 'c2lnbmF0dXJl';
var VERSION = 'dmVyc2lvbg==';

/**
 * Checks whether the license of the SDK is valid
 * @class
 * @ignore
 */

var L = function () {
  /**
   * Creates a new LicenseChecker
   */
  function L(license) {
    _classCallCheck(this, L);

    this._version = '2.4';
    this._l = typeof license === 'string' ? license.trim() : license;
    this._e = this._parseBigInt('65537', 10);
    this._n = this._parseBigInt('6819840423824240913788063375448466721602926474225172236787752309' + '8336604672061187336820404073576669839528249293719278301686716477' + '3742859209434481353888637963692711665138989982680829529436715362' + '5667358136346796192740590402327288838945110996697754005565843294' + '3537572395130934093465857147866505940324185122919531106934589987' + '0108307225910988692123234379186643268583453907260879685992156955' + '9365611423142339833978193569371093431275044410769200884553375977' + '3647508667624675016897621976339835025479716831395476245954274644' + '0628077261880980924552698138857743609502132632199713575442848784' + '2713045032260453199916894132342284390445225837907138900931659124' + '5542868850746377306421632875326596323793099870689104267910598717' + '5588970202082466871461192706070321938250462103821558100761330890' + '2281356202089358012868786573841087212687618786944368951946284113' + '9745420290435157777150691674661228996405349021099034285740903017' + '9406810634136188751670648983222653319056818302012063874664196648' + '8681563056966446643621715425036653214559713359559486988289399487' + '8672019313267274977616291309200066795329980321640466408798804658' + '4107737900256954976744353601826341965438148646041640662195744770' + '5440947482959458441845074598088031149173011240880824583060864734' + '90516969815873631', 10);
    this._parseLicense();
  }

  /**
   * Checks if the license is valid
   * @return {Boolean}
   */


  _createClass(L, [{
    key: 'v',
    value: function v() {
      return this._sigValid() && !this.isExp();
    }

    /**
     * Checks if the license is a valid JSON
     */

  }, {
    key: '_jsonValid',
    value: function _jsonValid() {
      try {
        this._decLic = JSON.parse(this._l);
      } catch (e) {
        this._decLic = {};
        return false; // not a valid json
      }
      return true;
    }

    /**
     * Checks if this license is valid for the current hostname
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_hostnameValid',
    value: function _hostnameValid() {
      if (typeof window === 'undefined') return true;
      if (!this._decLic[bd(APP_IDENTIFIERS)].length) return true;

      var hostname = window.location.hostname;

      var valid = false;
      this._decLic[bd(APP_IDENTIFIERS)].forEach(function (appIdentifier) {
        if (__WEBPACK_IMPORTED_MODULE_4__utils__["a" /* default */].wildCardMatch(hostname, appIdentifier)) {
          valid = true;
        }
      });
      return valid;
    }

    /**
     * Checks if this license is valid for the current platform
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_platformValid',
    value: function _platformValid() {
      var licensePlatform = this._decLic[bd(PLATFORM)];
      var systemPlatform =   'HTML5';
      return systemPlatform === licensePlatform;
    }

    /**
     * Throws an error if the license is not valid
     */

  }, {
    key: 'c',
    value: function c() {
      var _this = this;

      return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var licenseType = _typeof(_this._l);
        if (licenseType !== 'string' || !_this._jsonValid()) {
          var error = new Error();
          error.code = 'ELICINVFMT';
          return reject(error);
        }

        if (!_this._sigValid()) {
          var _error = new Error();
          _error.code = 'ELICINV';
          return reject(_error);
        }

        if (!_this._hostnameValid()) {
          var _error2 = new Error();
          _error2.code = 'ELICINVHOST';
          return reject(_error2);
        }

        if (!_this._platformValid()) {
          var _error3 = new Error();
          _error3.code = 'ELICINVPLAT';
          return reject(_error3);
        }

        if (_this.isExp()) {
          var _error4 = new Error();
          _error4.code = 'ELICEXP';
          return reject(_error4);
        }

        resolve();
      });
    }

    /**
     * Checks if the given tool identifier is available per license
     * @param  {String}  identifier
     * @return {Boolean}
     */

  }, {
    key: 'isToolAllowed',
    value: function isToolAllowed(identifier) {
      return this._includesFeature(identifier);
    }

    /**
     * Checks whether the license allows white-label usage of the UI.
     * @return {Boolean}
     */

  }, {
    key: 'isWhiteLabel',
    value: function isWhiteLabel() {
      return this._includesFeature('whitelabel', new __WEBPACK_IMPORTED_MODULE_5__lib_semantic_version__["a" /* SemanticVersion */]('2.4', true));
    }

    /**
     * Checks whether the license allows for custom assets to be used.
     * @return {Boolean}
     */

  }, {
    key: 'areCustomAssetsAllowed',
    value: function areCustomAssetsAllowed() {
      return this._includesFeature('customassets', new __WEBPACK_IMPORTED_MODULE_5__lib_semantic_version__["a" /* SemanticVersion */]('2.4', true));
    }

    /**
     * Tracks an edit
     * @return {Promise}
     */

  }, {
    key: 't',
    value: function t() {
      if (this._decLic.enterprise_license) return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve();
      if (this._includesFeature('noexporttracking', new __WEBPACK_IMPORTED_MODULE_5__lib_semantic_version__["a" /* SemanticVersion */]('2.4', true))) return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve();

      var trackPath = this._decLic[bd(DOMAINS)][0] + bd(bd(TRACK_PATH)) + this._decLic[bd(API_TOKEN)];
      var jsonLoader = new __WEBPACK_IMPORTED_MODULE_8__shared_loaders_json_loader__["a" /* default */](trackPath);
      return jsonLoader.load();
    }

    /**
     * Checks if this license is an enterprise license
     * @return {Boolean}
     */

  }, {
    key: 'isENT',
    value: function isENT() {
      if (!this._decLic) return false;
      return this._decLic[bd(ENTERPRISE_LICENSE)];
    }

    /**
     * Checks if the license signature is valid
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_sigValid',
    value: function _sigValid() {
      return this._verify(this._message, this._sig);
    }
  }, {
    key: 'exp',
    value: function exp() {
      return !!this._decLic[bd(EXPIRES_AT)];
    }
  }, {
    key: 'dl',
    value: function dl() {
      return Math.ceil((this._expAt() - Date.now()) / (60 * 60 * 24 * 1000));
    }

    /**
     * Check if license is expired now
     * @param {number} current_time
     * @private
     */

  }, {
    key: 'isExp',
    value: function isExp() {
      var now = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Date.now();

      if (this._decLic[bd(EXPIRES_AT)] === null) return false;
      return now > this._expAt();
    }

    /**
     * Returns the datetime that the license will expire at in milliseconds
     * @return {Number}
     * @private
     */

  }, {
    key: '_expAt',
    value: function _expAt() {
      return this._decLic[bd(EXPIRES_AT)] * 1000;
    }

    /**
     * Verify the signature
     * @param  {String} message
     * @param  {String} signature
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_verify',
    value: function _verify(message, signature) {
      var verification = void 0;
      var messageDigest = void 0;
      // Encode message to messageDigest with sha256
      messageDigest = this._encodeMessage(message);
      // Decode signature
      verification = this._decodeSignature(signature);

      // Cut to correct length of sha256 hash
      verification = verification.substr(-64);
      var isValid = messageDigest === verification;
      return isValid;
    }

    /**
     * Encode the message to sha256 messageDigest
     * @param {String} message
     * @return {String}
     * @private
     */

  }, {
    key: '_encodeMessage',
    value: function _encodeMessage(message) {
      var messageDigest = Object(__WEBPACK_IMPORTED_MODULE_9__vendor_sha256__["a" /* sha256 */])(message);
      return messageDigest;
    }

    /**
     * Decode signature and extract messageDigest
     * @param  {String} signature
     */

  }, {
    key: '_decodeSignature',
    value: function _decodeSignature(signature) {
      var verification = void 0;
      // Decode Base64 to ByteArray
      signature = __WEBPACK_IMPORTED_MODULE_7__lib_base64__["a" /* default */].decode(signature);
      // Convert ByteArray to HexString
      signature = byteArraytoHexString(signature);
      // Convert hex to BigInteger
      signature = this._parseBigInt(signature, 16);
      // Calculate verification
      verification = signature.modPowInt(this._e, this._n);
      // convert to hex
      verification = verification.toString(16);
      return verification;
    }

    /**
     * Parse the given string as a BigInteger with the given base
     * @param {String} str
     * @param {Number} base
     * @return {BigInteger}
     * @private
     */

  }, {
    key: '_parseBigInt',
    value: function _parseBigInt(str, base) {
      return new __WEBPACK_IMPORTED_MODULE_6__vendor_jsbn__["a" /* default */](str, base);
    }

    /**
     * Parses the license
     * @private
     */

  }, {
    key: '_parseLicense',
    value: function _parseLicense() {
      if (typeof this._l !== 'string') return;
      if (!this._jsonValid()) return;

      this._sig = this._decLic[bd(SIGNATURE)] || '';
      delete this._decLic[bd(SIGNATURE)];

      // Replace invalid base64 characters. This includes newlines
      this._sig = this._sig.replace(/[^A-Za-z0-9+/=]/g, '');
      this._message = this._l.replace(new RegExp(',"' + bd(SIGNATURE) + '":"([^"]*)"'), '');
    }

    /**
     * Checks whether the given feature is included in this license.
     * @param {string} feature The feature name.
     * @param {SemanticVersion} minLicenseVersion The minimum license version that could potentially include this feature.
     * @private
     */

  }, {
    key: '_includesFeature',
    value: function _includesFeature(feature) {
      var minLicenseVersion = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new __WEBPACK_IMPORTED_MODULE_5__lib_semantic_version__["a" /* SemanticVersion */]('1.0', true);

      var version = new __WEBPACK_IMPORTED_MODULE_5__lib_semantic_version__["a" /* SemanticVersion */](this._decLic[bd(VERSION)], true);
      if (minLicenseVersion.isMoreRecentThan(version)) return true;
      return this._decLic[bd(FEATURES)] && this._decLic[bd(FEATURES)].indexOf(feature) !== -1;
    }
  }]);

  return L;
}();

var FreeLicenseChecker = function () {
  function FreeLicenseChecker() {
    _classCallCheck(this, FreeLicenseChecker);
  }

  _createClass(FreeLicenseChecker, [{
    key: 'v',

    /**
     * Checks if the license is valid
     * @return {Boolean}
     */
    value: function v() {
      return true;
    }

    /**
     * Throws an error if the license is not valid
     */

  }, {
    key: 'c',
    value: function c() {
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve();
    }

    /**
     * Checks if the given tool identifier is available per license
     * @param  {String}  identifier
     * @return {Boolean}
     */

  }, {
    key: 'isToolAllowed',
    value: function isToolAllowed(identifier) {
      return true;
    }

    /**
     * Checks whether the license allows white-label usage of the UI.
     * @return {Boolean}
     */

  }, {
    key: 'isWhiteLabel',
    value: function isWhiteLabel() {
      return false;
    }

    /**
     * Checks whether the license allows for custom assets to be used.
     * @return {Boolean}
     */

  }, {
    key: 'areCustomAssetsAllowed',
    value: function areCustomAssetsAllowed() {
      return true;
    }

    /**
     * Tracks an edit
     * @return {Promise}
     */

  }, {
    key: 't',
    value: function t() {
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve();
    }

    /**
     * Checks if this license is an enterprise license
     * @return {Boolean}
     */

  }, {
    key: 'isENT',
    value: function isENT() {
      return false;
    }
  }, {
    key: 'exp',
    value: function exp() {
      return false;
    }
  }, {
    key: 'dl',
    value: function dl() {
      return 0;
    }

    /**
     * Check if license is expired now
     * @param {number} current_time
     * @private
     */

  }, {
    key: 'isExp',
    value: function isExp() {

      return false;
    }
  }]);

  return FreeLicenseChecker;
}();

/* harmony default export */ __webpack_exports__["b"] = (L);

/***/ }),
/* 300 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SemanticVersion; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/** eslint-disable */
var correctSemVerPattern = /^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g;
var optionalPatchPattern = /^(0|[1-9]\d*)\.(0|[1-9]\d*)(\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g;
/** eslint-enable */
/**
 * A class used to parse and compare strings that follow the Semantic Versioning Specification
 * (https://semver.org).
 */

var SemanticVersion = function () {
  _createClass(SemanticVersion, [{
    key: "major",

    /**
     * The major version number.
     * @returns {number}
     */
    get: function get() {
      return this._major;
    }

    /**
     * The minor version number.
     * @returns {number}
     */

  }, {
    key: "minor",
    get: function get() {
      return this._minor;
    }

    /**
     * The patch version number.
     * @returns {number}
     */

  }, {
    key: "patch",
    get: function get() {
      return this._patch;
    }

    /**
     * @param {string} version The semantic versioning string
     */

  }]);

  function SemanticVersion(version) {
    var patchVersionOptional = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

    _classCallCheck(this, SemanticVersion);

    var pattern = patchVersionOptional ? optionalPatchPattern : correctSemVerPattern;
    var groups = pattern.exec(version);
    pattern.lastIndex = 0;

    /**
     * @member {string} _major The major version number
     * @private
     */
    this._major = groups[1];

    /**
     * @member {string} _minor The minor version number
     * @private
     */
    this._minor = groups[2];

    /**
     * @member {string} _patch The patch version number
     * @private
     */
    this._patch = groups[3] || 0;
  }

  /**
   * Checks whether two semantic versions are the same.
   * @param {SemanticVersion} other
   * @returns {boolean}
   */


  _createClass(SemanticVersion, [{
    key: "equals",
    value: function equals(other) {
      return this._major === other._major && this._minor === other._minor && this._patch === other._patch;
    }

    /**
     * Checks whether this version is more recent than `other`.
     * @param {SemanticVersion} other The version to be compared.
     * @returns {boolean}
     */

  }, {
    key: "isMoreRecentThan",
    value: function isMoreRecentThan(other) {
      if (this._major < other.major) return false;
      if (this._major > other.major) return true;

      if (this._minor < other.minor) return false;
      if (this._minor > other.minor) return true;

      if (this._patch <= other.patch) return false;
      if (this._patch > other.patch) return true;
    }
  }]);

  return SemanticVersion;
}();



/***/ }),
/* 301 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* unused harmony export int2char */
/* eslint-disable */
/*!
 * Copyright (c) 2003-2005  Tom Wu
 * All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
 * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER
 * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF
 * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT
 * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * In addition, the following condition applies:
 *
 * All redistributions must retain an intact copy of this copyright notice
 * and disclaimer.
 */

// Polyfill navigator
var navigator = navigator || {};

// Basic JavaScript BN library - subset useful for RSA encryption.

// Bits per digit
var dbits;

// (public) Constructor
function BigInteger(a, b, c) {
  if (a != null) if ("number" == typeof a) this.fromNumber(a, b, c);else if (b == null && "string" != typeof a) this.fromString(a, 256);else this.fromString(a, b);
}

// return new, unset BigInteger
function nbi() {
  return new BigInteger(null);
}

// am: Compute w_j += (x*this_i), propagate carries,
// c is initial carry, returns final carry.
// c < 3*dvalue, x < 2*dvalue, this_i < dvalue
// We need to select the fastest one that works in this environment.

// am1: use a single mult and divide to get the high bits,
// max digit bits should be 26 because
// max internal value = 2*dvalue^2-2*dvalue (< 2^53)
function am1(i, x, w, j, c, n) {
  while (--n >= 0) {
    var v = x * this[i++] + w[j] + c;
    c = Math.floor(v / 0x4000000);
    w[j++] = v & 0x3ffffff;
  }
  return c;
}
// am2 avoids a big mult-and-extract completely.
// Max digit bits should be <= 30 because we do bitwise ops
// on values up to 2*hdvalue^2-hdvalue-1 (< 2^31)
function am2(i, x, w, j, c, n) {
  var xl = x & 0x7fff,
      xh = x >> 15;
  while (--n >= 0) {
    var l = this[i] & 0x7fff;
    var h = this[i++] >> 15;
    var m = xh * l + h * xl;
    l = xl * l + ((m & 0x7fff) << 15) + w[j] + (c & 0x3fffffff);
    c = (l >>> 30) + (m >>> 15) + xh * h + (c >>> 30);
    w[j++] = l & 0x3fffffff;
  }
  return c;
}
// Alternately, set max digit bits to 28 since some
// browsers slow down when dealing with 32-bit numbers.
function am3(i, x, w, j, c, n) {
  var xl = x & 0x3fff,
      xh = x >> 14;
  while (--n >= 0) {
    var l = this[i] & 0x3fff;
    var h = this[i++] >> 14;
    var m = xh * l + h * xl;
    l = xl * l + ((m & 0x3fff) << 14) + w[j] + c;
    c = (l >> 28) + (m >> 14) + xh * h;
    w[j++] = l & 0xfffffff;
  }
  return c;
}

if ( navigator.appName == "Microsoft Internet Explorer") {
  BigInteger.prototype.am = am2;
  dbits = 30;
} else if ( navigator.appName != "Netscape") {
  BigInteger.prototype.am = am1;
  dbits = 26;
} else {
  // Mozilla/Netscape seems to prefer am3
  BigInteger.prototype.am = am3;
  dbits = 28;
}

BigInteger.prototype.DB = dbits;
BigInteger.prototype.DM = (1 << dbits) - 1;
BigInteger.prototype.DV = 1 << dbits;

var BI_FP = 52;
BigInteger.prototype.FV = Math.pow(2, BI_FP);
BigInteger.prototype.F1 = BI_FP - dbits;
BigInteger.prototype.F2 = 2 * dbits - BI_FP;

// Digit conversions
var BI_RM = "0123456789abcdefghijklmnopqrstuvwxyz";
var BI_RC = new Array();
var rr, vv;
rr = "0".charCodeAt(0);
for (vv = 0; vv <= 9; ++vv) {
  BI_RC[rr++] = vv;
}rr = "a".charCodeAt(0);
for (vv = 10; vv < 36; ++vv) {
  BI_RC[rr++] = vv;
}rr = "A".charCodeAt(0);
for (vv = 10; vv < 36; ++vv) {
  BI_RC[rr++] = vv;
}function int2char(n) {
  return BI_RM.charAt(n);
}
function intAt(s, i) {
  var c = BI_RC[s.charCodeAt(i)];
  return c == null ? -1 : c;
}

// (protected) copy this to r
function bnpCopyTo(r) {
  for (var i = this.t - 1; i >= 0; --i) {
    r[i] = this[i];
  }r.t = this.t;
  r.s = this.s;
}

// (protected) set from integer value x, -DV <= x < DV
function bnpFromInt(x) {
  this.t = 1;
  this.s = x < 0 ? -1 : 0;
  if (x > 0) this[0] = x;else if (x < -1) this[0] = x + this.DV;else this.t = 0;
}

// return bigint initialized to value
function nbv(i) {
  var r = nbi();r.fromInt(i);return r;
}

// (protected) set from string and radix
function bnpFromString(s, b) {
  var k;
  if (b == 16) k = 4;else if (b == 8) k = 3;else if (b == 256) k = 8; // byte array
  else if (b == 2) k = 1;else if (b == 32) k = 5;else if (b == 4) k = 2;else {
      this.fromRadix(s, b);return;
    }
  this.t = 0;
  this.s = 0;
  var i = s.length,
      mi = false,
      sh = 0;
  while (--i >= 0) {
    var x = k == 8 ? s[i] & 0xff : intAt(s, i);
    if (x < 0) {
      if (s.charAt(i) == "-") mi = true;
      continue;
    }
    mi = false;
    if (sh == 0) this[this.t++] = x;else if (sh + k > this.DB) {
      this[this.t - 1] |= (x & (1 << this.DB - sh) - 1) << sh;
      this[this.t++] = x >> this.DB - sh;
    } else this[this.t - 1] |= x << sh;
    sh += k;
    if (sh >= this.DB) sh -= this.DB;
  }
  if (k == 8 && (s[0] & 0x80) != 0) {
    this.s = -1;
    if (sh > 0) this[this.t - 1] |= (1 << this.DB - sh) - 1 << sh;
  }
  this.clamp();
  if (mi) BigInteger.ZERO.subTo(this, this);
}

// (protected) clamp off excess high words
function bnpClamp() {
  var c = this.s & this.DM;
  while (this.t > 0 && this[this.t - 1] == c) {
    --this.t;
  }
}

// (public) return string representation in given radix
function bnToString(b) {
  if (this.s < 0) return "-" + this.negate().toString(b);
  var k;
  if (b == 16) k = 4;else if (b == 8) k = 3;else if (b == 2) k = 1;else if (b == 32) k = 5;else if (b == 4) k = 2;else return this.toRadix(b);
  var km = (1 << k) - 1,
      d,
      m = false,
      r = "",
      i = this.t;
  var p = this.DB - i * this.DB % k;
  if (i-- > 0) {
    if (p < this.DB && (d = this[i] >> p) > 0) {
      m = true;r = int2char(d);
    }
    while (i >= 0) {
      if (p < k) {
        d = (this[i] & (1 << p) - 1) << k - p;
        d |= this[--i] >> (p += this.DB - k);
      } else {
        d = this[i] >> (p -= k) & km;
        if (p <= 0) {
          p += this.DB;--i;
        }
      }
      if (d > 0) m = true;
      if (m) r += int2char(d);
    }
  }
  return m ? r : "0";
}

// (public) -this
function bnNegate() {
  var r = nbi();BigInteger.ZERO.subTo(this, r);return r;
}

// (public) |this|
function bnAbs() {
  return this.s < 0 ? this.negate() : this;
}

// (public) return + if this > a, - if this < a, 0 if equal
function bnCompareTo(a) {
  var r = this.s - a.s;
  if (r != 0) return r;
  var i = this.t;
  r = i - a.t;
  if (r != 0) return this.s < 0 ? -r : r;
  while (--i >= 0) {
    if ((r = this[i] - a[i]) != 0) return r;
  }return 0;
}

// returns bit length of the integer x
function nbits(x) {
  var r = 1,
      t;
  if ((t = x >>> 16) != 0) {
    x = t;r += 16;
  }
  if ((t = x >> 8) != 0) {
    x = t;r += 8;
  }
  if ((t = x >> 4) != 0) {
    x = t;r += 4;
  }
  if ((t = x >> 2) != 0) {
    x = t;r += 2;
  }
  if ((t = x >> 1) != 0) {
    x = t;r += 1;
  }
  return r;
}

// (public) return the number of bits in "this"
function bnBitLength() {
  if (this.t <= 0) return 0;
  return this.DB * (this.t - 1) + nbits(this[this.t - 1] ^ this.s & this.DM);
}

// (protected) r = this << n*DB
function bnpDLShiftTo(n, r) {
  var i;
  for (i = this.t - 1; i >= 0; --i) {
    r[i + n] = this[i];
  }for (i = n - 1; i >= 0; --i) {
    r[i] = 0;
  }r.t = this.t + n;
  r.s = this.s;
}

// (protected) r = this >> n*DB
function bnpDRShiftTo(n, r) {
  for (var i = n; i < this.t; ++i) {
    r[i - n] = this[i];
  }r.t = Math.max(this.t - n, 0);
  r.s = this.s;
}

// (protected) r = this << n
function bnpLShiftTo(n, r) {
  var bs = n % this.DB;
  var cbs = this.DB - bs;
  var bm = (1 << cbs) - 1;
  var ds = Math.floor(n / this.DB),
      c = this.s << bs & this.DM,
      i;
  for (i = this.t - 1; i >= 0; --i) {
    r[i + ds + 1] = this[i] >> cbs | c;
    c = (this[i] & bm) << bs;
  }
  for (i = ds - 1; i >= 0; --i) {
    r[i] = 0;
  }r[ds] = c;
  r.t = this.t + ds + 1;
  r.s = this.s;
  r.clamp();
}

// (protected) r = this >> n
function bnpRShiftTo(n, r) {
  r.s = this.s;
  var ds = Math.floor(n / this.DB);
  if (ds >= this.t) {
    r.t = 0;return;
  }
  var bs = n % this.DB;
  var cbs = this.DB - bs;
  var bm = (1 << bs) - 1;
  r[0] = this[ds] >> bs;
  for (var i = ds + 1; i < this.t; ++i) {
    r[i - ds - 1] |= (this[i] & bm) << cbs;
    r[i - ds] = this[i] >> bs;
  }
  if (bs > 0) r[this.t - ds - 1] |= (this.s & bm) << cbs;
  r.t = this.t - ds;
  r.clamp();
}

// (protected) r = this - a
function bnpSubTo(a, r) {
  var i = 0,
      c = 0,
      m = Math.min(a.t, this.t);
  while (i < m) {
    c += this[i] - a[i];
    r[i++] = c & this.DM;
    c >>= this.DB;
  }
  if (a.t < this.t) {
    c -= a.s;
    while (i < this.t) {
      c += this[i];
      r[i++] = c & this.DM;
      c >>= this.DB;
    }
    c += this.s;
  } else {
    c += this.s;
    while (i < a.t) {
      c -= a[i];
      r[i++] = c & this.DM;
      c >>= this.DB;
    }
    c -= a.s;
  }
  r.s = c < 0 ? -1 : 0;
  if (c < -1) r[i++] = this.DV + c;else if (c > 0) r[i++] = c;
  r.t = i;
  r.clamp();
}

// (protected) r = this * a, r != this,a (HAC 14.12)
// "this" should be the larger one if appropriate.
function bnpMultiplyTo(a, r) {
  var x = this.abs(),
      y = a.abs();
  var i = x.t;
  r.t = i + y.t;
  while (--i >= 0) {
    r[i] = 0;
  }for (i = 0; i < y.t; ++i) {
    r[i + x.t] = x.am(0, y[i], r, i, 0, x.t);
  }r.s = 0;
  r.clamp();
  if (this.s != a.s) BigInteger.ZERO.subTo(r, r);
}

// (protected) r = this^2, r != this (HAC 14.16)
function bnpSquareTo(r) {
  var x = this.abs();
  var i = r.t = 2 * x.t;
  while (--i >= 0) {
    r[i] = 0;
  }for (i = 0; i < x.t - 1; ++i) {
    var c = x.am(i, x[i], r, 2 * i, 0, 1);
    if ((r[i + x.t] += x.am(i + 1, 2 * x[i], r, 2 * i + 1, c, x.t - i - 1)) >= x.DV) {
      r[i + x.t] -= x.DV;
      r[i + x.t + 1] = 1;
    }
  }
  if (r.t > 0) r[r.t - 1] += x.am(i, x[i], r, 2 * i, 0, 1);
  r.s = 0;
  r.clamp();
}

// (protected) divide this by m, quotient and remainder to q, r (HAC 14.20)
// r != q, this != m.  q or r may be null.
function bnpDivRemTo(m, q, r) {
  var pm = m.abs();
  if (pm.t <= 0) return;
  var pt = this.abs();
  if (pt.t < pm.t) {
    if (q != null) q.fromInt(0);
    if (r != null) this.copyTo(r);
    return;
  }
  if (r == null) r = nbi();
  var y = nbi(),
      ts = this.s,
      ms = m.s;
  var nsh = this.DB - nbits(pm[pm.t - 1]); // normalize modulus
  if (nsh > 0) {
    pm.lShiftTo(nsh, y);pt.lShiftTo(nsh, r);
  } else {
    pm.copyTo(y);pt.copyTo(r);
  }
  var ys = y.t;
  var y0 = y[ys - 1];
  if (y0 == 0) return;
  var yt = y0 * (1 << this.F1) + (ys > 1 ? y[ys - 2] >> this.F2 : 0);
  var d1 = this.FV / yt,
      d2 = (1 << this.F1) / yt,
      e = 1 << this.F2;
  var i = r.t,
      j = i - ys,
      t = q == null ? nbi() : q;
  y.dlShiftTo(j, t);
  if (r.compareTo(t) >= 0) {
    r[r.t++] = 1;
    r.subTo(t, r);
  }
  BigInteger.ONE.dlShiftTo(ys, t);
  t.subTo(y, y); // "negative" y so we can replace sub with am later
  while (y.t < ys) {
    y[y.t++] = 0;
  }while (--j >= 0) {
    // Estimate quotient digit
    var qd = r[--i] == y0 ? this.DM : Math.floor(r[i] * d1 + (r[i - 1] + e) * d2);
    if ((r[i] += y.am(0, qd, r, j, 0, ys)) < qd) {
      // Try it out
      y.dlShiftTo(j, t);
      r.subTo(t, r);
      while (r[i] < --qd) {
        r.subTo(t, r);
      }
    }
  }
  if (q != null) {
    r.drShiftTo(ys, q);
    if (ts != ms) BigInteger.ZERO.subTo(q, q);
  }
  r.t = ys;
  r.clamp();
  if (nsh > 0) r.rShiftTo(nsh, r); // Denormalize remainder
  if (ts < 0) BigInteger.ZERO.subTo(r, r);
}

// (public) this mod a
function bnMod(a) {
  var r = nbi();
  this.abs().divRemTo(a, null, r);
  if (this.s < 0 && r.compareTo(BigInteger.ZERO) > 0) a.subTo(r, r);
  return r;
}

// Modular reduction using "classic" algorithm
function Classic(m) {
  this.m = m;
}
function cConvert(x) {
  if (x.s < 0 || x.compareTo(this.m) >= 0) return x.mod(this.m);else return x;
}
function cRevert(x) {
  return x;
}
function cReduce(x) {
  x.divRemTo(this.m, null, x);
}
function cMulTo(x, y, r) {
  x.multiplyTo(y, r);this.reduce(r);
}
function cSqrTo(x, r) {
  x.squareTo(r);this.reduce(r);
}

Classic.prototype.convert = cConvert;
Classic.prototype.revert = cRevert;
Classic.prototype.reduce = cReduce;
Classic.prototype.mulTo = cMulTo;
Classic.prototype.sqrTo = cSqrTo;

// (protected) return "-1/this % 2^DB"; useful for Mont. reduction
// justification:
//         xy == 1 (mod m)
//         xy =  1+km
//   xy(2-xy) = (1+km)(1-km)
// x[y(2-xy)] = 1-k^2m^2
// x[y(2-xy)] == 1 (mod m^2)
// if y is 1/x mod m, then y(2-xy) is 1/x mod m^2
// should reduce x and y(2-xy) by m^2 at each step to keep size bounded.
// JS multiply "overflows" differently from C/C++, so care is needed here.
function bnpInvDigit() {
  if (this.t < 1) return 0;
  var x = this[0];
  if ((x & 1) == 0) return 0;
  var y = x & 3; // y == 1/x mod 2^2
  y = y * (2 - (x & 0xf) * y) & 0xf; // y == 1/x mod 2^4
  y = y * (2 - (x & 0xff) * y) & 0xff; // y == 1/x mod 2^8
  y = y * (2 - ((x & 0xffff) * y & 0xffff)) & 0xffff; // y == 1/x mod 2^16
  // last step - calculate inverse mod DV directly;
  // assumes 16 < DB <= 32 and assumes ability to handle 48-bit ints
  y = y * (2 - x * y % this.DV) % this.DV; // y == 1/x mod 2^dbits
  // we really want the negative inverse, and -DV < y < DV
  return y > 0 ? this.DV - y : -y;
}

// Montgomery reduction
function Montgomery(m) {
  this.m = m;
  this.mp = m.invDigit();
  this.mpl = this.mp & 0x7fff;
  this.mph = this.mp >> 15;
  this.um = (1 << m.DB - 15) - 1;
  this.mt2 = 2 * m.t;
}

// xR mod m
function montConvert(x) {
  var r = nbi();
  x.abs().dlShiftTo(this.m.t, r);
  r.divRemTo(this.m, null, r);
  if (x.s < 0 && r.compareTo(BigInteger.ZERO) > 0) this.m.subTo(r, r);
  return r;
}

// x/R mod m
function montRevert(x) {
  var r = nbi();
  x.copyTo(r);
  this.reduce(r);
  return r;
}

// x = x/R mod m (HAC 14.32)
function montReduce(x) {
  while (x.t <= this.mt2) {
    // pad x so am has enough room later
    x[x.t++] = 0;
  }for (var i = 0; i < this.m.t; ++i) {
    // faster way of calculating u0 = x[i]*mp mod DV
    var j = x[i] & 0x7fff;
    var u0 = j * this.mpl + ((j * this.mph + (x[i] >> 15) * this.mpl & this.um) << 15) & x.DM;
    // use am to combine the multiply-shift-add into one call
    j = i + this.m.t;
    x[j] += this.m.am(0, u0, x, i, 0, this.m.t);
    // propagate carry
    while (x[j] >= x.DV) {
      x[j] -= x.DV;x[++j]++;
    }
  }
  x.clamp();
  x.drShiftTo(this.m.t, x);
  if (x.compareTo(this.m) >= 0) x.subTo(this.m, x);
}

// r = "x^2/R mod m"; x != r
function montSqrTo(x, r) {
  x.squareTo(r);this.reduce(r);
}

// r = "xy/R mod m"; x,y != r
function montMulTo(x, y, r) {
  x.multiplyTo(y, r);this.reduce(r);
}

Montgomery.prototype.convert = montConvert;
Montgomery.prototype.revert = montRevert;
Montgomery.prototype.reduce = montReduce;
Montgomery.prototype.mulTo = montMulTo;
Montgomery.prototype.sqrTo = montSqrTo;

// (protected) true iff this is even
function bnpIsEven() {
  return (this.t > 0 ? this[0] & 1 : this.s) == 0;
}

// (protected) this^e, e < 2^32, doing sqr and mul with "r" (HAC 14.79)
function bnpExp(e, z) {
  if (e > 0xffffffff || e < 1) return BigInteger.ONE;
  var r = nbi(),
      r2 = nbi(),
      g = z.convert(this),
      i = nbits(e) - 1;
  g.copyTo(r);
  while (--i >= 0) {
    z.sqrTo(r, r2);
    if ((e & 1 << i) > 0) z.mulTo(r2, g, r);else {
      var t = r;r = r2;r2 = t;
    }
  }
  return z.revert(r);
}

// (public) this^e % m, 0 <= e < 2^32
function bnModPowInt(e, m) {
  var z;
  if (e < 256 || m.isEven()) z = new Classic(m);else z = new Montgomery(m);
  return this.exp(e, z);
}

// protected
BigInteger.prototype.copyTo = bnpCopyTo;
BigInteger.prototype.fromInt = bnpFromInt;
BigInteger.prototype.fromString = bnpFromString;
BigInteger.prototype.clamp = bnpClamp;
BigInteger.prototype.dlShiftTo = bnpDLShiftTo;
BigInteger.prototype.drShiftTo = bnpDRShiftTo;
BigInteger.prototype.lShiftTo = bnpLShiftTo;
BigInteger.prototype.rShiftTo = bnpRShiftTo;
BigInteger.prototype.subTo = bnpSubTo;
BigInteger.prototype.multiplyTo = bnpMultiplyTo;
BigInteger.prototype.squareTo = bnpSquareTo;
BigInteger.prototype.divRemTo = bnpDivRemTo;
BigInteger.prototype.invDigit = bnpInvDigit;
BigInteger.prototype.isEven = bnpIsEven;
BigInteger.prototype.exp = bnpExp;

// public
BigInteger.prototype.toString = bnToString;
BigInteger.prototype.negate = bnNegate;
BigInteger.prototype.abs = bnAbs;
BigInteger.prototype.compareTo = bnCompareTo;
BigInteger.prototype.bitLength = bnBitLength;
BigInteger.prototype.mod = bnMod;
BigInteger.prototype.modPowInt = bnModPowInt;

// "constants"
BigInteger.ZERO = nbv(0);
BigInteger.ONE = nbv(1);

// Copyright (c) 2005-2009  Tom Wu
// All Rights Reserved.
// See "LICENSE" for details.

// Extended JavaScript BN functions, required for RSA private ops.

// Version 1.1: new BigInteger("0", 10) returns "proper" zero
// Version 1.2: square() API, isProbablePrime fix

// (public)
function bnClone() {
  var r = nbi();this.copyTo(r);return r;
}

// (public) return value as integer
function bnIntValue() {
  if (this.s < 0) {
    if (this.t == 1) return this[0] - this.DV;else if (this.t == 0) return -1;
  } else if (this.t == 1) return this[0];else if (this.t == 0) return 0;
  // assumes 16 < DB < 32
  return (this[1] & (1 << 32 - this.DB) - 1) << this.DB | this[0];
}

// (public) return value as byte
function bnByteValue() {
  return this.t == 0 ? this.s : this[0] << 24 >> 24;
}

// (public) return value as short (assumes DB>=16)
function bnShortValue() {
  return this.t == 0 ? this.s : this[0] << 16 >> 16;
}

// (protected) return x s.t. r^x < DV
function bnpChunkSize(r) {
  return Math.floor(Math.LN2 * this.DB / Math.log(r));
}

// (public) 0 if this == 0, 1 if this > 0
function bnSigNum() {
  if (this.s < 0) return -1;else if (this.t <= 0 || this.t == 1 && this[0] <= 0) return 0;else return 1;
}

// (protected) convert to radix string
function bnpToRadix(b) {
  if (b == null) b = 10;
  if (this.signum() == 0 || b < 2 || b > 36) return "0";
  var cs = this.chunkSize(b);
  var a = Math.pow(b, cs);
  var d = nbv(a),
      y = nbi(),
      z = nbi(),
      r = "";
  this.divRemTo(d, y, z);
  while (y.signum() > 0) {
    r = (a + z.intValue()).toString(b).substr(1) + r;
    y.divRemTo(d, y, z);
  }
  return z.intValue().toString(b) + r;
}

// (protected) convert from radix string
function bnpFromRadix(s, b) {
  this.fromInt(0);
  if (b == null) b = 10;
  var cs = this.chunkSize(b);
  var d = Math.pow(b, cs),
      mi = false,
      j = 0,
      w = 0;
  for (var i = 0; i < s.length; ++i) {
    var x = intAt(s, i);
    if (x < 0) {
      if (s.charAt(i) == "-" && this.signum() == 0) mi = true;
      continue;
    }
    w = b * w + x;
    if (++j >= cs) {
      this.dMultiply(d);
      this.dAddOffset(w, 0);
      j = 0;
      w = 0;
    }
  }
  if (j > 0) {
    this.dMultiply(Math.pow(b, j));
    this.dAddOffset(w, 0);
  }
  if (mi) BigInteger.ZERO.subTo(this, this);
}

// (protected) alternate constructor
function bnpFromNumber(a, b, c) {
  if ("number" == typeof b) {
    // new BigInteger(int,int,RNG)
    if (a < 2) this.fromInt(1);else {
      this.fromNumber(a, c);
      if (!this.testBit(a - 1)) // force MSB set
        this.bitwiseTo(BigInteger.ONE.shiftLeft(a - 1), op_or, this);
      if (this.isEven()) this.dAddOffset(1, 0); // force odd
      while (!this.isProbablePrime(b)) {
        this.dAddOffset(2, 0);
        if (this.bitLength() > a) this.subTo(BigInteger.ONE.shiftLeft(a - 1), this);
      }
    }
  } else {
    // new BigInteger(int,RNG)
    var x = new Array(),
        t = a & 7;
    x.length = (a >> 3) + 1;
    b.nextBytes(x);
    if (t > 0) x[0] &= (1 << t) - 1;else x[0] = 0;
    this.fromString(x, 256);
  }
}

// (public) convert to bigendian byte array
function bnToByteArray() {
  var i = this.t,
      r = new Array();
  r[0] = this.s;
  var p = this.DB - i * this.DB % 8,
      d,
      k = 0;
  if (i-- > 0) {
    if (p < this.DB && (d = this[i] >> p) != (this.s & this.DM) >> p) r[k++] = d | this.s << this.DB - p;
    while (i >= 0) {
      if (p < 8) {
        d = (this[i] & (1 << p) - 1) << 8 - p;
        d |= this[--i] >> (p += this.DB - 8);
      } else {
        d = this[i] >> (p -= 8) & 0xff;
        if (p <= 0) {
          p += this.DB;--i;
        }
      }
      if ((d & 0x80) != 0) d |= -256;
      if (k == 0 && (this.s & 0x80) != (d & 0x80)) ++k;
      if (k > 0 || d != this.s) r[k++] = d;
    }
  }
  return r;
}

function bnEquals(a) {
  return this.compareTo(a) == 0;
}
function bnMin(a) {
  return this.compareTo(a) < 0 ? this : a;
}
function bnMax(a) {
  return this.compareTo(a) > 0 ? this : a;
}

// (protected) r = this op a (bitwise)
function bnpBitwiseTo(a, op, r) {
  var i,
      f,
      m = Math.min(a.t, this.t);
  for (i = 0; i < m; ++i) {
    r[i] = op(this[i], a[i]);
  }if (a.t < this.t) {
    f = a.s & this.DM;
    for (i = m; i < this.t; ++i) {
      r[i] = op(this[i], f);
    }r.t = this.t;
  } else {
    f = this.s & this.DM;
    for (i = m; i < a.t; ++i) {
      r[i] = op(f, a[i]);
    }r.t = a.t;
  }
  r.s = op(this.s, a.s);
  r.clamp();
}

// (public) this & a
function op_and(x, y) {
  return x & y;
}
function bnAnd(a) {
  var r = nbi();this.bitwiseTo(a, op_and, r);return r;
}

// (public) this | a
function op_or(x, y) {
  return x | y;
}
function bnOr(a) {
  var r = nbi();this.bitwiseTo(a, op_or, r);return r;
}

// (public) this ^ a
function op_xor(x, y) {
  return x ^ y;
}
function bnXor(a) {
  var r = nbi();this.bitwiseTo(a, op_xor, r);return r;
}

// (public) this & ~a
function op_andnot(x, y) {
  return x & ~y;
}
function bnAndNot(a) {
  var r = nbi();this.bitwiseTo(a, op_andnot, r);return r;
}

// (public) ~this
function bnNot() {
  var r = nbi();
  for (var i = 0; i < this.t; ++i) {
    r[i] = this.DM & ~this[i];
  }r.t = this.t;
  r.s = ~this.s;
  return r;
}

// (public) this << n
function bnShiftLeft(n) {
  var r = nbi();
  if (n < 0) this.rShiftTo(-n, r);else this.lShiftTo(n, r);
  return r;
}

// (public) this >> n
function bnShiftRight(n) {
  var r = nbi();
  if (n < 0) this.lShiftTo(-n, r);else this.rShiftTo(n, r);
  return r;
}

// return index of lowest 1-bit in x, x < 2^31
function lbit(x) {
  if (x == 0) return -1;
  var r = 0;
  if ((x & 0xffff) == 0) {
    x >>= 16;r += 16;
  }
  if ((x & 0xff) == 0) {
    x >>= 8;r += 8;
  }
  if ((x & 0xf) == 0) {
    x >>= 4;r += 4;
  }
  if ((x & 3) == 0) {
    x >>= 2;r += 2;
  }
  if ((x & 1) == 0) ++r;
  return r;
}

// (public) returns index of lowest 1-bit (or -1 if none)
function bnGetLowestSetBit() {
  for (var i = 0; i < this.t; ++i) {
    if (this[i] != 0) return i * this.DB + lbit(this[i]);
  }if (this.s < 0) return this.t * this.DB;
  return -1;
}

// return number of 1 bits in x
function cbit(x) {
  var r = 0;
  while (x != 0) {
    x &= x - 1;++r;
  }
  return r;
}

// (public) return number of set bits
function bnBitCount() {
  var r = 0,
      x = this.s & this.DM;
  for (var i = 0; i < this.t; ++i) {
    r += cbit(this[i] ^ x);
  }return r;
}

// (public) true iff nth bit is set
function bnTestBit(n) {
  var j = Math.floor(n / this.DB);
  if (j >= this.t) return this.s != 0;
  return (this[j] & 1 << n % this.DB) != 0;
}

// (protected) this op (1<<n)
function bnpChangeBit(n, op) {
  var r = BigInteger.ONE.shiftLeft(n);
  this.bitwiseTo(r, op, r);
  return r;
}

// (public) this | (1<<n)
function bnSetBit(n) {
  return this.changeBit(n, op_or);
}

// (public) this & ~(1<<n)
function bnClearBit(n) {
  return this.changeBit(n, op_andnot);
}

// (public) this ^ (1<<n)
function bnFlipBit(n) {
  return this.changeBit(n, op_xor);
}

// (protected) r = this + a
function bnpAddTo(a, r) {
  var i = 0,
      c = 0,
      m = Math.min(a.t, this.t);
  while (i < m) {
    c += this[i] + a[i];
    r[i++] = c & this.DM;
    c >>= this.DB;
  }
  if (a.t < this.t) {
    c += a.s;
    while (i < this.t) {
      c += this[i];
      r[i++] = c & this.DM;
      c >>= this.DB;
    }
    c += this.s;
  } else {
    c += this.s;
    while (i < a.t) {
      c += a[i];
      r[i++] = c & this.DM;
      c >>= this.DB;
    }
    c += a.s;
  }
  r.s = c < 0 ? -1 : 0;
  if (c > 0) r[i++] = c;else if (c < -1) r[i++] = this.DV + c;
  r.t = i;
  r.clamp();
}

// (public) this + a
function bnAdd(a) {
  var r = nbi();this.addTo(a, r);return r;
}

// (public) this - a
function bnSubtract(a) {
  var r = nbi();this.subTo(a, r);return r;
}

// (public) this * a
function bnMultiply(a) {
  var r = nbi();this.multiplyTo(a, r);return r;
}

// (public) this^2
function bnSquare() {
  var r = nbi();this.squareTo(r);return r;
}

// (public) this / a
function bnDivide(a) {
  var r = nbi();this.divRemTo(a, r, null);return r;
}

// (public) this % a
function bnRemainder(a) {
  var r = nbi();this.divRemTo(a, null, r);return r;
}

// (public) [this/a,this%a]
function bnDivideAndRemainder(a) {
  var q = nbi(),
      r = nbi();
  this.divRemTo(a, q, r);
  return new Array(q, r);
}

// (protected) this *= n, this >= 0, 1 < n < DV
function bnpDMultiply(n) {
  this[this.t] = this.am(0, n - 1, this, 0, 0, this.t);
  ++this.t;
  this.clamp();
}

// (protected) this += n << w words, this >= 0
function bnpDAddOffset(n, w) {
  if (n == 0) return;
  while (this.t <= w) {
    this[this.t++] = 0;
  }this[w] += n;
  while (this[w] >= this.DV) {
    this[w] -= this.DV;
    if (++w >= this.t) this[this.t++] = 0;
    ++this[w];
  }
}

// A "null" reducer
function NullExp() {}
function nNop(x) {
  return x;
}
function nMulTo(x, y, r) {
  x.multiplyTo(y, r);
}
function nSqrTo(x, r) {
  x.squareTo(r);
}

NullExp.prototype.convert = nNop;
NullExp.prototype.revert = nNop;
NullExp.prototype.mulTo = nMulTo;
NullExp.prototype.sqrTo = nSqrTo;

// (public) this^e
function bnPow(e) {
  return this.exp(e, new NullExp());
}

// (protected) r = lower n words of "this * a", a.t <= n
// "this" should be the larger one if appropriate.
function bnpMultiplyLowerTo(a, n, r) {
  var i = Math.min(this.t + a.t, n);
  r.s = 0; // assumes a,this >= 0
  r.t = i;
  while (i > 0) {
    r[--i] = 0;
  }var j;
  for (j = r.t - this.t; i < j; ++i) {
    r[i + this.t] = this.am(0, a[i], r, i, 0, this.t);
  }for (j = Math.min(a.t, n); i < j; ++i) {
    this.am(0, a[i], r, i, 0, n - i);
  }r.clamp();
}

// (protected) r = "this * a" without lower n words, n > 0
// "this" should be the larger one if appropriate.
function bnpMultiplyUpperTo(a, n, r) {
  --n;
  var i = r.t = this.t + a.t - n;
  r.s = 0; // assumes a,this >= 0
  while (--i >= 0) {
    r[i] = 0;
  }for (i = Math.max(n - this.t, 0); i < a.t; ++i) {
    r[this.t + i - n] = this.am(n - i, a[i], r, 0, 0, this.t + i - n);
  }r.clamp();
  r.drShiftTo(1, r);
}

// Barrett modular reduction
function Barrett(m) {
  // setup Barrett
  this.r2 = nbi();
  this.q3 = nbi();
  BigInteger.ONE.dlShiftTo(2 * m.t, this.r2);
  this.mu = this.r2.divide(m);
  this.m = m;
}

function barrettConvert(x) {
  if (x.s < 0 || x.t > 2 * this.m.t) return x.mod(this.m);else if (x.compareTo(this.m) < 0) return x;else {
    var r = nbi();x.copyTo(r);this.reduce(r);return r;
  }
}

function barrettRevert(x) {
  return x;
}

// x = x mod m (HAC 14.42)
function barrettReduce(x) {
  x.drShiftTo(this.m.t - 1, this.r2);
  if (x.t > this.m.t + 1) {
    x.t = this.m.t + 1;x.clamp();
  }
  this.mu.multiplyUpperTo(this.r2, this.m.t + 1, this.q3);
  this.m.multiplyLowerTo(this.q3, this.m.t + 1, this.r2);
  while (x.compareTo(this.r2) < 0) {
    x.dAddOffset(1, this.m.t + 1);
  }x.subTo(this.r2, x);
  while (x.compareTo(this.m) >= 0) {
    x.subTo(this.m, x);
  }
}

// r = x^2 mod m; x != r
function barrettSqrTo(x, r) {
  x.squareTo(r);this.reduce(r);
}

// r = x*y mod m; x,y != r
function barrettMulTo(x, y, r) {
  x.multiplyTo(y, r);this.reduce(r);
}

Barrett.prototype.convert = barrettConvert;
Barrett.prototype.revert = barrettRevert;
Barrett.prototype.reduce = barrettReduce;
Barrett.prototype.mulTo = barrettMulTo;
Barrett.prototype.sqrTo = barrettSqrTo;

// (public) this^e % m (HAC 14.85)
function bnModPow(e, m) {
  var i = e.bitLength(),
      k,
      r = nbv(1),
      z;
  if (i <= 0) return r;else if (i < 18) k = 1;else if (i < 48) k = 3;else if (i < 144) k = 4;else if (i < 768) k = 5;else k = 6;
  if (i < 8) z = new Classic(m);else if (m.isEven()) z = new Barrett(m);else z = new Montgomery(m);

  // precomputation
  var g = new Array(),
      n = 3,
      k1 = k - 1,
      km = (1 << k) - 1;
  g[1] = z.convert(this);
  if (k > 1) {
    var g2 = nbi();
    z.sqrTo(g[1], g2);
    while (n <= km) {
      g[n] = nbi();
      z.mulTo(g2, g[n - 2], g[n]);
      n += 2;
    }
  }

  var j = e.t - 1,
      w,
      is1 = true,
      r2 = nbi(),
      t;
  i = nbits(e[j]) - 1;
  while (j >= 0) {
    if (i >= k1) w = e[j] >> i - k1 & km;else {
      w = (e[j] & (1 << i + 1) - 1) << k1 - i;
      if (j > 0) w |= e[j - 1] >> this.DB + i - k1;
    }

    n = k;
    while ((w & 1) == 0) {
      w >>= 1;--n;
    }
    if ((i -= n) < 0) {
      i += this.DB;--j;
    }
    if (is1) {
      // ret == 1, don't bother squaring or multiplying it
      g[w].copyTo(r);
      is1 = false;
    } else {
      while (n > 1) {
        z.sqrTo(r, r2);z.sqrTo(r2, r);n -= 2;
      }
      if (n > 0) z.sqrTo(r, r2);else {
        t = r;r = r2;r2 = t;
      }
      z.mulTo(r2, g[w], r);
    }

    while (j >= 0 && (e[j] & 1 << i) == 0) {
      z.sqrTo(r, r2);t = r;r = r2;r2 = t;
      if (--i < 0) {
        i = this.DB - 1;--j;
      }
    }
  }
  return z.revert(r);
}

// (public) gcd(this,a) (HAC 14.54)
function bnGCD(a) {
  var x = this.s < 0 ? this.negate() : this.clone();
  var y = a.s < 0 ? a.negate() : a.clone();
  if (x.compareTo(y) < 0) {
    var t = x;x = y;y = t;
  }
  var i = x.getLowestSetBit(),
      g = y.getLowestSetBit();
  if (g < 0) return x;
  if (i < g) g = i;
  if (g > 0) {
    x.rShiftTo(g, x);
    y.rShiftTo(g, y);
  }
  while (x.signum() > 0) {
    if ((i = x.getLowestSetBit()) > 0) x.rShiftTo(i, x);
    if ((i = y.getLowestSetBit()) > 0) y.rShiftTo(i, y);
    if (x.compareTo(y) >= 0) {
      x.subTo(y, x);
      x.rShiftTo(1, x);
    } else {
      y.subTo(x, y);
      y.rShiftTo(1, y);
    }
  }
  if (g > 0) y.lShiftTo(g, y);
  return y;
}

// (protected) this % n, n < 2^26
function bnpModInt(n) {
  if (n <= 0) return 0;
  var d = this.DV % n,
      r = this.s < 0 ? n - 1 : 0;
  if (this.t > 0) if (d == 0) r = this[0] % n;else for (var i = this.t - 1; i >= 0; --i) {
    r = (d * r + this[i]) % n;
  }return r;
}

// (public) 1/this % m (HAC 14.61)
function bnModInverse(m) {
  var ac = m.isEven();
  if (this.isEven() && ac || m.signum() == 0) return BigInteger.ZERO;
  var u = m.clone(),
      v = this.clone();
  var a = nbv(1),
      b = nbv(0),
      c = nbv(0),
      d = nbv(1);
  while (u.signum() != 0) {
    while (u.isEven()) {
      u.rShiftTo(1, u);
      if (ac) {
        if (!a.isEven() || !b.isEven()) {
          a.addTo(this, a);b.subTo(m, b);
        }
        a.rShiftTo(1, a);
      } else if (!b.isEven()) b.subTo(m, b);
      b.rShiftTo(1, b);
    }
    while (v.isEven()) {
      v.rShiftTo(1, v);
      if (ac) {
        if (!c.isEven() || !d.isEven()) {
          c.addTo(this, c);d.subTo(m, d);
        }
        c.rShiftTo(1, c);
      } else if (!d.isEven()) d.subTo(m, d);
      d.rShiftTo(1, d);
    }
    if (u.compareTo(v) >= 0) {
      u.subTo(v, u);
      if (ac) a.subTo(c, a);
      b.subTo(d, b);
    } else {
      v.subTo(u, v);
      if (ac) c.subTo(a, c);
      d.subTo(b, d);
    }
  }
  if (v.compareTo(BigInteger.ONE) != 0) return BigInteger.ZERO;
  if (d.compareTo(m) >= 0) return d.subtract(m);
  if (d.signum() < 0) d.addTo(m, d);else return d;
  if (d.signum() < 0) return d.add(m);else return d;
}

var lowprimes = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997];
var lplim = (1 << 26) / lowprimes[lowprimes.length - 1];

// (public) test primality with certainty >= 1-.5^t
function bnIsProbablePrime(t) {
  var i,
      x = this.abs();
  if (x.t == 1 && x[0] <= lowprimes[lowprimes.length - 1]) {
    for (i = 0; i < lowprimes.length; ++i) {
      if (x[0] == lowprimes[i]) return true;
    }return false;
  }
  if (x.isEven()) return false;
  i = 1;
  while (i < lowprimes.length) {
    var m = lowprimes[i],
        j = i + 1;
    while (j < lowprimes.length && m < lplim) {
      m *= lowprimes[j++];
    }m = x.modInt(m);
    while (i < j) {
      if (m % lowprimes[i++] == 0) return false;
    }
  }
  return x.millerRabin(t);
}

// (protected) true if probably prime (HAC 4.24, Miller-Rabin)
function bnpMillerRabin(t) {
  var n1 = this.subtract(BigInteger.ONE);
  var k = n1.getLowestSetBit();
  if (k <= 0) return false;
  var r = n1.shiftRight(k);
  t = t + 1 >> 1;
  if (t > lowprimes.length) t = lowprimes.length;
  var a = nbi();
  for (var i = 0; i < t; ++i) {
    //Pick bases at random, instead of starting at 2
    a.fromInt(lowprimes[Math.floor(Math.random() * lowprimes.length)]);
    var y = a.modPow(r, this);
    if (y.compareTo(BigInteger.ONE) != 0 && y.compareTo(n1) != 0) {
      var j = 1;
      while (j++ < k && y.compareTo(n1) != 0) {
        y = y.modPowInt(2, this);
        if (y.compareTo(BigInteger.ONE) == 0) return false;
      }
      if (y.compareTo(n1) != 0) return false;
    }
  }
  return true;
}

// protected
BigInteger.prototype.chunkSize = bnpChunkSize;
BigInteger.prototype.toRadix = bnpToRadix;
BigInteger.prototype.fromRadix = bnpFromRadix;
BigInteger.prototype.fromNumber = bnpFromNumber;
BigInteger.prototype.bitwiseTo = bnpBitwiseTo;
BigInteger.prototype.changeBit = bnpChangeBit;
BigInteger.prototype.addTo = bnpAddTo;
BigInteger.prototype.dMultiply = bnpDMultiply;
BigInteger.prototype.dAddOffset = bnpDAddOffset;
BigInteger.prototype.multiplyLowerTo = bnpMultiplyLowerTo;
BigInteger.prototype.multiplyUpperTo = bnpMultiplyUpperTo;
BigInteger.prototype.modInt = bnpModInt;
BigInteger.prototype.millerRabin = bnpMillerRabin;

// public
BigInteger.prototype.clone = bnClone;
BigInteger.prototype.intValue = bnIntValue;
BigInteger.prototype.byteValue = bnByteValue;
BigInteger.prototype.shortValue = bnShortValue;
BigInteger.prototype.signum = bnSigNum;
BigInteger.prototype.toByteArray = bnToByteArray;
BigInteger.prototype.equals = bnEquals;
BigInteger.prototype.min = bnMin;
BigInteger.prototype.max = bnMax;
BigInteger.prototype.and = bnAnd;
BigInteger.prototype.or = bnOr;
BigInteger.prototype.xor = bnXor;
BigInteger.prototype.andNot = bnAndNot;
BigInteger.prototype.not = bnNot;
BigInteger.prototype.shiftLeft = bnShiftLeft;
BigInteger.prototype.shiftRight = bnShiftRight;
BigInteger.prototype.getLowestSetBit = bnGetLowestSetBit;
BigInteger.prototype.bitCount = bnBitCount;
BigInteger.prototype.testBit = bnTestBit;
BigInteger.prototype.setBit = bnSetBit;
BigInteger.prototype.clearBit = bnClearBit;
BigInteger.prototype.flipBit = bnFlipBit;
BigInteger.prototype.add = bnAdd;
BigInteger.prototype.subtract = bnSubtract;
BigInteger.prototype.multiply = bnMultiply;
BigInteger.prototype.divide = bnDivide;
BigInteger.prototype.remainder = bnRemainder;
BigInteger.prototype.divideAndRemainder = bnDivideAndRemainder;
BigInteger.prototype.modPow = bnModPow;
BigInteger.prototype.modInverse = bnModInverse;
BigInteger.prototype.pow = bnPow;
BigInteger.prototype.gcd = bnGCD;
BigInteger.prototype.isProbablePrime = bnIsProbablePrime;

// JSBN-specific extension
BigInteger.prototype.square = bnSquare;

// BigInteger interfaces not implemented in jsbn:

// BigInteger(int signum, byte[] magnitude)
// double doubleValue()
// float floatValue()
// int hashCode()
// long longValue()
// static BigInteger valueOf(long val)


/* harmony default export */ __webpack_exports__["a"] = (BigInteger);

/***/ }),
/* 302 */
/***/ (function(module, exports, __webpack_require__) {
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.



var punycode = __webpack_require__(303);
var util = __webpack_require__(305);

exports.parse = urlParse;
exports.resolve = urlResolve;
exports.resolveObject = urlResolveObject;
exports.format = urlFormat;

exports.Url = Url;

function Url() {
  this.protocol = null;
  this.slashes = null;
  this.auth = null;
  this.host = null;
  this.port = null;
  this.hostname = null;
  this.hash = null;
  this.search = null;
  this.query = null;
  this.pathname = null;
  this.path = null;
  this.href = null;
}

// Reference: RFC 3986, RFC 1808, RFC 2396

// define these here so at least they only have to be
// compiled once on the first module load.
var protocolPattern = /^([a-z0-9.+-]+:)/i,
    portPattern = /:[0-9]*$/,

    // Special case for a simple path URL
    simplePathPattern = /^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,

    // RFC 2396: characters reserved for delimiting URLs.
    // We actually just auto-escape these.
    delims = ['<', '>', '"', '`', ' ', '\r', '\n', '\t'],

    // RFC 2396: characters not allowed for various reasons.
    unwise = ['{', '}', '|', '\\', '^', '`'].concat(delims),

    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.
    autoEscape = ['\''].concat(unwise),
    // Characters that are never ever allowed in a hostname.
    // Note that any invalid chars are also handled, but these
    // are the ones that are *expected* to be seen, so we fast-path
    // them.
    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),
    hostEndingChars = ['/', '?', '#'],
    hostnameMaxLen = 255,
    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,
    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,
    // protocols that can allow "unsafe" and "unwise" chars.
    unsafeProtocol = {
      'javascript': true,
      'javascript:': true
    },
    // protocols that never have a hostname.
    hostlessProtocol = {
      'javascript': true,
      'javascript:': true
    },
    // protocols that always contain a // bit.
    slashedProtocol = {
      'http': true,
      'https': true,
      'ftp': true,
      'gopher': true,
      'file': true,
      'http:': true,
      'https:': true,
      'ftp:': true,
      'gopher:': true,
      'file:': true
    },
    querystring = __webpack_require__(306);

function urlParse(url, parseQueryString, slashesDenoteHost) {
  if (url && util.isObject(url) && url instanceof Url) return url;

  var u = new Url;
  u.parse(url, parseQueryString, slashesDenoteHost);
  return u;
}

Url.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {
  if (!util.isString(url)) {
    throw new TypeError("Parameter 'url' must be a string, not " + typeof url);
  }

  // Copy chrome, IE, opera backslash-handling behavior.
  // Back slashes before the query string get converted to forward slashes
  // See: https://code.google.com/p/chromium/issues/detail?id=25916
  var queryIndex = url.indexOf('?'),
      splitter =
          (queryIndex !== -1 && queryIndex < url.indexOf('#')) ? '?' : '#',
      uSplit = url.split(splitter),
      slashRegex = /\\/g;
  uSplit[0] = uSplit[0].replace(slashRegex, '/');
  url = uSplit.join(splitter);

  var rest = url;

  // trim before proceeding.
  // This is to support parse stuff like "  http://foo.com  \n"
  rest = rest.trim();

  if (!slashesDenoteHost && url.split('#').length === 1) {
    // Try fast path regexp
    var simplePath = simplePathPattern.exec(rest);
    if (simplePath) {
      this.path = rest;
      this.href = rest;
      this.pathname = simplePath[1];
      if (simplePath[2]) {
        this.search = simplePath[2];
        if (parseQueryString) {
          this.query = querystring.parse(this.search.substr(1));
        } else {
          this.query = this.search.substr(1);
        }
      } else if (parseQueryString) {
        this.search = '';
        this.query = {};
      }
      return this;
    }
  }

  var proto = protocolPattern.exec(rest);
  if (proto) {
    proto = proto[0];
    var lowerProto = proto.toLowerCase();
    this.protocol = lowerProto;
    rest = rest.substr(proto.length);
  }

  // figure out if it's got a host
  // user@server is *always* interpreted as a hostname, and url
  // resolution will treat //foo/bar as host=foo,path=bar because that's
  // how the browser resolves relative URLs.
  if (slashesDenoteHost || proto || rest.match(/^\/\/[^@\/]+@[^@\/]+/)) {
    var slashes = rest.substr(0, 2) === '//';
    if (slashes && !(proto && hostlessProtocol[proto])) {
      rest = rest.substr(2);
      this.slashes = true;
    }
  }

  if (!hostlessProtocol[proto] &&
      (slashes || (proto && !slashedProtocol[proto]))) {

    // there's a hostname.
    // the first instance of /, ?, ;, or # ends the host.
    //
    // If there is an @ in the hostname, then non-host chars *are* allowed
    // to the left of the last @ sign, unless some host-ending character
    // comes *before* the @-sign.
    // URLs are obnoxious.
    //
    // ex:
    // http://a@b@c/ => user:a@b host:c
    // http://a@b?@c => user:a host:c path:/?@c

    // v0.12 TODO(isaacs): This is not quite how Chrome does things.
    // Review our test case against browsers more comprehensively.

    // find the first instance of any hostEndingChars
    var hostEnd = -1;
    for (var i = 0; i < hostEndingChars.length; i++) {
      var hec = rest.indexOf(hostEndingChars[i]);
      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))
        hostEnd = hec;
    }

    // at this point, either we have an explicit point where the
    // auth portion cannot go past, or the last @ char is the decider.
    var auth, atSign;
    if (hostEnd === -1) {
      // atSign can be anywhere.
      atSign = rest.lastIndexOf('@');
    } else {
      // atSign must be in auth portion.
      // http://a@b/c@d => host:b auth:a path:/c@d
      atSign = rest.lastIndexOf('@', hostEnd);
    }

    // Now we have a portion which is definitely the auth.
    // Pull that off.
    if (atSign !== -1) {
      auth = rest.slice(0, atSign);
      rest = rest.slice(atSign + 1);
      this.auth = decodeURIComponent(auth);
    }

    // the host is the remaining to the left of the first non-host char
    hostEnd = -1;
    for (var i = 0; i < nonHostChars.length; i++) {
      var hec = rest.indexOf(nonHostChars[i]);
      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))
        hostEnd = hec;
    }
    // if we still have not hit it, then the entire thing is a host.
    if (hostEnd === -1)
      hostEnd = rest.length;

    this.host = rest.slice(0, hostEnd);
    rest = rest.slice(hostEnd);

    // pull out port.
    this.parseHost();

    // we've indicated that there is a hostname,
    // so even if it's empty, it has to be present.
    this.hostname = this.hostname || '';

    // if hostname begins with [ and ends with ]
    // assume that it's an IPv6 address.
    var ipv6Hostname = this.hostname[0] === '[' &&
        this.hostname[this.hostname.length - 1] === ']';

    // validate a little.
    if (!ipv6Hostname) {
      var hostparts = this.hostname.split(/\./);
      for (var i = 0, l = hostparts.length; i < l; i++) {
        var part = hostparts[i];
        if (!part) continue;
        if (!part.match(hostnamePartPattern)) {
          var newpart = '';
          for (var j = 0, k = part.length; j < k; j++) {
            if (part.charCodeAt(j) > 127) {
              // we replace non-ASCII char with a temporary placeholder
              // we need this to make sure size of hostname is not
              // broken by replacing non-ASCII by nothing
              newpart += 'x';
            } else {
              newpart += part[j];
            }
          }
          // we test again with ASCII char only
          if (!newpart.match(hostnamePartPattern)) {
            var validParts = hostparts.slice(0, i);
            var notHost = hostparts.slice(i + 1);
            var bit = part.match(hostnamePartStart);
            if (bit) {
              validParts.push(bit[1]);
              notHost.unshift(bit[2]);
            }
            if (notHost.length) {
              rest = '/' + notHost.join('.') + rest;
            }
            this.hostname = validParts.join('.');
            break;
          }
        }
      }
    }

    if (this.hostname.length > hostnameMaxLen) {
      this.hostname = '';
    } else {
      // hostnames are always lower case.
      this.hostname = this.hostname.toLowerCase();
    }

    if (!ipv6Hostname) {
      // IDNA Support: Returns a punycoded representation of "domain".
      // It only converts parts of the domain name that
      // have non-ASCII characters, i.e. it doesn't matter if
      // you call it with a domain that already is ASCII-only.
      this.hostname = punycode.toASCII(this.hostname);
    }

    var p = this.port ? ':' + this.port : '';
    var h = this.hostname || '';
    this.host = h + p;
    this.href += this.host;

    // strip [ and ] from the hostname
    // the host field still retains them, though
    if (ipv6Hostname) {
      this.hostname = this.hostname.substr(1, this.hostname.length - 2);
      if (rest[0] !== '/') {
        rest = '/' + rest;
      }
    }
  }

  // now rest is set to the post-host stuff.
  // chop off any delim chars.
  if (!unsafeProtocol[lowerProto]) {

    // First, make 100% sure that any "autoEscape" chars get
    // escaped, even if encodeURIComponent doesn't think they
    // need to be.
    for (var i = 0, l = autoEscape.length; i < l; i++) {
      var ae = autoEscape[i];
      if (rest.indexOf(ae) === -1)
        continue;
      var esc = encodeURIComponent(ae);
      if (esc === ae) {
        esc = escape(ae);
      }
      rest = rest.split(ae).join(esc);
    }
  }


  // chop off from the tail first.
  var hash = rest.indexOf('#');
  if (hash !== -1) {
    // got a fragment string.
    this.hash = rest.substr(hash);
    rest = rest.slice(0, hash);
  }
  var qm = rest.indexOf('?');
  if (qm !== -1) {
    this.search = rest.substr(qm);
    this.query = rest.substr(qm + 1);
    if (parseQueryString) {
      this.query = querystring.parse(this.query);
    }
    rest = rest.slice(0, qm);
  } else if (parseQueryString) {
    // no query string, but parseQueryString still requested
    this.search = '';
    this.query = {};
  }
  if (rest) this.pathname = rest;
  if (slashedProtocol[lowerProto] &&
      this.hostname && !this.pathname) {
    this.pathname = '/';
  }

  //to support http.request
  if (this.pathname || this.search) {
    var p = this.pathname || '';
    var s = this.search || '';
    this.path = p + s;
  }

  // finally, reconstruct the href based on what has been validated.
  this.href = this.format();
  return this;
};

// format a parsed object into a url string
function urlFormat(obj) {
  // ensure it's an object, and not a string url.
  // If it's an obj, this is a no-op.
  // this way, you can call url_format() on strings
  // to clean up potentially wonky urls.
  if (util.isString(obj)) obj = urlParse(obj);
  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);
  return obj.format();
}

Url.prototype.format = function() {
  var auth = this.auth || '';
  if (auth) {
    auth = encodeURIComponent(auth);
    auth = auth.replace(/%3A/i, ':');
    auth += '@';
  }

  var protocol = this.protocol || '',
      pathname = this.pathname || '',
      hash = this.hash || '',
      host = false,
      query = '';

  if (this.host) {
    host = auth + this.host;
  } else if (this.hostname) {
    host = auth + (this.hostname.indexOf(':') === -1 ?
        this.hostname :
        '[' + this.hostname + ']');
    if (this.port) {
      host += ':' + this.port;
    }
  }

  if (this.query &&
      util.isObject(this.query) &&
      Object.keys(this.query).length) {
    query = querystring.stringify(this.query);
  }

  var search = this.search || (query && ('?' + query)) || '';

  if (protocol && protocol.substr(-1) !== ':') protocol += ':';

  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.
  // unless they had them to begin with.
  if (this.slashes ||
      (!protocol || slashedProtocol[protocol]) && host !== false) {
    host = '//' + (host || '');
    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;
  } else if (!host) {
    host = '';
  }

  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;
  if (search && search.charAt(0) !== '?') search = '?' + search;

  pathname = pathname.replace(/[?#]/g, function(match) {
    return encodeURIComponent(match);
  });
  search = search.replace('#', '%23');

  return protocol + host + pathname + search + hash;
};

function urlResolve(source, relative) {
  return urlParse(source, false, true).resolve(relative);
}

Url.prototype.resolve = function(relative) {
  return this.resolveObject(urlParse(relative, false, true)).format();
};

function urlResolveObject(source, relative) {
  if (!source) return relative;
  return urlParse(source, false, true).resolveObject(relative);
}

Url.prototype.resolveObject = function(relative) {
  if (util.isString(relative)) {
    var rel = new Url();
    rel.parse(relative, false, true);
    relative = rel;
  }

  var result = new Url();
  var tkeys = Object.keys(this);
  for (var tk = 0; tk < tkeys.length; tk++) {
    var tkey = tkeys[tk];
    result[tkey] = this[tkey];
  }

  // hash is always overridden, no matter what.
  // even href="" will remove it.
  result.hash = relative.hash;

  // if the relative url is empty, then there's nothing left to do here.
  if (relative.href === '') {
    result.href = result.format();
    return result;
  }

  // hrefs like //foo/bar always cut to the protocol.
  if (relative.slashes && !relative.protocol) {
    // take everything except the protocol from relative
    var rkeys = Object.keys(relative);
    for (var rk = 0; rk < rkeys.length; rk++) {
      var rkey = rkeys[rk];
      if (rkey !== 'protocol')
        result[rkey] = relative[rkey];
    }

    //urlParse appends trailing / to urls like http://www.example.com
    if (slashedProtocol[result.protocol] &&
        result.hostname && !result.pathname) {
      result.path = result.pathname = '/';
    }

    result.href = result.format();
    return result;
  }

  if (relative.protocol && relative.protocol !== result.protocol) {
    // if it's a known url protocol, then changing
    // the protocol does weird things
    // first, if it's not file:, then we MUST have a host,
    // and if there was a path
    // to begin with, then we MUST have a path.
    // if it is file:, then the host is dropped,
    // because that's known to be hostless.
    // anything else is assumed to be absolute.
    if (!slashedProtocol[relative.protocol]) {
      var keys = Object.keys(relative);
      for (var v = 0; v < keys.length; v++) {
        var k = keys[v];
        result[k] = relative[k];
      }
      result.href = result.format();
      return result;
    }

    result.protocol = relative.protocol;
    if (!relative.host && !hostlessProtocol[relative.protocol]) {
      var relPath = (relative.pathname || '').split('/');
      while (relPath.length && !(relative.host = relPath.shift()));
      if (!relative.host) relative.host = '';
      if (!relative.hostname) relative.hostname = '';
      if (relPath[0] !== '') relPath.unshift('');
      if (relPath.length < 2) relPath.unshift('');
      result.pathname = relPath.join('/');
    } else {
      result.pathname = relative.pathname;
    }
    result.search = relative.search;
    result.query = relative.query;
    result.host = relative.host || '';
    result.auth = relative.auth;
    result.hostname = relative.hostname || relative.host;
    result.port = relative.port;
    // to support http.request
    if (result.pathname || result.search) {
      var p = result.pathname || '';
      var s = result.search || '';
      result.path = p + s;
    }
    result.slashes = result.slashes || relative.slashes;
    result.href = result.format();
    return result;
  }

  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),
      isRelAbs = (
          relative.host ||
          relative.pathname && relative.pathname.charAt(0) === '/'
      ),
      mustEndAbs = (isRelAbs || isSourceAbs ||
                    (result.host && relative.pathname)),
      removeAllDots = mustEndAbs,
      srcPath = result.pathname && result.pathname.split('/') || [],
      relPath = relative.pathname && relative.pathname.split('/') || [],
      psychotic = result.protocol && !slashedProtocol[result.protocol];

  // if the url is a non-slashed url, then relative
  // links like ../.. should be able
  // to crawl up to the hostname, as well.  This is strange.
  // result.protocol has already been set by now.
  // Later on, put the first path part into the host field.
  if (psychotic) {
    result.hostname = '';
    result.port = null;
    if (result.host) {
      if (srcPath[0] === '') srcPath[0] = result.host;
      else srcPath.unshift(result.host);
    }
    result.host = '';
    if (relative.protocol) {
      relative.hostname = null;
      relative.port = null;
      if (relative.host) {
        if (relPath[0] === '') relPath[0] = relative.host;
        else relPath.unshift(relative.host);
      }
      relative.host = null;
    }
    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');
  }

  if (isRelAbs) {
    // it's absolute.
    result.host = (relative.host || relative.host === '') ?
                  relative.host : result.host;
    result.hostname = (relative.hostname || relative.hostname === '') ?
                      relative.hostname : result.hostname;
    result.search = relative.search;
    result.query = relative.query;
    srcPath = relPath;
    // fall through to the dot-handling below.
  } else if (relPath.length) {
    // it's relative
    // throw away the existing file, and take the new path instead.
    if (!srcPath) srcPath = [];
    srcPath.pop();
    srcPath = srcPath.concat(relPath);
    result.search = relative.search;
    result.query = relative.query;
  } else if (!util.isNullOrUndefined(relative.search)) {
    // just pull out the search.
    // like href='?foo'.
    // Put this after the other two cases because it simplifies the booleans
    if (psychotic) {
      result.hostname = result.host = srcPath.shift();
      //occationaly the auth can get stuck only in host
      //this especially happens in cases like
      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')
      var authInHost = result.host && result.host.indexOf('@') > 0 ?
                       result.host.split('@') : false;
      if (authInHost) {
        result.auth = authInHost.shift();
        result.host = result.hostname = authInHost.shift();
      }
    }
    result.search = relative.search;
    result.query = relative.query;
    //to support http.request
    if (!util.isNull(result.pathname) || !util.isNull(result.search)) {
      result.path = (result.pathname ? result.pathname : '') +
                    (result.search ? result.search : '');
    }
    result.href = result.format();
    return result;
  }

  if (!srcPath.length) {
    // no path at all.  easy.
    // we've already handled the other stuff above.
    result.pathname = null;
    //to support http.request
    if (result.search) {
      result.path = '/' + result.search;
    } else {
      result.path = null;
    }
    result.href = result.format();
    return result;
  }

  // if a url ENDs in . or .., then it must get a trailing slash.
  // however, if it ends in anything else non-slashy,
  // then it must NOT get a trailing slash.
  var last = srcPath.slice(-1)[0];
  var hasTrailingSlash = (
      (result.host || relative.host || srcPath.length > 1) &&
      (last === '.' || last === '..') || last === '');

  // strip single dots, resolve double dots to parent dir
  // if the path tries to go above the root, `up` ends up > 0
  var up = 0;
  for (var i = srcPath.length; i >= 0; i--) {
    last = srcPath[i];
    if (last === '.') {
      srcPath.splice(i, 1);
    } else if (last === '..') {
      srcPath.splice(i, 1);
      up++;
    } else if (up) {
      srcPath.splice(i, 1);
      up--;
    }
  }

  // if the path is allowed to go above the root, restore leading ..s
  if (!mustEndAbs && !removeAllDots) {
    for (; up--; up) {
      srcPath.unshift('..');
    }
  }

  if (mustEndAbs && srcPath[0] !== '' &&
      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {
    srcPath.unshift('');
  }

  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {
    srcPath.push('');
  }

  var isAbsolute = srcPath[0] === '' ||
      (srcPath[0] && srcPath[0].charAt(0) === '/');

  // put the host back
  if (psychotic) {
    result.hostname = result.host = isAbsolute ? '' :
                                    srcPath.length ? srcPath.shift() : '';
    //occationaly the auth can get stuck only in host
    //this especially happens in cases like
    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')
    var authInHost = result.host && result.host.indexOf('@') > 0 ?
                     result.host.split('@') : false;
    if (authInHost) {
      result.auth = authInHost.shift();
      result.host = result.hostname = authInHost.shift();
    }
  }

  mustEndAbs = mustEndAbs || (result.host && srcPath.length);

  if (mustEndAbs && !isAbsolute) {
    srcPath.unshift('');
  }

  if (!srcPath.length) {
    result.pathname = null;
    result.path = null;
  } else {
    result.pathname = srcPath.join('/');
  }

  //to support request.http
  if (!util.isNull(result.pathname) || !util.isNull(result.search)) {
    result.path = (result.pathname ? result.pathname : '') +
                  (result.search ? result.search : '');
  }
  result.auth = relative.auth || result.auth;
  result.slashes = result.slashes || relative.slashes;
  result.href = result.format();
  return result;
};

Url.prototype.parseHost = function() {
  var host = this.host;
  var port = portPattern.exec(host);
  if (port) {
    port = port[0];
    if (port !== ':') {
      this.port = port.substr(1);
    }
    host = host.substr(0, host.length - port.length);
  }
  if (host) this.hostname = host;
};


/***/ }),
/* 303 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(module, global) {var __WEBPACK_AMD_DEFINE_RESULT__;/*! https://mths.be/punycode v1.4.1 by @mathias */
(function(root) {

	/** Detect free variables */
	var freeExports = typeof exports == 'object' && exports &&
		!exports.nodeType && exports;
	var freeModule = typeof module == 'object' && module &&
		!module.nodeType && module;
	var freeGlobal = typeof global == 'object' && global;
	if (
		freeGlobal.global === freeGlobal ||
		freeGlobal.window === freeGlobal ||
		freeGlobal.self === freeGlobal
	) ;

	/**
	 * The `punycode` object.
	 * @name punycode
	 * @type Object
	 */
	var punycode,

	/** Highest positive signed 32-bit float value */
	maxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1

	/** Bootstring parameters */
	base = 36,
	tMin = 1,
	tMax = 26,
	skew = 38,
	damp = 700,
	initialBias = 72,
	initialN = 128, // 0x80
	delimiter = '-', // '\x2D'

	/** Regular expressions */
	regexPunycode = /^xn--/,
	regexNonASCII = /[^\x20-\x7E]/, // unprintable ASCII chars + non-ASCII chars
	regexSeparators = /[\x2E\u3002\uFF0E\uFF61]/g, // RFC 3490 separators

	/** Error messages */
	errors = {
		'overflow': 'Overflow: input needs wider integers to process',
		'not-basic': 'Illegal input >= 0x80 (not a basic code point)',
		'invalid-input': 'Invalid input'
	},

	/** Convenience shortcuts */
	baseMinusTMin = base - tMin,
	floor = Math.floor,
	stringFromCharCode = String.fromCharCode;

	/*--------------------------------------------------------------------------*/

	/**
	 * A generic error utility function.
	 * @private
	 * @param {String} type The error type.
	 * @returns {Error} Throws a `RangeError` with the applicable error message.
	 */
	function error(type) {
		throw new RangeError(errors[type]);
	}

	/**
	 * A generic `Array#map` utility function.
	 * @private
	 * @param {Array} array The array to iterate over.
	 * @param {Function} callback The function that gets called for every array
	 * item.
	 * @returns {Array} A new array of values returned by the callback function.
	 */
	function map(array, fn) {
		var length = array.length;
		var result = [];
		while (length--) {
			result[length] = fn(array[length]);
		}
		return result;
	}

	/**
	 * A simple `Array#map`-like wrapper to work with domain name strings or email
	 * addresses.
	 * @private
	 * @param {String} domain The domain name or email address.
	 * @param {Function} callback The function that gets called for every
	 * character.
	 * @returns {Array} A new string of characters returned by the callback
	 * function.
	 */
	function mapDomain(string, fn) {
		var parts = string.split('@');
		var result = '';
		if (parts.length > 1) {
			// In email addresses, only the domain name should be punycoded. Leave
			// the local part (i.e. everything up to `@`) intact.
			result = parts[0] + '@';
			string = parts[1];
		}
		// Avoid `split(regex)` for IE8 compatibility. See #17.
		string = string.replace(regexSeparators, '\x2E');
		var labels = string.split('.');
		var encoded = map(labels, fn).join('.');
		return result + encoded;
	}

	/**
	 * Creates an array containing the numeric code points of each Unicode
	 * character in the string. While JavaScript uses UCS-2 internally,
	 * this function will convert a pair of surrogate halves (each of which
	 * UCS-2 exposes as separate characters) into a single code point,
	 * matching UTF-16.
	 * @see `punycode.ucs2.encode`
	 * @see <https://mathiasbynens.be/notes/javascript-encoding>
	 * @memberOf punycode.ucs2
	 * @name decode
	 * @param {String} string The Unicode input string (UCS-2).
	 * @returns {Array} The new array of code points.
	 */
	function ucs2decode(string) {
		var output = [],
		    counter = 0,
		    length = string.length,
		    value,
		    extra;
		while (counter < length) {
			value = string.charCodeAt(counter++);
			if (value >= 0xD800 && value <= 0xDBFF && counter < length) {
				// high surrogate, and there is a next character
				extra = string.charCodeAt(counter++);
				if ((extra & 0xFC00) == 0xDC00) { // low surrogate
					output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);
				} else {
					// unmatched surrogate; only append this code unit, in case the next
					// code unit is the high surrogate of a surrogate pair
					output.push(value);
					counter--;
				}
			} else {
				output.push(value);
			}
		}
		return output;
	}

	/**
	 * Creates a string based on an array of numeric code points.
	 * @see `punycode.ucs2.decode`
	 * @memberOf punycode.ucs2
	 * @name encode
	 * @param {Array} codePoints The array of numeric code points.
	 * @returns {String} The new Unicode string (UCS-2).
	 */
	function ucs2encode(array) {
		return map(array, function(value) {
			var output = '';
			if (value > 0xFFFF) {
				value -= 0x10000;
				output += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);
				value = 0xDC00 | value & 0x3FF;
			}
			output += stringFromCharCode(value);
			return output;
		}).join('');
	}

	/**
	 * Converts a basic code point into a digit/integer.
	 * @see `digitToBasic()`
	 * @private
	 * @param {Number} codePoint The basic numeric code point value.
	 * @returns {Number} The numeric value of a basic code point (for use in
	 * representing integers) in the range `0` to `base - 1`, or `base` if
	 * the code point does not represent a value.
	 */
	function basicToDigit(codePoint) {
		if (codePoint - 48 < 10) {
			return codePoint - 22;
		}
		if (codePoint - 65 < 26) {
			return codePoint - 65;
		}
		if (codePoint - 97 < 26) {
			return codePoint - 97;
		}
		return base;
	}

	/**
	 * Converts a digit/integer into a basic code point.
	 * @see `basicToDigit()`
	 * @private
	 * @param {Number} digit The numeric value of a basic code point.
	 * @returns {Number} The basic code point whose value (when used for
	 * representing integers) is `digit`, which needs to be in the range
	 * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is
	 * used; else, the lowercase form is used. The behavior is undefined
	 * if `flag` is non-zero and `digit` has no uppercase form.
	 */
	function digitToBasic(digit, flag) {
		//  0..25 map to ASCII a..z or A..Z
		// 26..35 map to ASCII 0..9
		return digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);
	}

	/**
	 * Bias adaptation function as per section 3.4 of RFC 3492.
	 * https://tools.ietf.org/html/rfc3492#section-3.4
	 * @private
	 */
	function adapt(delta, numPoints, firstTime) {
		var k = 0;
		delta = firstTime ? floor(delta / damp) : delta >> 1;
		delta += floor(delta / numPoints);
		for (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {
			delta = floor(delta / baseMinusTMin);
		}
		return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));
	}

	/**
	 * Converts a Punycode string of ASCII-only symbols to a string of Unicode
	 * symbols.
	 * @memberOf punycode
	 * @param {String} input The Punycode string of ASCII-only symbols.
	 * @returns {String} The resulting string of Unicode symbols.
	 */
	function decode(input) {
		// Don't use UCS-2
		var output = [],
		    inputLength = input.length,
		    out,
		    i = 0,
		    n = initialN,
		    bias = initialBias,
		    basic,
		    j,
		    index,
		    oldi,
		    w,
		    k,
		    digit,
		    t,
		    /** Cached calculation results */
		    baseMinusT;

		// Handle the basic code points: let `basic` be the number of input code
		// points before the last delimiter, or `0` if there is none, then copy
		// the first basic code points to the output.

		basic = input.lastIndexOf(delimiter);
		if (basic < 0) {
			basic = 0;
		}

		for (j = 0; j < basic; ++j) {
			// if it's not a basic code point
			if (input.charCodeAt(j) >= 0x80) {
				error('not-basic');
			}
			output.push(input.charCodeAt(j));
		}

		// Main decoding loop: start just after the last delimiter if any basic code
		// points were copied; start at the beginning otherwise.

		for (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {

			// `index` is the index of the next character to be consumed.
			// Decode a generalized variable-length integer into `delta`,
			// which gets added to `i`. The overflow checking is easier
			// if we increase `i` as we go, then subtract off its starting
			// value at the end to obtain `delta`.
			for (oldi = i, w = 1, k = base; /* no condition */; k += base) {

				if (index >= inputLength) {
					error('invalid-input');
				}

				digit = basicToDigit(input.charCodeAt(index++));

				if (digit >= base || digit > floor((maxInt - i) / w)) {
					error('overflow');
				}

				i += digit * w;
				t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);

				if (digit < t) {
					break;
				}

				baseMinusT = base - t;
				if (w > floor(maxInt / baseMinusT)) {
					error('overflow');
				}

				w *= baseMinusT;

			}

			out = output.length + 1;
			bias = adapt(i - oldi, out, oldi == 0);

			// `i` was supposed to wrap around from `out` to `0`,
			// incrementing `n` each time, so we'll fix that now:
			if (floor(i / out) > maxInt - n) {
				error('overflow');
			}

			n += floor(i / out);
			i %= out;

			// Insert `n` at position `i` of the output
			output.splice(i++, 0, n);

		}

		return ucs2encode(output);
	}

	/**
	 * Converts a string of Unicode symbols (e.g. a domain name label) to a
	 * Punycode string of ASCII-only symbols.
	 * @memberOf punycode
	 * @param {String} input The string of Unicode symbols.
	 * @returns {String} The resulting Punycode string of ASCII-only symbols.
	 */
	function encode(input) {
		var n,
		    delta,
		    handledCPCount,
		    basicLength,
		    bias,
		    j,
		    m,
		    q,
		    k,
		    t,
		    currentValue,
		    output = [],
		    /** `inputLength` will hold the number of code points in `input`. */
		    inputLength,
		    /** Cached calculation results */
		    handledCPCountPlusOne,
		    baseMinusT,
		    qMinusT;

		// Convert the input in UCS-2 to Unicode
		input = ucs2decode(input);

		// Cache the length
		inputLength = input.length;

		// Initialize the state
		n = initialN;
		delta = 0;
		bias = initialBias;

		// Handle the basic code points
		for (j = 0; j < inputLength; ++j) {
			currentValue = input[j];
			if (currentValue < 0x80) {
				output.push(stringFromCharCode(currentValue));
			}
		}

		handledCPCount = basicLength = output.length;

		// `handledCPCount` is the number of code points that have been handled;
		// `basicLength` is the number of basic code points.

		// Finish the basic string - if it is not empty - with a delimiter
		if (basicLength) {
			output.push(delimiter);
		}

		// Main encoding loop:
		while (handledCPCount < inputLength) {

			// All non-basic code points < n have been handled already. Find the next
			// larger one:
			for (m = maxInt, j = 0; j < inputLength; ++j) {
				currentValue = input[j];
				if (currentValue >= n && currentValue < m) {
					m = currentValue;
				}
			}

			// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,
			// but guard against overflow
			handledCPCountPlusOne = handledCPCount + 1;
			if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {
				error('overflow');
			}

			delta += (m - n) * handledCPCountPlusOne;
			n = m;

			for (j = 0; j < inputLength; ++j) {
				currentValue = input[j];

				if (currentValue < n && ++delta > maxInt) {
					error('overflow');
				}

				if (currentValue == n) {
					// Represent delta as a generalized variable-length integer
					for (q = delta, k = base; /* no condition */; k += base) {
						t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);
						if (q < t) {
							break;
						}
						qMinusT = q - t;
						baseMinusT = base - t;
						output.push(
							stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))
						);
						q = floor(qMinusT / baseMinusT);
					}

					output.push(stringFromCharCode(digitToBasic(q, 0)));
					bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);
					delta = 0;
					++handledCPCount;
				}
			}

			++delta;
			++n;

		}
		return output.join('');
	}

	/**
	 * Converts a Punycode string representing a domain name or an email address
	 * to Unicode. Only the Punycoded parts of the input will be converted, i.e.
	 * it doesn't matter if you call it on a string that has already been
	 * converted to Unicode.
	 * @memberOf punycode
	 * @param {String} input The Punycoded domain name or email address to
	 * convert to Unicode.
	 * @returns {String} The Unicode representation of the given Punycode
	 * string.
	 */
	function toUnicode(input) {
		return mapDomain(input, function(string) {
			return regexPunycode.test(string)
				? decode(string.slice(4).toLowerCase())
				: string;
		});
	}

	/**
	 * Converts a Unicode string representing a domain name or an email address to
	 * Punycode. Only the non-ASCII parts of the domain name will be converted,
	 * i.e. it doesn't matter if you call it with a domain that's already in
	 * ASCII.
	 * @memberOf punycode
	 * @param {String} input The domain name or email address to convert, as a
	 * Unicode string.
	 * @returns {String} The Punycode representation of the given domain name or
	 * email address.
	 */
	function toASCII(input) {
		return mapDomain(input, function(string) {
			return regexNonASCII.test(string)
				? 'xn--' + encode(string)
				: string;
		});
	}

	/*--------------------------------------------------------------------------*/

	/** Define the public API */
	punycode = {
		/**
		 * A string representing the current Punycode.js version number.
		 * @memberOf punycode
		 * @type String
		 */
		'version': '1.4.1',
		/**
		 * An object of methods to convert from JavaScript's internal character
		 * representation (UCS-2) to Unicode code points, and back.
		 * @see <https://mathiasbynens.be/notes/javascript-encoding>
		 * @memberOf punycode
		 * @type Object
		 */
		'ucs2': {
			'decode': ucs2decode,
			'encode': ucs2encode
		},
		'decode': decode,
		'encode': encode,
		'toASCII': toASCII,
		'toUnicode': toUnicode
	};

	/** Expose `punycode` */
	// Some AMD build optimizers, like r.js, check for specific condition patterns
	// like the following:
	{
		!(__WEBPACK_AMD_DEFINE_RESULT__ = (function() {
			return punycode;
		}).call(exports, __webpack_require__, exports, module),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	}

}());

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(304)(module), __webpack_require__(64)));

/***/ }),
/* 304 */
/***/ (function(module, exports) {

module.exports = function(module) {
	if(!module.webpackPolyfill) {
		module.deprecate = function() {};
		module.paths = [];
		// module.parent = undefined by default
		if(!module.children) module.children = [];
		Object.defineProperty(module, "loaded", {
			enumerable: true,
			get: function() {
				return module.l;
			}
		});
		Object.defineProperty(module, "id", {
			enumerable: true,
			get: function() {
				return module.i;
			}
		});
		module.webpackPolyfill = 1;
	}
	return module;
};


/***/ }),
/* 305 */
/***/ (function(module, exports, __webpack_require__) {


module.exports = {
  isString: function(arg) {
    return typeof(arg) === 'string';
  },
  isObject: function(arg) {
    return typeof(arg) === 'object' && arg !== null;
  },
  isNull: function(arg) {
    return arg === null;
  },
  isNullOrUndefined: function(arg) {
    return arg == null;
  }
};


/***/ }),
/* 306 */
/***/ (function(module, exports, __webpack_require__) {


exports.decode = exports.parse = __webpack_require__(307);
exports.encode = exports.stringify = __webpack_require__(308);


/***/ }),
/* 307 */
/***/ (function(module, exports, __webpack_require__) {
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.



// If obj.hasOwnProperty has been overridden, then calling
// obj.hasOwnProperty(prop) will break.
// See: https://github.com/joyent/node/issues/1707
function hasOwnProperty(obj, prop) {
  return Object.prototype.hasOwnProperty.call(obj, prop);
}

module.exports = function(qs, sep, eq, options) {
  sep = sep || '&';
  eq = eq || '=';
  var obj = {};

  if (typeof qs !== 'string' || qs.length === 0) {
    return obj;
  }

  var regexp = /\+/g;
  qs = qs.split(sep);

  var maxKeys = 1000;
  if (options && typeof options.maxKeys === 'number') {
    maxKeys = options.maxKeys;
  }

  var len = qs.length;
  // maxKeys <= 0 means that we should not limit keys count
  if (maxKeys > 0 && len > maxKeys) {
    len = maxKeys;
  }

  for (var i = 0; i < len; ++i) {
    var x = qs[i].replace(regexp, '%20'),
        idx = x.indexOf(eq),
        kstr, vstr, k, v;

    if (idx >= 0) {
      kstr = x.substr(0, idx);
      vstr = x.substr(idx + 1);
    } else {
      kstr = x;
      vstr = '';
    }

    k = decodeURIComponent(kstr);
    v = decodeURIComponent(vstr);

    if (!hasOwnProperty(obj, k)) {
      obj[k] = v;
    } else if (isArray(obj[k])) {
      obj[k].push(v);
    } else {
      obj[k] = [obj[k], v];
    }
  }

  return obj;
};

var isArray = Array.isArray || function (xs) {
  return Object.prototype.toString.call(xs) === '[object Array]';
};


/***/ }),
/* 308 */
/***/ (function(module, exports, __webpack_require__) {
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.



var stringifyPrimitive = function(v) {
  switch (typeof v) {
    case 'string':
      return v;

    case 'boolean':
      return v ? 'true' : 'false';

    case 'number':
      return isFinite(v) ? v : '';

    default:
      return '';
  }
};

module.exports = function(obj, sep, eq, name) {
  sep = sep || '&';
  eq = eq || '=';
  if (obj === null) {
    obj = undefined;
  }

  if (typeof obj === 'object') {
    return map(objectKeys(obj), function(k) {
      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;
      if (isArray(obj[k])) {
        return map(obj[k], function(v) {
          return ks + encodeURIComponent(stringifyPrimitive(v));
        }).join(sep);
      } else {
        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));
      }
    }).join(sep);

  }

  if (!name) return '';
  return encodeURIComponent(stringifyPrimitive(name)) + eq +
         encodeURIComponent(stringifyPrimitive(obj));
};

var isArray = Array.isArray || function (xs) {
  return Object.prototype.toString.call(xs) === '[object Array]';
};

function map (xs, f) {
  if (xs.map) return xs.map(f);
  var res = [];
  for (var i = 0; i < xs.length; i++) {
    res.push(f(xs[i], i));
  }
  return res;
}

var objectKeys = Object.keys || function (obj) {
  var res = [];
  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);
  }
  return res;
};


/***/ }),
/* 309 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return sha256; });
/* eslint-disable */
/*!
 *  Secure Hash Algorithm (SHA256)
 *  http://www.webtoolkit.info/
 *
 *  Original code by Angel Marin, Paul Johnston.
 */

function sha256(s) {

  var chrsz = 8;

  function safe_add(x, y) {

    var lsw = (x & 0xFFFF) + (y & 0xFFFF);

    var msw = (x >> 16) + (y >> 16) + (lsw >> 16);

    return msw << 16 | lsw & 0xFFFF;
  }

  function S(X, n) {
    return X >>> n | X << 32 - n;
  }

  function R(X, n) {
    return X >>> n;
  }

  function Ch(x, y, z) {
    return x & y ^ ~x & z;
  }

  function Maj(x, y, z) {
    return x & y ^ x & z ^ y & z;
  }

  function Sigma0256(x) {
    return S(x, 2) ^ S(x, 13) ^ S(x, 22);
  }

  function Sigma1256(x) {
    return S(x, 6) ^ S(x, 11) ^ S(x, 25);
  }

  function Gamma0256(x) {
    return S(x, 7) ^ S(x, 18) ^ R(x, 3);
  }

  function Gamma1256(x) {
    return S(x, 17) ^ S(x, 19) ^ R(x, 10);
  }

  function core_sha256(m, l) {

    var K = new Array(0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5, 0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5, 0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3, 0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174, 0xE49B69C1, 0xEFBE4786, 0xFC19DC6, 0x240CA1CC, 0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA, 0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7, 0xC6E00BF3, 0xD5A79147, 0x6CA6351, 0x14292967, 0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13, 0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85, 0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3, 0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070, 0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5, 0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3, 0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208, 0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2);

    var HASH = new Array(0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19);

    var W = new Array(64);

    var a, b, c, d, e, f, g, h, i, j;

    var T1, T2;

    m[l >> 5] |= 0x80 << 24 - l % 32;

    m[(l + 64 >> 9 << 4) + 15] = l;

    for (var i = 0; i < m.length; i += 16) {

      a = HASH[0];

      b = HASH[1];

      c = HASH[2];

      d = HASH[3];

      e = HASH[4];

      f = HASH[5];

      g = HASH[6];

      h = HASH[7];

      for (var j = 0; j < 64; j++) {

        if (j < 16) W[j] = m[j + i];else W[j] = safe_add(safe_add(safe_add(Gamma1256(W[j - 2]), W[j - 7]), Gamma0256(W[j - 15])), W[j - 16]);

        T1 = safe_add(safe_add(safe_add(safe_add(h, Sigma1256(e)), Ch(e, f, g)), K[j]), W[j]);

        T2 = safe_add(Sigma0256(a), Maj(a, b, c));

        h = g;

        g = f;

        f = e;

        e = safe_add(d, T1);

        d = c;

        c = b;

        b = a;

        a = safe_add(T1, T2);
      }

      HASH[0] = safe_add(a, HASH[0]);

      HASH[1] = safe_add(b, HASH[1]);

      HASH[2] = safe_add(c, HASH[2]);

      HASH[3] = safe_add(d, HASH[3]);

      HASH[4] = safe_add(e, HASH[4]);

      HASH[5] = safe_add(f, HASH[5]);

      HASH[6] = safe_add(g, HASH[6]);

      HASH[7] = safe_add(h, HASH[7]);
    }

    return HASH;
  }

  function str2binb(str) {

    var bin = Array();

    var mask = (1 << chrsz) - 1;

    for (var i = 0; i < str.length * chrsz; i += chrsz) {

      bin[i >> 5] |= (str.charCodeAt(i / chrsz) & mask) << 24 - i % 32;
    }

    return bin;
  }

  function Utf8Encode(string) {

    string = string.replace(/\r\n/g, "\n");

    var utftext = "";

    for (var n = 0; n < string.length; n++) {

      var c = string.charCodeAt(n);

      if (c < 128) {

        utftext += String.fromCharCode(c);
      } else if (c > 127 && c < 2048) {

        utftext += String.fromCharCode(c >> 6 | 192);

        utftext += String.fromCharCode(c & 63 | 128);
      } else {

        utftext += String.fromCharCode(c >> 12 | 224);

        utftext += String.fromCharCode(c >> 6 & 63 | 128);

        utftext += String.fromCharCode(c & 63 | 128);
      }
    }

    return utftext;
  }

  function binb2hex(binarray) {

    var hex_tab =  "0123456789abcdef";

    var str = "";

    for (var i = 0; i < binarray.length * 4; i++) {

      str += hex_tab.charAt(binarray[i >> 2] >> (3 - i % 4) * 8 + 4 & 0xF) + hex_tab.charAt(binarray[i >> 2] >> (3 - i % 4) * 8 & 0xF);
    }

    return str;
  }

  s = Utf8Encode(s);

  return binb2hex(core_sha256(str2binb(s), s.length * chrsz));
}



/***/ }),
/* 310 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* WEBPACK VAR INJECTION */(function(global) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return rAF; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return cAF; });
/*
 * http://paulirish.com/2011/requestanimationframe-for-smart-animating/
 * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
 * requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel
 * MIT license
 * @license
 */

/* eslint-disable standard/no-callback-literal */

var root = typeof window === 'undefined' ? global : window;
var rAF = root.requestAnimationFrame;
var cAF = root.cancelAnimationFrame;

var lastTime = 0;
var vendors = ['ms', 'moz', 'webkit', 'o'];
for (var x = 0; x < vendors.length && !rAF; ++x) {
  rAF = root[vendors[x] + 'RequestAnimationFrame'];
  cAF = root[vendors[x] + 'CancelAnimationFrame'] || root[vendors[x] + 'CancelRequestAnimationFrame'];
}

/* Bind to root is necessary as the context must be valid */
if (rAF) {
  rAF = rAF.bind(root);
}
if (cAF) {
  cAF = cAF.bind(root);
}

/* istanbul ignore next */
if (!rAF) {
  rAF = function rAF(callback, element) {
    var currTime = new Date().getTime();
    var timeToCall = Math.max(0, 16 - (currTime - lastTime));
    var id = setTimeout(function () {
      callback(currTime + timeToCall);
    }, timeToCall);
    lastTime = currTime + timeToCall;
    return id;
  };
}

/* istanbul ignore next */
if (!cAF) {
  cAF = function cAF(id) {
    clearTimeout(id);
  };
}


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(64)));

/***/ }),
/* 311 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Represents a 3-dimensional vector while providing math functions to
 * modify / clone the vector. Fully chainable.
 * @class
 * @memberof PhotoEditorSDK.Math
 */
var Vector3 = function () {
  /**
   * Creates a Vector3
   * @param  {Number} x
   * @param  {Number} y
   * @param  {Number} z
   */
  function Vector3(x, y, z) {
    _classCallCheck(this, Vector3);

    this.x = x;
    this.y = y;
    this.z = z;

    if (typeof this.x === 'undefined') {
      this.x = 0;
    }
    if (typeof this.y === 'undefined') {
      this.y = 0;
    }
    if (typeof this.z === 'undefined') {
      this.z = 0;
    }
  }

  /**
   * Sets the given values
   * @param {Number} x
   * @param {Number} y
   * @param {Number} z
   * @return {PhotoEditorSDK.Math.Vectorz}
   */


  _createClass(Vector3, [{
    key: 'set',
    value: function set(x, y, z) {
      this.x = x;
      this.y = y;
      this.z = z;
      return this;
    }

    /**
     * Creates a clone of this vector
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'clone',
    value: function clone() {
      return new Vector3(this.x, this.y, this.z);
    }

    /**
     * Copies the values of the given vector
     * @param  {PhotoEditorSDK.Math.Vector3} other
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'copy',
    value: function copy(other) {
      this.x = other.x;
      this.y = other.y;
      this.z = other.z;
      return this;
    }

    /**
     * Clamps this vector with the given Vector3 / Number
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} minimum
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} maximum
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'clamp',
    value: function clamp(minimum, maximum) {
      var minimumSet = minimum !== null && typeof minimum !== 'undefined';
      var maximumSet = maximum !== null && typeof maximum !== 'undefined';

      /* istanbul ignore else  */
      if (!(minimum instanceof Vector3) && minimumSet) {
        minimum = new Vector3(minimum, minimum, minimum);
      }
      /* istanbul ignore else  */
      if (!(maximum instanceof Vector3) && maximumSet) {
        maximum = new Vector3(maximum, maximum, maximum);
      }

      if (minimumSet) {
        this.x = Math.max(minimum.x, this.x);
        this.y = Math.max(minimum.y, this.y);
        this.z = Math.max(minimum.z, this.z);
      }

      if (maximumSet) {
        this.x = Math.min(maximum.x, this.x);
        this.y = Math.min(maximum.y, this.y);
        this.z = Math.min(maximum.z, this.z);
      }
      return this;
    }

    /**
     * Divides this vector by the given Vector3 / Number
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} divisor
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'divide',
    value: function divide(divisor) {
      if (divisor instanceof Vector3) {
        this.x /= divisor.x;
        this.y /= divisor.y;
        this.z /= divisor.z;
      } else {
        this.x /= divisor;
        this.y /= divisor;
        this.z /= divisor;
      }
      return this;
    }

    /**
     * Subtracts the given Vector3 / Number from this vector
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} subtrahend
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'subtract',
    value: function subtract(subtrahend) {
      if (subtrahend instanceof Vector3) {
        this.x -= subtrahend.x;
        this.y -= subtrahend.y;
        this.z -= subtrahend.z;
      } else {
        this.x -= subtrahend;
        this.y -= subtrahend;
        this.z -= subtrahend;
      }
      return this;
    }

    /**
     * Multiplies the given Vector3 / Number with this vector
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} factor
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'multiply',
    value: function multiply(factor) {
      if (factor instanceof Vector3) {
        this.x *= factor.x;
        this.y *= factor.y;
        this.z *= factor.z;
      } else {
        this.x *= factor;
        this.y *= factor;
        this.z *= factor;
      }
      return this;
    }

    /**
     * Adds the given Vector3 / Numbers to this vector
     * @param {(Number|PhotoEditorSDK.Math.Vector3)} addend
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'add',
    value: function add(addend) {
      if (addend instanceof Vector3) {
        this.x += addend.x;
        this.y += addend.y;
        this.z += addend.z;
      } else {
        this.x += addend;
        this.y += addend;
        this.z += addend;
      }
      return this;
    }

    /**
     * Checks whether the x and y value are the same as the given ones
     * @param  {(Number|PhotoEditorSDK.Math.Vector3)} vec
     * @return {Boolean}
     */

  }, {
    key: 'equals',
    value: function equals(vec) {
      if (vec instanceof Vector3) {
        return vec.x === this.x && vec.y === this.y && vec.z === this.z;
      } else {
        return vec === this.x && vec === this.y && vec === this.z;
      }
    }

    /**
     * Rounds the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'round',
    value: function round() {
      this.x = Math.round(this.x);
      this.y = Math.round(this.y);
      this.z = Math.round(this.z);
      return this;
    }

    /**
     * Rounds up the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'ceil',
    value: function ceil() {
      this.x = Math.ceil(this.x);
      this.y = Math.ceil(this.y);
      this.z = Math.ceil(this.z);
      return this;
    }

    /**
     * Rounds down the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'floor',
    value: function floor() {
      this.x = Math.floor(this.x);
      this.y = Math.floor(this.y);
      this.z = Math.floor(this.z);
      return this;
    }

    /**
     * Fractional part of  the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'fract',
    value: function fract() {
      this.x = this.x % 1;
      this.y = this.y % 1;
      this.z = this.z % 1;
      return this;
    }

    /**
     * Convert the values of this vector to integer
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'toInt',
    value: function toInt() {
      this.x = this.x | 0;
      this.y = this.y | 0;
      this.z = this.z | 0;
      return this;
    }

    /**
     * Makes both numbers of this vector positive
     * @returns {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'abs',
    value: function abs() {
      this.x = Math.abs(this.x);
      this.y = Math.abs(this.y);
      this.z = Math.abs(this.z);
      return this;
    }

    /**
     * Returns the euclidean length of this vector
     * @return {Number}
     */

  }, {
    key: 'len',
    value: function len() {
      return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);
    }

    /**
     * Returns the smallest number in this vector
     * @return {Number}
     */

  }, {
    key: 'min',
    value: function min() {
      return Math.min(Math.min(this.x, this.y), this.z);
    }

    /**
     * Returns the largest number in this vector
     * @return {Number}
     */

  }, {
    key: 'max',
    value: function max() {
      return Math.max(Math.max(this.x, this.y), this.z);
    }

    /**
     * Returns a POJO of this Vector3
     * @return {Object}
     */

  }, {
    key: 'toObject',
    value: function toObject() {
      return { x: this.x, y: this.y, z: this.z };
    }

    /**
     * Returns a string representation of this vector
     * @return {String}
     */

  }, {
    key: 'toString',
    value: function toString() {
      return 'Vector3({ x: ' + this.x + ', y: ' + this.y + ', z: ' + this.z + ' })';
    }

    /**
     * Rounds this vector's values to the given number of decimals
     * @param  {Number} decimals
     * @return {Number}
     */

  }, {
    key: 'roundDecimal',
    value: function roundDecimal(decimals) {
      this.x = parseFloat(this.x.toFixed(decimals));
      this.y = parseFloat(this.y.toFixed(decimals));
      this.z = parseFloat(this.z.toFixed(decimals));
      return this;
    }

    /**
     * Creates a new Vector3 instance from the given Object
     * @param  {Object} object
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }], [{
    key: 'fromObject',
    value: function fromObject(object) {
      return new Vector3(object.x, object.y, object.z);
    }

    /**
     * Returns a null vector
     * @return {PhotoEditorSDK.Math.Vector3}
     */

  }, {
    key: 'NULL',
    get: function get() {
      return new Vector3(0, 0, 0);
    }
  }]);

  return Vector3;
}();

/* harmony default export */ __webpack_exports__["a"] = (Vector3);

/***/ }),
/* 312 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Represents a closed range
 * @class
 * @memberof PhotoEditorSDK.Math
 */
var Range = function () {
  /**
   * Creates a closed range
   * @param {Number} min - The smallest number included in the range
   * @param {Number} max - The largest number included in the range
   */
  function Range(min, max) {
    _classCallCheck(this, Range);

    this.min = min;
    this.max = max;
  }

  /**
   * Returns the lower bound of the range
   * @returns {Number}
   */


  _createClass(Range, [{
    key: "getMin",
    value: function getMin() {
      return this.min;
    }

    /**
     * Returns the upper bound of the range
     * @returns {Number}
     */

  }, {
    key: "getMax",
    value: function getMax() {
      return this.max;
    }

    /**
     * Returns the length of this range
     * @returns {Number}
     */

  }, {
    key: "getLength",
    value: function getLength() {
      return this.max - this.min;
    }

    /**
     * Returns true if the specified value is contained in this range
     * @param {Number} value
     * @returns {Boolean}
     */

  }, {
    key: "contains",
    value: function contains(value) {
      return this.min <= value && value <= this.max;
    }
  }]);

  return Range;
}();

/* harmony default export */ __webpack_exports__["a"] = (Range);

/***/ }),
/* 313 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vector2__ = __webpack_require__(45);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_log__ = __webpack_require__(24);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var CubicBezierCurve = function () {
  function CubicBezierCurve() {
    var p0 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](0, 0);
    var p1 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](1, 1);
    var p2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](2, -1);
    var p3 = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](2, 0);

    _classCallCheck(this, CubicBezierCurve);

    // Bezier curve control points
    this._p0 = p0.clone();
    this._p1 = p1.clone();
    this._p2 = p2.clone();
    this._p3 = p3.clone();

    /// The segments used for measuring curve length
    this._segments = [];

    /// The current curve length
    this._length = -1;

    /// The current sampled points
    this._sample = [];
  }

  /**
   * Set the curve's control points.
   *
   * @param {PhotoEditorSDK.Math.Vector2} p0
   * @param {PhotoEditorSDK.Math.Vector2} p1
   * @param {PhotoEditorSDK.Math.Vector2} p2
   * @param {PhotoEditorSDK.Math.Vector2} p3
   */


  _createClass(CubicBezierCurve, [{
    key: 'set',
    value: function set() {
      var p0 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](0, 0);
      var p1 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](1, 1);
      var p2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](2, 1);
      var p3 = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new __WEBPACK_IMPORTED_MODULE_1__vector2__["a" /* default */](2, 0);

      this._p0 = p0.clone();
      this._p1 = p1.clone();
      this._p2 = p2.clone();
      this._p3 = p3.clone();
    }

    /**
     * Returns the length previously calculated by the `calculateSegments` method.
     * @returns {Number}
     */

  }, {
    key: 'getLength',
    value: function getLength() {
      return this._length;
    }

    /**
     * This method subdivides the curve into segments, calculating the values at
     * each segment's endpoints and calculating also an approximate value for the
     * curve's length. Should be called before any sampling methods are called.
     *
     * @param {Number} N - The number of segments
     */

  }, {
    key: 'calculateSegments',
    value: function calculateSegments() {
      var N = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 100;

      var t = 0;
      var len = 0;
      var segments = [];
      var step = 1 / N;

      var lastPoint = this._p0.clone();

      for (var i = 1; i <= N; i++) {
        var segment = [];

        segment.push({
          t: t,
          s: len,
          point: lastPoint
        });

        t += step;

        t = Math.min(t, 1);

        var point = this.evalAt(t);
        var delta = point.clone().subtract(lastPoint);

        len += delta.len();

        segment.push({
          t: t,
          s: len,
          point: point
        });

        segments.push(segment);

        lastPoint = point;
      }

      this._segments = segments;
      this._length = len;

      return len;
    }

    /**
     * Evaluates the curve at the parameter `t`.
     *
     * @param {Number} t - A number between 0 and 1.
     * @returns {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'evalAt',
    value: function evalAt(t) {
      t = this.normalizeParameter(t);

      var a = this._p0.clone().multiply(Math.pow(1 - t, 3));
      var b = this._p1.clone().multiply(3 * (1 - t) * (1 - t) * t);
      var c = this._p2.clone().multiply(3 * (1 - t) * t * t);
      var d = this._p3.clone().multiply(t * t * t);

      return a.add(b).add(c).add(d);
    }

    /**
     * Checks if a length value `s` lies within a given curve segment.
     *
     * @param {Number} s
     * @param {Object} segment
     * @returns {Boolean}
     */

  }, {
    key: 'isInSegment',
    value: function isInSegment(s, segment) {
      s = this.normalizeArcLength(s);

      return s >= segment[0].s && s <= segment[1].s;
    }

    /**
     * Get the segment where the given arc-length lies in.
     *
     * @param {Number} s - the arc-length
     * @returns {Object}
     */

  }, {
    key: 'getArcLengthSegment',
    value: function getArcLengthSegment(s) {
      s = this.normalizeArcLength(s);

      for (var i = 0; i < this._segments.length; i++) {
        var segment = this._segments[i];

        if (this.isInSegment(s, segment)) {
          return segment;
        }
      }

      return null;
    }

    /**
     * Normalize the arc-length to the interval [0, length]
     *
     * @param {Number} s
     * @returns {Number}
     */

  }, {
    key: 'normalizeArcLength',
    value: function normalizeArcLength(s) {
      return Math.max(Math.min(this._length, s), 0);
    }

    /**
     * Normalize the curve parameter to the interval [0, 1]
     * @param {Number} t
     * @returns {Number}
     */

  }, {
    key: 'normalizeParameter',
    value: function normalizeParameter(t) {
      return Math.max(Math.min(1, t), 0);
    }

    /**
     * Get the curve parameter for a given arc-length.
     *
     * @param {Number} s
     * @returns {Number}
     */

  }, {
    key: 'getParameterForArcLength',
    value: function getParameterForArcLength(s) {
      var arcLen = this.normalizeArcLength(s);

      var segment = this.getArcLengthSegment(arcLen);

      if (!segment) {
        __WEBPACK_IMPORTED_MODULE_2__shared_log__["a" /* default */].warn('CubicBezierCurve#getParameterForArcLength', 'Segment not found.');
        return -1;
      }

      var a = (arcLen - segment[1].s) / (segment[0].s - segment[1].s);

      return a * segment[0].t + (1 - a) * segment[1].t;
    }

    /**
     * Evaluate the curve at a given arc-length
     *
     * @param {Number} s
     */

  }, {
    key: 'evalAtArcLength',
    value: function evalAtArcLength(s) {
      return this.evalAt(this.getParameterForArcLength(s));
    }

    /**
     * Get the segment-approximate value for the curve at a given arc-length; uses
     * linear interpolation between segment endpoints to approximate the value.
     *
     * @param {Number} s
     * @returns {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'approximateAtArcLength',
    value: function approximateAtArcLength(s) {
      var arcLen = this.normalizeArcLength(s);

      var segment = this.getArcLengthSegment(arcLen);

      if (!segment) {
        return -1;
      }

      var a = (arcLen - segment[1].s) / (segment[0].s - segment[1].s);

      return segment[0].point.clone().multiply(a).add(segment[1].point.clone().multiply(1 - a));
    }

    /**
     * Sample the curve in the parameter space, returning a sample of (N+1)
     * points.
     *
     * @param {Number} N
     * @returns {Array<Number>}
     */

  }, {
    key: 'parameterSample',
    value: function parameterSample() {
      var N = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 100;

      var step = 1 / N;

      var sample = [];
      var t = 0;
      for (var i = 0; i <= N + 1; i++) {
        sample.push(this.evalAt(t));
        t += step;
      }

      this._sample = sample;
      return [].concat(sample);
    }

    /**
     * Samples the curve in arc-length space, using approximate segment arc-lenght calculations. Returns a
     * sample of (N+1) points.
     *
     * @param {Number} N
     * @param {Boolean} excludeStartPoint - If true, excludes the start-point
     * @param {Boolean} excludeEndPoint - If true, excludes the end-point
     */

  }, {
    key: 'arcLengthApproxSample',
    value: function arcLengthApproxSample() {
      var N = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 100;
      var excludeStartPoint = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      var excludeEndPoint = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

      var step = this._length / N;

      var sample = [];
      var s = 0;
      for (var i = excludeStartPoint ? 1 : 0; i < N + 1; i++) {
        sample.push(this.approximateAtArcLength(s));
        s += step;
      }

      if (excludeEndPoint) {
        sample.pop();
      }

      this._sample = sample;
      return [].concat(sample);
    }
  }]);

  return CubicBezierCurve;
}();

/* harmony default export */ __webpack_exports__["a"] = (CubicBezierCurve);

/***/ }),
/* 314 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__globals__ = __webpack_require__(38);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__lib_math_vector2__ = __webpack_require__(45);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__operation__ = __webpack_require__(167);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var OptionType = __WEBPACK_IMPORTED_MODULE_4__globals__["Constants"].OptionType;

/**
 * An operation that can rotate and flip an image depending on the given EXIF information
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var ExifOrientationOperation = function (_Operation) {
  _inherits(ExifOrientationOperation, _Operation);

  function ExifOrientationOperation() {
    _classCallCheck(this, ExifOrientationOperation);

    return _possibleConstructorReturn(this, (ExifOrientationOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ExifOrientationOperation)).apply(this, arguments));
  }

  _createClass(ExifOrientationOperation, [{
    key: 'getRotation',

    /**
     * Returns the rotation in degrees
     * @return {Number}
     * @private
     */
    value: function getRotation() {
      var degrees = 0;
      switch (this.getTags().Orientation) {
        case 7:
        case 8:
          degrees = -90;
          break;
        case 3:
        case 4:
          degrees = -180;
          break;
        case 5:
        case 6:
          degrees = 90;
          break;
      }
      return degrees;
    }

    /**
     * Checks if the image needs to be flipped vertically
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_getFlipVertically',
    value: function _getFlipVertically() {
      var _getTags = this.getTags(),
          Orientation = _getTags.Orientation;

      return [5, 7].indexOf(Orientation) !== -1;
    }

    /**
     * Checks if the image needs to be flipped horizontally
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_getFlipHorizontally',
    value: function _getFlipHorizontally() {
      var _getTags2 = this.getTags(),
          Orientation = _getTags2.Orientation;

      return [2, 4].indexOf(Orientation) !== -1;
    }

    /**
     * Returns the options based on the EXIF orientation
     * @return {Object}
     * @private
     */

  }, {
    key: '_getFinalOptions',
    value: function _getFinalOptions() {
      return {
        rotation: this.getRotation(),
        flipVertically: this._getFlipVertically(),
        flipHorizontally: this._getFlipHorizontally()
      };
    }

    /**
     * Rotates and/or flips the image
     * @param  {PhotoEditorSDK} sdk
     * @returns {Promise}
     * @override
     * @private
     */

  }, {
    key: '_render',
    value: function _render(sdk) {
      var options = this._getFinalOptions();
      var actualDegrees = options.rotation % 360;
      var radians = actualDegrees * (Math.PI / 180);

      this._sprite.setScale(options.flipHorizontally ? -1 : 1, options.flipVertically ? -1 : 1);
      this._sprite.setRotation(radians);
      this._sprite.setAnchor(0.5, 0.5);
      this._sprite.updateTransform();

      var bounds = this._sprite.getBounds();
      this._renderTexture.resizeTo(new __WEBPACK_IMPORTED_MODULE_6__lib_math_vector2__["a" /* default */](bounds.width, bounds.height));

      // Make sure we're rendering to top left corner
      this._sprite.setPosition(this._renderTexture.getDimensions().divide(2));

      // Draw
      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5__shared_vendor_promise__["a" /* default */].resolve();
    }

    /**
     * Returns the dimensions the given dimensions will have after this operation
     * has been applied
     * @param {PhotoEditorSDK.Math.Vector2} dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     * @override
     */

  }, {
    key: 'getNewDimensions',
    value: function getNewDimensions(dimensions) {
      var options = this._getFinalOptions();
      dimensions = dimensions.clone();
      if (options.rotation % 180) {
        dimensions.flip();
      }
      return dimensions;
    }

    /**
     * Applies the necessary rotation/flip to the image and
     * returns a new canvas with the corrected image
     * @param {Image} image
     * @return {Canvas}
     */

  }, {
    key: 'applyTo',
    value: function applyTo(image) {
      var options = this._getFinalOptions();

      var canvas = __WEBPACK_IMPORTED_MODULE_4__globals__["Utils"].createCanvas();

      if (Math.abs(options.rotation % 180) === 90) {
        canvas.width = image.height;
        canvas.height = image.width;
      } else {
        canvas.width = image.width;
        canvas.height = image.height;
      }

      var context = canvas.getContext('2d');

      var rotation = options.rotation * Math.PI / 180;
      var adjustX = 0.5 * (canvas.width - image.width);
      var adjustY = 0.5 * (canvas.height - image.height);
      context.translate(adjustX, adjustY);
      context.translate(0.5 * image.width, 0.5 * image.height);
      context.rotate(rotation);
      context.translate(-0.5 * image.width, -0.5 * image.height);

      if (options.flipVertically) {
        context.translate(0, image.height);
        context.scale(1, -1);
      }

      if (options.flipHorizontally) {
        context.translate(image.width, 0);
        context.scale(-1, 1);
      }

      context.drawImage(image, 0, 0);

      return canvas;
    }
  }]);

  return ExifOrientationOperation;
}(__WEBPACK_IMPORTED_MODULE_7__operation__["a" /* default */]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


ExifOrientationOperation.identifier = 'exif-orientation';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
ExifOrientationOperation.prototype.availableOptions = {
  tags: { type: OptionType.OBJECT, default: {} }
};

/* harmony default export */ __webpack_exports__["a"] = (ExifOrientationOperation);

/***/ }),
/* 315 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__array_stream__ = __webpack_require__(121);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__constants__ = __webpack_require__(122);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var MARKERS = __WEBPACK_IMPORTED_MODULE_2__constants__["a" /* default */].MARKERS;

/**
 * JFIFData provides access to the JFIF Information inside the JPEG Header
 * @class
 * @memberof PhotoEditorSDK
 * @ignore
 */

var JFIFData = function () {
  /**
   * Creates an JFIFData instance
   * @param {Uint8Array} buf
   */
  function JFIFData(buf) {
    _classCallCheck(this, JFIFData);

    this._buf = buf;
    this._stream = new __WEBPACK_IMPORTED_MODULE_1__array_stream__["a" /* default */](this._buf);
    this._stream.setHead(0);
  }

  /**
   * Check if buf contains valid JFIF Segment
   * @returns {Boolean}
   */


  _createClass(JFIFData, [{
    key: 'isValid',
    value: function isValid() {
      this._stream.setHead(0);
      var marker = this._stream.readInt16();
      if (marker !== MARKERS.APP0) {
        return false;
      }
      // Skip length
      var length = this._stream.readInt16();
      if (!(length >= 16)) {
        return false;
      }
      var fileIdentifier = this._stream.readString(4);
      var fileIdentifierEndMarker = this._stream.readInt8();
      if (!(fileIdentifier === 'JFIF')) {
        return false;
      }
      if (!(fileIdentifierEndMarker === 0x00)) {
        return false;
      }
      return true;
    }

    /**
     * Set the unit density. Valid params are 0..
     * @param {Number} val
     */

  }, {
    key: 'setUnitDensity',
    value: function setUnitDensity(val) {
      this._stream.setHead(11);
      this._stream.writeInt8(val);
    }

    /**
     * Set the density x value
     * @param {Number} val
     */

  }, {
    key: 'setDensityX',
    value: function setDensityX(val) {
      this._stream.setHead(12);
      this._stream.writeInt16(val);
    }

    /**
     * Set the density y value
     * @param {Number} val
     */

  }, {
    key: 'setDensityY',
    value: function setDensityY(val) {
      this._stream.setHead(14);
      this._stream.writeInt16(val);
    }

    /**
     * Returns the units for the X and Y densities.
     * units 0: X and Y specify the pixel aspect ratio
     * units 1: dots per inch
     * units 2: dots per cm
     * @returns {Number}
     */

  }, {
    key: 'getUnitDensity',
    value: function getUnitDensity() {
      this._stream.setHead(11);
      return this._stream.readInt8();
    }

    /**
     * Returns the Xdensity
     * @returns {Number}
     */

  }, {
    key: 'getDensityX',
    value: function getDensityX() {
      this._stream.setHead(12);
      return this._stream.readInt16();
    }

    /**
     * Returns the Ydensity
     * @returns {Number}
     */

  }, {
    key: 'getDensityY',
    value: function getDensityY() {
      this._stream.setHead(14);
      return this._stream.readInt16();
    }

    /**
     * Returns the internal data buffer
     * @returns {Uint8Array}
     * @memberof JFIFData
     */

  }, {
    key: 'getBuffer',
    value: function getBuffer() {
      return this._buf;
    }
  }]);

  return JFIFData;
}();

/* harmony default export */ __webpack_exports__["a"] = (JFIFData);

/***/ }),
/* 316 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__array_stream__ = __webpack_require__(121);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__constants__ = __webpack_require__(122);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils__ = __webpack_require__(32);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var invariant = __WEBPACK_IMPORTED_MODULE_3__utils__["a" /* default */].invariant;
var MARKERS = __WEBPACK_IMPORTED_MODULE_2__constants__["a" /* default */].MARKERS,
    EXIF_TAGS = __WEBPACK_IMPORTED_MODULE_2__constants__["a" /* default */].EXIF_TAGS;

/**
 * EXIFData provides access to the Exif Information inside the JPEG Header
 * @class
 * @memberof PhotoEditorSDK
 * @ignore
 */

var EXIFData = function () {
  /**
   * Creates an ExifData instance
   * @param {Uint8Array} buf
   */
  function EXIFData(buf) {
    _classCallCheck(this, EXIFData);

    this._buf = buf;
    this._stream = new __WEBPACK_IMPORTED_MODULE_1__array_stream__["a" /* default */](this._buf);
    this._stream.setHead(0);
    this._parse();
  }

  /**
   * Check if buf contains valid EXIF Segment
   * @returns {Boolean}
   */


  _createClass(EXIFData, [{
    key: 'isValid',
    value: function isValid() {
      this._stream.setHead(0);
      // Skip marker
      var marker = this._stream.readInt16();
      if (marker !== MARKERS.EXIF) {
        return false;
      }
      // Skip length
      var length = this._stream.readInt16();
      if (!(length > 0)) {
        return false;
      }
      var header = this._stream.readString(4);
      if (header !== 'Exif') {
        return false;
      }
      return true;
    }
    /**
     * Parses the exif tags
     * @return {Object}
     * @private
     */

  }, {
    key: '_parse',
    value: function _parse() {
      if (!this.isValid()) {
        return;
      }

      this._stream.setHead(10);
      var tiffOffset = this._stream.getHead();

      // Find endian type
      var bigEndian = false;
      var endian = this._stream.readInt16();
      if (endian === 0x4949) {
        bigEndian = false;
      } else if (endian === 0x4d4d) {
        bigEndian = true;
      } else {
        invariant(false, 'Invalid TIFF data: No endian type found');
      }

      invariant(this._stream.readInt16(!bigEndian) === 0x002A, 'Invalid TIFF data: No 0x002A');

      var firstIFDOffset = this._stream.readInt32(!bigEndian);
      invariant(firstIFDOffset >= 8, 'Invalid TIFF data: First IFD offset < 8');

      var ifdOffset = tiffOffset + firstIFDOffset;
      var tags = this._readTags(this._stream, tiffOffset, ifdOffset, bigEndian);
      this._tags = tags.tags;
      this._tagData = tags.tagData;
    }

    /**
     * Returns the tags
     * @return {Object}
     */

  }, {
    key: 'getTags',
    value: function getTags() {
      return this._tags;
    }

    /**
     * Returns the tag data (key, value, byte position etc.)
     * @return {Object[]}
     */

  }, {
    key: 'getTagData',
    value: function getTagData() {
      return this._tagData;
    }
  }, {
    key: 'setOrientation',
    value: function setOrientation(orientation) {
      if (this._tagData.Orientation) {
        var entryOffset = this._tagData.Orientation.entryOffset;
        // Replace value in buffer

        this._stream.setHead(entryOffset + 8);
        this._stream.writeInt16(orientation);
      }
    }

    /**
     * Reads the TIFF tags from the stream
     * @param  {ArrayBuffer} stream
     * @param  {Number} tiffStart The position where tiff data starts
     * @param  {Number} ifdStart  The position where the IFD starts
     * @param  {Boolean} bigEndian
     * @return {Object}
     * @private
     */

  }, {
    key: '_readTags',
    value: function _readTags(stream, tiffStart, ifdStart, bigEndian) {
      stream.setHead(ifdStart);
      var entriesCount = stream.readInt16(!bigEndian);
      var tags = {};
      var tagData = [];

      for (var i = 0; i < entriesCount; i++) {
        var entryOffset = ifdStart + i * 12 + 2;
        stream.setHead(entryOffset);
        var tag = stream.readInt16(!bigEndian);
        var type = void 0;
        var numValues = void 0;
        var valueOffset = void 0;
        if (EXIF_TAGS[tag]) {
          tag = EXIF_TAGS[tag];
          type = stream.readInt16(!bigEndian);
          numValues = stream.readInt32(!bigEndian);
          valueOffset = stream.readInt32(!bigEndian) + tiffStart;
          var value = null;

          switch (type) {
            case 1: // byte, 8-bit unsigned int
            case 7:
              // undefined, 8-bit byte, value depending on field
              if (numValues === 1) {
                value = stream.readInt8(!bigEndian);
              } else {
                value = [];
                for (var _i = 0; _i < numValues; _i++) {
                  value.push(stream.readInt8(!bigEndian));
                }
              }
              break;
            case 2:
              // 8-bit ascii char
              stream.setHead(numValues > 4 ? valueOffset : entryOffset + 8);
              value = stream.readString(numValues);
              break;
            case 3:
              // short
              stream.setHead(numValues > 2 ? valueOffset : entryOffset + 8);
              if (numValues === 1) {
                value = stream.readInt16(!bigEndian);
              } else {
                value = [];
                for (var _i2 = 0; _i2 < numValues; _i2++) {
                  value.push(stream.readInt16(!bigEndian));
                }
              }
              break;
            case 4: // long
            case 9:
              // slong
              stream.setHead(numValues > 1 ? valueOffset : entryOffset + 8);
              if (numValues === 1) {
                value = stream.readInt32(!bigEndian);
              } else {
                value = [];
                for (var _i3 = 0; _i3 < numValues; _i3++) {
                  value.push(stream.readInt32(!bigEndian));
                }
              }
              break;
            case 5: // rational (two long values, first numerator, second denominator)
            case 10:
              // rational (two slongs)
              stream.setHead(valueOffset);
              if (numValues === 1) {
                var numerator = stream.readInt32(!bigEndian);
                var denominator = stream.readInt32(!bigEndian);
                value = numerator / denominator;
              } else {
                value = [];
                for (var _i4 = 0; _i4 < numValues; _i4++) {
                  var _numerator = stream.readInt32(!bigEndian);
                  var _denominator = stream.readInt32(!bigEndian);
                  var val = _numerator / _denominator;
                  value.push(val);
                }
              }
              break;
          }

          tags[tag] = value;
          tagData[tag] = {
            value: value,
            numValues: numValues,
            entryOffset: entryOffset,
            valueOffset: valueOffset,
            type: type
          };
        }
      }

      return { tags: tags, tagData: tagData };
    }

    /**
     * Returns internal buffer
     * @returns {Uint8Array}
     */

  }, {
    key: 'getBuffer',
    value: function getBuffer() {
      return this._buf;
    }
  }]);

  return EXIFData;
}();

/* harmony default export */ __webpack_exports__["a"] = (EXIFData);

/***/ }),
/* 317 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__constants__ = __webpack_require__(40);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__engine__ = __webpack_require__(85);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils__ = __webpack_require__(32);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__image__ = __webpack_require__(89);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__exif__ = __webpack_require__(120);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__configurable__ = __webpack_require__(70);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








/**
 * @class
 * @alias PhotoEditorSDK.ImageExporter
 * @private
 */

var ImageExporter = function (_Configurable) {
  _inherits(ImageExporter, _Configurable);

  function ImageExporter(sdk) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, ImageExporter);

    var _this = _possibleConstructorReturn(this, (ImageExporter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(ImageExporter)).call(this, options));

    _this._sdk = sdk;
    return _this;
  }

  /**
   * Exports the image from the given canvas with the given options
   * @return {Promise}
   */


  _createClass(ImageExporter, [{
    key: 'export',
    value: function _export() {
      var _this2 = this;

      var imageFormat = this._options.imageFormat;

      // Rerender stack recursively, if it's not done yet

      var rerenderIfNeeded = function rerenderIfNeeded(response) {
        if (!response.renderDone) {
          return _this2._sdk.render().then(function (response) {
            return rerenderIfNeeded(response);
          });
        }

        return response;
      };

      return this.validateSettings().then(function () {
        return _this2._prepareSDK().then(function (response) {
          return rerenderIfNeeded(response);
        });
      }).then(function (response) {
        var outputTexture = response.outputTexture,
            renderDone = response.renderDone;

        var renderer = _this2._sdk.getRenderer();
        var canvas = renderer.getCanvas();
        if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5__constants__["RendererType"].WEBGL)) {
          canvas = _this2._createCanvasFromTexture(outputTexture);
        }
        return _this2._encodeImageFormat(canvas);
      }).then(function (result) {
        return _this2._restoreExifMetadata(result, imageFormat);
      }).then(function (result) {
        return _this2._restoreSDK().then(function () {
          return result;
        });
      });
    }

    /**
     * Restores the JPEG Exif Information if applicable
     *
     * @param {string} result
     * @return {string}
     * @returns DataURI of JPEG encoded image with Exif Information
     * @memberof ImageExporter
     */

  }, {
    key: '_restoreExifMetadata',
    value: function _restoreExifMetadata(result, imageFormat, quality) {
      if (imageFormat === __WEBPACK_IMPORTED_MODULE_5__constants__["ImageFormat"].JPEG) {
        var exif = this._sdk.getExif(); // This is basically the JPEG Header

        if (exif) {
          {
            result = exif.restoreSegments(result);
          }
        }
      }
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve(result);
    }

    /**
     *
     *
     * @param {HTMLCanvasElement} canvas
     * @return {string}
     * @returns string
     * @memberof ImageExporter
     */

  }, {
    key: '_encodeAsDataURL',
    value: function _encodeAsDataURL(canvas, imageFormat, quality) {
      if (__WEBPACK_IMPORTED_MODULE_7__utils__["a" /* default */].isBrowser) {
        return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve(canvas.toDataURL(imageFormat, quality));
      } else {
        return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
          canvas.toDataURL(imageFormat, quality, function (err, jpeg) {
            if (err) {
              reject(err);
            } else {
              resolve(jpeg);
            }
          });
        });
      }
    }

    /**
     *
     * @param {HTMLCanvasElement} canvas
     * @return {HTMLImageElement}
     * @memberof ImageExporter
     */

  }, {
    key: '_encodeAsHTMLImage',
    value: function _encodeAsHTMLImage(canvas, imageFormat, quality) {
      return this._encodeAsDataURL(canvas).then(function (dataURI) {
        var outputImage = new __WEBPACK_IMPORTED_MODULE_8__image__["a" /* default */]();
        outputImage.src = dataURI;
        return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve(outputImage);
      });
    }

    /**
     *
     * @param {HTMLCanvasElement} canvas
     * @return {Array}
     * @memberof ImageExporter
     */

  }, {
    key: '_encodeAsBuffer',
    value: function _encodeAsBuffer(canvas, imageFormat, quality) {
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.reject(new Error('Unsupported platform for RenderType')); // eslint-disable-line no-unreachable
    }

    /**
     * Encode canvas as BLOB
     *
     * @param {HTMLCanvasElement} canvas
     * @param {ImageFormat} imageFormat
     * @param {number} quality
     * @return {Blob}
     * @memberof ImageExporter
     */

  }, {
    key: '_encodeAsMSBlob',
    value: function _encodeAsMSBlob(canvas, imageFormat, quality) {
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve(canvas.msToBlob());
    }

    /**
     * Encode canvas as BLOB
     *
     * @param {HTMLCanvasElement} canvas
     * @param {ImageFormat} imageFormat
     * @param {number} quality
     * @return {Blob}
     * @memberof ImageExporter
     */

  }, {
    key: '_encodeAsBLOB',
    value: function _encodeAsBLOB(canvas, imageFormat, quality) {
      return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        canvas.toBlob(function (blob) {
          resolve(blob);
        }, imageFormat, quality);
      });
    }

    /**
     * Encode canvas to specified Image format
     *
     * @param {HTMLCanvasElement} canvas
     * @return {any}
     * @returns HTMLImage|Blob|Buffer
     * @memberof ImageExporter
     */

  }, {
    key: '_encodeImageFormat',
    value: function _encodeImageFormat(canvas) {
      var _options = this._options,
          imageFormat = _options.imageFormat,
          quality = _options.quality;

      var renderType = this._options.renderType;
      if ([__WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].MSBLOB, __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].BLOB].indexOf(renderType) !== -1) {
        var userAgent = window && window.navigator && window.navigator.userAgent || '';
        var isEdge = userAgent.indexOf('Edge') !== -1;
        if (isEdge) {
          renderType = __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].MSBLOB;
        } else {
          renderType = __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].BLOB;
        }
      }
      switch (renderType) {
        case __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].IMAGE:
          {
            return this._encodeAsHTMLImage(canvas, imageFormat, quality);
          }
        case __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].DATAURL:
          {
            return this._encodeAsDataURL(canvas, imageFormat, quality);
          }
        case __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].BUFFER:
          {
            return this._encodeAsBuffer(canvas, imageFormat, quality);
          }
        case __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].MSBLOB:
          {
            return this._encodeAsMSBlob(canvas, imageFormat, quality);
          }
        case __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].BLOB:
          {
            return this._encodeAsBLOB(canvas, imageFormat, quality);
          }
      }

      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.reject(new Error('Unsupported RenderType: ' + renderType + '!'));
    }

    /**
     * Prepares the SDK for exporting
     * @private
     */

  }, {
    key: '_prepareSDK',
    value: function _prepareSDK() {
      var renderer = this._sdk.getRenderer();

      this._sdkSettings = {
        dimensions: renderer.getDimensions().clone(),
        textureQuality: this._sdk.getTextureQuality(),
        pixelRatio: this._sdk.getPixelRatio(),
        renderMode: this._sdk.getRenderMode()
      };

      this._sdk.setRenderMode('export');
      this._sdk.setTextureQuality(1);

      var resizeCanvas = renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5__constants__["RendererType"].CANVAS);
      renderer.setPixelRatio(1);
      renderer.resizeTo(this._sdk.getFinalDimensions(), resizeCanvas);

      this._sdk.setAllOperationsToDirty(true);

      var stack = this._sdk.getOperationsStack();
      stack.forEach(function (operation) {
        operation.disposeRenderTextures();
      });
      stack.disableCache();

      return this._sdk.render();
    }

    /**
     * Restores the previous SDK options
     * @private
     */

  }, {
    key: '_restoreSDK',
    value: function _restoreSDK() {
      var stack = this._sdk.getOperationsStack();
      stack.enableCache();

      this._sdk.setRenderMode(this._sdkSettings.renderMode);
      var renderer = this._sdk.getRenderer();

      var resizeCanvas = renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5__constants__["RendererType"].CANVAS);
      renderer.setPixelRatio(this._sdkSettings.pixelRatio);
      renderer.resizeTo(this._sdkSettings.dimensions, resizeCanvas);

      this._sdk.setTextureQuality(this._sdkSettings.textureQuality);
      this._sdk.setAllOperationsToDirty(true);
      return this._sdk.render();
    }

    /**
     * Creates a canvas from the given Texture by attaching it to an FBO and using
     * gl.readPixels() to read the pixels. It then writes the pixel data to a new
     * 2D (not hardware-accelerated) canvas and calls .toDataURL() on it.
     * @param  {PhotoEditorSDK.Engine.Texture} texture
     * @return {HTMLCanvasElement}
     * @private
     */

  }, {
    key: '_createCanvasFromTexture',
    value: function _createCanvasFromTexture(texture) {
      var renderer = this._sdk.getRenderer();
      var finalDimensions = this._sdk.getFinalDimensions();

      var gl = this._sdk.getRenderer().getContext();

      // Create temporary framebuffer
      var fbo = gl.createFramebuffer();
      gl.bindFramebuffer(gl.FRAMEBUFFER, fbo);

      // Attach output texture to FBO
      var glTexture = texture.getBaseTexture().getGLTextureForRenderer(renderer);
      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, glTexture, 0);

      // Read pixels from FBO
      var pixels = new Uint8Array(finalDimensions.x * finalDimensions.y * 4);
      gl.readPixels(0, 0, finalDimensions.x, finalDimensions.y, gl.RGBA, gl.UNSIGNED_BYTE, pixels);

      // Check if we have any semi-transparent pixels
      var hasTransparency = this._checkPixelsForTransparency(pixels);

      var renderTexture = void 0;
      if (hasTransparency) {
        // Since our textures have premultiplied RGB values, we need to un-premultiply the
        // values before reading them from the texture and passing them to a canvas
        var sprite = new __WEBPACK_IMPORTED_MODULE_6__engine__["a" /* default */].Sprite(texture);
        sprite.setFilters([new __WEBPACK_IMPORTED_MODULE_6__engine__["a" /* default */].Filters.UnpremultiplyFilter()]);
        var container = new __WEBPACK_IMPORTED_MODULE_6__engine__["a" /* default */].Container();
        container.addChild(sprite);
        renderTexture = new __WEBPACK_IMPORTED_MODULE_6__engine__["a" /* default */].RenderTexture(renderer, finalDimensions.x, finalDimensions.y);
        renderTexture.render(container);

        // Attach the new texture
        var _glTexture = renderTexture.getBaseTexture().getGLTextureForRenderer(renderer);
        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, _glTexture, 0);

        // Read pixels from FBO
        gl.readPixels(0, 0, finalDimensions.x, finalDimensions.y, gl.RGBA, gl.UNSIGNED_BYTE, pixels);

        // Switch back to default render target, dispose the texture
        renderer.setRenderTarget();
        renderTexture.dispose();
      }

      // Create canvas with dimensions of output texture
      var canvas = __WEBPACK_IMPORTED_MODULE_7__utils__["a" /* default */].createCanvas();
      canvas.width = finalDimensions.x;
      canvas.height = finalDimensions.y;

      // Copy pixel data over
      var context = canvas.getContext('2d');
      var imageData = context.createImageData(finalDimensions.x, finalDimensions.y);

      imageData.data.set(pixels);

      // Render to canvas
      context.putImageData(imageData, 0, 0);

      // Delete FBO
      gl.deleteFramebuffer(fbo);

      return canvas;
    }

    /**
     * Checks if any of the given RGBA pixels has transparency
     * @param  {Uint8Array} pixels
     * @return {Boolean}
     */

  }, {
    key: '_checkPixelsForTransparency',
    value: function _checkPixelsForTransparency(pixels) {
      var finalDimensions = this._sdk.getFinalDimensions();
      var maxIndex = finalDimensions.x * finalDimensions.y * 4;
      var value = void 0;
      for (var i = 3; i < maxIndex; i += 4) {
        value = pixels[i];
        if (value !== 255) {
          return true;
        }
      }
      return false;
    }
  }]);

  return ImageExporter;
}(__WEBPACK_IMPORTED_MODULE_10__configurable__["a" /* default */]);

ImageExporter.prototype.availableOptions = {
  renderType: { type: __WEBPACK_IMPORTED_MODULE_5__constants__["OptionType"].STRING, available: __WEBPACK_IMPORTED_MODULE_7__utils__["a" /* default */].values(__WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"]), default: __WEBPACK_IMPORTED_MODULE_5__constants__["RenderType"].IMAGE },
  imageFormat: { type: __WEBPACK_IMPORTED_MODULE_5__constants__["OptionType"].STRING, available: __WEBPACK_IMPORTED_MODULE_7__utils__["a" /* default */].values(__WEBPACK_IMPORTED_MODULE_5__constants__["ImageFormat"]), default: __WEBPACK_IMPORTED_MODULE_5__constants__["ImageFormat"].PNG },
  quality: { type: __WEBPACK_IMPORTED_MODULE_5__constants__["OptionType"].NUMBER, default: 0.8 }
};

/* harmony default export */ __webpack_exports__["a"] = (ImageExporter);

/***/ }),
/* 318 */
/***/ (function(module, exports) {

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 * @license
 */

/* eslint-disable */

// --------------------- ARRAY POLYFILLS ----------------------

// https://tc39.github.io/ecma262/#sec-array.prototype.findindex
if (!Array.prototype.findIndex) {
  Object.defineProperty(Array.prototype, 'findIndex', {
    value: function value(predicate) {
      // 1. Let O be ? ToObject(this value).
      if (this == null) {
        throw new TypeError('"this" is null or not defined');
      }

      var o = Object(this);

      // 2. Let len be ? ToLength(? Get(O, "length")).
      var len = o.length >>> 0;

      // 3. If IsCallable(predicate) is false, throw a TypeError exception.
      if (typeof predicate !== 'function') {
        throw new TypeError('predicate must be a function');
      }

      // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.
      var thisArg = arguments[1];

      // 5. Let k be 0.
      var k = 0;

      // 6. Repeat, while k < len
      while (k < len) {
        // a. Let Pk be ! ToString(k).
        // b. Let kValue be ? Get(O, Pk).
        // c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).
        // d. If testResult is true, return k.
        var kValue = o[k];
        if (predicate.call(thisArg, kValue, k, o)) {
          return k;
        }
        // e. Increase k by 1.
        k++;
      }

      // 7. Return -1.
      return -1;
    },
    configurable: true,
    writable: true
  });
}

/***/ }),
/* 319 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Provides environment functions for internal use
 * @class
 * @memberof PhotoEditorSDK
 * @private
 */
var Env = function () {
  function Env() {
    _classCallCheck(this, Env);
  }

  _createClass(Env, null, [{
    key: 'current',

    /**
     * Return current environment
     * @returns {Boolean}
     */
    value: function current() {
      return ("development");
    }

    /**
     * Returns True if testing environment
     * @returns {Boolean}
     */

  }, {
    key: 'isTest',
    value: function isTest() {
      return ("development") === 'test';
    }

    /**
     * Returns True if development environment
     * @returns {Boolean}
     */

  }, {
    key: 'isDevelopment',
    value: function isDevelopment() {
      return ("development") === 'development';
    }

    /**
     * Returns True if production environment
     * @returns {Boolean}
     */

  }, {
    key: 'isProduction',
    value: function isProduction() {
      return  !this.isTest() && !this.isDevelopment();
    }
  }]);

  return Env;
}();

/* harmony default export */ __webpack_exports__["a"] = (Env);

/***/ }),
/* 320 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__adjustments_operation__ = __webpack_require__(321);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__blur_operation__ = __webpack_require__(329);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter_operation__ = __webpack_require__(331);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__frame_operation__ = __webpack_require__(397);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__license_watermark_operation__ = __webpack_require__(398);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__linear_focus_operation__ = __webpack_require__(402);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__mirrored_focus_operation__ = __webpack_require__(405);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__orientation_operation__ = __webpack_require__(408);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__overlay_operation__ = __webpack_require__(409);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__radial_focus_operation__ = __webpack_require__(410);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__selective_blur_operation__ = __webpack_require__(413);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__sprite_operation__ = __webpack_require__(419);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__transform_operation__ = __webpack_require__(448);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__watermark_operation__ = __webpack_require__(450);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__art_filter_operation__ = __webpack_require__(451);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__output_operation__ = __webpack_require__(475);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__flip_operation__ = __webpack_require__(476);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




















var Operations = [__WEBPACK_IMPORTED_MODULE_1__adjustments_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_2__blur_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_3__filter_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_4__frame_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_5__license_watermark_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_6__linear_focus_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_7__mirrored_focus_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_8__orientation_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_9__overlay_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_10__radial_focus_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_11__selective_blur_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_12__sprite_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_13__transform_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_14__watermark_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_15__art_filter_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_16__output_operation__["a" /* default */], __WEBPACK_IMPORTED_MODULE_17__flip_operation__["a" /* default */]];

__WEBPACK_IMPORTED_MODULE_0_photoeditorsdk_core___default.a.AllOperations = Operations;

/* harmony default export */ __webpack_exports__["default"] = (Operations);

/***/ }),
/* 321 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_filters_adjustments_filter__ = __webpack_require__(172);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__clarity_filter__ = __webpack_require__(323);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__temperature_filter__ = __webpack_require__(325);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__sharpness_filter__ = __webpack_require__(327);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var ColorMatrix = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].ColorMatrix;

/**
 * Applies adjustments (brightness, saturation, contrast) to the image
 * @class
 * @alias Operations.AdjustmentsOperation
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK
 */

var AdjustmentsOperation = function (_Operation) {
  _inherits(AdjustmentsOperation, _Operation);

  /**
   * Creates a new AdjustmentsOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   * @param  {Number} [options.brightness = 0]
   * @param  {Number} [options.saturation = 1]
   * @param  {Number} [options.exposure = 0]
   * @param  {Number} [options.contrast = 1]
   * @param  {Number} [options.shadows = 0]
   * @param  {Number} [options.highlights = 1]
   * @param  {Number} [options.whites = 0]
   * @param  {Number} [options.blacks = 0]
   * @param  {Number} [options.temperature = 0]
   * @param  {Number} [options.sharpness = 0]
   */
  function AdjustmentsOperation() {
    var _ref;

    _classCallCheck(this, AdjustmentsOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = AdjustmentsOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(AdjustmentsOperation)).call.apply(_ref, [this].concat(args)));

    _this._clarityFilter = new __WEBPACK_IMPORTED_MODULE_7__clarity_filter__["a" /* default */]();
    _this._temperatureFilter = new __WEBPACK_IMPORTED_MODULE_8__temperature_filter__["a" /* default */]();
    _this._sharpnessFilter = new __WEBPACK_IMPORTED_MODULE_9__sharpness_filter__["a" /* default */]();
    _this._filter = new __WEBPACK_IMPORTED_MODULE_6__shared_filters_adjustments_filter__["a" /* default */]();
    _this._sprite.setFilters([_this._clarityFilter, _this._temperatureFilter, _this._filter]);
    return _this;
  }

  /**
   * Applies this operation
   * @param  {PhotoEditorSDK} sdk
   * @return {Promise} renderer
   * @private
   */


  _createClass(AdjustmentsOperation, [{
    key: '_render',
    value: function _render(sdk) {
      var dimensions = sdk.getDimensions();
      dimensions.x = 1.0 / dimensions.x;
      dimensions.y = 1.0 / dimensions.y;
      var clarityColorMatrix = new ColorMatrix();
      clarityColorMatrix.multiply(ColorMatrix.createSaturationMatrix(-0.3 * this._options.clarity + 1));
      clarityColorMatrix.multiply(ColorMatrix.createContrastMatrix(0.1 * this._options.clarity + 1));

      this._clarityFilter.set({
        clarity: this._options.clarity,
        pixelDimension: dimensions,
        colorMatrix: clarityColorMatrix,
        colorOffset: clarityColorMatrix.getOffsets()
      });
      this._temperatureFilter.set({
        temperature: this._options.temperature
      });
      this._sharpnessFilter.set({
        sharpness: this._options.sharpness,
        pixelDimension: dimensions
      });

      var colorMatrix = new ColorMatrix();
      colorMatrix.multiply(ColorMatrix.createExposureMatrix(this._options.exposure));
      colorMatrix.multiply(ColorMatrix.createSaturationMatrix(this._options.saturation + 1));
      colorMatrix.multiply(ColorMatrix.createContrastMatrix((this._options.contrast > 0 ? this._options.contrast * 2 : this._options.contrast) + 1));
      colorMatrix.multiply(ColorMatrix.createBrightnessMatrix(this._options.brightness));

      this._filter.set({
        gamma: this._options.gamma,
        shadows: this._options.shadows,
        highlights: this._options.highlights,
        whites: this._options.whites,
        blacks: this._options.blacks,
        colorMatrix: colorMatrix,
        colorOffset: colorMatrix.getOffsets()
      });

      var filters = [];
      if (this._options.clarity !== 0) {
        filters.push(this._clarityFilter);
      }
      if (this._options.sharpness !== 0) {
        filters.push(this._sharpnessFilter);
      }
      if (this._options.temperature !== 0) {
        filters.push(this._temperatureFilter);
      }

      filters.push(this._filter);
      this._sprite.setFilters(filters);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(AdjustmentsOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(AdjustmentsOperation.prototype), 'dispose', this).call(this);
      this._filter.dispose();
      this._clarityFilter.dispose();
      this._temperatureFilter.dispose();
      this._sharpnessFilter.dispose();
    }
  }]);

  return AdjustmentsOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


AdjustmentsOperation.identifier = 'adjustments';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
AdjustmentsOperation.prototype.availableOptions = {
  brightness: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, minValue: -1, midValue: 0, maxValue: 1 },
  saturation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  contrast: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  gamma: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1.0, minValue: 0.5, midValue: 1, maxValue: 2 },
  exposure: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  shadows: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -2, midValue: 0, maxValue: 2 },
  highlights: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  clarity: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  whites: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  blacks: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  temperature: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 },
  sharpness: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.0, minValue: -1, midValue: 0, maxValue: 1 }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.AdjustmentsOperation = AdjustmentsOperation;

/* harmony default export */ __webpack_exports__["a"] = (AdjustmentsOperation);

/***/ }),
/* 322 */
/***/ (function(module, exports) {

module.exports = "precision highp float;\n\nvarying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nuniform float u_gamma;\nuniform float u_shadows;\nuniform float u_highlights;\nuniform float u_whites;\nuniform float u_blacks;\n\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorOffset;\n\nconst float EPSILON = 0.0000001;\n\nfloat calculateLuminance(vec3 rgb) {\n    // This is the luminance calculation part of the RGB to HSL formular.\n    vec4 p = mix(\n        vec4(rgb.gb, 0.0, -1.0 / 3.0),\n        vec4(rgb.bg, -1.0, 2.0 / 3.0),\n        vec4(rgb.g < rgb.b)\n    );\n\n    vec4 q = mix(\n        vec4(rgb.r, p.yzx),\n        vec4(p.xyw, rgb.r),\n        vec4(rgb.r < p.x)\n    );\n\n    float croma = q.x - min(q.w, q.y);\n    float luminance = q.x - croma * 0.5;\n    return luminance;\n}\n\nvec3 map(vec3 x, float in_min, float in_max, float out_min, float out_max){\n  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\n}\n\nvoid main() {\n\n  vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);\n  color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha\n\n  // Apply gamma\n  if (u_gamma != 1.0) {\n    color.rgb = pow(color.rgb, vec3(1.0 / max(u_gamma, EPSILON)));\n  }\n\n  // Apply shadows and highlights\n  float luminance = calculateLuminance(color.rgb);\n\n  float shadow = u_shadows >= 0.0\n    ? clamp(\n          pow(luminance, 1.0 / (u_shadows + 1.0))\n          + pow(luminance, 2.0 / (u_shadows + 1.0)) * -0.76\n          - luminance\n    , 0.0, max(u_shadows, 1.0))\n    : -clamp(\n          pow(luminance, 1.0 / (-u_shadows + 1.0))\n          + pow(luminance, 2.0 / (-u_shadows + 1.0)) * -0.76\n          - luminance\n    , 0.0, max(-u_shadows, 1.0));\n\n  float highlight = u_highlights < 0.0\n    ? clamp(\n          1.0\n          - pow(1.0 - luminance, 1.0 / (1.0 - u_highlights))\n          - pow(1.0 - luminance, 2.0 / (1.0 - u_highlights)) * -0.8\n          - luminance\n     , -1.0, 0.0)\n    : -clamp(\n          1.0\n          - pow(1.0 - luminance, 1.0 / (1.0 + u_highlights))\n          - pow(1.0 - luminance, 2.0 / (1.0 + u_highlights)) * -0.8\n          - luminance\n     , -1.0, 0.0);\n\n  // Bright color need more contrast and dark color need more brightness.\n  // This is to keep saturatation because the color information of a dark colors is lost.\n  float shadowContrast   = shadow * luminance * luminance;\n  float shadowBrightness = shadow - shadowContrast;\n\n  float offset = luminance + shadowContrast + highlight;\n  color.rgb = clamp(offset * ((color.rgb + shadowBrightness) / max(luminance, EPSILON)), 0.0, 1.0);\n  \n  // Apply Color Matrix\n  color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;\n  color.rgb = map(color.rgb, 0.0, 1.0, u_blacks / 2.0, 1.0 + u_whites / 2.0);\n  color = clamp(color, 0.0, 1.0);\n  color.rgb *= color.a; // Reset premultiplied alpha\n\n  gl_FragColor = color;\n}\n";

/***/ }),
/* 323 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2,
    ColorMatrix = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].ColorMatrix;

var ClarityFilter = function (_Engine$Filter) {
  _inherits(ClarityFilter, _Engine$Filter);

  function ClarityFilter() {
    _classCallCheck(this, ClarityFilter);

    var _this = _possibleConstructorReturn(this, (ClarityFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ClarityFilter)).call(this));

    _this._fragmentSource = __webpack_require__(324);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer.
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(ClarityFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      // const inputDimensions = inputTarget.getDimensions()
      var outputContext = outputTarget.getContext();
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var clarity = this._options.clarity;
      var colorMatrix = this._options.colorMatrix;
      var colorOffset = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"](this._options.colorOffset[0], this._options.colorOffset[1], this._options.colorOffset[2], this._options.colorOffset[3]);
      var width = inputCanvas.width;
      var height = inputCanvas.height;
      var inputImageData = inputContext.getImageData(0, 0, width, height);
      var outputImageData = outputContext.createImageData(width, height);

      this.canvasShader(inputImageData, outputImageData, clarity, colorMatrix, colorOffset);

      outputContext.putImageData(outputImageData, 0, 0);
    }

    /**
     *
     *
     * @param {ImageData} inputImageData
     * @param {ImageData} outputImageData
     * @param {Number} clarity
     * @param {ColorMatrix} colorMatrix
     * @param {Color} colorOffset
     * @memberof ClarityFilter
     */

  }, {
    key: 'canvasShader',
    value: function canvasShader(inputImageData, outputImageData, clarity, colorMatrix, colorOffset) {
      var clamp = function clamp(x, minVal, maxVal) {
        return Math.min(Math.max(x, minVal), maxVal);
      };
      var smoothstep = function smoothstep(edge0, edge1, x) {
        var t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
        return t * t * (3.0 - 2.0 * t);
      };

      var stride = inputImageData.width * 4;
      var length = inputImageData.data.length;
      var maxIdx = length - 1;
      var minIdx = 0;
      var inData = inputImageData.data;
      var outData = outputImageData.data;

      var tmpColor = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"]();
      var divisor = 255 * 9;
      var sampleEdge = function sampleEdge(idx) {
        idx = idx < minIdx ? minIdx : idx;
        idx = idx > maxIdx ? maxIdx : idx;
        return inData[idx];
      };

      for (var idx = 0; idx < length; idx += 4) {
        var colorR = sampleEdge(idx + 0);
        var colorG = sampleEdge(idx + 1);
        var colorB = sampleEdge(idx + 2);
        var colorA = sampleEdge(idx + 3);

        var mergedR = (colorR + sampleEdge(idx - 4 - stride + 0) + sampleEdge(idx - 4 + 0) + sampleEdge(idx - 4 + stride + 0) + sampleEdge(idx - stride + 0) + sampleEdge(idx + stride + 0) + sampleEdge(idx + 4 - stride + 0) + sampleEdge(idx + 4 + 0) + sampleEdge(idx + 4 + stride)) / divisor;

        var mergedG = (colorG + sampleEdge(idx - 4 - stride + 1) + sampleEdge(idx - 4 + 1) + sampleEdge(idx - 4 + stride + 1) + sampleEdge(idx - stride + 1) + sampleEdge(idx + stride + 1) + sampleEdge(idx + 4 - stride + 1) + sampleEdge(idx + 4 + 1) + sampleEdge(idx + 4 + stride + 1)) / divisor;

        var mergedB = (colorB + sampleEdge(idx - 4 - stride + 2) + sampleEdge(idx - 4 + 2) + sampleEdge(idx - 4 + stride + 2) + sampleEdge(idx - stride + 2) + sampleEdge(idx + stride + 2) + sampleEdge(idx + 4 - stride + 2) + sampleEdge(idx + 4 + 2) + sampleEdge(idx + 4 + stride + 2)) / divisor;

        var mergedA = (colorA + sampleEdge(idx - 4 - stride + 3) + sampleEdge(idx - 4 + 3) + sampleEdge(idx - 4 + stride + 3) + sampleEdge(idx - stride + 3) + sampleEdge(idx + stride + 3) + sampleEdge(idx + 4 - stride + 3) + sampleEdge(idx + 4 + 3) + sampleEdge(idx + 4 + stride + 3)) / divisor;

        colorR /= 255;
        colorG /= 255;
        colorB /= 255;
        colorA /= 255;

        var grayValue = clamp(colorR * 0.3 + colorG * 0.59 + colorB * 0.1, 0.111111, 0.999999);

        var frequenceFactor = Math.min(smoothstep(1.0 - grayValue, 0.0, 0.11), smoothstep(grayValue, 0.0, 0.11));
        var scalar = clarity * 3.7 * frequenceFactor;
        var scale = Math.pow(2.0, clarity * 0.27 * frequenceFactor);
        var outR = clamp(colorR + clamp((colorR - mergedR) * scalar, 0.0, 10.0), 0.0, 1.0) * scale;
        var outG = clamp(colorG + clamp((colorG - mergedG) * scalar, 0.0, 10.0), 0.0, 1.0) * scale;
        var outB = clamp(colorB + clamp((colorB - mergedB) * scalar, 0.0, 10.0), 0.0, 1.0) * scale;
        var outA = clamp(colorA + clamp((colorA - mergedA) * scalar, 0.0, 10.0), 0.0, 1.0);

        tmpColor.set(outR, outG, outB, outA);

        var outColor = colorMatrix.apply(tmpColor).clamp(0, 1);

        outData[idx + 0] = outColor.r * 255;
        outData[idx + 1] = outColor.g * 255;
        outData[idx + 2] = outColor.b * 255;
        outData[idx + 3] = outColor.a * 255;
      }
    }
  }]);

  return ClarityFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

ClarityFilter.prototype.availableOptions = {
  clarity: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  pixelDimension: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 },
  colorMatrix: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR_MATRIX, default: new ColorMatrix(), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].MAT4 },
  colorOffset: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].ARRAY, default: [], uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT4 }
};

/* harmony default export */ __webpack_exports__["a"] = (ClarityFilter);

/***/ }),
/* 324 */
/***/ (function(module, exports) {

module.exports = "precision mediump float;\n\n// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE\nuniform sampler2D u_image;\n\n// Size of one pixel == vec2(1.0 / u_image.width, 1.0 / u_image.height)\nuniform vec2 u_pixelDimension;\n\n// Range (-1.0 - 1.0)\nuniform float u_clarity;\n\nvarying vec2 v_texCoord;\n\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorOffset;\n\nconst float EPSILON = 0.000001;\n\nvec4 unpremultiply(vec4 col) {\n    col.rgb /= max(col.a, EPSILON);\n    return col;\n}\n\nvoid main() {\n    vec4 color = texture2D(u_image, v_texCoord);\n    color = unpremultiply(color);\n\n    // L = Left, R = Right, C = Center, T = Top, B = Bottom\n    vec4 colLB = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x, -u_pixelDimension.y));\n    vec4 colLC = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,                 0.0));\n    vec4 colLT = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,  u_pixelDimension.y));\n\n    vec4 colCL = texture2D(u_image, v_texCoord + vec2(                0.0, -u_pixelDimension.y));\n    vec4 colCR = texture2D(u_image, v_texCoord + vec2(                0.0,  u_pixelDimension.y));\n    \n    vec4 colRB = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x, -u_pixelDimension.y));\n    vec4 colRC = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,                 0.0));\n    vec4 colRT = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,  u_pixelDimension.y));\n\n    vec4 mergedColor = color;\n    mergedColor.rgb += unpremultiply(colLB).rgb + unpremultiply(colLC).rgb + unpremultiply(colLT).rgb;\n    mergedColor.rgb += unpremultiply(colCL).rgb + unpremultiply(colCR).rgb;\n    mergedColor.rgb += unpremultiply(colRB).rgb + unpremultiply(colRC).rgb + unpremultiply(colRT).rgb;\n\n    mergedColor /= 9.0;\n\n    float grayValue = clamp(color.r * 0.3 + color.g * 0.59 + color.b * 0.1, 0.111111, 0.999999);\n    // 1.0 and 0.0 result in white not black, therefore we clamp\n\n    // Here we create a function that will map values below 0.1 to 0. Values above 0.2 will be mapped to 1,\n    // and for values between 0.1 and 0.2 it will produce a gradient.\n    // The funtion is mirror at 0.5, meaning values between 0.8 and 0.9 will result in a decending gradient.\n    // And values above 0.9 will be mapped to 0.\n    float frequenceFactor = min(smoothstep(1.0 - grayValue, 0.0, 0.11), smoothstep(grayValue, 0.0, 0.11));\n\n    // here we apply the high pass filter. Its strength is determined by the uniform ,\n    // and the frequence factor. That means the only the mid tones are affected by this filter.\n    // Clarity input is ranging from -1 to 1. But we want to strengthen the effect.\n    // Therefore we see this little magic number '3.7'.\n    color.rgb = clamp(color + clamp((color - mergedColor) * u_clarity * 3.7 * frequenceFactor, 0.0, 10.0), 0.0, 1.0).rgb;\n\n    // apply exposure but only to the mid tones.\n    color.rgb = color.rgb * pow(2.0, u_clarity * 0.27 * frequenceFactor);\n\n    // apply contrast and desaturation matrix\n    color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;\n\n    color.rgb *= color.a; // Premultiply alpha\n\n    gl_FragColor = clamp(color, 0.0, 1.0);\n}\n";

/***/ }),
/* 325 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector3 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector3;

var TemperatureFilter = function (_Engine$Filter) {
  _inherits(TemperatureFilter, _Engine$Filter);

  function TemperatureFilter() {
    _classCallCheck(this, TemperatureFilter);

    var _this = _possibleConstructorReturn(this, (TemperatureFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TemperatureFilter)).call(this));

    _this._fragmentSource = __webpack_require__(326);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer.
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(TemperatureFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var outputContext = outputTarget.getContext();
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var temperature = this._options.temperature;
      var width = inputCanvas.width;
      var height = inputCanvas.height;
      var inputImageData = inputContext.getImageData(0, 0, width, height);
      var outputImageData = outputContext.createImageData(width, height);

      this.canvasShader(inputImageData, outputImageData, temperature);

      outputContext.putImageData(outputImageData, 0, 0);
    }

    /**
     *
     *
     * @param {ImageData} inputImageData
     * @param {ImageData} outputImageData
     * @param {Number} clarity
     * @param {ColorMatrix} colorMatrix
     * @param {Color} colorOffset
     * @memberof ClarityFilter
     */

  }, {
    key: 'canvasShader',
    value: function canvasShader(inputImageData, outputImageData, temperature) {
      var clamp = function clamp(x, minVal, maxVal) {
        return Math.min(Math.max(x, minVal), maxVal);
      };
      var mix = function mix(x, y, a) {
        return x * (1.0 - a) + y * a;
      };

      var mat3Vec3DotProduct = function mat3Vec3DotProduct(mat3, vec3) {
        // mat 3 is column first
        var outX = mat3[0] * vec3[0] + mat3[3] * vec3[1] + mat3[6] * vec3[2];
        var outY = mat3[1] * vec3[0] + mat3[4] * vec3[1] + mat3[7] * vec3[2];
        var outZ = mat3[2] * vec3[0] + mat3[5] * vec3[1] + mat3[8] * vec3[2];
        return [outX, outY, outZ];
      };

      var length = inputImageData.data.length;
      var maxIdx = length - 1;
      var minIdx = 0;
      var inData = inputImageData.data;
      var outData = outputImageData.data;

      var sampleEdge = function sampleEdge(idx) {
        idx = idx < minIdx ? minIdx : idx;
        idx = idx > maxIdx ? maxIdx : idx;
        return inData[idx];
      };

      var warmFilter = [0.93, 0.54, 0.0];

      var RGBtoYIQ = [0.299, 0.587, 0.114, // 1 column
      0.596, -0.274, -0.322, // 2 column
      0.212, -0.523, 0.311]; // 3 column

      var YIQtoRGB = [1.0, 0.956, 0.621, 1.0, -0.272, -0.647, 1.0, -1.105, 1.702];

      var tint = 0.0;
      for (var idx = 0; idx < length; idx += 4) {
        var colorR = sampleEdge(idx + 0) / 255.0;
        var colorG = sampleEdge(idx + 1) / 255.0;
        var colorB = sampleEdge(idx + 2) / 255.0;
        var colorA = sampleEdge(idx + 3) / 255.0;

        var source = [colorR, colorG, colorB];
        var yiq = mat3Vec3DotProduct(RGBtoYIQ, source);
        yiq.z = clamp(yiq.z + tint * 0.5226 * 0.1, -0.5226, 0.5226);
        var rgb = mat3Vec3DotProduct(YIQtoRGB, yiq);

        var processed = [rgb[0] < 0.5 ? 2.0 * rgb[0] * warmFilter[0] : 1.0 - 2.0 * (1.0 - rgb[0]) * (1.0 - warmFilter[0]), rgb[1] < 0.5 ? 2.0 * rgb[1] * warmFilter[1] : 1.0 - 2.0 * (1.0 - rgb[1]) * (1.0 - warmFilter[1]), rgb[2] < 0.5 ? 2.0 * rgb[2] * warmFilter[2] : 1.0 - 2.0 * (1.0 - rgb[2]) * (1.0 - warmFilter[2])];

        outData[idx + 0] = mix(rgb[0], processed[0], temperature) * 255;
        outData[idx + 1] = mix(rgb[1], processed[1], temperature) * 255;
        outData[idx + 2] = mix(rgb[2], processed[2], temperature) * 255;
        outData[idx + 3] = colorA * 255;
      }
    }
  }]);

  return TemperatureFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

TemperatureFilter.prototype.availableOptions = {
  temperature: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }
};

/* harmony default export */ __webpack_exports__["a"] = (TemperatureFilter);

/***/ }),
/* 326 */
/***/ (function(module, exports) {

module.exports = "precision mediump float;\n\n// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE\nuniform sampler2D u_image;\n\n// Range (-1.0 - 1.0)\nuniform float u_temperature;\n\nconst lowp vec3 warmFilter = vec3(0.93, 0.54, 0.0);\n\nconst mediump mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.596, -0.274, -0.322, 0.212, -0.523, 0.311);\nconst mediump mat3 YIQtoRGB = mat3(1.0, 0.956, 0.621, 1.0, -0.272, -0.647, 1.0, -1.105, 1.702);\n\nconst float EPSILON = 0.0000001;\n\nvarying vec2 v_texCoord;\nvoid main() {\n  float temperature = u_temperature;\n  const float tint = 0.0;\n  vec4 source = texture2D(u_image, v_texCoord);\n\n  source.rgb /= max(source.a, EPSILON);   // Revert premultiplied alpha\n\n  vec3 yiq = RGBtoYIQ * source.rgb;\n  yiq.b = clamp(yiq.b + tint*0.5226*0.1, -0.5226, 0.5226);\n  vec3 rgb = YIQtoRGB * yiq;\n\n  vec3 processed = mix(\n    (1.0 - 2.0 * (1.0 - rgb) * (1.0 - warmFilter)),\n    (2.0 * rgb * warmFilter),\n    vec3(rgb.r < 0.5, rgb.g < 0.5, rgb.b < 0.5)\n  );\n\n  vec4 color = vec4(mix(rgb, processed, temperature), source.a);\n\n  color.rgb *= color.a;   // Premultiply alpha again\n\n  gl_FragColor = color;\n}\n";

/***/ }),
/* 327 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

var SharpnessFilter = function (_Engine$Filter) {
  _inherits(SharpnessFilter, _Engine$Filter);

  function SharpnessFilter() {
    _classCallCheck(this, SharpnessFilter);

    var _this = _possibleConstructorReturn(this, (SharpnessFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(SharpnessFilter)).call(this));

    _this._fragmentSource = __webpack_require__(328);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer.
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(SharpnessFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var outputContext = outputTarget.getContext();
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var sharpness = this._options.sharpness;
      var width = inputCanvas.width;
      var height = inputCanvas.height;
      var inputImageData = inputContext.getImageData(0, 0, width, height);
      var outputImageData = outputContext.createImageData(width, height);

      this.canvasShader(inputImageData, outputImageData, sharpness);

      outputContext.putImageData(outputImageData, 0, 0);
    }

    /**
     * Applies this filter to the given inputImageData and stores the result
     * in the given outputImageData using the CanvasRenderer.
     *
     * @param {ImageData} inputImageData
     * @param {ImageData} outputImageData
     * @param {Number} sharpness
     * @memberof ClarityFilter
     */

  }, {
    key: 'canvasShader',
    value: function canvasShader(inputImageData, outputImageData, sharpness) {
      var clamp = function clamp(x, minVal, maxVal) {
        return Math.min(Math.max(x, minVal), maxVal);
      };

      var EPSILON = 0.000001;

      var width = inputImageData.width;
      var height = inputImageData.height;
      var inData = inputImageData.data;
      var outData = outputImageData.data;

      var mix = function mix(x, y, a) {
        return x * (1 - a) + y * a;
      };

      var sample = function sample(idx) {
        return clamp(inData[idx] / 255, 0, 1);
      };

      var clampedIndex = function clampedIndex(x, y) {
        var sampleX = clamp(x, 0, width - 1);
        var sampleY = clamp(y, 0, height - 1);
        return 4 * (sampleX + width * sampleY);
      };

      var color = [];
      var sharpenedColor = [];
      var dXOffsets = [-1, 0, 0, 1];
      var dYOffsets = [0, -1, 1, 0];

      var factor = sharpness > 0 ? -1.0 : 0.2;
      var totalWeight = sharpness > 0 ? 5.0 : 0.2;
      var absSharpness = Math.abs(sharpness);

      for (var x = 0; x < width; x++) {
        for (var y = 0; y < height; y++) {
          var idx = clampedIndex(x, y);

          color[0] = sample(idx + 0); // R
          color[1] = sample(idx + 1); // G
          color[2] = sample(idx + 2); // B
          color[3] = sample(idx + 3); // A

          // Since the GLSL Shader performs the following computations with
          // premultiplied colors, we need to premultiply here as well

          sharpenedColor[0] = totalWeight * color[0] * color[3];
          sharpenedColor[1] = totalWeight * color[1] * color[3];
          sharpenedColor[2] = totalWeight * color[2] * color[3];
          sharpenedColor[3] = totalWeight * color[3];

          for (var i = 0; i < 4; i++) {
            var dX = dXOffsets[i];
            var dY = dYOffsets[i];
            var offsetIndex = clampedIndex(x + dX, y + dY);
            var tempA = sample(offsetIndex + 3);
            sharpenedColor[3] += factor * tempA;
            // Premultiply RGB channels
            for (var c = 0; c < 3; c++) {
              sharpenedColor[c] += factor * sample(offsetIndex + c) * tempA;
            }
          }

          // Unpremultiply
          for (var _i = 0; _i < 3; _i++) {
            sharpenedColor[_i] /= Math.max(sharpenedColor[3], EPSILON);
            sharpenedColor[_i] = clamp(sharpenedColor[_i], 0, 1);
          }
          sharpenedColor[3] = clamp(sharpenedColor[3], 0, 1);

          // Calculate the final sharpened output color
          for (var _i2 = 0; _i2 < 4; _i2++) {
            color[_i2] = clamp(mix(color[_i2], sharpenedColor[_i2], absSharpness), 0, 1);
            outData[idx + _i2] = color[_i2] * 255;
          }
        }
      }
    }
  }]);

  return SharpnessFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

SharpnessFilter.prototype.availableOptions = {
  sharpness: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT },
  pixelDimension: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT2 }
};

/* harmony default export */ __webpack_exports__["a"] = (SharpnessFilter);

/***/ }),
/* 328 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform vec2 u_pixelDimension;\nuniform float u_sharpness;\n \nconst float EPSILON = 0.000001;\n \nvoid main() {\n    vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);\n\n    float factor        = mix(0.2, -1.0, float(u_sharpness > 0.0));\n    vec4 sharpenedColor = mix(0.2,  5.0, float(u_sharpness > 0.0)) * color;\n \n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2(-1.0,  0.0)), 0.0, 1.0);\n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0, -1.0)), 0.0, 1.0);\n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0,  1.0)), 0.0, 1.0);\n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 1.0,  0.0)), 0.0, 1.0);\n \n    color.rgb /= max(color.a, EPSILON); // unpremultiply\n    sharpenedColor.rgb /= max(sharpenedColor.a, EPSILON); // unpremultiply\n \n    sharpenedColor = clamp(sharpenedColor, 0.0, 1.0);\n \n    color = clamp(mix(color, sharpenedColor, abs(u_sharpness)), 0.0, 1.0);\n      \n    gl_FragColor = vec4(color.rgb * color.a, color.a); // premultiply\n}";

/***/ }),
/* 329 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_filters_blur_filter__ = __webpack_require__(73);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a radial focus
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var BlurOperation = function (_Operation) {
  _inherits(BlurOperation, _Operation);

  /**
   * Creates a new BlurOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function BlurOperation() {
    var _ref;

    _classCallCheck(this, BlurOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = BlurOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BlurOperation)).call.apply(_ref, [this].concat(args)));

    _this._lastBlurRadius = _this._options.blurRadius;

    var blurOption = {
      blurQuality: {
        type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING
      }
    };

    _this._horizontalFilter = new __WEBPACK_IMPORTED_MODULE_6__shared_filters_blur_filter__["a" /* default */]({}, blurOption);
    _this._verticalFilter = new __WEBPACK_IMPORTED_MODULE_6__shared_filters_blur_filter__["a" /* default */]({}, blurOption);
    _this._sprite.setFilters([_this._horizontalFilter, _this._verticalFilter]);

    _this._horizontalFilter.setDelta(new Vector2(0.5, 0.5));
    _this._verticalFilter.setDelta(new Vector2(-0.5, 0.5));

    _this._filter = new __WEBPACK_IMPORTED_MODULE_6__shared_filters_blur_filter__["a" /* default */]({}, blurOption);
    return _this;
  }

  /**
   * Renders the radial blur using WebGL
   * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
   * @private
   * @override
   */
  /* istanbul ignore next */


  _createClass(BlurOperation, [{
    key: '_renderWebGL',
    value: function _renderWebGL(inputTexture) {
      return this._renderBlur(inputTexture);
    }

    /**
     * Renders the radial blur using Canvas2D
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     * @override
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(inputTexture) {
      if (this._options.highQualityCanvasBlur) {
        return this._renderBlur(inputTexture);
      } else {
        return this._renderLQCanvasBlur(inputTexture);
      }
    }

    /**
     * Renders a high quality blur
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     * @override
     */

  }, {
    key: '_renderBlur',
    value: function _renderBlur(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();
      var shortestSide = inputDimensions.min();

      var blurRadius = this._options.blurRadius;


      var commonOptions = {
        blurRadius: blurRadius * shortestSide,
        texSize: inputDimensions,
        blurQuality: 'high'
      };

      this._horizontalFilter.set(commonOptions);
      this._verticalFilter.set(commonOptions);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Renders a low quality blur using Canvas2D
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderLQCanvasBlur',
    value: function _renderLQCanvasBlur(inputTexture) {
      var blurRadius = this._options.blurRadius;

      var inputDimensions = inputTexture.getDimensions();

      this._filter.set({
        blurRadius: blurRadius,
        texSize: inputDimensions,
        blurQuality: 'low'
      });

      this._sprite.setFilters([this._filter]);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'transform',
    value: function transform(transformChange) {
      var size = this.getBlurRadius();
      var blurRadius = transformChange.applyToRelativeSize(size);

      this.set({ blurRadius: blurRadius }, false);
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(BlurOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(BlurOperation.prototype), 'dispose', this).call(this);
      this._filter.dispose();
      this._verticalFilter.dispose();
      this._horizontalFilter.dispose();
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return true;
    }
  }]);

  return BlurOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


BlurOperation.identifier = 'blur';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
BlurOperation.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 },
  highQualityCanvasBlur: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.BlurOperation = BlurOperation;

/* harmony default export */ __webpack_exports__["a"] = (BlurOperation);

/***/ }),
/* 330 */
/***/ (function(module, exports) {

module.exports = "/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n    float radius = u_blurRadius;\n\n    const float steps = 30.0;\n\n    for (float t = -steps; t <= steps; t++) {\n        float percent = (t + offset - 0.5) / steps;\n        float weight = 1.0 - abs(percent);\n\n        // Somehow `sample` is a keyword in headless-gl\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n}\n";

/***/ }),
/* 331 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__filters_identity_filter__ = __webpack_require__(173);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__filters_primitives__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__filters__ = __webpack_require__(364);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__filters_filter__ = __webpack_require__(7);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */







/**
 * An operation that can apply a selected filter
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var FilterOperation = function (_Operation) {
  _inherits(FilterOperation, _Operation);

  function FilterOperation() {
    _classCallCheck(this, FilterOperation);

    return _possibleConstructorReturn(this, (FilterOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(FilterOperation)).apply(this, arguments));
  }

  _createClass(FilterOperation, [{
    key: '_render',

    /**
     * Renders this operation
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @return {Promise}
     * @private
     */
    value: function _render(inputTexture) {
      return this._selectedFilter.render(this._sdk, inputTexture, this._renderTexture);
    }

    /**
     * Applies this operation
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @return {Promise}
     * @override
     */

  }, {
    key: 'render',
    value: function render(inputTexture) {
      if (this._selectedFilter.getDirty()) {
        this.setDirty(true);
      }

      if (!this.getEnabled()) {
        this.setDirtyForRenderer(false, this._sdk.getRenderer());
        return __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Promise"].resolve(inputTexture);
      }

      return _get(FilterOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(FilterOperation.prototype), 'render', this).call(this, inputTexture);
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @override
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {
      _get(FilterOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(FilterOperation.prototype), 'setDirtyForRenderer', this).call(this, dirty, renderer);
      this._selectedFilter.setDirtyForRenderer(dirty, renderer);
    }

    /**
     * Frees the memory
     */

  }, {
    key: 'disposeRenderTextures',
    value: function disposeRenderTextures() {
      _get(FilterOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(FilterOperation.prototype), 'disposeRenderTextures', this).call(this);
      if (this._selectedFilter) {
        this._selectedFilter.disposeRenderTextures();
      }
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(FilterOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(FilterOperation.prototype), 'dispose', this).call(this);
      if (this._selectedFilter) {
        this._selectedFilter.dispose();
      }
    }
  }, {
    key: 'restoreSnapshot',
    value: function restoreSnapshot(serializedOptions) {
      var options = _extends({}, serializedOptions);
      delete options.filter;

      if (serializedOptions.filter) {
        var FilterConstructor = serializedOptions.filter.constructor;
        if (FilterConstructor.identifier === '3d-lut') {
          this.setFilter(new FilterConstructor({
            image: serializedOptions.filter.getImage(),
            resolution: serializedOptions.filter.getResolution(),
            horizontalTileCount: serializedOptions.filter.getHorizontalTileCount(),
            verticalTileCount: serializedOptions.filter.getVerticalTileCount()
          }));
        } else if (FilterConstructor.identifier === 'duotone') {
          this.setFilter(new FilterConstructor({
            lightColor: serializedOptions.filter.getLightColor(),
            darkColor: serializedOptions.filter.getDarkColor(),
            intensity: serializedOptions.filter.getIntensity()
          }));
        } else {
          this.setFilter(new FilterConstructor());
        }
      }
      this.set(options);
    }
  }, {
    key: 'resetToDefaultFilterIntensity',
    value: function resetToDefaultFilterIntensity() {
      var filterOptions = this._selectedFilter && this._selectedFilter.availableOptions;
      var defaultIntensity = filterOptions && filterOptions.intensity.default;
      this.setIntensity(defaultIntensity || 1.0);
    }
  }]);

  return FilterOperation;
}(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


FilterOperation.identifier = 'filter';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
FilterOperation.prototype.availableOptions = {
  identifier: {
    type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING,
    default: 'identity'
  },
  intensity: {
    type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER,
    default: 1,
    setter: function setter(intensity) {
      this._selectedFilter && this._selectedFilter.setIntensity(intensity);
      return intensity;
    }
  },
  filter: {
    type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].OBJECT,
    default: new __WEBPACK_IMPORTED_MODULE_7__filters_identity_filter__["a" /* default */](),
    setter: function setter(Filter) {
      if (this._selectedFilter) {
        this._selectedFilter.dispose();
        this._selectedFilter = null;
      }

      this._selectedFilter = Filter;
      if (typeof this._options.intensity !== 'undefined') {
        this._selectedFilter.set({
          intensity: this._options.intensity
        });
      }
      return Filter;
    }
  }
};

FilterOperation.FilterPrimitives = __WEBPACK_IMPORTED_MODULE_8__filters_primitives__;
FilterOperation.Filters = __WEBPACK_IMPORTED_MODULE_9__filters__;
FilterOperation.Filter = __WEBPACK_IMPORTED_MODULE_10__filters_filter__["a" /* default */];
__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default.a.Operations.FilterOperation = FilterOperation;

/* harmony default export */ __webpack_exports__["a"] = (FilterOperation);

/***/ }),
/* 332 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var BlendFilter = function (_Engine$Filter) {
  _inherits(BlendFilter, _Engine$Filter);

  function BlendFilter() {
    _classCallCheck(this, BlendFilter);

    var _this = _possibleConstructorReturn(this, (BlendFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(BlendFilter)).call(this));

    _this._fragmentSource = __webpack_require__(333);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {PhotoEditorSDK.Engine.CanvasRenderer} renderer
   * @param  {PhotoEditorSDK.Engine.RenderTarget} inputTarget
   * @param  {PhotoEditorSDK.Engine.RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(BlendFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var outputContext = outputTarget.getContext();

      var filteredCanvas = this._options.filteredCanvas;


      outputContext.save();
      outputContext.globalAlpha = 1 - this._options.intensity;
      outputContext.drawImage(canvas, 0, 0);
      outputContext.globalAlpha = this._options.intensity;
      outputContext.drawImage(filteredCanvas, 0, 0);
      outputContext.restore();
    }
  }]);

  return BlendFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

BlendFilter.prototype.availableOptions = {
  filteredImage: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].INT },
  filteredCanvas: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: null },
  intensity: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * A helper class that can collect {@link Primitive} instances and render
   * the stack
   * @class
   * @memberof PhotoEditorSDK.Operations.FilterOperation.Filter
   */
};
var PrimitivesStack = function () {
  function PrimitivesStack() {
    var intensity = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;

    _classCallCheck(this, PrimitivesStack);

    this._intensity = intensity;

    this._stack = [];
    this._dirtiness = {};
    this._renderTextures = {};
    this._container = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Container();
    this._sprite = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Sprite();
    this._container.addChild(this._sprite);

    this._blendFilter = new BlendFilter();
  }

  /**
   * Adds the given primitive to the stack
   * @param {PhotoEditorSDK.Operations.FilterOperation.Filter.Primitive} primitive
   */


  _createClass(PrimitivesStack, [{
    key: 'push',
    value: function push(primitive) {
      this._stack.push(primitive);
    }

    /**
     * Clears the stack
     */

  }, {
    key: 'clear',
    value: function clear() {
      this._stack = [];
    }

    /**
     * Renders this stack
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @param  {PhotoEditorSDK.Engine.RenderTexture} outputTexture
     * @return {Promise}
     * @description This takes the output sprite's current texture and renders
     *              it to this stack's internal render texture. It then uses the
     *              internal texture as a uniform for a blend shader and renders
     *              the sprite with the original texture and the blend shader to
     *              the outputTexture
     */

  }, {
    key: 'render',
    value: function render(sdk, inputTexture, outputTexture) {
      if (this.isEmpty()) {
        return __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Promise"].resolve();
      }
      var renderer = sdk.getRenderer();

      this._sprite.setTexture(inputTexture);

      // Make sure we have a RenderTexture we can render the filtered image to
      var filteredRenderTexture = this._renderTextures[renderer.id];
      if (!filteredRenderTexture) {
        var frame = sdk.getSprite().getTexture().getFrame();
        filteredRenderTexture = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].RenderTexture(sdk.getRenderer(), frame.width, frame.height);
        this._renderTextures[renderer.id] = filteredRenderTexture;
      }

      // Resize filtered render texture to output texture dimensions
      var textureDimensions = outputTexture.getDimensions();
      filteredRenderTexture.resizeTo(textureDimensions);

      var shouldRender = this.isDirtyForRenderer(renderer);
      if (shouldRender) {
        // Update primitives
        this._stack.forEach(function (p) {
          p.update(sdk);
        });

        // Set filters
        var filters = this._stack.map(function (p) {
          return p.getFilter();
        });
        this._sprite.setFilters(filters);

        // Render to RenderTexture
        filteredRenderTexture.render(this._container);
        this.setDirtyForRenderer(false, renderer);
      }

      // Use filteredRenderTexture as uniform for blend shader, blend the two
      // to achieve intensity
      this._blendFilter.setIntensity(this._intensity);
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["RendererType"].CANVAS)) {
        this._blendFilter.setFilteredCanvas(filteredRenderTexture.getRenderTarget().getCanvas());
      } else if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["RendererType"].WEBGL)) {
        var baseTexture = filteredRenderTexture.getBaseTexture();
        baseTexture.setGLUnit(this._blendFilter.getFilteredImage());
        renderer.updateTexture(baseTexture, false);
      }
      this._sprite.setFilters([this._blendFilter]);

      outputTexture.clear(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].TRANSPARENT);
      outputTexture.render(this._container);

      if (shouldRender) {
        this.disposeRenderTextures();
      }

      return __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Promise"].resolve();
    }
  }, {
    key: 'setIntensity',
    value: function setIntensity(intensity) {
      this._intensity = intensity;
    }

    /**
     * Returns whether this stack is empty
     * @returns {Boolean}
     */

  }, {
    key: 'isEmpty',
    value: function isEmpty() {
      return this._stack.length === 0;
    }

    /**
     * Checks if this operation is dirty for the given renderer
     * @param  {PhotoEditorSDK.Engine.BaseRenderer}  renderer
     * @return {Boolean}
     */

  }, {
    key: 'isDirtyForRenderer',
    value: function isDirtyForRenderer(renderer) {
      if (!(renderer.id in this._dirtiness)) {
        this._dirtiness[renderer.id] = true;
      }
      return this._dirtiness[renderer.id];
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer) {
      this._dirtiness[renderer.id] = dirty;
    }

    /**
     * Sets the dirtiness for all renderers
     * @param {Boolean} dirty
     */

  }, {
    key: 'setDirty',
    value: function setDirty(dirty) {
      for (var rendererId in this._dirtiness) {
        this._dirtiness[rendererId] = dirty;
      }
    }

    /**
     * Disposes the render textures, frees some memory
     */

  }, {
    key: 'disposeRenderTextures',
    value: function disposeRenderTextures() {
      for (var rendererId in this._renderTextures) {
        this._renderTextures[rendererId].dispose();
        delete this._renderTextures[rendererId];
      }
    }

    /**
     * Cleans up this instance
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this.disposeRenderTextures();
      this._stack.forEach(function (primitive) {
        return primitive.dispose();
      });
      this._stack = [];
      this._blendFilter.dispose();

      this._sprite.dispose();
    }
  }]);

  return PrimitivesStack;
}();

/* harmony default export */ __webpack_exports__["a"] = (PrimitivesStack);

/***/ }),
/* 333 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_filteredImage;\nuniform float u_intensity;\n\nvoid main() {\n  vec4 color0 = texture2D(u_image, v_texCoord);\n  vec4 color1 = texture2D(u_filteredImage, v_texCoord);\n  gl_FragColor = mix(color0, color1, u_intensity);\n}\n";

/***/ }),
/* 334 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var BrightnessFilter = function (_Engine$Filter) {
  _inherits(BrightnessFilter, _Engine$Filter);

  function BrightnessFilter() {
    _classCallCheck(this, BrightnessFilter);

    var _this = _possibleConstructorReturn(this, (BrightnessFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(BrightnessFilter)).call(this));

    _this._fragmentSource = __webpack_require__(335);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(BrightnessFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var brightness = this._options.brightness;


      if (brightness === 0) {
        outputContext.putImageData(imageData, 0, 0);
        return;
      }
      brightness = brightness * 255;

      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;
        imageData.data[index] += brightness;
        imageData.data[index + 1] += brightness;
        imageData.data[index + 2] += brightness;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return BrightnessFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


BrightnessFilter.prototype.availableOptions = {
  brightness: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * Brightness primitive
   * @class
   * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
   * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
   */
};
var Brightness = function (_Primitive) {
  _inherits(Brightness, _Primitive);

  function Brightness() {
    var _ref;

    _classCallCheck(this, Brightness);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Brightness.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Brightness)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new BrightnessFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(Brightness, [{
    key: 'update',
    value: function update() {
      this._filter.setBrightness(this._options.brightness);
    }
  }]);

  return Brightness;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


Brightness.prototype.availableOptions = BrightnessFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Brightness);

/***/ }),
/* 335 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_brightness;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;\n}\n";

/***/ }),
/* 336 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var ContrastFilter = function (_Engine$Filter) {
  _inherits(ContrastFilter, _Engine$Filter);

  function ContrastFilter() {
    _classCallCheck(this, ContrastFilter);

    var _this = _possibleConstructorReturn(this, (ContrastFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ContrastFilter)).call(this));

    _this._fragmentSource = __webpack_require__(337);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(ContrastFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var contrast = this._options.contrast;

      if (contrast === 1) {
        return;
      }

      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;
        imageData.data[index] = (imageData.data[index] - 127) * contrast + 127;
        imageData.data[index + 1] = (imageData.data[index + 1] - 127) * contrast + 127;
        imageData.data[index + 2] = (imageData.data[index + 2] - 127) * contrast + 127;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return ContrastFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


ContrastFilter.prototype.availableOptions = {
  contrast: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * Contrast primitive
   * @class
   * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
   * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
   */
};
var Contrast = function (_Primitive) {
  _inherits(Contrast, _Primitive);

  function Contrast() {
    var _ref;

    _classCallCheck(this, Contrast);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Contrast.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Contrast)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new ContrastFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(Contrast, [{
    key: 'update',
    value: function update() {
      this._filter.setContrast(this._options.contrast);
    }
  }]);

  return Contrast;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


Contrast.prototype.availableOptions = ContrastFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Contrast);

/***/ }),
/* 337 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_contrast;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);\n}\n";

/***/ }),
/* 338 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var ColorMatrix = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].ColorMatrix;

var ColorMatrixFilter = function (_Engine$Filter) {
  _inherits(ColorMatrixFilter, _Engine$Filter);

  function ColorMatrixFilter() {
    _classCallCheck(this, ColorMatrixFilter);

    var _this = _possibleConstructorReturn(this, (ColorMatrixFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ColorMatrixFilter)).call(this));

    _this._fragmentSource = __webpack_require__(339);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(ColorMatrixFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var colorMatrix = this._options.colorMatrix;

      var color = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"](0, 0, 0, 0);

      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;
        color.r = imageData.data[index] / 255;
        color.g = imageData.data[index + 1] / 255;
        color.b = imageData.data[index + 2] / 255;
        color = colorMatrix.apply(color);
        imageData.data[index] = color.r * 255;
        imageData.data[index + 1] = color.g * 255;
        imageData.data[index + 2] = color.b * 255;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return ColorMatrixFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


ColorMatrixFilter.prototype.availableOptions = {
  colorMatrix: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR_MATRIX, default: new ColorMatrix(), uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].MAT4 },
  colorMatrixOffset: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].ARRAY, default: [], uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT4 }

  /**
   * ColorMatrix primitive
   * @class
   * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
   * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
   */
};
var ColorMatrixPrimitive = function (_Primitive) {
  _inherits(ColorMatrixPrimitive, _Primitive);

  function ColorMatrixPrimitive() {
    var _ref;

    _classCallCheck(this, ColorMatrixPrimitive);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = ColorMatrixPrimitive.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ColorMatrixPrimitive)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new ColorMatrixFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(ColorMatrixPrimitive, [{
    key: 'update',
    value: function update() {
      this._filter.setColorMatrix(this._options.colorMatrix);
    }
  }]);

  return ColorMatrixPrimitive;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


ColorMatrixPrimitive.prototype.availableOptions = ColorMatrixFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (ColorMatrixPrimitive);

/***/ }),
/* 339 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorMatrixOffset;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = texColor * u_colorMatrix + u_colorMatrixOffset;\n}\n";

/***/ }),
/* 340 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var DesaturationFilter = function (_Engine$Filter) {
  _inherits(DesaturationFilter, _Engine$Filter);

  function DesaturationFilter() {
    _classCallCheck(this, DesaturationFilter);

    var _this = _possibleConstructorReturn(this, (DesaturationFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(DesaturationFilter)).call(this));

    _this._fragmentSource = __webpack_require__(341);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(DesaturationFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var grayXfer = [0.3, 0.59, 0.11];
      var desaturation = this._options.desaturation;


      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;
        var gray = grayXfer[0] * imageData.data[index] / 255 + grayXfer[1] * imageData.data[index + 1] / 255 + grayXfer[2] * imageData.data[index + 2] / 255;

        imageData.data[index] += (gray * 255 - imageData.data[index]) * desaturation;
        imageData.data[index + 1] += (gray * 255 - imageData.data[index + 1]) * desaturation;
        imageData.data[index + 2] += (gray * 255 - imageData.data[index + 2]) * desaturation;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return DesaturationFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


DesaturationFilter.prototype.availableOptions = {
  desaturation: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * Desaturation primitive
   * @class
   * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
   * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
   */
};
var Desaturation = function (_Primitive) {
  _inherits(Desaturation, _Primitive);

  function Desaturation() {
    var _ref;

    _classCallCheck(this, Desaturation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Desaturation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Desaturation)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new DesaturationFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(Desaturation, [{
    key: 'update',
    value: function update() {
      this._filter.setDesaturation(this._options.desaturation);
    }
  }]);

  return Desaturation;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


Desaturation.prototype.availableOptions = DesaturationFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Desaturation);

/***/ }),
/* 341 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_desaturation;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec3 grayXfer = vec3(0.3, 0.59, 0.11);\n  vec3 gray = vec3(dot(grayXfer, texColor.xyz));\n  gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);\n}\n";

/***/ }),
/* 342 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/*
* This file is part of PhotoEditorSDK.
*
* Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
* All rights reserved.
*
* Redistribution and use in source and binary forms, without
* modification, are permitted provided that the following license agreement
* is approved and a legal/financial contract was signed by the user.
* The license agreement can be found under following link:
*
* https://www.photoeditorsdk.com/LICENSE.txt
*/




var DuoToneFilter = function (_Engine$Filter) {
  _inherits(DuoToneFilter, _Engine$Filter);

  function DuoToneFilter() {
    _classCallCheck(this, DuoToneFilter);

    var _this = _possibleConstructorReturn(this, (DuoToneFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(DuoToneFilter)).call(this));

    _this._fragmentSource = __webpack_require__(343);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param {CanvasRenderer} renderer
   * @param {RenderTarget} inputTarget
   * @param {RenderTarget} outputTarget
   * @param {Boolear} clear = false
   */


  _createClass(DuoToneFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var _options = this._options,
          lightColor = _options.lightColor,
          darkColor = _options.darkColor,
          intensity = _options.intensity;


      for (var i = 0; i < canvas.width * canvas.height; i++) {
        var index = i * 4;

        var r = imageData.data[index] / 255;
        var g = imageData.data[index + 1] / 255;
        var b = imageData.data[index + 2] / 255;
        var a = imageData.data[index + 3] / 255;

        var color = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"](r, g, b, a);
        var duotone = this._duoToneKernel(color, lightColor, darkColor, intensity);

        imageData.data[index] = duotone.r * 255;
        imageData.data[index + 1] = duotone.g * 255;
        imageData.data[index + 2] = duotone.b * 255;
        imageData.data[index + 3] = duotone.a * 255;
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }, {
    key: '_duoToneKernel',
    value: function _duoToneKernel(color, light, dark, intensity) {
      var EPSILON = 0.0000001;

      color.clone().clamp(0, 1);

      // Apply intensity as "symmetric gamma"
      if (intensity > 0.0) {
        var exp = Math.max(intensity + 1.0, EPSILON);
        color.r = 1.0 - Math.pow(1.0 - color.r, exp);
        color.g = 1.0 - Math.pow(1.0 - color.g, exp);
        color.b = 1.0 - Math.pow(1.0 - color.b, exp);
      } else {
        var _exp = Math.max(-intensity + 1.0, EPSILON);
        color.r = Math.pow(color.r, _exp);
        color.g = Math.pow(color.g, _exp);
        color.b = Math.pow(color.b, _exp);
      }

      // Colorimetric (perceptual luminance-preserving) RGB to grayscale conversion
      // https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale
      var luminance = 0.2126 * color.r + 0.7152 * color.g + 0.0722 * color.b;

      // Apply DuoTone
      var clampedLuminance = Math.min(Math.max(luminance, 0), 1);
      var duotone = dark.clone().mix(light, clampedLuminance);
      duotone.a *= color.a;

      return duotone;
    }
  }]);

  return DuoToneFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
* Specifies the available options for this filter
* @type {Object}
* @ignore
*/


DuoToneFilter.prototype.availableOptions = {
  lightColor: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].RED, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT4 },
  darkColor: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].BLACK, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT4 },
  intensity: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.5, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
  * DuoTone primitive
  * @class
  * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
  * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
  */
};
var DuoTone = function (_Primitive) {
  _inherits(DuoTone, _Primitive);

  function DuoTone() {
    var _ref;

    _classCallCheck(this, DuoTone);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = DuoTone.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(DuoTone)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new DuoToneFilter();
    return _this2;
  }

  /**
  * Updates the filter's uniforms
  */


  _createClass(DuoTone, [{
    key: 'update',
    value: function update() {
      this._filter.setLightColor(this._options.lightColor);
      this._filter.setDarkColor(this._options.darkColor);

      // Remap shader input from [0,1] to [-1,1]
      var shaderIntensity = 2.0 * this._options.intensity - 1.0;
      this._filter.setIntensity(shaderIntensity);
    }
  }]);

  return DuoTone;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
* Specifies the available options for this primitive
* @type {Object}
* @ignore
*/


DuoTone.prototype.availableOptions = DuoToneFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (DuoTone);

/***/ }),
/* 343 */
/***/ (function(module, exports) {

module.exports = "precision highp float;\n\nuniform sampler2D u_image;\nuniform vec4 u_lightColor;\nuniform vec4 u_darkColor;\nuniform float u_intensity;\nvarying vec2 v_texCoord;\n\nconst float EPSILON = 0.0000001;\nconst vec3 GRAYSCALE_WEIGHTS = vec3(0.2126, 0.7152, 0.0722);\n\nvec4 duotoneKernel(vec4 sampledCol, vec4 light, vec4 dark, float intensity) {\n  vec4 color = clamp(sampledCol, 0.0, 1.0);\n  color.rgb /= max(color.a, EPSILON);\n  color = clamp(color, 0.0, 1.0); // necessary to get rid of all extended sRGB issues with OpenGL ES\n \n  // Apply intensity as \"symmetric gamma\"\n  if (intensity > 0.0) {\n    color.rgb = 1.0 - pow(1.0 - color.rgb, vec3(max(intensity + 1.0, EPSILON)));\n  } else {\n    color.rgb = pow(color.rgb, vec3(max(-intensity + 1.0, EPSILON)));\n  }\n \n  // Colorimetric (perceptual luminance-preserving) RGB to grayscale conversion\n  // https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale\n  float luminance = dot(GRAYSCALE_WEIGHTS, color.rgb);\n \n  // Apply DuoTone\n  vec4 duotone = mix(dark, light, clamp(luminance, 0.0, 1.0));\n  duotone.a *= color.a;\n  \n  duotone.rgb *= duotone.a;\n\n  return duotone;\n}\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = duotoneKernel(texColor, u_lightColor, u_darkColor, u_intensity);\n}";

/***/ }),
/* 344 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/*
* This file is part of PhotoEditorSDK.
*
* Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
* All rights reserved.
*
* Redistribution and use in source and binary forms, without
* modification, are permitted provided that the following license agreement
* is approved and a legal/financial contract was signed by the user.
* The license agreement can be found under following link:
*
* https://www.photoeditorsdk.com/LICENSE.txt
*/




var GammaFilter = function (_Engine$Filter) {
  _inherits(GammaFilter, _Engine$Filter);

  function GammaFilter() {
    _classCallCheck(this, GammaFilter);

    var _this = _possibleConstructorReturn(this, (GammaFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(GammaFilter)).call(this));

    _this._fragmentSource = __webpack_require__(345);
    return _this;
  }

  /**
  * Applies this filter to the given inputTarget and renders it to
  * the given outputTarget using the CanvasRenderer
  * @param  {CanvasRenderer} renderer
  * @param  {RenderTarget} inputTarget
  * @param  {RenderTarget} outputTarget
  * @param  {Boolean} clear = false
  * @private
  */


  _createClass(GammaFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var gamma = this._options.gamma;
      // pre calculate lookup tables for each channel

      var gammaArrayRed = new Float32Array(256);
      for (var i = 0; i < 256; i++) {
        gammaArrayRed[i] = 255.0 * Math.pow(i / 255.0, gamma.r);
      }

      var gammaArrayGreen = new Float32Array(256);
      for (var _i = 0; _i < 256; _i++) {
        gammaArrayGreen[_i] = 255.0 * Math.pow(_i / 255.0, gamma.g);
      }

      var gammaArrayBlue = new Float32Array(256);
      for (var _i2 = 0; _i2 < 256; _i2++) {
        gammaArrayBlue[_i2] = 255.0 * Math.pow(_i2 / 255.0, gamma.b);
      }

      for (var _i3 = 0; _i3 < canvas.width * canvas.height; _i3++) {
        var index = _i3 * 4;
        imageData.data[index] = gammaArrayRed[imageData.data[index]];
        imageData.data[index + 1] = gammaArrayGreen[imageData.data[index + 1]];
        imageData.data[index + 2] = gammaArrayBlue[imageData.data[index + 2]];
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return GammaFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
* Specifies the available options for this filter
* @type {Object}
* @ignore
*/


GammaFilter.prototype.availableOptions = {
  gamma: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].WHITE, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT3 }

  /**
  * Gamma primitive
  * @class
  * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
  * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
  */
};
var Gamma = function (_Primitive) {
  _inherits(Gamma, _Primitive);

  function Gamma() {
    var _ref;

    _classCallCheck(this, Gamma);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Gamma.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Gamma)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new GammaFilter();
    return _this2;
  }

  /**
  * Updates the filter's uniforms
  */


  _createClass(Gamma, [{
    key: 'update',
    value: function update() {
      this._filter.setGamma(this._options.gamma);
    }
  }]);

  return Gamma;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
* Specifies the available options for this primitive
* @type {Object}
* @ignore
*/


Gamma.prototype.availableOptions = GammaFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Gamma);

/***/ }),
/* 345 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform vec3 u_gamma;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec3 rgb = vec3(texColor.r, texColor.g, texColor.b);\n  rgb = pow(rgb, u_gamma);\n  gl_FragColor = vec4(rgb * texColor.a, texColor.a);;\n}\n";

/***/ }),
/* 346 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var GlowFilter = function (_Engine$Filter) {
  _inherits(GlowFilter, _Engine$Filter);

  function GlowFilter() {
    _classCallCheck(this, GlowFilter);

    var _this = _possibleConstructorReturn(this, (GlowFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(GlowFilter)).call(this));

    _this._fragmentSource = __webpack_require__(347);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(GlowFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      var color = this._options.color;


      var d;
      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          var x01 = x / canvas.width;
          var y01 = y / canvas.height;

          var nx = (x01 - 0.5) / 0.75;
          var ny = (y01 - 0.5) / 0.75;

          var scalarX = nx * nx;
          var scalarY = ny * ny;
          d = 1 - (scalarX + scalarY);
          d = Math.min(Math.max(d, 0.1), 1.0);

          imageData.data[index] = imageData.data[index] * (d * color.r);
          imageData.data[index + 1] = imageData.data[index + 1] * (d * color.g);
          imageData.data[index + 2] = imageData.data[index + 2] * (d * color.b);
          imageData.data[index + 3] = 255;
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return GlowFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


GlowFilter.prototype.availableOptions = {
  color: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].WHITE, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT3 }

  /**
   * Glow primitive
   * @class
   * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
   * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
   */
};
var Glow = function (_Primitive) {
  _inherits(Glow, _Primitive);

  function Glow() {
    var _ref;

    _classCallCheck(this, Glow);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Glow.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Glow)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new GlowFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(Glow, [{
    key: 'update',
    value: function update() {
      this._filter.setColor(this._options.color);
    }
  }]);

  return Glow;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


Glow.prototype.availableOptions = GlowFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Glow);

/***/ }),
/* 347 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nuniform vec3 u_color;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n\n  vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);\n  textureCoord /= 0.75;\n\n  float d = 1.0 - dot(textureCoord, textureCoord);\n  d = clamp(d, 0.2, 1.0);\n  vec3 newColor = texColor.rgb * d * u_color.rgb;\n  gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);\n}\n";

/***/ }),
/* 348 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var GobblinFilter = function (_Engine$Filter) {
  _inherits(GobblinFilter, _Engine$Filter);

  function GobblinFilter() {
    _classCallCheck(this, GobblinFilter);

    var _this = _possibleConstructorReturn(this, (GobblinFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(GobblinFilter)).call(this));

    _this._fragmentSource = __webpack_require__(349);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(GobblinFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          imageData.data[index + 2] = imageData.data[index + 1] * 0.33;
          imageData.data[index] = imageData.data[index] * 0.6;
          imageData.data[index + 2] += imageData.data[index] * 0.33;
          imageData.data[index + 1] = imageData.data[index + 1] * 0.7;
          imageData.data[index + 3] = 255;
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return GobblinFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Gobblin primitive
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
 * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
 */


var Gobblin = function (_Primitive) {
  _inherits(Gobblin, _Primitive);

  function Gobblin() {
    var _ref;

    _classCallCheck(this, Gobblin);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Gobblin.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Gobblin)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new GobblinFilter();
    return _this2;
  }

  return Gobblin;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Gobblin);

/***/ }),
/* 349 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  texColor.b = texColor.g * 0.33;\n  texColor.r = texColor.r * 0.6;\n  texColor.b += texColor.r * 0.33;\n  texColor.g = texColor.g * 0.7;\n  gl_FragColor = texColor;\n}\n";

/***/ }),
/* 350 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var GrayscaleFilter = function (_Engine$Filter) {
  _inherits(GrayscaleFilter, _Engine$Filter);

  function GrayscaleFilter() {
    _classCallCheck(this, GrayscaleFilter);

    var _this = _possibleConstructorReturn(this, (GrayscaleFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(GrayscaleFilter)).call(this));

    _this._fragmentSource = __webpack_require__(351);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(GrayscaleFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          var luminance = imageData.data[index] * 0.2125 + imageData.data[index + 1] * 0.7154 + imageData.data[index + 2] * 0.0721;

          imageData.data[index] = luminance;
          imageData.data[index + 1] = luminance;
          imageData.data[index + 2] = luminance;
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return GrayscaleFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Grayscale primitive
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
 * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
 */


var Grayscale = function (_Primitive) {
  _inherits(Grayscale, _Primitive);

  function Grayscale() {
    var _ref;

    _classCallCheck(this, Grayscale);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Grayscale.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Grayscale)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new GrayscaleFilter();
    return _this2;
  }

  return Grayscale;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (Grayscale);

/***/ }),
/* 351 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nvec3 W = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float luminance = dot(texColor.rgb, W);\n  gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);\n}\n";

/***/ }),
/* 352 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_lookupTable;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;\n  float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;\n  float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;\n\n  gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);\n}\n";

/***/ }),
/* 353 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__primitive__ = __webpack_require__(18);






var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;


var TEXTURE_GL_UNIT = 3;

var LookupTableImageFilter = function (_Engine$Filter) {
  _inherits(LookupTableImageFilter, _Engine$Filter);

  function LookupTableImageFilter() {
    _classCallCheck(this, LookupTableImageFilter);

    var _this = _possibleConstructorReturn(this, (LookupTableImageFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableImageFilter)).call(this));

    _this._precomputeQuads();
    _this._fragmentSource = __webpack_require__(354);
    return _this;
  }

  /**
   * This function pre-calculates an array that holds quads for each
   * of the 256 possible values of the blue channel
   * @private
   */


  _createClass(LookupTableImageFilter, [{
    key: '_precomputeQuads',
    value: function _precomputeQuads() {
      this._quads = [];
      for (var i = 0; i < 256; i++) {
        var blueColor = i / 255 * 63;
        var quad = new Vector2();

        quad.y = (blueColor | 0) * 0.125 | 0;
        quad.x = (blueColor | 0) - quad.y * 8;
        this._quads.push(quad);
      }
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the CanvasRenderer
     * @param  {CanvasRenderer} renderer
     * @param  {RenderTarget} inputTarget
     * @param  {RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var lutImage = this._options.lookupTableImage;
      var lutCanvas = this._createImageCanvas(lutImage);
      var lutContext = lutCanvas.getContext('2d');

      var inputImageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var filterImageData = lutContext.getImageData(0, 0, lutImage.width, lutImage.height);

      var texCoord = new Vector2();
      for (var index = 0; index < canvas.width * canvas.height * 4; index += 4) {
        var r = inputImageData.data[index];
        var g = inputImageData.data[index + 1];
        var b = inputImageData.data[index + 2];
        var a = inputImageData.data[index + 3] / 255;
        var quad = this._quads[b];

        // 64 since we have 8x8 tiles on a 512x512 texture.
        var tileSideLength = 64;

        // calculate pixel position of the coordinate origin.
        texCoord.x = quad.x * tileSideLength;
        texCoord.y = quad.y * tileSideLength;

        // now lookup the correct color within the tile.
        // the position of the pixel is indicated by the vector,
        // induced by the combination of the red and green vector.
        texCoord.x += Math.floor(r / 4); // r / 256 * 64 = r / 4
        texCoord.y += Math.floor(g / 4); // g / 256 * 64 = r / 4

        var texCoordIndex = (lutImage.width * texCoord.y + texCoord.x) * 4 | 0;
        var newR = filterImageData.data[texCoordIndex];
        newR = r * (1 - a) + newR * a;
        var newG = filterImageData.data[texCoordIndex + 1];
        newG = g * (1 - a) + newG * a;
        var newB = filterImageData.data[texCoordIndex + 2];
        newB = b * (1 - a) + newB * a;
        inputImageData.data[index] = newR;
        inputImageData.data[index + 1] = newG;
        inputImageData.data[index + 2] = newB;
      }
      outputContext.putImageData(inputImageData, 0, 0);
    }

    /**
     * Creates a canvas with the given image
     * @param  {Image} image
     * @return {HTMLCanvasElement}
     * @private
     */

  }, {
    key: '_createImageCanvas',
    value: function _createImageCanvas(image) {
      var canvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
      canvas.width = image.width;
      canvas.height = image.height;

      var context = canvas.getContext('2d');
      context.drawImage(image, 0, 0);

      return canvas;
    }
  }]);

  return LookupTableImageFilter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


LookupTableImageFilter.prototype.availableOptions = {
  lookupTable: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: TEXTURE_GL_UNIT, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].INT },
  lookupTableImage: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].IMAGE, uniformType: null }

  /**
   * Stores a 256 byte long lookup table in a 2d texture which will be
   * used to look up the corresponding value for each channel.
   * @class
   * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
   * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
   */
};
var LookupTableImage = function (_Primitive) {
  _inherits(LookupTableImage, _Primitive);

  function LookupTableImage() {
    var _ref;

    _classCallCheck(this, LookupTableImage);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = LookupTableImage.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableImage)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new LookupTableImageFilter();
    _this2._textures = {};
    return _this2;
  }

  /**
   * Gets called before this primitive's filter is being applied
   * @param {PhotoEditorSDK} sdk
   */


  _createClass(LookupTableImage, [{
    key: 'update',
    value: function update(sdk) {
      var renderer = sdk.getRenderer();
      /* istanbul ignore if */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        this._updateWebGLTexture(sdk);
      } else if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].CANVAS)) {
        this._filter.setLookupTableImage(this._options.image);
      }
    }

    /**
     * Updates the lookup table texture (WebGL only)
     * @param {PhotoEditorSDK} sdk
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_updateWebGLTexture',
    value: function _updateWebGLTexture(sdk) {
      var renderer = sdk.getRenderer();
      var id = renderer.id;

      if (!this._textures[id]) {
        this._textures[id] = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].BaseTexture();
      }

      var texture = this._textures[id];
      texture.setSource(this._options.image);
      texture.setGLUnit(TEXTURE_GL_UNIT);

      renderer.updateTexture(texture);
    }

    /**
     * Cleans up this primitive
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(LookupTableImage.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableImage.prototype), 'dispose', this).call(this);
      for (var id in this._textures) {
        delete this._textures[id];
      }
    }
  }]);

  return LookupTableImage;
}(__WEBPACK_IMPORTED_MODULE_6__primitive__["a" /* default */]);

LookupTableImage.prototype.availableOptions = {
  image: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].IMAGE }
};

/* harmony default export */ __webpack_exports__["a"] = (LookupTableImage);

/***/ }),
/* 354 */
/***/ (function(module, exports) {

module.exports = "/**\n * Based off of GPUImage's LookupFilter:\n * https://github.com/BradLarson/GPUImage/blob/master/framework/Source/GPUImageLookupFilter.m\n */\n\nvarying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_lookupTable;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float blueColor = texColor.b * 63.0;\n\n  vec2 quad1;\n  quad1.y = floor(floor(blueColor) / 8.0);\n  quad1.x = floor(blueColor) - (quad1.y * 8.0);\n\n  vec2 quad2;\n  quad2.y = floor(ceil(blueColor) / 8.0);\n  quad2.x = ceil(blueColor) - (quad2.y * 8.0);\n\n  vec2 texCoord1;\n  texCoord1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);\n  texCoord1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);\n\n  vec2 texCoord2;\n  texCoord2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);\n  texCoord2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);\n\n  vec4 newColor1 = texture2D(u_lookupTable, texCoord1);\n  vec4 newColor2 = texture2D(u_lookupTable, texCoord2);\n\n  vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\n  gl_FragColor = mix(texColor, vec4(newColor.rgb, texColor.w), texColor.a);\n}\n";

/***/ }),
/* 355 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var SaturationFilter = function (_Engine$Filter) {
  _inherits(SaturationFilter, _Engine$Filter);

  function SaturationFilter() {
    _classCallCheck(this, SaturationFilter);

    var _this = _possibleConstructorReturn(this, (SaturationFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(SaturationFilter)).call(this));

    _this._fragmentSource = __webpack_require__(356);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(SaturationFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var saturation = this._options.saturation;


      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          var luminance = imageData.data[index] * 0.2125 + imageData.data[index + 1] * 0.7154 + imageData.data[index + 2] * 0.0721;
          imageData.data[index] = luminance * (1 - saturation) + imageData.data[index] * saturation;
          imageData.data[index + 1] = luminance * (1 - saturation) + imageData.data[index + 1] * saturation;
          imageData.data[index + 2] = luminance * (1 - saturation) + imageData.data[index + 2] * saturation;
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return SaturationFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


SaturationFilter.prototype.availableOptions = {
  saturation: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * Saturation primitive
   * @class
   * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
   * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
   */
};
var Saturation = function (_Primitive) {
  _inherits(Saturation, _Primitive);

  function Saturation() {
    var _ref;

    _classCallCheck(this, Saturation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = Saturation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(Saturation)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new SaturationFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(Saturation, [{
    key: 'update',
    value: function update() {
      this._filter.setSaturation(this._options.saturation);
    }
  }]);

  return Saturation;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


Saturation.prototype.availableOptions = SaturationFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (Saturation);

/***/ }),
/* 356 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_saturation;\n\nconst vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float luminance = dot(texColor.rgb, luminanceWeighting);\n\n  vec3 greyScaleColor = vec3(luminance);\n\n  gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);\n}\n";

/***/ }),
/* 357 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var SoftColorOverlayFilter = function (_Engine$Filter) {
  _inherits(SoftColorOverlayFilter, _Engine$Filter);

  function SoftColorOverlayFilter() {
    _classCallCheck(this, SoftColorOverlayFilter);

    var _this = _possibleConstructorReturn(this, (SoftColorOverlayFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(SoftColorOverlayFilter)).call(this));

    _this._fragmentSource = __webpack_require__(358);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(SoftColorOverlayFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          imageData.data[index] = Math.max(this._options.color.r * 255, imageData.data[index]);
          imageData.data[index + 1] = Math.max(this._options.color.g * 255, imageData.data[index + 1]);
          imageData.data[index + 2] = Math.max(this._options.color.b * 255, imageData.data[index + 2]);
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return SoftColorOverlayFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


SoftColorOverlayFilter.prototype.availableOptions = {
  color: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"].WHITE, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].FLOAT3 }

  /**
   * SoftColorOverlay primitive
   * @class
   * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
   * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
   */
};
var SoftColorOverlay = function (_Primitive) {
  _inherits(SoftColorOverlay, _Primitive);

  function SoftColorOverlay() {
    var _ref;

    _classCallCheck(this, SoftColorOverlay);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = SoftColorOverlay.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(SoftColorOverlay)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new SoftColorOverlayFilter();
    return _this2;
  }

  /**
   * Updates the filter's uniforms
   */


  _createClass(SoftColorOverlay, [{
    key: 'update',
    value: function update() {
      this._filter.setColor(this._options.color);
    }
  }]);

  return SoftColorOverlay;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


SoftColorOverlay.prototype.availableOptions = SoftColorOverlayFilter.prototype.availableOptions;

/* harmony default export */ __webpack_exports__["a"] = (SoftColorOverlay);

/***/ }),
/* 358 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform vec3 u_color;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec4 overlayVec4 = vec4(u_color, texColor.a);\n  gl_FragColor = max(overlayVec4 * texColor.a, texColor);\n}\n";

/***/ }),
/* 359 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__lookup_table__ = __webpack_require__(174);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Tone curve primitive
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitives.LookupTable
 * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
 */

var ToneCurve = function (_LookupTable) {
  _inherits(ToneCurve, _LookupTable);

  function ToneCurve() {
    var _ref;

    _classCallCheck(this, ToneCurve);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = ToneCurve.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(ToneCurve)).call.apply(_ref, [this].concat(args)));

    if (!_this._options.rgbControlPoints) {
      _this._options.rgbControlPoints = {
        red: _this._options.controlPoints,
        green: _this._options.controlPoints,
        blue: _this._options.controlPoints
      };
    }

    _this._updateLookupTable();
    return _this;
  }

  /**
   * Calculates the lookup table
   * @private
   */


  _createClass(ToneCurve, [{
    key: '_updateLookupTable',
    value: function _updateLookupTable() {
      var r = this._calculateSplineCurve(this._options.rgbControlPoints.red);
      var g = this._calculateSplineCurve(this._options.rgbControlPoints.green);
      var b = this._calculateSplineCurve(this._options.rgbControlPoints.blue);

      this._options.data = this._buildLookupTable(r, g, b);
    }

    /**
     * Builds the lookup table
     * @param  {Array} r
     * @param  {Array} g
     * @param  {Array} b
     * @return {Array}
     * @private
     */

  }, {
    key: '_buildLookupTable',
    value: function _buildLookupTable(r, g, b) {
      var data = [];

      for (var i = 0; i < 256; i++) {
        data.push(Math.min(Math.max(i + r[i], 0), 255));
        data.push(Math.min(Math.max(i + g[i], 0), 255));
        data.push(Math.min(Math.max(i + b[i], 0), 255));
        data.push(255);
      }

      return data;
    }

    /**
     * Calculates the spline curve data for the given points
     * @param  {Array.<Array.<Number>>} points
     * @return {Array.<Number>}
     */

  }, {
    key: '_calculateSplineCurve',
    value: function _calculateSplineCurve(points) {
      points = points.sort(function (a, b) {
        return a[0] > b[0];
      });

      var splinePoints = this._getSplineCurve(points);
      var firstSplinePoint = splinePoints[0];
      var i;

      if (firstSplinePoint[0] > 0) {
        for (i = 0; i < firstSplinePoint[0]; i++) {
          splinePoints.unshift([0, 0]);
        }
      }

      var preparedPoints = [];
      for (i = 0; i < splinePoints.length; i++) {
        var newPoint = splinePoints[i];
        var origPoint = [newPoint[0], newPoint[0]];

        var distance = Math.sqrt(Math.pow(origPoint[0] - newPoint[0], 2) + Math.pow(origPoint[1] - newPoint[1], 2));

        if (origPoint[1] > newPoint[1]) {
          distance = -distance;
        }

        preparedPoints.push(distance);
      }

      return preparedPoints;
    }
  }, {
    key: '_getSplineCurve',
    value: function _getSplineCurve(points) {
      var sdA = this._secondDerivative(points);

      var n = sdA.length;
      var sd = [];
      var i;

      for (i = 0; i < n; i++) {
        sd[i] = sdA[i];
      }

      var output = [];

      for (i = 0; i < n - 1; i++) {
        var cur = points[i];
        var next = points[i + 1];

        for (var x = cur[0]; x < next[0]; x++) {
          var t = (x - cur[0]) / (next[0] - cur[0]);

          var a = 1 - t;
          var b = t;
          var h = next[0] - cur[0];

          var y = a * cur[1] + b * next[1] + h * h / 6 * ((a * a * a - a) * sd[i] + (b * b * b - b) * sd[i + 1]);

          if (y > 255) {
            y = 255;
          } else if (y < 0) {
            y = 0;
          }

          output.push([x, y]);
        }
      }

      if (output.length === 255) {
        output.push(points[points.length - 1]);
      }

      return output;
    }
  }, {
    key: '_secondDerivative',
    value: function _secondDerivative(points) {
      var n = points.length;
      if (n <= 0 || n === 1) {
        return null;
      }

      var matrix = [];
      var result = [];
      var i, k;

      matrix[0] = [0, 1, 0];

      for (i = 1; i < n - 1; i++) {
        var P1 = points[i - 1];
        var P2 = points[i];
        var P3 = points[i + 1];

        matrix[i] = matrix[i] || [];
        matrix[i][0] = (P2[0] - P1[0]) / 6;
        matrix[i][1] = (P3[0] - P1[0]) / 3;
        matrix[i][2] = (P3[0] - P2[0]) / 6;
        result[i] = (P3[1] - P2[1]) / (P3[0] - P2[0]) - (P2[1] - P1[1]) / (P2[0] - P1[0]);
      }

      result[0] = 0;
      result[n - 1] = 0;

      matrix[n - 1] = [0, 1, 0];

      // Pass 1
      for (i = 1; i < n; i++) {
        k = matrix[1][0] / matrix[i - 1][1];
        matrix[i][1] -= k * matrix[i - 1][2];
        matrix[i][0] = 0;
        result[i] -= k * result[i - 1];
      }

      // Pass 2
      for (i = n - 2; i > 0; i--) {
        k = matrix[i][2] / matrix[i + 1][1];
        matrix[i][1] -= k * matrix[i + 1][0];
        matrix[i][2] = 0;
        result[i] -= k * result[i + 1];
      }

      var y2 = [];
      for (i = 0; i < n; i++) {
        y2[i] = result[i] / matrix[i][1];
      }

      return y2;
    }
  }]);

  return ToneCurve;
}(__WEBPACK_IMPORTED_MODULE_5__lookup_table__["a" /* default */]);

/**
 * Specifies the available options for this primitive
 * @type {Object}
 * @ignore
 */


ToneCurve.prototype.availableOptions = {
  rgbControlPoints: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT },
  controlPoints: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].ARRAY, default: [] },
  textureGLUnit: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 }
};

/* harmony default export */ __webpack_exports__["a"] = (ToneCurve);

/***/ }),
/* 360 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitive__ = __webpack_require__(18);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var X400Filter = function (_Engine$Filter) {
  _inherits(X400Filter, _Engine$Filter);

  function X400Filter() {
    _classCallCheck(this, X400Filter);

    var _this = _possibleConstructorReturn(this, (X400Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(X400Filter)).call(this));

    _this._fragmentSource = __webpack_require__(361);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(X400Filter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);

      for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
          var index = (canvas.width * y + x) * 4;

          var gray = imageData.data[index] / 255 * 0.3 + imageData.data[index + 1] / 255 * 0.3 + imageData.data[index + 2] / 255 * 0.3;
          gray -= 0.2;
          gray = Math.max(0.0, Math.min(1.0, gray));
          gray += 0.15;
          gray *= 1.4;

          gray *= 255;
          imageData.data[index] = gray;
          imageData.data[index + 1] = gray;
          imageData.data[index + 2] = gray;
        }
      }

      outputContext.putImageData(imageData, 0, 0);
    }
  }]);

  return X400Filter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * X400 primitive
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
 * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
 */


var X400 = function (_Primitive) {
  _inherits(X400, _Primitive);

  function X400() {
    var _ref;

    _classCallCheck(this, X400);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = X400.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(X400)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new X400Filter();
    return _this2;
  }

  return X400;
}(__WEBPACK_IMPORTED_MODULE_5__primitive__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (X400);

/***/ }),
/* 361 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;\n  gray -= 0.2;\n  gray = clamp(gray, 0.0, 1.0);\n  gray += 0.15;\n  gray *= 1.4;\n  gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);\n}\n";

/***/ }),
/* 362 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__primitive__ = __webpack_require__(18);






var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2,
    Vector3 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector3;


var TEXTURE_GL_UNIT = 3;

var ThreeDLookupTableImageFilter = function (_Engine$Filter) {
  _inherits(ThreeDLookupTableImageFilter, _Engine$Filter);

  function ThreeDLookupTableImageFilter() {
    _classCallCheck(this, ThreeDLookupTableImageFilter);

    var _this = _possibleConstructorReturn(this, (ThreeDLookupTableImageFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(ThreeDLookupTableImageFilter)).call(this));

    _this._precomputeQuads();
    _this._fragmentSource = __webpack_require__(363);
    return _this;
  }

  /**
   * This function pre-calculates an array that holds quads for each
   * of the 256 possible values of the blue channel
   * @private
   */


  _createClass(ThreeDLookupTableImageFilter, [{
    key: '_precomputeQuads',
    value: function _precomputeQuads() {
      this._quads = [];
      for (var i = 0; i < 256; i++) {
        var blueColor = i / 255 * 63;
        var quad = new Vector2();

        quad.y = (blueColor | 0) * 0.125 | 0;
        quad.x = (blueColor | 0) - quad.y * 8;
        this._quads.push(quad);
      }
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the CanvasRenderer
     * @param  {CanvasRenderer} renderer
     * @param  {RenderTarget} inputTarget
     * @param  {RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var _options = this._options,
          resolution = _options.resolution,
          horizontalTileCount = _options.horizontalTileCount,
          verticalTileCount = _options.verticalTileCount;


      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var lutImage = this._options.lookupTableImage;
      var lutCanvas = this._createImageCanvas(lutImage);
      var lutContext = lutCanvas.getContext('2d');

      var inputImageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var lutImageData = lutContext.getImageData(0, 0, lutImage.width, lutImage.height);

      // const rRange = Math.floor(resolution / horizontalTileCount - 1)
      // const gRange = Math.floor(resolution / verticalTileCount - 1)
      // const bRange = Math.floor(horizontalTileCount * verticalTileCount - 1)

      var ranges = new Vector3(resolution / horizontalTileCount - 1 | 0, resolution / verticalTileCount - 1 | 0, horizontalTileCount * verticalTileCount - 1 | 0);

      var inputColor = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var outputColor = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var lutColorFB = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var lutColorCB = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();

      var cRfGf = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var cRfGc = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var cRcGf = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var cRcGc = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();

      var tileFloor = new Vector2();
      var tileCeil = new Vector2();

      var mix = function mix(target, x, y, a) {
        target.r = x.r * (1 - a) + y.r * a;
        target.g = x.g * (1 - a) + y.g * a;
        target.b = x.b * (1 - a) + y.b * a;
      };

      var lookup = function lookup(target, x, y) {
        x = 0.5 + x | 0;
        y = 0.5 + y | 0;
        var index = (y * resolution + x) * 4;
        target.r = lutImageData.data[index] / 255;
        target.g = lutImageData.data[index + 1] / 255;
        target.b = lutImageData.data[index + 2] / 255;
        target.a = lutImageData.data[index + 3] / 255;
      };

      var interpolateTempA = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var interpolateTempB = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"]();
      var bilinearInterpolate = function bilinearInterpolate(target, cRfGf, cRfGc, cRcGf, cRcGc, redFract, greenFract) {
        mix(interpolateTempA, cRfGf, cRcGf, redFract);
        mix(interpolateTempB, cRfGc, cRcGc, redFract);
        mix(target, interpolateTempA, interpolateTempB, greenFract);
      };

      var pixelsPerTile = new Vector2(resolution, resolution).divide(horizontalTileCount, verticalTileCount).floor();
      for (var index = 0; index < canvas.width * canvas.height * 4; index += 4) {
        inputColor.set(inputImageData.data[index] / 255, inputImageData.data[index + 1] / 255, inputImageData.data[index + 2] / 255, inputImageData.data[index + 3] / 255);

        var tmp = new Vector3(inputColor.r * ranges.x, inputColor.g * ranges.y, inputColor.b * ranges.z);

        var floors = tmp.clone().floor().toInt();
        var ceils = tmp.clone().ceil().toInt();
        var fracts = tmp.clone().fract();

        tileFloor.y = floors.z / horizontalTileCount | 0;
        tileFloor.x = floors.z - tileFloor.y * horizontalTileCount | 0;

        tileCeil.y = ceils.z / horizontalTileCount | 0;
        tileCeil.x = ceils.z - tileCeil.y * horizontalTileCount | 0;

        tileFloor.multiply(pixelsPerTile);
        tileCeil.multiply(pixelsPerTile);

        lookup(cRfGf, tileFloor.x + floors.x, tileFloor.y + floors.y);
        lookup(cRfGc, tileFloor.x + floors.x, tileFloor.y + ceils.y);
        lookup(cRcGf, tileFloor.x + ceils.x, tileFloor.y + floors.y);
        lookup(cRcGc, tileFloor.x + ceils.x, tileFloor.y + ceils.y);

        bilinearInterpolate(lutColorFB, cRfGf, cRfGc, cRcGf, cRcGc, fracts.x, fracts.y);

        lookup(cRfGf, tileCeil.x + floors.x, tileCeil.y + floors.y);
        lookup(cRfGc, tileCeil.x + floors.x, tileCeil.y + ceils.y);
        lookup(cRcGf, tileCeil.x + ceils.x, tileCeil.y + floors.y);
        lookup(cRcGc, tileCeil.x + ceils.x, tileCeil.y + ceils.y);

        bilinearInterpolate(lutColorCB, cRfGf, cRfGc, cRcGf, cRcGc, fracts.x, fracts.y);

        mix(outputColor, lutColorFB, lutColorCB, fracts.z);

        // interpolation = clamp(Math.floor(outputColor * 255. + .5) / 255., 0.0, 1.0);

        inputImageData.data[index] = Math.ceil(outputColor.r * 255);
        inputImageData.data[index + 1] = Math.ceil(outputColor.g * 255);
        inputImageData.data[index + 2] = Math.ceil(outputColor.b * 255);
      }
      outputContext.putImageData(inputImageData, 0, 0);
    }

    /**
     * Creates a canvas with the given image
     * @param  {Image} image
     * @return {HTMLCanvasElement}
     * @private
     */

  }, {
    key: '_createImageCanvas',
    value: function _createImageCanvas(image) {
      var canvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
      canvas.width = image.width;
      canvas.height = image.height;

      var context = canvas.getContext('2d');
      context.drawImage(image, 0, 0);

      return canvas;
    }
  }]);

  return ThreeDLookupTableImageFilter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


ThreeDLookupTableImageFilter.prototype.availableOptions = {
  lookupTable: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: TEXTURE_GL_UNIT, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].INT },
  lookupTableImage: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].IMAGE, uniformType: null },
  resolution: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 128, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  horizontalTileCount: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 5, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  verticalTileCount: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 5, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT }

  /**
   * Stores a 256 byte long lookup table in a 2d texture which will be
   * used to look up the corresponding value for each channel.
   * @class
   * @extends PhotoEditorSDK.Operations.FilterOperation.Filters.Primitive
   * @memberof PhotoEditorSDK.Operations.FilterOperation.FilterPrimitives
   */
};
var LookupTableImage = function (_Primitive) {
  _inherits(LookupTableImage, _Primitive);

  function LookupTableImage() {
    var _ref;

    _classCallCheck(this, LookupTableImage);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this2 = _possibleConstructorReturn(this, (_ref = LookupTableImage.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableImage)).call.apply(_ref, [this].concat(args)));

    _this2._filter = new ThreeDLookupTableImageFilter();
    _this2._textures = {};
    return _this2;
  }

  /**
   * Gets called before this primitive's filter is being applied
   * @param {PhotoEditorSDK} sdk
   */


  _createClass(LookupTableImage, [{
    key: 'update',
    value: function update(sdk) {
      var renderer = sdk.getRenderer();
      /* istanbul ignore if */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        this._updateWebGLTexture(sdk);
      } else if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].CANVAS)) {
        this._filter.setLookupTableImage(this._options.image);
      }

      var _options2 = this._options,
          resolution = _options2.resolution,
          verticalTileCount = _options2.verticalTileCount,
          horizontalTileCount = _options2.horizontalTileCount;

      this._filter.set({
        resolution: resolution, verticalTileCount: verticalTileCount, horizontalTileCount: horizontalTileCount
      });
    }

    /**
     * Updates the lookup table texture (WebGL only)
     * @param {PhotoEditorSDK} sdk
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_updateWebGLTexture',
    value: function _updateWebGLTexture(sdk) {
      var renderer = sdk.getRenderer();
      var id = renderer.id;

      if (!this._textures[id]) {
        this._textures[id] = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].BaseTexture();
      }

      var texture = this._textures[id];
      texture.setSource(this._options.image);
      texture.setGLUnit(TEXTURE_GL_UNIT);
      texture.setMinFilter(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].BaseTexture.NearestFilter);

      renderer.updateTexture(texture);
    }

    /**
     * Cleans up this primitive
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(LookupTableImage.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LookupTableImage.prototype), 'dispose', this).call(this);
      for (var id in this._textures) {
        delete this._textures[id];
      }
    }
  }]);

  return LookupTableImage;
}(__WEBPACK_IMPORTED_MODULE_6__primitive__["a" /* default */]);

LookupTableImage.prototype.availableOptions = {
  image: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].IMAGE },
  resolution: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 128 },
  horizontalTileCount: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 5 },
  verticalTileCount: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 5 }
};

/* harmony default export */ __webpack_exports__["a"] = (LookupTableImage);

/***/ }),
/* 363 */
/***/ (function(module, exports) {

module.exports = "precision highp float;\n\nuniform sampler2D u_image;\n\nuniform sampler2D u_lookupTable;\n\nuniform float u_resolution;     // Texture-Resolution, must be power of 2: 64, 128, 256, 512, 1024, 2048, 4096\nuniform float u_horizontalTileCount; // Horizontal Blue Tiles\nuniform float u_verticalTileCount; // Vertical Blue Tiles\n\nvarying vec2 v_texCoord;\n\nconst float EPSILON = 0.000001;\n\n// Try to get the exact pixel of the lut map image\nvec3 lutColor(int texPosX, int texPosY) {\n    return texture2D(u_lookupTable, (0.5 / u_resolution) + vec2(float(texPosX), float(texPosY)) / u_resolution).rgb;\n}\n\nvec3 bilinearInterpolate(vec3 cRfGf, vec3 cRfGc, vec3 cRcGf, vec3 cRcGc, float redFract, float greenFract) {\n    return mix(mix(cRfGf, cRcGf, redFract), mix(cRfGc, cRcGc, redFract), greenFract);\n}\n\nvoid main() {\n    vec4 inputColor = clamp(texture2D(u_image, v_texCoord.xy), 0.0, 1.0);\n\n    vec3 sourceColor = vec3(inputColor.rgb / max(inputColor.a, EPSILON)); \n\n    vec3 ranges = vec3(\n        floor(u_resolution / u_horizontalTileCount - 1.0),\n        floor(u_resolution / u_verticalTileCount - 1.0),\n        floor(u_horizontalTileCount * u_horizontalTileCount - 1.0)\n    );\n    \n    vec3 tmp = sourceColor * ranges;\n    ivec3 floors = ivec3(tmp);\n    ivec3 ceils = ivec3(ceil(tmp));\n    vec3 fracts = fract(tmp);\n\n    // Map tile index to tile pixel pos.\n    ivec2 pixelsPerTile = ivec2(\n        u_resolution / u_horizontalTileCount, \n        u_resolution / u_verticalTileCount\n      );\n\n    ivec2 tileFloor; // Blue tile index\n    tileFloor.y = floors.z / int(u_horizontalTileCount);\n    tileFloor.x = (floors.z - (tileFloor.y * int(u_horizontalTileCount)));\n\n    ivec2 tileCeil; // Blue tile index\n    tileCeil.y = ceils.z / int(u_horizontalTileCount);\n    tileCeil.x = (ceils.z - (tileCeil.y * int(u_horizontalTileCount)));\n    \n    tileFloor *= pixelsPerTile;\n    tileCeil *= pixelsPerTile; \n    \n    \n    // Interpolate between red and green\n    vec3 lutColorFB = bilinearInterpolate(\n        lutColor(tileFloor.x + floors.x, tileFloor.y + floors.y),\n        lutColor(tileFloor.x + floors.x, tileFloor.y + ceils.y),\n        lutColor(tileFloor.x + ceils.x,  tileFloor.y + floors.y),\n        lutColor(tileFloor.x + ceils.x,  tileFloor.y + ceils.y),\n        fracts.x, fracts.y\n    );\n    vec3 lutColorCB = bilinearInterpolate(\n        lutColor(tileCeil.x + floors.x, tileCeil.y + floors.y),\n        lutColor(tileCeil.x + floors.x, tileCeil.y + ceils.y),\n        lutColor(tileCeil.x + ceils.x,  tileCeil.y + floors.y),\n        lutColor(tileCeil.x + ceils.x,  tileCeil.y + ceils.y),\n        fracts.x, fracts.y\n    );\n\n    // Interpolate between the blue values\n    vec3 interpolation = mix(lutColorFB, lutColorCB, fracts.z);\n\n    // Round Color Values to prevent that for ex. 254.999999 is cutting to 254 instead of 255;\n    interpolation = clamp(floor(interpolation * 255. + .5) / 255., 0.0, 1.0);\n\n    gl_FragColor = vec4(interpolation.rgb * inputColor.a, inputColor.a);\n}\n";

/***/ }),
/* 364 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__identity_filter__ = __webpack_require__(173);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "IdentityFilter", function() { return __WEBPACK_IMPORTED_MODULE_0__identity_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__a15_filter__ = __webpack_require__(365);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "A15Filter", function() { return __WEBPACK_IMPORTED_MODULE_1__a15_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__breeze_filter__ = __webpack_require__(366);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "BreezeFilter", function() { return __WEBPACK_IMPORTED_MODULE_2__breeze_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__bw_filter__ = __webpack_require__(367);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "BWFilter", function() { return __WEBPACK_IMPORTED_MODULE_3__bw_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__bwhard_filter__ = __webpack_require__(368);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "BWHardFilter", function() { return __WEBPACK_IMPORTED_MODULE_4__bwhard_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__celsius_filter__ = __webpack_require__(369);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "CelsiusFilter", function() { return __WEBPACK_IMPORTED_MODULE_5__celsius_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__chest_filter__ = __webpack_require__(370);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ChestFilter", function() { return __WEBPACK_IMPORTED_MODULE_6__chest_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__duotone_filter__ = __webpack_require__(371);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "DuoToneFilter", function() { return __WEBPACK_IMPORTED_MODULE_7__duotone_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__fixie_filter__ = __webpack_require__(372);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "FixieFilter", function() { return __WEBPACK_IMPORTED_MODULE_8__fixie_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__food_filter__ = __webpack_require__(373);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "FoodFilter", function() { return __WEBPACK_IMPORTED_MODULE_9__food_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__fridge_filter__ = __webpack_require__(374);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "FridgeFilter", function() { return __WEBPACK_IMPORTED_MODULE_10__fridge_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__front_filter__ = __webpack_require__(375);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "FrontFilter", function() { return __WEBPACK_IMPORTED_MODULE_11__front_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__glam_filter__ = __webpack_require__(376);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "GlamFilter", function() { return __WEBPACK_IMPORTED_MODULE_12__glam_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__gobblin_filter__ = __webpack_require__(377);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "GobblinFilter", function() { return __WEBPACK_IMPORTED_MODULE_13__gobblin_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__k1_filter__ = __webpack_require__(378);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "K1Filter", function() { return __WEBPACK_IMPORTED_MODULE_14__k1_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__k2_filter__ = __webpack_require__(379);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "K2Filter", function() { return __WEBPACK_IMPORTED_MODULE_15__k2_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__k6_filter__ = __webpack_require__(380);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "K6Filter", function() { return __WEBPACK_IMPORTED_MODULE_16__k6_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__kdynamic_filter__ = __webpack_require__(381);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "KDynamicFilter", function() { return __WEBPACK_IMPORTED_MODULE_17__kdynamic_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__lenin_filter__ = __webpack_require__(382);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LeninFilter", function() { return __WEBPACK_IMPORTED_MODULE_18__lenin_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__lomo_filter__ = __webpack_require__(383);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LomoFilter", function() { return __WEBPACK_IMPORTED_MODULE_19__lomo_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__mellow_filter__ = __webpack_require__(384);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "MellowFilter", function() { return __WEBPACK_IMPORTED_MODULE_20__mellow_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21__metal_filter__ = __webpack_require__(385);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "MetalFilter", function() { return __WEBPACK_IMPORTED_MODULE_21__metal_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22__morning_filter__ = __webpack_require__(386);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "MorningFilter", function() { return __WEBPACK_IMPORTED_MODULE_22__morning_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23__orchid_filter__ = __webpack_require__(387);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "OrchidFilter", function() { return __WEBPACK_IMPORTED_MODULE_23__orchid_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24__pola_filter__ = __webpack_require__(388);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "PolaFilter", function() { return __WEBPACK_IMPORTED_MODULE_24__pola_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25__pola669_filter__ = __webpack_require__(389);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "Pola669Filter", function() { return __WEBPACK_IMPORTED_MODULE_25__pola669_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_26__quozi_filter__ = __webpack_require__(390);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "QuoziFilter", function() { return __WEBPACK_IMPORTED_MODULE_26__quozi_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_27__semired_filter__ = __webpack_require__(391);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "SemiredFilter", function() { return __WEBPACK_IMPORTED_MODULE_27__semired_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_28__sunny_filter__ = __webpack_require__(392);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "SunnyFilter", function() { return __WEBPACK_IMPORTED_MODULE_28__sunny_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_29__texas_filter__ = __webpack_require__(393);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "TexasFilter", function() { return __WEBPACK_IMPORTED_MODULE_29__texas_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_30__x400_filter__ = __webpack_require__(394);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "X400Filter", function() { return __WEBPACK_IMPORTED_MODULE_30__x400_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_31__lut_filter__ = __webpack_require__(395);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "LUTFilter", function() { return __WEBPACK_IMPORTED_MODULE_31__lut_filter__["a"]; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_32__3d_lut_filter__ = __webpack_require__(396);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "ThreeDLUTFilter", function() { return __WEBPACK_IMPORTED_MODULE_32__3d_lut_filter__["a"]; });
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * @namespace PhotoEditorSDK.Operations.FilterOperation.Filters
 */
































// Special lookup table filter



/***/ }),
/* 365 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * A15 Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var A15Filter = function (_Filter) {
  _inherits(A15Filter, _Filter);

  function A15Filter() {
    var _ref;

    _classCallCheck(this, A15Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = A15Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(A15Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 0.63
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Brightness"]({
      brightness: 0.12
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 38], [94, 94], [148, 142], [175, 187], [255, 255]],
        green: [[0, 0], [77, 53], [171, 190], [255, 255]],
        blue: [[0, 10], [48, 85], [174, 228], [255, 255]]
      }
    }));
    return _this;
  }

  return A15Filter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


A15Filter.identifier = 'a15';

/* harmony default export */ __webpack_exports__["a"] = (A15Filter);

/***/ }),
/* 366 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Breeze Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var BreezeFilter = function (_Filter) {
  _inherits(BreezeFilter, _Filter);

  function BreezeFilter() {
    var _ref;

    _classCallCheck(this, BreezeFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Desaturation
    var _this = _possibleConstructorReturn(this, (_ref = BreezeFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(BreezeFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Desaturation"]({
      desaturation: 0.5
    }));

    // Tone curve
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [170, 170], [212, 219], [234, 242], [255, 255]],
        green: [[0, 0], [170, 168], [234, 231], [255, 255]],
        blue: [[0, 0], [170, 170], [212, 208], [255, 255]]
      }
    }));
    return _this;
  }

  return BreezeFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


BreezeFilter.identifier = 'breeze';

/* harmony default export */ __webpack_exports__["a"] = (BreezeFilter);

/***/ }),
/* 367 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * BW Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var BWFilter = function (_Filter) {
  _inherits(BWFilter, _Filter);

  function BWFilter() {
    var _ref;

    _classCallCheck(this, BWFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = BWFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(BWFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Grayscale"]());
    return _this;
  }

  return BWFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


BWFilter.identifier = 'bw';

/* harmony default export */ __webpack_exports__["a"] = (BWFilter);

/***/ }),
/* 368 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * BWHard Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var BWHardFilter = function (_Filter) {
  _inherits(BWHardFilter, _Filter);

  function BWHardFilter() {
    var _ref;

    _classCallCheck(this, BWHardFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = BWHardFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(BWHardFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Grayscale"]());
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 1.5
    }));
    return _this;
  }

  return BWHardFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


BWHardFilter.identifier = 'bwhard';

/* harmony default export */ __webpack_exports__["a"] = (BWHardFilter);

/***/ }),
/* 369 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Celsius Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var CelsiusFilter = function (_Filter) {
  _inherits(CelsiusFilter, _Filter);

  function CelsiusFilter() {
    var _ref;

    _classCallCheck(this, CelsiusFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = CelsiusFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(CelsiusFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 69], [55, 110], [202, 230], [255, 255]],
        green: [[0, 44], [89, 93], [185, 141], [255, 189]],
        blue: [[0, 76], [39, 82], [218, 138], [255, 171]]
      }
    }));
    return _this;
  }

  return CelsiusFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


CelsiusFilter.identifier = 'celsius';

/* harmony default export */ __webpack_exports__["a"] = (CelsiusFilter);

/***/ }),
/* 370 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Chest Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var ChestFilter = function (_Filter) {
  _inherits(ChestFilter, _Filter);

  function ChestFilter() {
    var _ref;

    _classCallCheck(this, ChestFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = ChestFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(ChestFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [44, 44], [124, 143], [221, 204], [255, 255]],
        green: [[0, 0], [130, 127], [213, 199], [255, 255]],
        blue: [[0, 0], [51, 52], [219, 204], [255, 255]]
      }
    }));
    return _this;
  }

  return ChestFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


ChestFilter.identifier = 'chest';

/* harmony default export */ __webpack_exports__["a"] = (ChestFilter);

/***/ }),
/* 371 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * DuoTone Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var DuoToneFilter = function (_Filter) {
  _inherits(DuoToneFilter, _Filter);

  function DuoToneFilter() {
    var _ref;

    _classCallCheck(this, DuoToneFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = DuoToneFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(DuoToneFilter)).call.apply(_ref, [this].concat(args, [{
      intensity: {
        type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].NUMBER,
        default: 0.5,
        required: true,
        setter: function setter(intensity) {
          if (this._filterPrimitive) {
            this._filterPrimitive.setIntensity(intensity);
            this._stack.setIntensity(1.0);
          }
          this._dirty = true;
          return intensity;
        }
      }
    }])));

    _this._filterPrimitive = new __WEBPACK_IMPORTED_MODULE_5__primitives__["DuoTone"]({
      lightColor: _this._options.lightColor || __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Color"].WHITE,
      darkColor: _this._options.darkColor || __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Color"].BLACK,
      intensity: _this._options.intensity || 0.5
    });

    _this._stack.push(_this._filterPrimitive);
    return _this;
  }

  return DuoToneFilter;
}(__WEBPACK_IMPORTED_MODULE_4__filter__["a" /* default */]);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


DuoToneFilter.prototype.availableOptions = {
  lightColor: {
    type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].COLOR,
    default: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Color"].WHITE,
    required: true,
    setter: function setter(color) {
      if (this._filterPrimitive) {
        this._filterPrimitive.setLightColor(color);
      }
      this.setDirty && this.setDirty(true);
      return color;
    }
  },
  darkColor: {
    type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].COLOR,
    default: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Color"].BLACK,
    required: true,
    setter: function setter(color) {
      if (this._filterPrimitive) {
        this._filterPrimitive.setDarkColor(color);
      }
      this.setDirty && this.setDirty(true);
      return color;
    }
  },
  intensity: {
    type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].NUMBER,
    default: 0.5,
    required: true
  }

  /**
   * This filter's identifier
   * @type {String}
   * @default
   */
};DuoToneFilter.identifier = 'duotone';

/* harmony default export */ __webpack_exports__["a"] = (DuoToneFilter);

/***/ }),
/* 372 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Fixie Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var FixieFilter = function (_Filter) {
  _inherits(FixieFilter, _Filter);

  function FixieFilter() {
    var _ref;

    _classCallCheck(this, FixieFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = FixieFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(FixieFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [44, 28], [63, 48], [128, 132], [235, 248], [255, 255]],
        green: [[0, 0], [20, 10], [60, 45], [190, 209], [211, 231], [255, 255]],
        blue: [[0, 31], [41, 62], [150, 142], [234, 212], [255, 224]]
      }
    }));
    return _this;
  }

  return FixieFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


FixieFilter.identifier = 'fixie';

/* harmony default export */ __webpack_exports__["a"] = (FixieFilter);

/***/ }),
/* 373 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Food Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var FoodFilter = function (_Filter) {
  _inherits(FoodFilter, _Filter);

  function FoodFilter() {
    var _ref;

    _classCallCheck(this, FoodFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = FoodFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(FoodFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 1.35
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 1.1
    }));
    return _this;
  }

  return FoodFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


FoodFilter.identifier = 'food';

/* harmony default export */ __webpack_exports__["a"] = (FoodFilter);

/***/ }),
/* 374 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Fridge Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var FridgeFilter = function (_Filter) {
  _inherits(FridgeFilter, _Filter);

  function FridgeFilter() {
    var _ref;

    _classCallCheck(this, FridgeFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = FridgeFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(FridgeFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 9], [21, 11], [45, 24], [255, 220]],
        green: [[0, 12], [21, 21], [42, 42], [150, 150], [170, 173], [255, 210]],
        blue: [[0, 28], [43, 72], [128, 185], [255, 220]]
      }
    }));
    return _this;
  }

  return FridgeFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


FridgeFilter.identifier = 'fridge';

/* harmony default export */ __webpack_exports__["a"] = (FridgeFilter);

/***/ }),
/* 375 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Front Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var FrontFilter = function (_Filter) {
  _inherits(FrontFilter, _Filter);

  function FrontFilter() {
    var _ref;

    _classCallCheck(this, FrontFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = FrontFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(FrontFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 65], [28, 67], [67, 113], [125, 183], [187, 217], [255, 229]],
        green: [[0, 52], [42, 59], [104, 134], [169, 209], [255, 240]],
        blue: [[0, 52], [65, 68], [93, 104], [150, 153], [255, 198]]
      }
    }));
    return _this;
  }

  return FrontFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


FrontFilter.identifier = 'front';

/* harmony default export */ __webpack_exports__["a"] = (FrontFilter);

/***/ }),
/* 376 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Glam Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var GlamFilter = function (_Filter) {
  _inherits(GlamFilter, _Filter);

  function GlamFilter() {
    var _ref;

    _classCallCheck(this, GlamFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = GlamFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(GlamFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 1.1
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [94, 74], [181, 205], [255, 255]],
        green: [[0, 0], [127, 127], [255, 255]],
        blue: [[0, 0], [102, 73], [227, 213], [255, 255]]
      }
    }));
    return _this;
  }

  return GlamFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


GlamFilter.identifier = 'glam';

/* harmony default export */ __webpack_exports__["a"] = (GlamFilter);

/***/ }),
/* 377 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Gobblin Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var GobblinFilter = function (_Filter) {
  _inherits(GobblinFilter, _Filter);

  function GobblinFilter() {
    var _ref;

    _classCallCheck(this, GobblinFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = GobblinFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(GobblinFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Gobblin"]());
    return _this;
  }

  return GobblinFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


GobblinFilter.identifier = 'gobblin';

/* harmony default export */ __webpack_exports__["a"] = (GobblinFilter);

/***/ }),
/* 378 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * K1 Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var K1Filter = function (_Filter) {
  _inherits(K1Filter, _Filter);

  function K1Filter() {
    var _ref;

    _classCallCheck(this, K1Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = K1Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(K1Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [53, 32], [91, 80], [176, 205], [255, 255]]
    }));

    // Saturation
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 0.9
    }));
    return _this;
  }

  return K1Filter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


K1Filter.identifier = 'k1';

/* harmony default export */ __webpack_exports__["a"] = (K1Filter);

/***/ }),
/* 379 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * K2 Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var K2Filter = function (_Filter) {
  _inherits(K2Filter, _Filter);

  function K2Filter() {
    var _ref;

    _classCallCheck(this, K2Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = K2Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(K2Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_5__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [54, 33], [77, 82], [94, 103], [122, 126], [177, 193], [229, 232], [255, 255]]
    }));

    // Soft color overlay
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_5__primitives__["SoftColorOverlay"]({
      color: new __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Color"](40 / 255, 40 / 255, 40 / 255)
    }));
    return _this;
  }

  return K2Filter;
}(__WEBPACK_IMPORTED_MODULE_4__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


K2Filter.identifier = 'k2';

/* harmony default export */ __webpack_exports__["a"] = (K2Filter);

/***/ }),
/* 380 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * K6 Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var K6Filter = function (_Filter) {
  _inherits(K6Filter, _Filter);

  function K6Filter() {
    var _ref;

    _classCallCheck(this, K6Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Saturation
    var _this = _possibleConstructorReturn(this, (_ref = K6Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(K6Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 0.5
    }));
    return _this;
  }

  return K6Filter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


K6Filter.identifier = 'k6';

/* harmony default export */ __webpack_exports__["a"] = (K6Filter);

/***/ }),
/* 381 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * KDynamic Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var KDynamicFilter = function (_Filter) {
  _inherits(KDynamicFilter, _Filter);

  function KDynamicFilter() {
    var _ref;

    _classCallCheck(this, KDynamicFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = KDynamicFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(KDynamicFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [17, 27], [46, 69], [90, 112], [156, 200], [203, 243], [255, 255]]
    }));

    // Saturation
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 0.7
    }));
    return _this;
  }

  return KDynamicFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


KDynamicFilter.identifier = 'kdynamic';

/* harmony default export */ __webpack_exports__["a"] = (KDynamicFilter);

/***/ }),
/* 382 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Lenin Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var LeninFilter = function (_Filter) {
  _inherits(LeninFilter, _Filter);

  function LeninFilter() {
    var _ref;

    _classCallCheck(this, LeninFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Desaturation
    var _this = _possibleConstructorReturn(this, (_ref = LeninFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(LeninFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Desaturation"]({
      desaturation: 0.4
    }));

    // Tone curve
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 20], [40, 20], [106, 111], [129, 153], [190, 223], [255, 255]],
        green: [[0, 20], [40, 20], [62, 41], [106, 108], [132, 159], [203, 237], [255, 255]],
        blue: [[0, 40], [40, 40], [73, 60], [133, 160], [191, 297], [203, 237], [237, 239], [255, 255]]
      }
    }));
    return _this;
  }

  return LeninFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


LeninFilter.identifier = 'lenin';

/* harmony default export */ __webpack_exports__["a"] = (LeninFilter);

/***/ }),
/* 383 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Lomo Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var LomoFilter = function (_Filter) {
  _inherits(LomoFilter, _Filter);

  function LomoFilter() {
    var _ref;

    _classCallCheck(this, LomoFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = LomoFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(LomoFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [87, 20], [131, 156], [183, 205], [255, 200]]
    }));
    return _this;
  }

  return LomoFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


LomoFilter.identifier = 'lomo';

/* harmony default export */ __webpack_exports__["a"] = (LomoFilter);

/***/ }),
/* 384 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Mellow Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var MellowFilter = function (_Filter) {
  _inherits(MellowFilter, _Filter);

  function MellowFilter() {
    var _ref;

    _classCallCheck(this, MellowFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = MellowFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(MellowFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [41, 84], [87, 134], [255, 255]],
        green: [[0, 0], [255, 216]],
        blue: [[0, 0], [255, 131]]
      }
    }));
    return _this;
  }

  return MellowFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


MellowFilter.identifier = 'mellow';

/* harmony default export */ __webpack_exports__["a"] = (MellowFilter);

/***/ }),
/* 385 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var ColorMatrix = __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Math"].ColorMatrix;

/**
 * Metal Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var MetalFilter = function (_Filter) {
  _inherits(MetalFilter, _Filter);

  function MetalFilter() {
    var _ref;

    _classCallCheck(this, MetalFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = MetalFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(MetalFilter)).call.apply(_ref, [this].concat(args)));

    var matrix1 = new ColorMatrix(0.8158218291630716, 0, 0, 0, -0.01779810181190647, 0, 0.8098360655737704, 0, 0, 0.0916393442622953, 0, 0, 0.4596336773932402, 0, 0.12760574782432707, 0, 0, 0, 1, 0);
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_5__primitives__["ColorMatrixPrimitive"]({
      colorMatrix: matrix1
    }));
    var gammaColor = new __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Color"](0.8, 0.6, 0.9);
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_5__primitives__["Gamma"]({
      gamma: gammaColor
    }));
    return _this;
  }

  return MetalFilter;
}(__WEBPACK_IMPORTED_MODULE_4__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


MetalFilter.identifier = 'metal';

/* harmony default export */ __webpack_exports__["a"] = (MetalFilter);

/***/ }),
/* 386 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Morning Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var MorningFilter = function (_Filter) {
  _inherits(MorningFilter, _Filter);

  function MorningFilter() {
    var _ref;

    _classCallCheck(this, MorningFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = MorningFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(MorningFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 40], [255, 230]],
        green: [[0, 10], [255, 225]],
        blue: [[0, 20], [255, 181]]
      }
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Glow"]());
    return _this;
  }

  return MorningFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


MorningFilter.identifier = 'morning';

/* harmony default export */ __webpack_exports__["a"] = (MorningFilter);

/***/ }),
/* 387 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Orchid Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var OrchidFilter = function (_Filter) {
  _inherits(OrchidFilter, _Filter);

  function OrchidFilter() {
    var _ref;

    _classCallCheck(this, OrchidFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Tone curve
    var _this = _possibleConstructorReturn(this, (_ref = OrchidFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(OrchidFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [115, 130], [195, 215], [255, 255]],
        green: [[0, 0], [148, 153], [172, 215], [255, 255]],
        blue: [[0, 46], [58, 75], [178, 205], [255, 255]]
      },
      textureGLUnit: 2
    }));

    // Tone curve
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [117, 151], [189, 217], [255, 255]],
      textureGLUnit: 3
    }));

    // Desaturation
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Desaturation"]({
      desaturation: 0.65
    }));
    return _this;
  }

  return OrchidFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


OrchidFilter.identifier = 'orchid';

/* harmony default export */ __webpack_exports__["a"] = (OrchidFilter);

/***/ }),
/* 388 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Pola Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var PolaFilter = function (_Filter) {
  _inherits(PolaFilter, _Filter);

  function PolaFilter() {
    var _ref;

    _classCallCheck(this, PolaFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = PolaFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(PolaFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [94, 74], [181, 205], [255, 255]],
        green: [[0, 0], [34, 34], [99, 76], [176, 190], [255, 255]],
        blue: [[0, 0], [102, 73], [227, 213], [255, 255]]
      }
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 0.8
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 1.5
    }));
    return _this;
  }

  return PolaFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


PolaFilter.identifier = 'pola';

/* harmony default export */ __webpack_exports__["a"] = (PolaFilter);

/***/ }),
/* 389 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Pola669 Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var Pola669Filter = function (_Filter) {
  _inherits(Pola669Filter, _Filter);

  function Pola669Filter() {
    var _ref;

    _classCallCheck(this, Pola669Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = Pola669Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(Pola669Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [56, 18], [196, 209], [255, 255]],
        green: [[0, 38], [71, 84], [255, 255]],
        blue: [[0, 0], [131, 133], [204, 211], [255, 255]]
      }
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Saturation"]({
      saturation: 0.8
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Contrast"]({
      contrast: 1.5
    }));
    return _this;
  }

  return Pola669Filter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


Pola669Filter.identifier = 'pola669';

/* harmony default export */ __webpack_exports__["a"] = (Pola669Filter);

/***/ }),
/* 390 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Quozi Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var QuoziFilter = function (_Filter) {
  _inherits(QuoziFilter, _Filter);

  function QuoziFilter() {
    var _ref;

    _classCallCheck(this, QuoziFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    // Desaturation
    var _this = _possibleConstructorReturn(this, (_ref = QuoziFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(QuoziFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Desaturation"]({
      desaturation: 0.65
    }));

    // Tone curve
    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 50], [40, 78], [118, 170], [181, 211], [255, 255]],
        green: [[0, 27], [28, 45], [109, 157], [157, 195], [179, 208], [206, 212], [255, 240]],
        blue: [[0, 50], [12, 55], [46, 103], [103, 162], [194, 182], [241, 201], [255, 219]]
      }
    }));
    return _this;
  }

  return QuoziFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


QuoziFilter.identifier = 'quozi';

/* harmony default export */ __webpack_exports__["a"] = (QuoziFilter);

/***/ }),
/* 391 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Semired Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var SemiredFilter = function (_Filter) {
  _inherits(SemiredFilter, _Filter);

  function SemiredFilter() {
    var _ref;

    _classCallCheck(this, SemiredFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = SemiredFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(SemiredFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 129], [75, 153], [181, 227], [255, 255]],
        green: [[0, 8], [111, 85], [212, 158], [255, 226]],
        blue: [[0, 5], [75, 22], [193, 90], [255, 229]]
      }
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["Glow"]());
    return _this;
  }

  return SemiredFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


SemiredFilter.identifier = 'semired';

/* harmony default export */ __webpack_exports__["a"] = (SemiredFilter);

/***/ }),
/* 392 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Sunny Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var SunnyFilter = function (_Filter) {
  _inherits(SunnyFilter, _Filter);

  function SunnyFilter() {
    var _ref;

    _classCallCheck(this, SunnyFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = SunnyFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(SunnyFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 0], [62, 82], [141, 154], [255, 255]],
        green: [[0, 39], [56, 96], [192, 176], [255, 255]],
        blue: [[0, 0], [174, 99], [255, 235]]
      },
      textureGLUnit: 2
    }));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      controlPoints: [[0, 0], [55, 20], [158, 191], [255, 255]],
      textureGLUnit: 3
    }));
    return _this;
  }

  return SunnyFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


SunnyFilter.identifier = 'sunny';

/* harmony default export */ __webpack_exports__["a"] = (SunnyFilter);

/***/ }),
/* 393 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Texas Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var TexasFilter = function (_Filter) {
  _inherits(TexasFilter, _Filter);

  function TexasFilter() {
    var _ref;

    _classCallCheck(this, TexasFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TexasFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(TexasFilter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["ToneCurve"]({
      rgbControlPoints: {
        red: [[0, 72], [89, 99], [176, 212], [255, 237]],
        green: [[0, 49], [255, 192]],
        blue: [[0, 72], [255, 151]]
      }
    }));
    return _this;
  }

  return TexasFilter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


TexasFilter.identifier = 'texas';

/* harmony default export */ __webpack_exports__["a"] = (TexasFilter);

/***/ }),
/* 394 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * X400 Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var X400Filter = function (_Filter) {
  _inherits(X400Filter, _Filter);

  function X400Filter() {
    var _ref;

    _classCallCheck(this, X400Filter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = X400Filter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(X400Filter)).call.apply(_ref, [this].concat(args)));

    _this._stack.push(new __WEBPACK_IMPORTED_MODULE_4__primitives__["X400"]());
    return _this;
  }

  return X400Filter;
}(__WEBPACK_IMPORTED_MODULE_3__filter__["a" /* default */]);

/**
 * This filter's identifier
 * @type {String}
 * @default
 */


X400Filter.identifier = 'x400';

/* harmony default export */ __webpack_exports__["a"] = (X400Filter);

/***/ }),
/* 395 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * Lomo Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var LUTFilter = function (_Filter) {
  _inherits(LUTFilter, _Filter);

  function LUTFilter() {
    var _ref;

    _classCallCheck(this, LUTFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = LUTFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(LUTFilter)).call.apply(_ref, [this].concat(args)));

    _this._lutPrimitive = new __WEBPACK_IMPORTED_MODULE_5__primitives__["LookupTableImage"]({
      image: _this._options.image
    });
    _this._stack.push(_this._lutPrimitive);
    return _this;
  }

  return LUTFilter;
}(__WEBPACK_IMPORTED_MODULE_4__filter__["a" /* default */]);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


LUTFilter.prototype.availableOptions = {
  image: {
    type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].IMAGE,
    required: true,
    setter: function setter(image) {
      if (this._lutPrimitive) {
        this._lutPrimitive.setImage(image);
      }
      this.setDirty(true);
      return image;
    }
  }

  /**
   * This filter's identifier
   * @type {String}
   * @default
   */
};LUTFilter.identifier = 'lut';

/* harmony default export */ __webpack_exports__["a"] = (LUTFilter);

/***/ }),
/* 396 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filter__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__primitives__ = __webpack_require__(8);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * 3D LUT Filter
 * @class
 * @extends PhotoEditorSDK.Operations.FilterOperation.Filter
 * @memberof PhotoEditorSDK.Operations.FilterOperation.Filters
 */

var ThreeDLUTFilter = function (_Filter) {
  _inherits(ThreeDLUTFilter, _Filter);

  function ThreeDLUTFilter() {
    var _ref;

    _classCallCheck(this, ThreeDLUTFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = ThreeDLUTFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(ThreeDLUTFilter)).call.apply(_ref, [this].concat(args)));

    var _this$_options = _this._options,
        image = _this$_options.image,
        resolution = _this$_options.resolution,
        verticalTileCount = _this$_options.verticalTileCount,
        horizontalTileCount = _this$_options.horizontalTileCount;

    _this._lutPrimitive = new __WEBPACK_IMPORTED_MODULE_5__primitives__["ThreeDLookupTableImage"]({
      image: image, resolution: resolution, verticalTileCount: verticalTileCount, horizontalTileCount: horizontalTileCount
    });
    _this._stack.push(_this._lutPrimitive);
    return _this;
  }

  return ThreeDLUTFilter;
}(__WEBPACK_IMPORTED_MODULE_4__filter__["a" /* default */]);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


ThreeDLUTFilter.prototype.availableOptions = {
  image: {
    type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].IMAGE,
    required: true,
    setter: function setter(image) {
      if (this._lutPrimitive) {
        this._lutPrimitive.setImage(image);
      }
      this.setDirty(true);
      return image;
    }
  },
  resolution: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].NUMBER, default: 128 },
  horizontalTileCount: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].NUMBER, default: 5 },
  verticalTileCount: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["OptionType"].NUMBER, default: 5 }

  /**
   * This filter's identifier
   * @type {String}
   * @default
   */
};ThreeDLUTFilter.identifier = '3d-lut';

/* harmony default export */ __webpack_exports__["a"] = (ThreeDLUTFilter);

/***/ }),
/* 397 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__);








var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* global HTMLImageElement */
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a frame around the image
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var FrameOperation = function (_Operation) {
  _inherits(FrameOperation, _Operation);

  /**
   * Creates a new FrameOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function FrameOperation() {
    var _ref;

    _classCallCheck(this, FrameOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = FrameOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(FrameOperation)).call.apply(_ref, [this].concat(args)));

    _this._colorOverlayFilter = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Filters.ColorOverlayFilter({
      color: _this.getTintColor()
    });

    _this._frameContainer = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Container();

    _this._resetSprites();
    if (_this._options.frame) {
      _this._createSpritesForFrame(_this._options.frame);
    }
    return _this;
  }

  /**
   * Resets the spriteGroups and sprites attributes
   * @private
   */


  _createClass(FrameOperation, [{
    key: '_resetSprites',
    value: function _resetSprites() {
      this._spriteGroups = {
        top: {},
        left: {},
        right: {},
        bottom: {}
      };
      this._sprites = [];
      this._repeatSprites = {
        top: [],
        left: [],
        right: [],
        bottom: []
      };
    }

    /**
     * Creates the sprites and image groups for the given frame object
     * @param  {Object} frame
     * @private
     */

  }, {
    key: '_createSpritesForFrame',
    value: function _createSpritesForFrame(frame) {
      var _this2 = this;

      if (!frame) return this._disposeSprites();

      var imageGroups = frame.imageGroups,
          layoutMode = frame.layoutMode;

      this._layoutMode = layoutMode || 'horizontal-inside';

      this._disposeSprites();

      ['top', 'left', 'right', 'bottom'].forEach(function (group) {
        if (typeof imageGroups[group] === 'undefined') return;

        ['start', 'mid', 'end'].forEach(function (part) {
          if (typeof imageGroups[group][part] === 'undefined') return;

          // In case object is passed, pick attributes
          var image = imageGroups[group][part];
          if ('image' in image) {
            image = image.image;
          }

          // Create texture and sprites
          var texture = __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Texture.fromImage(image);
          var sprite = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Sprite(texture);
          _this2._spriteGroups[group][part] = sprite;
          _this2._sprites.push(sprite);
          _this2._frameContainer.addChild(sprite);
        });
      });
    }

    /**
     * Renders the frame operation
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_render',
    value: function _render(inputTexture) {
      var dimensions = this._renderTexture.getDimensions();

      // Create and position sprites
      if (this._options.frame) {
        this._colorOverlayFilter.setColor(this.getTintColor());
        this._updateSprites(inputTexture);
      }

      // Prepare render texture for frame
      if (!this._frameRenderTexture) {
        this._frameRenderTexture = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].RenderTexture(this._sdk.getRenderer(), dimensions.x, dimensions.y);
        this._frameSprite = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Sprite(this._frameRenderTexture);
        this._container.addChild(this._frameSprite);
      } else {
        this._frameRenderTexture.resizeTo(dimensions);
      }

      this._frameSprite.setAlpha(this._options.alpha);

      // Handle tinting
      if (this._options.frame && this._options.frame.tintable) {
        this._frameSprite.setFilters([this._colorOverlayFilter]);
      } else {
        this._frameSprite.setFilters([]);
      }

      // Render frame
      this._frameRenderTexture.clear();
      this._frameRenderTexture.render(this._frameContainer);

      // Render everything
      this._renderTexture.render(this._container);
      return __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Updates the sprite positions and scalings
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_updateSprites',
    value: function _updateSprites(inputTexture) {
      var dimensions = inputTexture.getDimensions();
      this._frameWidth = Math.ceil(inputTexture.getDimensions().min() * this._options.scale);

      this._updateHorizontalSpriteGroup(inputTexture, 'top', 0);
      this._updateHorizontalSpriteGroup(inputTexture, 'bottom', dimensions.y - this._frameWidth);
      this._updateVerticalSpriteGroup(inputTexture, 'left', 0);
      this._updateVerticalSpriteGroup(inputTexture, 'right', dimensions.x - this._frameWidth);
    }

    /**
     * Updates the sprite positions and scale for the given horizontal sprite group
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @param {String} group
     * @param {Number} offset = 0
     * @private
     */

  }, {
    key: '_updateHorizontalSpriteGroup',
    value: function _updateHorizontalSpriteGroup(inputTexture, group) {
      var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

      var dimensions = inputTexture.getDimensions();
      var verticalInside = this._layoutMode === 'vertical-inside';

      var startSprite = this._spriteGroups[group].start;
      var midSprite = this._spriteGroups[group].mid;
      var endSprite = this._spriteGroups[group].end;

      var startWidth = 0;
      var endWidth = 0;

      var textureDimensions = void 0,
          textureRatio = void 0;
      if (startSprite) {
        textureDimensions = startSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        startWidth = Math.floor(this._frameWidth / textureRatio);

        var startPosition = new Vector2(0, offset);
        startPosition.x = verticalInside ? this._frameWidth : 0;

        startSprite.setPosition(startPosition);
        startSprite.setHeight(this._frameWidth);
        startSprite.setWidth(startWidth);
      }

      if (endSprite) {
        textureDimensions = endSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        endWidth = Math.floor(this._frameWidth * textureRatio);

        var endPosition = new Vector2(dimensions.x - endWidth, offset);
        endPosition.x -= verticalInside ? this._frameWidth : 0;

        endSprite.setPosition(endPosition);
        endSprite.setHeight(this._frameWidth);
        endSprite.setWidth(endWidth);
      }

      if (midSprite) {
        textureDimensions = midSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        var midPosition = new Vector2(startWidth, offset);
        var midWidth = dimensions.x - startWidth - endWidth;

        if (verticalInside) {
          midPosition.x += this._frameWidth;
          midWidth -= this._frameWidth * 2;
        }

        midSprite.setPosition(midPosition);
        midSprite.setWidth(midWidth);
        midSprite.setHeight(this._frameWidth);

        // Canvas 2D implementations for NodeJS apparently automatically
        // smoothen scaled images. This fades out the edges
        // of the stretched midSprite, leaving gaps between them and the frame
        // corners.

        // Handle repeat
        if (this._options.frame.imageGroups[group].mid.mode === 'repeat') {
          // Make sure we have exactly the right amount of sprites we need
          var defaultSpriteWidth = this._frameWidth / textureRatio;
          var requiredRepeatSprites = Math.ceil(midWidth / defaultSpriteWidth);
          var consumedWidth = 0;

          if (requiredRepeatSprites !== -1) {
            var spriteWidth = Math.round(midWidth / requiredRepeatSprites);
            midSprite.setWidth(spriteWidth);
            consumedWidth += spriteWidth;

            this._ensureRepeatSpritesExist(requiredRepeatSprites - 1, group, midSprite);

            // Reposition all repeat sprites
            for (var i = 0; i < requiredRepeatSprites - 1; i++) {
              // Divide the remaining height by the remaining amount of sprites to be placed
              spriteWidth = Math.round((midWidth - consumedWidth) / (requiredRepeatSprites - i - 1));

              var sprite = this._repeatSprites[group][i];
              var spritePosition = midPosition.clone().add(consumedWidth, 0).floor();
              sprite.setPosition(spritePosition);
              sprite.setWidth(spriteWidth);
              sprite.setHeight(this._frameWidth);

              consumedWidth += spriteWidth;
            }
          }
        }
      }
    }
  }, {
    key: '_ensureRepeatSpritesExist',
    value: function _ensureRepeatSpritesExist(requiredSpritesCount, group, sourceSprite) {
      var _this3 = this;

      // Make sure we don't get an EventEmitter warning
      sourceSprite.getTexture().setMaxListeners(requiredSpritesCount + 1);

      var existingSpritesCount = this._repeatSprites[group].length;
      if (requiredSpritesCount > existingSpritesCount) {
        // We need more sprites
        var missingRepeatSprites = requiredSpritesCount - existingSpritesCount;
        for (var i = 0; i < missingRepeatSprites; i++) {
          var sprite = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Sprite(sourceSprite.getTexture());
          this._repeatSprites[group].push(sprite);
          this._frameContainer.addChild(sprite);
          this._sprites.push(sprite);
        }
      } else if (requiredSpritesCount < existingSpritesCount) {
        // We need less sprites
        var spareRepeatSprites = this._repeatSprites[group].splice(requiredSpritesCount);
        spareRepeatSprites.forEach(function (sprite) {
          var index = _this3._sprites.indexOf(sprite);
          if (index === -1) return;

          _this3._sprites.splice(index, 1);
          _this3._frameContainer.removeChild(sprite);
          sprite.dispose();
        });
      }
    }

    /**
     * Updates the sprite positions and scale for given vertical column
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @param {String} group
     * @param {Number} offset = 0
     * @private
     */

  }, {
    key: '_updateVerticalSpriteGroup',
    value: function _updateVerticalSpriteGroup(inputTexture, group) {
      var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

      var dimensions = inputTexture.getDimensions();
      var horizontalInside = this._layoutMode === 'horizontal-inside';

      var startSprite = this._spriteGroups[group].start;
      var midSprite = this._spriteGroups[group].mid;
      var endSprite = this._spriteGroups[group].end;

      var startHeight = 0;
      var endHeight = 0;

      var textureDimensions = void 0,
          textureRatio = void 0;
      if (startSprite) {
        textureDimensions = startSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        startHeight = Math.floor(this._frameWidth * textureRatio);

        var startPosition = new Vector2(offset, 0);
        startPosition.y = horizontalInside ? this._frameWidth : 0;

        startSprite.setPosition(startPosition);
        startSprite.setWidth(this._frameWidth);
        startSprite.setHeight(startHeight);
      }

      if (endSprite) {
        textureDimensions = endSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        endHeight = Math.floor(this._frameWidth * textureRatio);

        var endPosition = new Vector2(offset, dimensions.y - endHeight);
        endPosition.y -= horizontalInside ? this._frameWidth : 0;

        endSprite.setPosition(endPosition);
        endSprite.setWidth(this._frameWidth);
        endSprite.setHeight(endHeight);
      }

      if (midSprite) {
        textureDimensions = midSprite.getTexture().getDimensions();
        textureRatio = textureDimensions.y / textureDimensions.x;

        var midPosition = new Vector2(offset, startHeight);
        var midHeight = dimensions.y - startHeight - endHeight;

        if (horizontalInside) {
          midPosition.y += this._frameWidth;
          midHeight -= this._frameWidth * 2;
        }

        midSprite.setPosition(midPosition);
        midSprite.setHeight(midHeight);
        midSprite.setWidth(this._frameWidth);

        // Canvas 2D implementations for NodeJS apparently automatically
        // smoothen scaled images. This fades out the edges
        // of the stretched midSprite, leaving gaps between them and the frame
        // corners.

        // Handle repeat
        if (this._options.frame.imageGroups[group].mid.mode === 'repeat') {
          // Make sure we have exactly the right amount of sprites we need
          var defaultSpriteHeight = this._frameWidth * textureRatio;
          var requiredRepeatSprites = Math.ceil(midHeight / defaultSpriteHeight);
          var consumedHeight = 0;

          if (requiredRepeatSprites !== -1) {
            var spriteHeight = Math.round(midHeight / requiredRepeatSprites);
            midSprite.setHeight(spriteHeight);
            consumedHeight += spriteHeight;

            this._ensureRepeatSpritesExist(requiredRepeatSprites - 1, group, midSprite);

            // Reposition all repeat sprites
            for (var i = 0; i < requiredRepeatSprites - 1; i++) {
              // Divide the remaining height by the remaining amount of sprites to be placed
              spriteHeight = Math.round((midHeight - consumedHeight) / (requiredRepeatSprites - i - 1));

              var sprite = this._repeatSprites[group][i];
              var spritePosition = midPosition.clone().add(0, consumedHeight).floor();
              sprite.setPosition(spritePosition);
              sprite.setHeight(spriteHeight);
              sprite.setWidth(this._frameWidth);

              consumedHeight += spriteHeight;
            }
          }
        }
      }
    }

    /**
     * Disposes all sprites
     * @private
     */

  }, {
    key: '_disposeSprites',
    value: function _disposeSprites() {
      var _this4 = this;

      this._sprites.forEach(function (sprite) {
        _this4._frameContainer.removeChild(sprite);
        sprite.getTexture().dispose();

        sprite.dispose();
      });
      this._resetSprites();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(FrameOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(FrameOperation.prototype), 'dispose', this).call(this);
      this._disposeSprites();
      if (this._colorOverlayFilter) this._colorOverlayFilter.dispose();
      if (this._frameRenderTexture) this._frameRenderTexture.dispose();
    }

    /**
     * Validates the given frame object
     * @param  {Object} frame
     */

  }], [{
    key: 'validateFrame',
    value: function validateFrame(frame) {
      if (!frame) return;
      var imageGroups = frame.imageGroups,
          layoutMode = frame.layoutMode;


      if (typeof frame.identifier !== 'string') {
        throw new Error('Frame needs a property `identifier` of type String.');
      }

      if (_typeof(frame.imageGroups) !== 'object') {
        throw new Error('Frame needs a property `imageGroups` of type Object.');
      }

      var validateImageGroup = function validateImageGroup(group) {
        var _imageGroups$group = imageGroups[group],
            start = _imageGroups$group.start,
            end = _imageGroups$group.end,
            mid = _imageGroups$group.mid;


        if (typeof imageGroups[group] === 'undefined') return;
        if (_typeof(imageGroups[group]) !== 'object') {
          throw new Error('Frame: `imageGroups.' + group + '` needs to be of type Object.');
        }

        if (typeof start !== 'undefined' && !(start instanceof __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Image"] || typeof HTMLImageElement !== 'undefined' && start instanceof HTMLImageElement)) {
          throw new Error('Frame: `imageGroups.' + group + '.start` needs to be of type Image.');
        }

        if (typeof mid !== 'undefined' && !(start instanceof __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Image"] || typeof HTMLImageElement !== 'undefined' && start instanceof HTMLImageElement) && (typeof mid === 'undefined' ? 'undefined' : _typeof(mid)) !== 'object') {
          throw new Error('Frame: `imageGroups.' + group + '.mid` needs to be of type Image or Object.');
        }

        if (typeof end !== 'undefined' && !(end instanceof __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Image"] || typeof HTMLImageElement !== 'undefined' && end instanceof HTMLImageElement)) {
          throw new Error('Frame: `imageGroups.' + group + '.end` needs to be of type Image.');
        }
      };

      if (typeof layoutMode !== 'undefined' && ['vertical-inside', 'horizontal-inside'].indexOf(layoutMode) === -1) {
        throw new Error('Frame: `layoutMode` must be one of vertical-inside, horizontal-inside');
      }

      if (typeof tintable !== 'undefined' && typeof tintable !== 'boolean') {
        throw new Error('Frame: `tintable` needs to be of type Boolean.');
      }

      validateImageGroup('top');
      validateImageGroup('left');
      validateImageGroup('right');
      validateImageGroup('bottom');
    }
  }]);

  return FrameOperation;
}(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


FrameOperation.identifier = 'frame';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
FrameOperation.prototype.availableOptions = {
  frame: {
    type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].OBJECT,
    validation: FrameOperation.validateFrame,
    setter: function setter(frame, initial) {
      if (!initial) {
        this._createSpritesForFrame(frame);
      }
      return frame;
    },
    default: null
  },
  alpha: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  tintColor: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].COLOR, default: new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Color"](1, 1, 1, 0) },
  scale: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.1 }
};

__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default.a.Operations.FrameOperation = FrameOperation;

/* harmony default export */ __webpack_exports__["a"] = (FrameOperation);

/***/ }),
/* 398 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__watermark_filter__ = __webpack_require__(399);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__watermark__ = __webpack_require__(401);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





/**
 * An operation that renders the PESDK watermark to the image.
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var LicenseWatermarkOperation = function (_Operation) {
  _inherits(LicenseWatermarkOperation, _Operation);

  function LicenseWatermarkOperation() {
    var _ref;

    _classCallCheck(this, LicenseWatermarkOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = LicenseWatermarkOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LicenseWatermarkOperation)).call.apply(_ref, [this].concat(args)));

    _this._applyWatermarkFilter = function () {
      if (!_this._watermarkFilter) {
        _this._watermarkFilter = new __WEBPACK_IMPORTED_MODULE_6__watermark_filter__["a" /* default */]({ watermarkImage: _this._watermarkImage });
      }

      _this._sprite.setFilters([_this._watermarkFilter]);

      _this._renderTexture.render(_this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    };

    _this._loadWatermarkImage = function () {
      if (!_this._watermarkImage) {
        return new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"](function (resolve, reject) {
          _this._watermarkImage = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Image"]();
          _this._watermarkImage.onload = resolve;
          _this._watermarkImage.src = __WEBPACK_IMPORTED_MODULE_7__watermark__["a" /* default */];
        });
      } else {
        return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
      }
    };

    _this._watermarkFilter = null;
    _this._watermarkImage = null;
    return _this;
  }

  /**
   * Applies the watermark filter to the render texture
   *
   * @memberof LicenseWatermarkOperation
   * @private
   */


  /**
   * Loads and caches the watermark image.
   *
   * @memberof LicenseWatermarkOperation
   * @private
   */


  _createClass(LicenseWatermarkOperation, [{
    key: '_render',


    /**
     * Renders the watermark operation.
     *
     * @param  {PhotoEditorSDK} sdk
     * @returns {Promise}
     * @override
     * @private
     */
    value: function _render(sdk) {
      return this._loadWatermarkImage().then(this._applyWatermarkFilter);
    }
  }, {
    key: 'dispose',
    value: function dispose() {
      if (this._watermarkFilter) {
        this._watermarkFilter.dispose();
      }
      _get(LicenseWatermarkOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LicenseWatermarkOperation.prototype), 'dispose', this).call(this);
    }
  }]);

  return LicenseWatermarkOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
   * A unique string that identifies this operation. Can be used to select
   * operations.
   * @type {String}
   * @default
   */


LicenseWatermarkOperation.identifier = 'license-watermark';

/**
   * Specifies the available options for this operation
   * @type {Object}
   * @ignore
   */
LicenseWatermarkOperation.prototype.availableOptions = {};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.LicenseWatermarkOperation = LicenseWatermarkOperation;

/* harmony default export */ __webpack_exports__["a"] = (LicenseWatermarkOperation);

/***/ }),
/* 399 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/* istanbul ignore next */

var WatermarkFilter = function (_Engine$Filter) {
  _inherits(WatermarkFilter, _Engine$Filter);

  function WatermarkFilter() {
    var _ref;

    _classCallCheck(this, WatermarkFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = WatermarkFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(WatermarkFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(400);
    return _this;
  }

  _createClass(WatermarkFilter, [{
    key: '_applyWebGL',
    value: function _applyWebGL(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      var gl = renderer.getContext();
      var canvas = gl.canvas;
      var shader = this.getShaderForRenderer(renderer);

      var frame = inputTarget.getFrame();
      var existingCanvas = this._watermarkCanvas;
      if (!existingCanvas || frame.width !== existingCanvas.width || frame.height !== existingCanvas.height) {
        this._createWatermarkCanvas(frame.width, frame.height);
      }

      // Create watermark texture
      var texture = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Texture.fromCanvas(this._watermarkCanvas);
      var baseTexture = texture.getBaseTexture();
      renderer.updateTexture(baseTexture);
      baseTexture.setGLUnit(1);

      renderer.setRenderTarget(outputTarget);
      if (clear) {
        outputTarget.clear();
      }

      renderer.setShader(shader);

      var projectionMatrix = renderer.getCurrentRenderTarget().getProjectionMatrix().toArray();
      shader.setUniform('u_projMatrix', projectionMatrix);
      shader.syncUniforms();

      gl.uniform1i(gl.getUniformLocation(shader.getProgram(), 'u_watermarkTex'), 1);

      // Render!
      gl.activeTexture(gl.TEXTURE0);
      gl.bindTexture(gl.TEXTURE_2D, inputTarget.getTexture());
      gl.activeTexture(gl.TEXTURE1);
      gl.bindTexture(gl.TEXTURE_2D, baseTexture.getGLTextureForRenderer(renderer));

      gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);

      texture.dispose();
    }
  }, {
    key: '_createWatermarkCanvas',
    value: function _createWatermarkCanvas(width, height) {
      var image = this._options.watermarkImage;
      var watermarkCanvas = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].createCanvas();
      watermarkCanvas.width = width;
      watermarkCanvas.height = height;
      var watermarkContext = watermarkCanvas.getContext('2d');

      // Scale according to aspect ratio and place at center
      var scale = void 0,
          x = void 0,
          y = void 0;
      if (width > height) {
        scale = width / image.width;
        y = (height - image.height * scale) / 2;
        x = 0;
      } else {
        scale = height / image.height;
        y = 0;
        x = (width - image.width * scale) / 2;
      }

      watermarkContext.drawImage(image, 0, 0, image.width, image.height, x, y, image.width * scale, image.height * scale);

      this._watermarkCanvas = watermarkCanvas;
      this._watermarkContext = watermarkContext;
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the CanvasRenderer
     * @param  {CanvasRenderer} renderer
     * @param  {RenderTarget} inputTarget
     * @param  {RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var canvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var image = this._options.watermarkImage;

      this._createWatermarkCanvas(canvas.width, canvas.height);

      var imageData = inputContext.getImageData(0, 0, canvas.width, canvas.height);
      var waterMarkImageData = this._watermarkContext.getImageData(0, 0, canvas.width, canvas.height);

      var inputColor = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"]();
      var overlayColor = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"]();
      var outputColor = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Color"]();
      for (var i = 0; i < canvas.width * canvas.height * 4; i += 4) {
        inputColor.set(imageData.data[i] / 255, imageData.data[i + 1] / 255, imageData.data[i + 2] / 255, imageData.data[i + 3] / 255);
        overlayColor.set(waterMarkImageData.data[i] / 255, waterMarkImageData.data[i + 1] / 255, waterMarkImageData.data[i + 2] / 255, waterMarkImageData.data[i + 3] / 255);

        if (overlayColor.r > 0.8) {
          outputColor.copy(inputColor.clone().mix(overlayColor, 0.3));
        } else {
          outputColor.copy(inputColor);
        }

        imageData.data[i] = outputColor.r * 255;
        imageData.data[i + 1] = outputColor.g * 255;
        imageData.data[i + 2] = outputColor.b * 255;
        imageData.data[i + 3] = outputColor.a * 255;
      }

      outputContext.putImageData(imageData, 0, 0);

      // outputContext.drawImage(this._options.watermarkImage, 0, 0, canvas.width, canvas.height)
    }
  }]);

  return WatermarkFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

/**
 * Specifies the available options for this filter
 * @type {Object}
 * @ignore
 */


WatermarkFilter.prototype.availableOptions = {
  watermarkImage: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, required: true }
};

/* harmony default export */ __webpack_exports__["a"] = (WatermarkFilter);

/***/ }),
/* 400 */
/***/ (function(module, exports) {

module.exports = "uniform sampler2D u_image;\nuniform sampler2D u_watermarkTex;\n\nvarying vec2 v_texCoord;\n\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  vec4 watermarkColor = texture2D(u_watermarkTex, v_texCoord);\n\n  if (watermarkColor.r > 0.8) {\n    gl_FragColor = mix(color, watermarkColor, 0.3);\n  } else {\n    gl_FragColor = color;\n  }\n}\n";

/***/ }),
/* 401 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
var watermark = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDA4NDFGODc4N0ZCMTFFOEFCRjZEQ0E4MkRCQzYyNjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDA4NDFGODg4N0ZCMTFFOEFCRjZEQ0E4MkRCQzYyNjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMDg0MUY4NTg3RkIxMUU4QUJGNkRDQTgyREJDNjI2MiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMDg0MUY4Njg3RkIxMUU4QUJGNkRDQTgyREJDNjI2MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ppk6b2UAAAASUExURQAAAP///8zMzDMzM2ZmZpmZmer1GSkAABunSURBVHja7F3rgt6mDlzr8v6v3O5ukqaJbQSS0GDjn+c0+9lomBkJEB8fD3tEPvbz5ocO3oPw6vgfx+aA9z56HBsBL37k+H50D8UrHz6OjYAd/42ANxvAjYC3G8BfD+0ReacB3AjYBmAj4IXPcfJQVVFQaFuQSgNYiwBW2uxTbADrEMDyA4p7RaLUABYhgP8D4i5H1xrAAgT8mvzbgWIYgLkI4D9VaGtAuQGYiAD5G4NbAxAEYAoCvmz/rkJAVQAmxoKvCGhrAIABSEeAXP/81oDiDDAfASx36NvFQAgDkIcA1kLh2U+HAKTMx1b4twlAyADTEMBUgLn9DAtAcDyYCo3HfroywAQEiFl2tgbgCEAYAuzh34lgUQaokheRnvBvE1BjAOiuNiATw79NQE0GyB9JCOgN/zYBJQIgd/+nIybcH/5tAgoEQO/hMYqAofBvDZgvANTOEAYWh1mPYwNgCQFgQ45Is8K/TcB0ARBTlaAPAY7wbxNQJgD3oevIz+3WX8+YYmtAlQDEIMAcfhI+p6WtAVUCcI8AEzWzPfyXvLQBME8A1F4ssiDA7P1Ibn5tV4PnCUBPubA9NcUafr79N9sEFArALY3flwOs4q/ceDPaGhD+aJev44Fk0Mr+ym2+2QCYIwDUSxg38iyD4T8FwK4EzHGA/BGFAKP3V7ZBZ5uAUgG4n9EyXPhTtmJtA2CGA6RBR89j5k+5g562CZggADJEG395dHaGf5uAIgfYrraoJRUQb/i3CUh/OkpAtoKQ9k1/5W6F2gBId4AmkqWGEZTOqp/domwTkOwA1fFvf8bHMv1NRb3tAqFKAFYEGKY/yShH7fWgXAcovn/+ObMNub+Mk9Q2AakOkLwAOgK83wZAnQNk91+IEf9tApAdYCsVCBD/XQoqcYAU8UdC9/XKdoHfbCs8gwAk5K9EiP82AX9NNSJhxiKATiNIEgPUF5qAX8NAGgMCiTp4I3nsv13gxTwg8usBhTVg0Azvf//35eUACGACCTx6SVnsf/mqLzQB5wEbBgEHUrTJCGog9l8JALo9QxVD2xQYoqjpf/7tGwBOIuDgo9eS2ttpu0CDzvYRgUaHSdOm//kffx0ALDJL5iJLNAHcAtRfttu1QHPBzSgGGt96gbOm/3aBvdWWthhwRvcdyWvtuAHQu+7awACl9F7RvKY+2wX2L7rdYCCFAD6MXWY2ACYB4AYDlDRROU0EZBeDx9oqnmIgiwDMjYZCoPWyNICP4cdy5D6KUTVJBLYLdADgz/oAZ3n1a6LShL+7ATAqBZrZf5OTROD1LlAO9/OjIpNKAGki8HoA0BHwfElBKgF8jJ4232nADAB80UAuAWSJwOvTgCgA5BXrGmql4QCglwOAhKJQoTPAKuED8B86fnvkt+f3//15ScDn97MQHAEMNh0acYGi9P1YtO/7UZUl8XAtgcxKWATgPnM8QwO/0SDLYIFvx9OJgfghoPjf0TQD9BMJqwHgj25c42KgU17X9UMBNGcGwjJ1II4aJZ7zvqO/xHFm14oDQBhYd0UOYCAnm4o5dzg7+L/DAAsDHZXQXgzwLM3q9IFTaH/6uGRkwT4M0DzO6vixoPzWQwEfCwOgBwNpFXXHr5VH/wEA+DDe0ZD3naOHT4uZH3OpabASbiBSmQlaw+8JRPThLMD4UkgLAzz1pVuvDRN+tIuJXIuhd5yauqTae/wIJ/xwFoCd3H05tDz5rW9GFin8cJsN2B26cxpIxrnYKQAr/HD7zSTgDaXA6lopgMHC/0gAaMFnim1sFS38cLuNAhokcInQWXRH4KY/3n7DgE3RFQpgoQD2Tf9f+3z+t//r/4+IdmwdgtxxHAAAquE5akwvGY770HaeH4jQFhoYHgC9weOie9hPA+yY/t+r9THx+cLCKRDgNhwHAKAK5nRDsNIZ+5yNGitcSeMHgFbBXK5toHbEXvM26axwHYEfAFQGc7rgHnPuTzK9XsmPA0DhV8q5DbTRf+bMv34/OAvgPxdV+JV8utamtujXMJQ+DwCVXzmY6CuX4ZMXAIC6ASCFb1+t+68DQO1XDnS4mze2uoAFcG8HKDY6ghv+Re6kcwOg9isZN/yLXEjl3g9S3GGnQwNmG/A1bqPxAqC6vYZZA+ZvxaQNACAKEISRRWw+5QVA+X0LBJT4N7mJnweA8iZ7Ajn9V0kCHwAAhpz+H8tcTC7hAKD6gUYY9VVuJXYCAKDHnmKew1pEARIAoABTDWDxbYWVwBwACBAA6kR3kSTQDQCpFzqGPIari1gAbwQB7t1UyBMYtIgF8AKgvtc+Qx7AWEYB4gGAkgUK2rCC3kKxOgAEswvHMgqwPAAwT+CuowCrA0AxD+CuowCLA4Ax47+QAiwOAELk/6UUYG0ABDYOf2cV6MO9HFwLAALtwLGQAiwNAFQCWEkBVgYAAxaAllOAlQGgmA5wLQVYGACwBLCUAngX9AsBQKgEsJQCrAsAVAe4mAJ493TVLQejpoBFXROrAFC2IWQpAgBWAO+23qotYbAO8LxtzQfw41NxLgIAbAq4mgIsCgBcAlhNARIAIEWjjEEADGpNJwJgwufiOsDFigABmXxJIQA2BTzdogZtAd2ZfAUAzveBQYymLKcArUz+99sRQAAA7ADXs4CnmP3tGgz6+woN+r5CI4ZAnpUCrlcE+BhrtvnzYo1/cTC/FMjA93DoakWAz/tfD9cznwGAHeDHsZACfM7ejquOeloxvzUFXMYCfoX+SHto+iRDGWV8C3h1k9E6AAB2gOAW8Cv2x5Rn9r3xKD4L1gJOjH02AGgxAqhXAD6/2zv1yUM9sgO8UCcpfLvJE3/CjEROAT+gGlUmG/0iAEATgMD0Kq1g/SkhgXaA9x1L50GAEW5MT4oJcgrYbFo9AwJVmj+JAhYmgAkQqOf9dF+GnALa1tT00byfTQHQDtB4hWXKtVVQUz9xYkKngOZF9WAIMGT0U6T5CQTwDQFeg/h/bglSVZHPPUKnm4Sun1c5wL5dNUFuUJOCLtcbAH/SDkt7K4FOmGIwS21aYZI1NvByG/SBaiNvAsi1AhwTehVmnw7RBB9IjyKAICtA3tAzx8xS1mwKwHaAg1PRbQWkatbPV2jkfWAOMZbpwPua9utVaYGPAvm02KkDhBD7CRyN7QDP4WnN0V06YL85O39fSmadDtsB8tXbMaXrAFVP/CkUwNAO8DwI329ng4BDB7Q98bl0HAidXBIJoAMCEjs3ZrH+JKGWZQnADoFhEiCM4GemgoydAkr7q00Q0Lifr7owK4kCsFPAJgF8h8li1sZGCokdU7h6xRTwhPYsENCoFyCo2aAJfxM7BTzHvOaQAD+cAlZ0gBeQZ00hAUJySPHTldZzgNfwNLjBfhKAooBwwX4QAVitgEa8RJlHCk4FV3SADXhqeE1AoLKk2KRdF3SALXgarID6x7xskoRyNjgBjDqetg70kQBUJhjq2lbcBybj/3QU5Qw1TQKX7lbcB2aEZzsf0GUpIE63sVNA8sGzqQMdMoDVmyZMuBWaADRl3g7+McKngKMOSBPNbt9XchgJCNZUiaFu6BSQYzZ2aJQXxKKAEPO2YjeI/iFvkoA+hwJo/t+YrHJDIy4xMoDllwNm74r9wMboqUkCsiAF+PUbeR+YBJ+FlAAZ4IdRAPI+MA4/Dd0iAYsMKBYFOBkc2QFyxjm/VjrAq1GAMxUEdoCccxi+RQLyKgoAPgp0GSj326nTCCxBATSDPkriH3EAhnxGAIwCODilgSCAy/jHoFNdCECjgOFU8GKdleufy3wtyp6IywgsQQHqnQeQD6dTjGX0GMw6DzI5rxd/ySZOYzjBKGDQy9Fy8dcJ88YEADQKGMrmZLn4R4/w3bZhHqAPAaMAehgBxM8wHfYaa1CAPIsABCf+eBTQvaazoAOMvhhOPVBDo4DuVd0FU8CvL2KM+ONRQO/x2WPVJ6otizP+eMsofT6QjuPdEFC31VCwgnCXD5Rj6ccPAfLXGuAooGdJgI7j1RAIiD/edvoOCtBj/cdjB0Pif2G80Sjg7IX4eMQzCgEOir+lcyHmkoAeD3mkNP4XA46fCvLxmGeg3RsHrjXBbaixpYJ0POhRros/3pY6kw+U41lPwDmo4bgtmQqef720n3N+kZyn455WLYs/3rZ6AwWMZ6+T4W6/q9d3ut/F23AHa5q2xPPG0ysfZgw43t+p27qED9QYzqqAu/VGqKL4412y0KAAX+JSkvbYaKAtA5QR/+VSQWfeUpT2mGiAR8s/zg9Yygd64VoGd0sHeBlL/70AFjQRuNkd5hfxOrizp+mnRNeT29oCeVDIb+Mr0x4e7veXGn9fJ9OpPjAieqWL4E0IaK/9D8GuFs6KLp6O4O/iygcPHO7Pjv8qIsAxlbzqtKcBAe2x/1HAFTQROJ/qQTlc+QrY/cFe7fiPw2CLJgIdK/4cxS/1LucMAXLMiP/VgIO1D4wCKUDl41YH1DYOofe+womAdR0tvNSEQAJqiv8E1S0UAckSgEapCcMJSFv+o00LnAhQGgF8oLSX1XsEyDEx/ldvUycCnEcAMCtgcvdlk+N/NeXq1gRy7s9FSQWbKKcjP/03vYwAU0B4qWn+Rw7tcJapU67MBkjmOMCcixtAAM99F7CbJYNeDGczZO8xJ+LZpKugFMAJ4/4BjwAteBWBpADN+OOKjgAtGfEqG8CZSgi0GVKr7V9rxMtsgGZOBaDNkAoS/8s3ITgKoKw/XqN3VGz/miNeZQRl+k6oIqwbEECV411mBClxMJAoIPaW+Iy8S6AogBP/eI3l5XL5b1kRBqIAyhz0Irnj6tFvkhDSzJBMxDMU2VXbv3J7pJM9QF3OI6jyXzwwaRRAaI63MAlXhDrkZKsmaEi/hKRU/TAIAmhiJbCWArjGfnFKP6PsYeE0AsBb/aAS2OEgIMMHMiDVXcNS5/8k0tBkpIKKmPNWpKbdfXcVZlQyaQ9tHxTBxH9OVcKUCmr4MANvhtWZcMNDQHQqaNC9MgqQeSJwb/8FSSGDU0HYlHeqCHBjmgsQQcamgibhqzsWN2nM22ePBGh+RKaCtsQX7lgcT4y/NP+b2UYgMhU0Oh+09gg0L/5s4UqIA/WZlS+0HjmhI25tPaE42UCYDzSnPnA9cubEX+1+SespgGO5D1sEdH78GwggqaYAiplcinZ7Tmrrvj5lV5SqUIwPvEgn0LqmZ/Zv7e08pyiFwYhU8BJFaF3T01r33ZX/LmLZ7HDL61DAZZzhbs+hHB94G//hytkkCPh5+uYvrHGXsibGXz3OeY4QuK3azR+Ao4CM+5yGL54w5E4zMoLUG0PgLtCa1RjFBHVL+YyESyiAfN8v4aWmVLhLSfytW0ezzYCPpxsyv+hdyiHx59Hhm00DHqvWRM+CF6nGlECNDs5aRE3FgMMbN+P7aB8YsbRrP0GQh4Fxnjb8S7RUMNCWSMyyZ8cmUkp6hn/MwB2rXaQaEv++z5OhfaS4T9aAg/nAyM1d+qT4Sx7nZvpALoz/aIdjyIfyOBch7THkf2MO9zE6wOm5d1LaI6Xxf4wOaHruneUDqTj+tuuwVyQApDbSd5wkxfF/BAQ0vNQ0zwdSefwfAIHs3BuBAm4ce4SsLQ0BmbQGk5QKOsATaWvWhQAl597ZqaBAxP9zuBZNCjk394agAHUt/z67LqDTlmGzKEBh4v8x2GkClQBW2R3Gw/Gfe9R8LQeIuSQgA++jARsA/Lnmcg5wpVSQxyelvDv+7e9HSwX7KaCRn+mrDQANglpWooBppzovf4cAnmETrMtTQNOaSeKbFXumADe3BgWMF4K/xiGCBHhaqhHHTjwObMaigDEvExokQo6/axov0TPCUQyK+R5Fjr9PyJ9BAS0j4DzSycj679VxtFSQxl6ntYdTw2kJJf7eCKL5QBl9nQYCHAmhQsffzeH6DAow9HiJFQDCiL9/bxfaQaFhCmgu1gySwHiZpS4FnMshKBTQPsyhYSOMEv8QBacFKIBd0XKQACMngEEenh9DAYY1e40YYRQDGMXeYD7QQwFtGeirCQi0AYwib7RUkFxf1SYBdo4MigGIs29gB4XE91kcd1uWQhuAwAQOTOi8b9Pcxm80g4wtAIHSDZYKipeQ2vs3TXgiaAEIVW6sJQF2f1lbBmh0iQlFAGJjBuYD1f9pAZ1/CVoAgllb8Smg89sMTV6UJ44waAq4EAVkdHqSKR57AQJAwzuHvIyBBK6tgEILQMKExVoSoJiXMZDAhRVgbAeYAE8sCpCg0pSl3ZuaLxHSBxMAmumlqA+0NHdQ4whjO0BCRFUoBYx9oYUE/rIC+i4HCGd7+PzUH0eO1x0EPB1r1ksBwSjg3+BT9L4+6oSArucAI/Sp3gfeBN83B03dHX5BgN+WAkKkgq3g+77S1unrBwT0bSlgufdlIdMBfM9n2ro8fUJgRQIIClJBKvg58e3dFzh86pxAQN+XAtb4QLZO/Cg9ctwC8NRVQNskgYh9SByGu/3BEED2GlX6Ghj3cf6cakcy86SngOkME3JDmjP0YeUOWpgAJmj01fCQMo9HXvyhD6x30LIEMMGl3zXEo08UcE/gP+d8bIc1zeM5fAKYUqprb6omEvkMLp/H/N/5/jnhKaW1XtAF7n0d4J92FGicAv6GgqllXVTwIy9r7YHAqwgA9bYsCr+13ewGUQhg2jZFekH0e9wgyirAtPV6rMbolHlTuwUC2ASQgk56+tTvgsCjukGE+8BVp74dAigEMHW3hr4l+AYIQBNAVoWK3xP8JgT4hQRQB4CK4N9DAKQKPHvDJtUYvtLZJgRMALO3bNP8ic+QLEvvJICJpQCqnvj3qAd+tVRw8stif/XNIAQwf8M+vyv2lzIrwASg838yKPQCF/tLzDMsNLPfjRIi37edBIFmH3EpSBgAnKv9uKFHt4Alp3blbDT4azf3IBDAAYBrAWvOa/Ed53xt+1I9u8VS9Wu3mCwHAFwLWNO5g32CyMsBAFYBis5ssw90jLuqZudZDAtYtUJB7wKAohJAWSv3cADoagRAqC82ZzKFA4CQASCoFrCudxv5KJHWAgCqBSxsV6dvAgCsAhQ27ZE3AQBVASrbdvGbAECYBFDauO9NAEAtApS27nwTAATTAtZ27nSWcpYCAKgC1LbvfhEAQBWguHGrs5anC60GgZaBi6/weBEAMBWgunPzewDAkEWA+t7tPhVfaEcIpgLU397wGgBAKgDA5Q1vAQCkAiDcW/0WACBWgQRgX63TBK4DAEAFEIST6m8BAKACXPVn+dgAeIUCEEavGmcpeBkAoCnAZfvK2W/lXA1cBQBoCiAwJ6vkHQAAUwDF6Van7wCAIinAXffi6W9F7wAAAa0EC9ThWueC/iIAYCAFUKiOtd6THYsAAEcBms3rdQPgyQrQbstG5S8kzqkFCACUJNB0d8Xc8fMGcA0AgCSBtq6Mc5FJrwAARBnQenXN1Ddzn+6lFQBwNvTTFcDemp/XBgDgtnCAJLDnEkuphaU+DwDlSWDfNbYz383N4EsAoDgJ7L7FmBfixhUAUKsAAzfZz0OnuPlnBQBIHcuyDHXb5HW4cQUAlCWBpmtrqdIG+tOjRQEgM6Jvmvxc2bYmQBwXAECBBWBj9A/i872BkyggID1aAACTLYA5+D/jXHiFkd8CrNAncGIS2BP87+n/+ZTZwABuXKFT6BQL8NlWvbO/vt4Q8ZxpFKAACwCAL641oa9+9+yP/NfdCv0Xq8j9G/Ia3LhAs2hp3nDzfb1RDxz4+yaF4Us1/hhoqqGAiF0SC9wX0BOi/12I8eP5N9I/nv+uzjicD0kbo1yhAN2/+jAATHrU8o4Vd4X0/yj+lkCGCz+xTaakQBvleQAQtPCfjnHFqnBI53T8HWEEzv5lFHBOjequBG8A3IWfu3LV6Rbwm6Ie1SqYVwj/VTikaGBINgDitf+eXKdfGSKet10IAIps/ZovqoXSaMMAPAAInfuLKEBssOX+t6atAGOmSqb6QIp5e/i1IF4k+le1gCwfyEHfAL8WJLW2j/3vmiMCGoRj+KUACVi5GQp+XzZ9Q8sEQoznH7REd4CBvRrzg39NAVJPANcYWOm2gO+NG9lAEM8Wk/OXQ3JGf+aGtA4AfgeC5gGB4wMTb6sljOAWuzn4DyD83NQTCQZJoOZwEYgray4MgL/BIPrfhqDWjiH93CnEEj5djxk+UOKczkMAcAGJkye7DiYzRCDQ7h5PBUDZWhjli0BubURfDgCvCeYEb2kgAO060ZJngjYALnwgJRMAfww1MjjWywLT7ZQkgCp0Yt3gK4IG3gWAjMWw5Iuk9P6Ps24A+ABAOSGKEoH25kN2ScG7koCcPJgz7bVp76EDAxsAARwoef7avPt41A5sAESIoKbJa8/m4yEM6MsAICkTlbNmV+/xg34MyMsAkLQpMutKUeqPWScGeAMgRAUpZX4N7jvtwcDbAJCzHHbdW5bjYWX6k9a84G0eMMcFStIA+zaef26o2gCw2GrvcpAmueyAoydNMXgfAML3hEiazdaQiN2LgbwOAMEu0FCK5zoC+PmXromANwBcAJBEn0WhinLhCN4HgEgXyJlOO+Hc0QkINgAco6Cp5VbKKdz+HwTv84BxLjD5VilNPHPyubv+vQCIMQGd+zA44C1jPfunMaTXLQVdDS0H0EgsAuacO+UXWoAIEzCw/YIiAPbKcE0BQBe1ju3C6yPbXbWb6wJ7hnZ0E6a6f2MTAIALNLA/uVOBWYeOtwb0Ti5L+PnDjYBZbQc2ADrX2MlG9OxMBeY1HnnpM3YBt8n7yW2SSDacbQcIaAJM4f/VjkU8ySBtB4hXCtLOgq+OpwKyHSCcCTAVfv7fjYlGEXBhIHbQkgGgzvD/2VyaR9eFaDtArFKQreyr1pnciqVsB1jkAtkRfmJzKBsImNBvZD92E2Bc9JFO48hbAAABIKPhv75boB8BWwBgTID5ZI10G7rrgtAWABQTYF7xlZGU7nJO0y4BQJgAc/h14IKWGwRsAYCoBJjDb6nsS8fuAN5ndwBMgNjv5hn9oSsEbAGoNQFHT/jt81KtCNDtAKsTQXtbhZ4Le40I2AJQDoAjI/x3P6VbAKBMQKD360fAFgAAExDo/Yy/JQ08bgEA0wCSYLTJ7X+wBQALADQ8IaWBANoCgG8CSFJ+Ta4NwBYAIBNAkoU32QKArwEkiYxzUX3aawDJj84M/0f/mcJtAEA0gGQ64rYATAEATQ1/JwK2AECYAIo14roFYKlEkLgAczsDRDEByjWsswUAQQNIefpv7oNgMIkgSQnqtgHA0ABKFWBD8rEzwEoN0Ozp10TANgB1GkAygX1bCNgCUKUBOmno7xGwM8CJAKAJvr8TAdsAlJgA5TLkbQNQ+Mg85TciYBuA2SaAtGTMeXcCwMgDykb8FAHbALy7CrENwLsRsOP/cgRsA/g+C7IN4EbANoAbAdsAbATs+L/2kW0ANwK2AXz1w4+L/z8CDADebzi4XHs84QAAAABJRU5ErkJggg==';

/* harmony default export */ __webpack_exports__["a"] = (watermark);

/***/ }),
/* 402 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__linear_focus_filter__ = __webpack_require__(403);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a linear focus
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var LinearFocusOperation = function (_Operation) {
  _inherits(LinearFocusOperation, _Operation);

  /**
   * Creates a new LinearFocusOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function LinearFocusOperation() {
    var _ref;

    _classCallCheck(this, LinearFocusOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = LinearFocusOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LinearFocusOperation)).call.apply(_ref, [this].concat(args)));

    _this._lastBlurRadius = _this._options.blurRadius;
    _this._lastControlPoint1 = _this._options.controlPoint1.clone();
    _this._lastControlPoint2 = _this._options.controlPoint2.clone();

    var blurOption = {
      blurQuality: {
        type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING
      }
    };

    _this._horizontalFilter = new __WEBPACK_IMPORTED_MODULE_6__linear_focus_filter__["a" /* default */]({}, blurOption);
    _this._verticalFilter = new __WEBPACK_IMPORTED_MODULE_6__linear_focus_filter__["a" /* default */]({}, blurOption);
    _this._sprite.setFilters([_this._horizontalFilter, _this._verticalFilter]);

    _this._horizontalFilter.setDelta(new Vector2(0.5, 0.5));
    _this._verticalFilter.setDelta(new Vector2(-0.5, 0.5));

    _this._filter = new __WEBPACK_IMPORTED_MODULE_6__linear_focus_filter__["a" /* default */]({}, blurOption);
    return _this;
  }

  /**
   * Applies the given rotation change
   * @param  {PhotoEditorSDK.Operations.RotationOperation} operation
   * @param  {Number} degrees
   */


  _createClass(LinearFocusOperation, [{
    key: 'rotate',
    value: function rotate(degrees) {
      var controlPoint1 = this._options.controlPoint1;
      var controlPoint2 = this._options.controlPoint2;

      if (degrees === 90) {
        controlPoint1.flip();
        controlPoint1.x = 1 - controlPoint1.x;
        controlPoint2.flip();
        controlPoint2.x = 1 - controlPoint2.x;
      } else if (degrees === -90) {
        controlPoint1.flip();
        controlPoint1.y = 1 - controlPoint1.y;
        controlPoint2.flip();
        controlPoint2.y = 1 - controlPoint2.y;
      }

      this.set({ controlPoint1: controlPoint1, controlPoint2: controlPoint2 });
    }

    /**
     * Applies a flip with the given direction
     * @param  {String} direction
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      var controlPoint1 = this._options.controlPoint1;
      var controlPoint2 = this._options.controlPoint2;

      switch (direction) {
        case 'horizontal':
          controlPoint1.x = 1 - controlPoint1.x;
          controlPoint2.x = 1 - controlPoint2.x;
          break;
        case 'vertical':
          controlPoint1.y = 1 - controlPoint1.y;
          controlPoint2.y = 1 - controlPoint2.y;
          break;
      }

      this.set({ controlPoint1: controlPoint1, controlPoint2: controlPoint2 });
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'transform',
    value: function transform(transformChange) {
      var _this2 = this;

      var newOptions = {};

      ['controlPoint1', 'controlPoint2'].forEach(function (optionName) {
        var vector = _this2.getOption(optionName);
        newOptions[optionName] = transformChange.applyToRelativePoint(vector);
      });

      ['blurRadius'].forEach(function (optionName) {
        var size = _this2.getOption(optionName);
        newOptions[optionName] = transformChange.applyToRelativeSize(size);
      });

      this.set(newOptions, false);
    }

    /**
     * Renders the linear focus using WebGL
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @override
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(inputTexture) {
      return this._renderBlur(inputTexture);
    }

    /**
     * Renders the linear blur using Canvas2D
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @override
     * @private
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(inputTexture) {
      if (this._options.highQualityCanvasBlur) {
        return this._renderBlur(inputTexture);
      } else {
        return this._renderLQCanvasBlur(inputTexture);
      }
    }

    /**
     * Renders a high quality linear blur
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderBlur',
    value: function _renderBlur(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();
      var shortestSide = inputDimensions.min();

      var _options = this._options,
          blurRadius = _options.blurRadius,
          controlPoint1 = _options.controlPoint1,
          controlPoint2 = _options.controlPoint2;

      var commonOptions = {
        blurRadius: blurRadius * shortestSide,

        controlPoint1: controlPoint1.clone(),
        controlPoint2: controlPoint2.clone(),
        texSize: inputDimensions,
        blurQuality: 'high'
      };

      this._horizontalFilter.set(commonOptions);
      this._verticalFilter.set(commonOptions);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Renders a low quality linear blur using Canvas2D
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderLQCanvasBlur',
    value: function _renderLQCanvasBlur(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();

      var _options2 = this._options,
          blurRadius = _options2.blurRadius,
          controlPoint1 = _options2.controlPoint1,
          controlPoint2 = _options2.controlPoint2;

      this._filter.set({
        blurRadius: blurRadius,
        controlPoint1: controlPoint1.clone(),
        controlPoint2: controlPoint2.clone(),
        texSize: inputDimensions,
        blurQuality: 'low'
      });

      this._sprite.setFilters([this._filter]);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(LinearFocusOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LinearFocusOperation.prototype), 'dispose', this).call(this);
      this._filter.dispose();
      this._verticalFilter.dispose();
      this._horizontalFilter.dispose();
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return true;
    }
  }]);

  return LinearFocusOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


LinearFocusOperation.identifier = 'linear-focus';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
LinearFocusOperation.prototype.availableOptions = {
  controlPoint1: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.0, 0.5) },
  controlPoint2: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1.0, 0.5) },
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 },
  highQualityCanvasBlur: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.LinearFocusOperation = LinearFocusOperation;

/* harmony default export */ __webpack_exports__["a"] = (LinearFocusOperation);

/***/ }),
/* 403 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur__ = __webpack_require__(91);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__ = __webpack_require__(73);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

var LinearFocusFilter = function (_Engine$Filter) {
  _inherits(LinearFocusFilter, _Engine$Filter);

  function LinearFocusFilter() {
    var _ref;

    _classCallCheck(this, LinearFocusFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = LinearFocusFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LinearFocusFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(404);

    _this._lastBlurRadius = null;
    _this._lastControlPoint1 = new Vector2();
    _this._lastControlPoint2 = new Vector2();

    _this._blurFilter = new __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__["a" /* default */]();

    _this._blurredRenderTarget = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);

    _this._maskRenderTarget = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(LinearFocusFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var _this2 = this;

      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      if (this._options.blurQuality === 'low') {
        this._renderLQBlur(renderer, inputTarget, outputTarget, clear);
        return;
      }

      var inputDimensions = inputTarget.getDimensions();
      var dimensionsChanged = !outputTarget.getDimensions().equals(inputDimensions);

      var shouldUpdateBlur = inputTarget.getBaseTexture().isDirty() || this._lastBlurRadius !== this._options.blurRadius || dimensionsChanged;

      if (shouldUpdateBlur) {
        var delta = new Vector2(this._options.delta.x, this._options.delta.y);
        this._blurFilter.setDelta(delta);
        var options = {
          blurRadius: this._options.blurRadius,
          texSize: inputDimensions
        };
        var clamp = function clamp(x, minVal, maxVal) {
          return Math.min(Math.max(x, minVal), maxVal);
        };
        var smoothstep = function smoothstep(e0, e1, x) {
          var t = clamp((x - e0) / (e1 - e0), 0.0, 1.0);
          return t * t * (3.0 - 2.0 * t);
        };

        var controlVec = this._options.controlPoint2.clone().subtract(this._options.controlPoint1.clone());

        var blurRadius = this._options.blurRadius;
        var radius = function radius(x, y) {
          return smoothstep(0.0, 1.0, Math.abs(clamp(new Vector2(x, y).subtract(_this2._options.controlPoint1).dot(controlVec) / controlVec.dot(controlVec), 0.0, 1.0))) * blurRadius;
        };
        this._blurFilter.set(options);
        this._blurFilter._applyCanvas(renderer, inputTarget, outputTarget, clear, radius);
        this._lastBlurRadius = this._options.blurRadius;
      }
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the low quality but fast stack-blur
     * implementation
     * @param  {CanvasRenderer} renderer
     * @param  {RenderTarget} inputTarget
     * @param  {RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_renderLQBlur',
    value: function _renderLQBlur(renderer, inputTarget, outputTarget) {

      var inputDimensions = inputTarget.getDimensions();
      var dimensionsChanged = !this._blurredRenderTarget.getDimensions().equals(inputDimensions);

      this._blurredRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._blurredRenderTarget.resizeTo(inputTarget.getDimensions());

      this._maskRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._maskRenderTarget.resizeTo(inputTarget.getDimensions());

      var shouldUpdateMask = !this._lastControlPoint1.equals(this._options.controlPoint1) || !this._lastControlPoint2.equals(this._options.controlPoint2) || dimensionsChanged;

      var shouldUpdateBlur = inputTarget.getBaseTexture().isDirty() || this._lastBlurRadius !== this._options.blurRadius || dimensionsChanged;

      if (shouldUpdateMask) {
        this._renderMask();
        this._lastControlPoint1 = this._options.controlPoint1.clone();
        this._lastControlPoint2 = this._options.controlPoint2.clone();
      }

      if (shouldUpdateBlur) {
        this._blurImage(inputTarget);
        this._lastBlurRadius = this._options.blurRadius;
      }

      this._applyMask(inputTarget, outputTarget);
    }

    /**
     * Creates a blurred copy of the image
     * @param  {CanvasRenderTarget} inputTarget
     * @return {Canvas}
     * @private
     */

  }, {
    key: '_blurImage',
    value: function _blurImage(inputTarget) {
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var inputDimensions = new Vector2(inputCanvas.width, inputCanvas.height);
      var blurryImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      __WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur___default.a.stackBlurCanvasRGBA(blurryImageData, 0, 0, inputCanvas.width, inputCanvas.height, this._options.blurRadius * inputDimensions.min());

      var blurryContext = this._blurredRenderTarget.getContext();
      blurryContext.putImageData(blurryImageData, 0, 0);
    }

    /**
     * Renders the mask canvas
     * @private
     */

  }, {
    key: '_renderMask',
    value: function _renderMask() {
      var canvas = this._maskRenderTarget.getCanvas();
      var context = this._maskRenderTarget.getContext();

      var canvasDimensions = new Vector2(canvas.width, canvas.height);

      var controlPoint1 = this._options.controlPoint1.clone().multiply(canvasDimensions);
      var controlPoint2 = this._options.controlPoint2.clone().multiply(canvasDimensions);

      // Build gradient
      var gradient = context.createLinearGradient(controlPoint1.x, controlPoint1.y, controlPoint2.x, controlPoint2.y);
      gradient.addColorStop(0, '#FFFFFF');
      gradient.addColorStop(1, '#000000');

      // Draw gradient
      context.fillStyle = gradient;
      context.fillRect(0, 0, canvas.width, canvas.height);
    }

    /**
     * Applies the blur and mask to the input canvas
     * @param {CanvasRenderTarget} inputTarget
     * @param {CanvasRenderTarget} outputTarget
     * @private
     */

  }, {
    key: '_applyMask',
    value: function _applyMask(inputTarget, outputTarget) {
      var outputContext = outputTarget.getContext();
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var blurredContext = this._blurredRenderTarget.getContext();
      var maskContext = this._maskRenderTarget.getContext();

      var inputImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      var pixels = inputImageData.data;
      var blurredPixels = blurredContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;
      var maskPixels = maskContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;

      var alpha = void 0;
      for (var i = 0; i < inputCanvas.width * inputCanvas.height * 4; i += 4) {
        alpha = maskPixels[i] / 255;

        pixels[i] = alpha * pixels[i] + (1 - alpha) * blurredPixels[i];
        pixels[i + 1] = alpha * pixels[i + 1] + (1 - alpha) * blurredPixels[i + 1];
        pixels[i + 2] = alpha * pixels[i + 2] + (1 - alpha) * blurredPixels[i + 2];
      }

      outputContext.putImageData(inputImageData, 0, 0);
    }
  }, {
    key: 'dispose',
    value: function dispose() {
      _get(LinearFocusFilter.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(LinearFocusFilter.prototype), 'dispose', this).call(this);
      this._blurFilter.dispose();
      this._blurredRenderTarget.dispose();
      this._maskRenderTarget.dispose();
    }
  }]);

  return LinearFocusFilter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filter);

LinearFocusFilter.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 30, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  controlPoint1: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0.5), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 },
  controlPoint2: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 0.5), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 },
  delta: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 1), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 },
  texSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 }
};

/* harmony default export */ __webpack_exports__["a"] = (LinearFocusFilter);

/***/ }),
/* 404 */
/***/ (function(module, exports) {

module.exports = "/*!\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform vec2 u_controlPoint1;\nuniform vec2 u_controlPoint2;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    vec2 vector = u_controlPoint2 - u_controlPoint1;\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n\n    float radius = smoothstep(0.0, 1.0,\n      abs(\n        clamp(dot(v_texCoord - u_controlPoint1, vector) / dot(vector, vector), 0.0, 1.0)\n      )\n    ) * u_blurRadius;\n\n    for (float t = -30.0; t <= 30.0; t++) {\n      float percent = (t + offset - 0.5) / 30.0;\n      float weight = 1.0 - abs(percent);\n      vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n      color += _sample * weight;\n      total += weight;\n    }\n\n    gl_FragColor = color / total;\n}\n";

/***/ }),
/* 405 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__mirrored_focus_filter__ = __webpack_require__(406);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a mirrored focus
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var MirroredFocusOperation = function (_Operation) {
  _inherits(MirroredFocusOperation, _Operation);

  /**
   * Creates a new MirroredFocusOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function MirroredFocusOperation() {
    var _ref;

    _classCallCheck(this, MirroredFocusOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = MirroredFocusOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(MirroredFocusOperation)).call.apply(_ref, [this].concat(args)));

    _this._lastBlurRadius = _this._options.blurRadius;
    _this._lastSize = _this._options.size;
    _this._lastGradientSize = _this._options.gradientSize;

    var blurOption = {
      blurQuality: {
        type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING
      }
    };

    _this._horizontalFilter = new __WEBPACK_IMPORTED_MODULE_6__mirrored_focus_filter__["a" /* default */]({}, blurOption);
    _this._verticalFilter = new __WEBPACK_IMPORTED_MODULE_6__mirrored_focus_filter__["a" /* default */]({}, blurOption);
    _this._sprite.setFilters([_this._horizontalFilter, _this._verticalFilter]);

    _this._horizontalFilter.setDelta(new Vector2(0.5, 0.5));
    _this._verticalFilter.setDelta(new Vector2(-0.5, 0.5));

    _this._filter = new __WEBPACK_IMPORTED_MODULE_6__mirrored_focus_filter__["a" /* default */]({}, blurOption);
    _this._renderBlur.bind(_this);
    return _this;
  }

  /**
   * Applies the given rotation change
   * @param  {PhotoEditorSDK.Operations.RotationOperation} operation
   * @param  {Number} degrees
   */


  _createClass(MirroredFocusOperation, [{
    key: 'rotate',
    value: function rotate(degrees) {
      var start = this._options.start;
      var end = this._options.end;

      if (degrees === 90) {
        start.flip();
        start.x = 1 - start.x;
        end.flip();
        end.x = 1 - end.x;
      } else if (degrees === -90) {
        start.flip();
        start.y = 1 - start.y;
        end.flip();
        end.y = 1 - end.y;
      }

      this.set({ start: start, end: end });
    }

    /**
     * Applies a flip with the given direction
     * @param  {String} direction
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      var start = this._options.start;
      var end = this._options.end;

      switch (direction) {
        case 'horizontal':
          start.x = 1 - start.x;
          end.x = 1 - end.x;
          break;
        case 'vertical':
          start.y = 1 - start.y;
          end.y = 1 - end.y;
          break;
      }

      this.set({ start: start, end: end });
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'transform',
    value: function transform(transformChange) {
      var _this2 = this;

      var newOptions = {};

      ['start', 'end'].forEach(function (optionName) {
        var vector = _this2.getOption(optionName);
        newOptions[optionName] = transformChange.applyToRelativePoint(vector);
      });

      ['blurRadius', 'size', 'gradientSize'].forEach(function (optionName) {
        var size = _this2.getOption(optionName);
        newOptions[optionName] = transformChange.applyToRelativeSize(size);
      });

      this.set(newOptions, false);
    }

    /**
     * Transforms this image using WebGL
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @override
     * @private
     */
    /* istanbul ignore next */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(inputTexture) {
      return this._renderBlur(inputTexture);
    }

    /**
     * Renders the radial blur using Canvas2D
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @override
     * @private
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(inputTexture) {
      if (this._options.highQualityCanvasBlur) {
        return this._renderBlur(inputTexture);
      } else {
        return this._renderLQCanvasBlur(inputTexture);
      }
    }

    /**
     * Renders a high quality mirrored blur
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     * @override
     */

  }, {
    key: '_renderBlur',
    value: function _renderBlur(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();
      var shortestSide = inputDimensions.min();

      var start = this._options.start.clone();
      var end = this._options.end.clone();

      var _options = this._options,
          blurRadius = _options.blurRadius,
          size = _options.size,
          gradientSize = _options.gradientSize;

      var commonOptions = {
        blurRadius: blurRadius * shortestSide,
        size: size * shortestSide,
        gradientSize: gradientSize * shortestSide,

        start: start.clone().multiply(inputDimensions),
        end: end.clone().multiply(inputDimensions),
        texSize: inputDimensions,
        blurQuality: 'high'
      };

      this._horizontalFilter.set(commonOptions);
      this._verticalFilter.set(commonOptions);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Renders a low quality mirrored blur using Canvas2D
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderLQCanvasBlur',
    value: function _renderLQCanvasBlur(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();

      var _options2 = this._options,
          blurRadius = _options2.blurRadius,
          size = _options2.size,
          gradientSize = _options2.gradientSize,
          start = _options2.start,
          end = _options2.end;

      this._filter.set({
        blurRadius: blurRadius,
        gradientSize: gradientSize,
        size: size,
        start: start.clone(),
        end: end.clone(),
        texSize: inputDimensions,
        blurQuality: 'low'
      });

      this._sprite.setFilters([this._filter]);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(MirroredFocusOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(MirroredFocusOperation.prototype), 'dispose', this).call(this);
      this._filter.dispose();
      this._verticalFilter.dispose();
      this._horizontalFilter.dispose();
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return true;
    }
  }]);

  return MirroredFocusOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


MirroredFocusOperation.identifier = 'mirrored-focus';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
MirroredFocusOperation.prototype.availableOptions = {
  start: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.0, 0.5) },
  end: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1.0, 0.5) },
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 },
  size: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.1 },
  gradientSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.1 },
  highQualityCanvasBlur: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.MirroredFocusOperation = MirroredFocusOperation;

/* harmony default export */ __webpack_exports__["a"] = (MirroredFocusOperation);

/***/ }),
/* 406 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur__ = __webpack_require__(91);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__ = __webpack_require__(73);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

var MirroredFocusFilter = function (_Engine$Filter) {
  _inherits(MirroredFocusFilter, _Engine$Filter);

  function MirroredFocusFilter() {
    var _ref;

    _classCallCheck(this, MirroredFocusFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = MirroredFocusFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(MirroredFocusFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(407);

    _this._lastBlurRadius = null;
    _this._lastGradientRadius = null;
    _this._lastStart = new Vector2();
    _this._lastEnd = new Vector2();

    _this._blurFilter = new __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__["a" /* default */]();

    _this._blurredRenderTarget = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);

    _this._maskRenderTarget = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(MirroredFocusFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      if (this._options.blurQuality === 'low') {
        this._renderLQBlur(renderer, inputTarget, outputTarget, clear);
        return;
      }

      var inputDimensions = inputTarget.getDimensions();
      var dimensionsChanged = !outputTarget.getDimensions().equals(inputDimensions);

      var shouldUpdateBlur = inputTarget.getBaseTexture().isDirty() || this._lastBlurRadius !== this._options.blurRadius || dimensionsChanged;

      if (shouldUpdateBlur) {
        var delta = new Vector2(this._options.delta.x, this._options.delta.y);
        this._blurFilter.setDelta(delta);
        var options = {
          blurRadius: this._options.blurRadius,
          texSize: inputDimensions
        };
        var clamp = function clamp(x, minVal, maxVal) {
          return Math.min(Math.max(x, minVal), maxVal);
        };
        var smoothstep = function smoothstep(e0, e1, x) {
          var t = clamp((x - e0) / (e1 - e0), 0.0, 1.0);
          return t * t * (3.0 - 2.0 * t);
        };

        var _options = this._options,
            blurRadius = _options.blurRadius,
            gradientSize = _options.gradientSize,
            size = _options.size,
            start = _options.start,
            end = _options.end,
            texSize = _options.texSize;


        var normal = new Vector2(start.y - end.y, end.x - start.x);
        normal.divide(normal.len());

        var radius = function radius(x, y) {
          return smoothstep(0.0, 1.0, (Math.abs(texSize.clone().multiply(x, y).subtract(start).dot(normal)) - size) / gradientSize) * blurRadius;
        };
        this._blurFilter.set(options);
        this._blurFilter._applyCanvas(renderer, inputTarget, outputTarget, clear, radius);
        this._lastBlurRadius = this._options.blurRadius;
      }
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the CanvasRenderer using the low-quality
     * but fast stack-blur implementation
     * @param  {CanvasRenderer} renderer
     * @param  {RenderTarget} inputTarget
     * @param  {RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_renderLQBlur',
    value: function _renderLQBlur(renderer, inputTarget, outputTarget) {

      var inputDimensions = inputTarget.getDimensions();
      var dimensionsChanged = !this._blurredRenderTarget.getDimensions().equals(inputDimensions);

      this._blurredRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._blurredRenderTarget.resizeTo(inputTarget.getDimensions());

      this._maskRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._maskRenderTarget.resizeTo(inputTarget.getDimensions());

      var shouldUpdateMask = !this._lastStart.equals(this._options.start) || !this._lastEnd.equals(this._options.end) || this._lastGradientRadius !== this._options.size || dimensionsChanged;

      var shouldUpdateBlur = inputTarget.getBaseTexture().isDirty() || this._lastBlurRadius !== this._options.blurRadius || dimensionsChanged;

      if (shouldUpdateMask) {
        this._renderMask();

        this._lastStart = this._options.start.clone();
        this._lastEnd = this._options.end.clone();
        this._lastGradientRadius = this._options.size;
      }

      if (shouldUpdateBlur) {
        this._blurImage(inputTarget);
        this._lastBlurRadius = this._options.blurRadius;
      }

      this._applyMask(inputTarget, outputTarget);
    }

    /**
     * Creates a blurred copy of the image
     * @param  {CanvasRenderTarget} inputTarget
     * @return {Canvas}
     * @private
     */

  }, {
    key: '_blurImage',
    value: function _blurImage(inputTarget) {
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var inputDimensions = new Vector2(inputCanvas.width, inputCanvas.height);
      var blurryImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      __WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur___default.a.stackBlurCanvasRGBA(blurryImageData, 0, 0, inputCanvas.width, inputCanvas.height, this._options.blurRadius * inputDimensions.min());

      var blurryContext = this._blurredRenderTarget.getContext();
      blurryContext.putImageData(blurryImageData, 0, 0);
    }

    /**
     * Renders the mask canvas
     * @private
     */

  }, {
    key: '_renderMask',
    value: function _renderMask() {
      var canvas = this._maskRenderTarget.getCanvas();
      var context = this._maskRenderTarget.getContext();
      var pixelRatio = this._maskRenderTarget.getPixelRatio();

      var canvasDimensions = new Vector2(canvas.width, canvas.height);

      var size = this._options.size * canvasDimensions.min() * pixelRatio;
      var gradientSize = this._options.gradientSize * canvasDimensions.min() * pixelRatio;
      var start = this._options.start.clone().multiply(canvasDimensions);
      var end = this._options.end.clone().multiply(canvasDimensions);
      var dist = end.clone().subtract(start);
      var middle = start.clone().add(dist.clone().divide(2));

      var totalDist = dist.len();
      var factor = dist.clone().divide(totalDist);

      var gradientStart = middle.clone().add((size + gradientSize) * factor.y, -(size + gradientSize) * factor.x);
      var gradientEnd = middle.clone().add(-(size + gradientSize) * factor.y, (size + gradientSize) * factor.x);

      // Build gradient
      var gradient = context.createLinearGradient(gradientStart.x, gradientStart.y, gradientEnd.x, gradientEnd.y);
      var fullGradientSize = gradientEnd.clone().subtract(gradientStart).len();
      gradient.addColorStop(0, '#000000');
      gradient.addColorStop(gradientSize / 2 / fullGradientSize, '#FFFFFF');
      gradient.addColorStop(1.0 - gradientSize / 2 / fullGradientSize, '#FFFFFF');
      gradient.addColorStop(1, '#000000');

      // Draw gradient
      context.fillStyle = gradient;
      context.fillRect(0, 0, canvas.width, canvas.height);
    }

    /**
     * Applies the blur and mask to the input canvas
     * @param {CanvasRenderTarget} inputTarget
     * @param {CanvasRenderTarget} outputTarget
     * @private
     */

  }, {
    key: '_applyMask',
    value: function _applyMask(inputTarget, outputTarget) {
      var outputContext = outputTarget.getContext();
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var blurredContext = this._blurredRenderTarget.getContext();
      var maskContext = this._maskRenderTarget.getContext();

      var inputImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      var pixels = inputImageData.data;
      var blurredPixels = blurredContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;
      var maskPixels = maskContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;

      var alpha = void 0;
      for (var i = 0; i < inputCanvas.width * inputCanvas.height * 4; i += 4) {
        alpha = maskPixels[i] / 255;

        pixels[i] = alpha * pixels[i] + (1 - alpha) * blurredPixels[i];
        pixels[i + 1] = alpha * pixels[i + 1] + (1 - alpha) * blurredPixels[i + 1];
        pixels[i + 2] = alpha * pixels[i + 2] + (1 - alpha) * blurredPixels[i + 2];
      }

      outputContext.putImageData(inputImageData, 0, 0);
    }
  }, {
    key: 'dispose',
    value: function dispose() {
      _get(MirroredFocusFilter.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(MirroredFocusFilter.prototype), 'dispose', this).call(this);
      this._blurFilter.dispose();
    }
  }]);

  return MirroredFocusFilter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filter);

MirroredFocusFilter.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 30, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  size: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 50, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  gradientSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 50, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  start: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0.5), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 },
  end: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 0.5), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 },
  delta: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 1), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 },
  texSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 }
};

/* harmony default export */ __webpack_exports__["a"] = (MirroredFocusFilter);

/***/ }),
/* 407 */
/***/ (function(module, exports) {

module.exports = "/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform float u_gradientSize;\nuniform float u_size;\nuniform vec2 u_start;\nuniform vec2 u_end;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n\n    vec2 normal = normalize(vec2(u_start.y - u_end.y, u_end.x - u_start.x));\n    float radius = smoothstep(0.0, 1.0,\n      (abs(\n        dot(v_texCoord * u_texSize - u_start, normal)\n      ) - u_size) / u_gradientSize\n    ) * u_blurRadius;\n\n    for (float t = -30.0; t <= 30.0; t++) {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n}\n";

/***/ }),
/* 408 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can rotate and flip an image
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var OrientationOperation = function (_Operation) {
  _inherits(OrientationOperation, _Operation);

  function OrientationOperation() {
    _classCallCheck(this, OrientationOperation);

    return _possibleConstructorReturn(this, (OrientationOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(OrientationOperation)).apply(this, arguments));
  }

  _createClass(OrientationOperation, [{
    key: '_render',

    /**
     * Rotates and/or flips the image
     * @param  {PhotoEditorSDK} sdk
     * @returns {Promise}
     * @override
     * @private
     */
    value: function _render(sdk) {
      var actualDegrees = this._options.rotation % 360;
      var radians = actualDegrees * (Math.PI / 180);

      // Adjustments for first rotate, then flip convention
      var rot90Or270 = actualDegrees === 90 || actualDegrees === 270;
      var xorFlips = this._options.flipHorizontally !== this._options.flipVertically;
      var actualFlipVert = rot90Or270 && xorFlips ? !this._options.flipVertically : this._options.flipVertically;
      var actualFlipHoriz = rot90Or270 && xorFlips ? !this._options.flipHorizontally : this._options.flipHorizontally;

      this._sprite.setScale(actualFlipHoriz ? -1 : 1, actualFlipVert ? -1 : 1);
      this._sprite.setRotation(radians);
      this._sprite.setAnchor(0.5, 0.5);
      this._sprite.updateTransform();

      var bounds = this._sprite.getBounds();
      this._renderTexture.resizeTo(new Vector2(bounds.width, bounds.height));

      // Make sure we're rendering to top left corner
      this._sprite.setPosition(this._renderTexture.getDimensions().divide(2).round());

      // Draw
      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Returns the dimensions the given dimensions will have after this operation
     * has been applied
     * @param {PhotoEditorSDK.Math.Vector2} dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     * @override
     */

  }, {
    key: 'getNewDimensions',
    value: function getNewDimensions(dimensions) {
      dimensions = dimensions.clone();
      if (this._options.rotation % 180) {
        dimensions.flip();
      }
      return dimensions;
    }

    /**
     * Flips the image while incorporating the current rotation
     * @param {String} direction
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      var rotation = this._options.rotation;

      if (rotation === 90 || rotation === 270) {
        if (direction === 'vertical') {
          direction = 'horizontal';
        } else {
          direction = 'vertical';
        }
      }

      switch (direction) {
        case 'vertical':
          this.setFlipVertically(!this.getFlipVertically());
          break;
        case 'horizontal':
          this.setFlipHorizontally(!this.getFlipHorizontally());
          break;
      }
    }
  }]);

  return OrientationOperation;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


OrientationOperation.identifier = 'orientation';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
OrientationOperation.prototype.availableOptions = {
  rotation: {
    type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER,
    default: 0,
    validation: function validation(value) {
      if (value % 90 !== 0) {
        throw new Error('OrientationOperation: `rotation` has to be a multiple of 90.');
      }
    },
    setter: function setter(value) {
      return (value + 360) % 360;
    }
  },
  flipVertically: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  flipHorizontally: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default.a.Operations.OrientationOperation = OrientationOperation;

/* harmony default export */ __webpack_exports__["a"] = (OrientationOperation);

/***/ }),
/* 409 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var OverlayFilter = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Filters.OverlayFilter;
var Vector2 = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Math"].Vector2;

var GL_UNIT = 4;

/**
 * An operation that can draw a watermark on top of the image
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var OverlayOperation = function (_Operation) {
  _inherits(OverlayOperation, _Operation);

  /**
   * Creates a new OverlayOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function OverlayOperation() {
    var _ref;

    _classCallCheck(this, OverlayOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = OverlayOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(OverlayOperation)).call.apply(_ref, [this].concat(args)));

    _this._overlayTexture = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Texture.fromImage(_this._options.image);
    _this._overlayContainer = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Container();
    _this._overlaySprite = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Sprite();
    _this._overlaySprite.setTexture(_this._overlayTexture);
    _this._overlaySprite.setAnchor(0, 0);
    _this._overlayContainer.addChild(_this._overlaySprite);

    _this._overlayFilter = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Filters.OverlayFilter({
      overlayImage: _this._overlayTexture.getBaseTexture().getGLUnit(),
      overlayTexture: _this._overlayTexture
    });
    _this._sprite.setFilters([_this._overlayFilter]);

    _this._renderedOverlaySprite = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Sprite();
    _this._renderedOverlayContainer = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Container();
    _this._renderedOverlayContainer.addChild(_this._renderedOverlaySprite);

    _this._overlayRendered = false;
    _this._lastInputDimensions = new Vector2(0, 0);
    return _this;
  }

  _createClass(OverlayOperation, [{
    key: 'setOption',
    value: function setOption(name, value) {
      _get(OverlayOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(OverlayOperation.prototype), 'setOption', this).call(this, name, value);

      if (name === 'image' && value && this._sdk) {
        var renderer = this._sdk.getRenderer();
        var baseTexture = this._overlayTexture.getBaseTexture();
        baseTexture.setSource(value);

        if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["RendererType"].WEBGL)) {
          renderer.updateTexture(baseTexture);
        }

        this._overlayRendered = false;
      }
    }

    /**
     * Renders the watermark
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     * @override
     */

  }, {
    key: '_render',
    value: function _render(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();
      var _options = this._options,
          image = _options.image,
          alpha = _options.alpha,
          blendMode = _options.blendMode;

      if (!image) {
        this._sprite.setFilters([]);
        this._renderTexture.render(this._container);
        return __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Promise"].resolve();
      }

      if (!this._overlayRendered || !this._lastInputDimensions.equals(inputDimensions)) {
        this._renderOverlayToRenderTexture(inputTexture);
        this._overlayRendered = true;
        this._lastInputDimensions.copy(inputDimensions);
      }

      this._overlayFilter.set({
        blendMode: blendMode,
        overlayImage: this._overlayRenderTexture.getBaseTexture().getGLUnit(),
        overlayTexture: this._overlayRenderTexture,
        alpha: alpha
      });
      this._sprite.setFilters([this._overlayFilter]);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Renders the overlay to a render texture that has the same dimensions as the input texture
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderOverlayToRenderTexture',
    value: function _renderOverlayToRenderTexture(inputTexture) {
      var renderer = this._sdk.getRenderer();
      var textureDimensions = inputTexture.getDimensions();

      if (!this._overlayRenderTexture) {
        this._overlayRenderTexture = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].RenderTexture(renderer, textureDimensions.x, textureDimensions.y);
        this._renderedOverlaySprite.setTexture(this._overlayRenderTexture);
      }

      var _options$image = this._options.image,
          width = _options$image.width,
          height = _options$image.height;

      var dimensions = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].resizeVectorToFill(new Vector2(width, height), textureDimensions);
      this._overlaySprite.setWidth(dimensions.x);
      this._overlaySprite.setHeight(dimensions.y);

      var baseTexture = this._overlayRenderTexture.getBaseTexture();

      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["RendererType"].WEBGL)) {
        baseTexture.setGLUnit(GL_UNIT);
        renderer.updateTexture(baseTexture, false);
      }
      this._overlayRenderTexture.resizeTo(textureDimensions);
      this._overlayRenderTexture.render(this._overlayContainer);
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(OverlayOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(OverlayOperation.prototype), 'dispose', this).call(this);
      if (this._overlaySprite) this._overlaySprite.dispose();
      if (this._overlayRenderTexture) this._renderedOverlaySprite.dispose();
      if (this._overlayFilter) this._overlayFilter.dispose();
      if (this._overlayTexture) this._overlayTexture.dispose();
      if (this._overlayRenderTexture) this._overlayRenderTexture.dispose();
      if (this._renderedOverlaySprite) this._renderedOverlaySprite.dispose();
    }
  }]);

  return OverlayOperation;
}(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


OverlayOperation.identifier = 'overlay';

/**
 * The available blend modes
 * @type {Object}
 */
OverlayOperation.BLEND_MODES = OverlayFilter.BLEND_MODES;

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
OverlayOperation.prototype.availableOptions = {
  identifier: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING },
  image: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].IMAGE },
  blendMode: {
    type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER,
    default: OverlayFilter.BLEND_MODES.MULTIPLY,
    available: __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(OverlayFilter.BLEND_MODES).map(function (o) {
      return OverlayFilter.BLEND_MODES[o];
    })
  },
  alpha: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 }
};

__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default.a.Operations.OverlayOperation = OverlayOperation;

/* harmony default export */ __webpack_exports__["a"] = (OverlayOperation);

/***/ }),
/* 410 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__radial_focus_filter__ = __webpack_require__(411);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a radial focus
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var RadialFocusOperation = function (_Operation) {
  _inherits(RadialFocusOperation, _Operation);

  /**
   * Creates a new RadialFocusOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function RadialFocusOperation() {
    var _ref;

    _classCallCheck(this, RadialFocusOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = RadialFocusOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(RadialFocusOperation)).call.apply(_ref, [this].concat(args)));

    _this._lastBlurRadius = _this._options.blurRadius;
    _this._lastGradientRadius = _this._options.gradientRadius;

    var blurOptions = {
      blurQuality: {
        type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING
      }
    };

    _this._horizontalFilter = new __WEBPACK_IMPORTED_MODULE_6__radial_focus_filter__["a" /* default */]({}, blurOptions);
    _this._verticalFilter = new __WEBPACK_IMPORTED_MODULE_6__radial_focus_filter__["a" /* default */]({}, blurOptions);
    _this._sprite.setFilters([_this._horizontalFilter, _this._verticalFilter]);

    _this._horizontalFilter.setDelta(new Vector2(0.5, 0.5));
    _this._verticalFilter.setDelta(new Vector2(-0.5, 0.5));

    _this._filter = new __WEBPACK_IMPORTED_MODULE_6__radial_focus_filter__["a" /* default */]({}, blurOptions);
    return _this;
  }

  /**
   * Applies the given rotation change
   * @param  {Number} degrees
   */


  _createClass(RadialFocusOperation, [{
    key: 'rotate',
    value: function rotate(degrees) {
      var position = this._options.position;

      if (degrees === 90) {
        position.flip();
        position.x = 1 - position.x;
      } else if (degrees === -90) {
        position.flip();
        position.y = 1 - position.y;
      }

      this.set({ position: position });
    }

    /**
     * Applies a flip with the given direction
     * @param  {String} direction
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      var position = this._options.position;

      switch (direction) {
        case 'horizontal':
          position.x = 1 - position.x;
          break;
        case 'vertical':
          position.y = 1 - position.y;
          break;
      }

      this.set({ position: position });
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'transform',
    value: function transform(transformChange) {
      var _this2 = this;

      var newOptions = {};

      var vector = this.getPosition();
      newOptions.position = transformChange.applyToRelativePoint(vector);

      ['radius', 'blurRadius', 'gradientRadius'].forEach(function (optionName) {
        var size = _this2.getOption(optionName);
        newOptions[optionName] = transformChange.applyToRelativeSize(size);
      });

      this.set(newOptions, false);
    }

    /**
     * Renders the radial blur using WebGL
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     * @override
     */
    /* istanbul ignore next */

  }, {
    key: '_renderWebGL',
    value: function _renderWebGL(inputTexture) {
      return this._renderBlur(inputTexture);
    }

    /**
     * Renders the radial blur using Canvas2D
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     * @override
     */

  }, {
    key: '_renderCanvas',
    value: function _renderCanvas(inputTexture) {
      if (this._options.highQualityCanvasBlur) {
        return this._renderBlur(inputTexture);
      } else {
        return this._renderLQCanvasBlur(inputTexture);
      }
    }

    /**
     * Renders a high quality radial blur
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderBlur',
    value: function _renderBlur(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();
      var shortestSide = inputDimensions.min();

      var _options = this._options,
          position = _options.position,
          blurRadius = _options.blurRadius,
          radius = _options.radius,
          gradientRadius = _options.gradientRadius;


      var commonOptions = {
        blurRadius: blurRadius * shortestSide,
        radius: radius * shortestSide,
        gradientRadius: gradientRadius * shortestSide,
        position: position.clone().multiply(inputDimensions),
        texSize: inputDimensions,
        blurQuality: 'high'
      };

      this._horizontalFilter.set(commonOptions);
      this._verticalFilter.set(commonOptions);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Renders a low quality radial blur using Canvas2D
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderLQCanvasBlur',
    value: function _renderLQCanvasBlur(inputTexture) {
      var _options2 = this._options,
          blurRadius = _options2.blurRadius,
          radius = _options2.radius,
          gradientRadius = _options2.gradientRadius,
          position = _options2.position;

      var inputDimensions = inputTexture.getDimensions();

      this._filter.set({
        blurRadius: blurRadius,
        radius: radius,
        gradientRadius: gradientRadius,
        position: position,
        texSize: inputDimensions,
        blurQuality: 'low'
      });

      this._sprite.setFilters([this._filter]);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(RadialFocusOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(RadialFocusOperation.prototype), 'dispose', this).call(this);
      this._filter.dispose();
      this._verticalFilter.dispose();
      this._horizontalFilter.dispose();
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return true;
    }
  }]);

  return RadialFocusOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


RadialFocusOperation.identifier = 'radial-focus';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
RadialFocusOperation.prototype.availableOptions = {
  position: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5) },
  radius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.25 },
  gradientRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.125 },
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 },
  highQualityCanvasBlur: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.RadialFocusOperation = RadialFocusOperation;

/* harmony default export */ __webpack_exports__["a"] = (RadialFocusOperation);

/***/ }),
/* 411 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur__ = __webpack_require__(91);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__ = __webpack_require__(73);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

var RadialFocusFilter = function (_Engine$Filter) {
  _inherits(RadialFocusFilter, _Engine$Filter);

  function RadialFocusFilter() {
    var _ref;

    _classCallCheck(this, RadialFocusFilter);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = RadialFocusFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(RadialFocusFilter)).call.apply(_ref, [this].concat(args)));

    _this._fragmentSource = __webpack_require__(412);

    _this._lastBlurRadius = null;
    _this._lastGradientRadius = null;
    _this._lastPosition = new Vector2();

    _this._blurFilter = new __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__["a" /* default */]();

    _this._blurredRenderTarget = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);

    _this._maskRenderTarget = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].CanvasRenderTarget(100, 100, 1);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {CanvasRenderer} renderer
   * @param  {RenderTarget} inputTarget
   * @param  {RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(RadialFocusFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {
      var _this2 = this;

      var clear = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      if (this._options.blurQuality === 'low') {
        this._renderLQBlur(renderer, inputTarget, outputTarget, clear);
        return;
      }

      var inputDimensions = inputTarget.getDimensions();
      var dimensionsChanged = !outputTarget.getDimensions().equals(inputDimensions);

      var _options = this._options,
          blurRadius = _options.blurRadius,
          position = _options.position,
          texSize = _options.texSize,
          gradientRadius = _options.gradientRadius;


      var shouldUpdateBlur = inputTarget.getBaseTexture().isDirty() || this._lastBlurRadius !== blurRadius || dimensionsChanged;

      if (shouldUpdateBlur) {
        var delta = new Vector2(this._options.delta.x, this._options.delta.y);
        this._blurFilter.setDelta(delta);
        var options = {
          blurRadius: blurRadius,
          texSize: inputDimensions
        };
        var clamp = function clamp(x, minVal, maxVal) {
          return Math.min(Math.max(x, minVal), maxVal);
        };
        var smoothstep = function smoothstep(e0, e1, x) {
          var t = clamp((x - e0) / (e1 - e0), 0.0, 1.0);
          return t * t * (3.0 - 2.0 * t);
        };

        var radius = function radius(x, y) {
          return smoothstep(0.0, 1.0, (Math.abs(texSize.clone().multiply(x, y).subtract(position).len()) - _this2._options.radius) / (gradientRadius * 2.0)) * blurRadius;
        };
        this._blurFilter.set(options);
        this._blurFilter._applyCanvas(renderer, inputTarget, outputTarget, clear, radius);
        this._lastBlurRadius = blurRadius;
      }
    }

    /**
     * Applies this filter to the given inputTarget and renders it to
     * the given outputTarget using the CanvasRenderer using the low quality
     * stack-blur implementation
     * @param  {CanvasRenderer} renderer
     * @param  {RenderTarget} inputTarget
     * @param  {RenderTarget} outputTarget
     * @param  {Boolean} clear = false
     * @private
     */

  }, {
    key: '_renderLQBlur',
    value: function _renderLQBlur(renderer, inputTarget, outputTarget) {

      var inputDimensions = inputTarget.getDimensions();
      var dimensionsChanged = !this._blurredRenderTarget.getDimensions().equals(inputDimensions);

      this._blurredRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._blurredRenderTarget.resizeTo(inputTarget.getDimensions());

      this._maskRenderTarget.setPixelRatio(inputTarget.getPixelRatio());
      this._maskRenderTarget.resizeTo(inputTarget.getDimensions());

      var shouldUpdateMask = !this._lastPosition.equals(this._options.position) || this._lastGradientRadius !== this._options.gradientRadius || dimensionsChanged;

      var shouldUpdateBlur = inputTarget.getBaseTexture().isDirty() || this._lastBlurRadius !== this._options.blurRadius || dimensionsChanged;

      if (shouldUpdateMask) {
        this._renderMask();

        this._lastPosition = this._options.position.clone();
        this._lastGradientRadius = this._options.gradientRadius;
      }

      if (shouldUpdateBlur) {
        this._blurImage(inputTarget);
        this._lastBlurRadius = this._options.blurRadius;
      }

      this._applyMask(inputTarget, outputTarget);
    }

    /**
     * Creates a blurred copy of the image
     * @param  {CanvasRenderTarget} inputTarget
     * @return {Canvas}
     * @private
     */

  }, {
    key: '_blurImage',
    value: function _blurImage(inputTarget) {
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();

      var inputDimensions = new Vector2(inputCanvas.width, inputCanvas.height);
      var blurryImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      __WEBPACK_IMPORTED_MODULE_6__shared_vendor_stack_blur___default.a.stackBlurCanvasRGBA(blurryImageData, 0, 0, inputCanvas.width, inputCanvas.height, this._options.blurRadius * inputDimensions.min());

      var blurryContext = this._blurredRenderTarget.getContext();
      blurryContext.putImageData(blurryImageData, 0, 0);
    }

    /**
     * Renders the mask canvas
     * @private
     */

  }, {
    key: '_renderMask',
    value: function _renderMask() {
      var canvas = this._maskRenderTarget.getCanvas();
      var context = this._maskRenderTarget.getContext();

      var canvasDimensions = new Vector2(canvas.width, canvas.height);
      var pixelRatio = this._maskRenderTarget.getPixelRatio();
      var position = this._options.position.clone().multiply(canvasDimensions);

      var _options2 = this._options,
          radius = _options2.radius,
          gradientRadius = _options2.gradientRadius;

      radius *= canvas.height;
      gradientRadius *= canvas.height;

      // Build gradient
      var gradient = context.createRadialGradient(position.x, position.y, 0, position.x, position.y, (radius + gradientRadius) * pixelRatio);
      gradient.addColorStop(0, '#FFFFFF');
      gradient.addColorStop(radius / (radius + gradientRadius), '#FFFFFF');
      gradient.addColorStop(1, '#000000');

      // Draw gradient
      context.fillStyle = gradient;
      context.fillRect(0, 0, canvasDimensions.x, canvasDimensions.y);
    }

    /**
     * Applies the blur and mask to the input canvas
     * @param {CanvasRenderTarget} inputTarget
     * @param {CanvasRenderTarget} outputTarget
     * @private
     */

  }, {
    key: '_applyMask',
    value: function _applyMask(inputTarget, outputTarget) {
      var outputContext = outputTarget.getContext();
      var inputCanvas = inputTarget.getCanvas();
      var inputContext = inputTarget.getContext();
      var blurredContext = this._blurredRenderTarget.getContext();
      var maskContext = this._maskRenderTarget.getContext();

      var inputImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      var pixels = inputImageData.data;
      var blurredPixels = blurredContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;
      var maskPixels = maskContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;

      var alpha = void 0;
      for (var i = 0; i < inputCanvas.width * inputCanvas.height * 4; i += 4) {
        alpha = maskPixels[i] / 255;

        pixels[i] = alpha * pixels[i] + (1 - alpha) * blurredPixels[i];
        pixels[i + 1] = alpha * pixels[i + 1] + (1 - alpha) * blurredPixels[i + 1];
        pixels[i + 2] = alpha * pixels[i + 2] + (1 - alpha) * blurredPixels[i + 2];
      }

      outputContext.putImageData(inputImageData, 0, 0);
    }
  }, {
    key: 'dispose',
    value: function dispose() {
      _get(RadialFocusFilter.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(RadialFocusFilter.prototype), 'dispose', this).call(this);
      this._blurFilter.dispose();
      this._blurredRenderTarget.dispose();
      this._maskRenderTarget.dispose();
    }
  }]);

  return RadialFocusFilter;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filter);

RadialFocusFilter.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 30, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  radius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 50, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  gradientRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 25, uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT },
  position: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 },
  delta: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 1), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 },
  texSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100), uniformType: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["UniformType"].FLOAT2 }
};

/* harmony default export */ __webpack_exports__["a"] = (RadialFocusFilter);

/***/ }),
/* 412 */
/***/ (function(module, exports) {

module.exports = "/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_radius;\nuniform float u_blurRadius;\nuniform float u_gradientRadius;\nuniform vec2 u_position;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nconst float blurSteps = 30.0;\nconst float EPSILON = 0.000000001;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    vec2 coord = v_texCoord * u_texSize;\n    vec2 diff = coord - u_position;\n    float dist = sqrt(diff.x * diff.x + diff.y * diff.y);\n\n    float blurPercentage = smoothstep( \n      0.0, 1.0,\n      (abs(dist) - u_radius) / u_gradientRadius\n    );\n\n    float radius = blurPercentage * u_blurRadius;\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n\n    for (float t = -blurSteps; t <= blurSteps; t++) {\n        float percent = (t + offset - 0.5) / blurSteps;\n        float weight = 1.0 - abs(percent);\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / max(total, EPSILON);\n}\n";

/***/ }),
/* 413 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_sprites_brush_sprite__ = __webpack_require__(175);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__ = __webpack_require__(73);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_filters_mask_filter__ = __webpack_require__(417);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a selective blur using brushes
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var SelectiveBlurOperation = function (_Operation) {
  _inherits(SelectiveBlurOperation, _Operation);

  /**
   * Creates a new SelectiveBlurOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function SelectiveBlurOperation() {
    var _ref;

    _classCallCheck(this, SelectiveBlurOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = SelectiveBlurOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(SelectiveBlurOperation)).call.apply(_ref, [this].concat(args)));

    var renderer = _this._sdk.getRenderer();

    _this._lastBlurRadius = null;
    _this._blurredRenderTexture = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].RenderTexture(renderer, 100, 100, 1);
    _this._maskRenderTexture = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].RenderTexture(renderer, 100, 100, 1);

    _this._brushSprite = new __WEBPACK_IMPORTED_MODULE_6__shared_sprites_brush_sprite__["a" /* default */](_this);
    _this._brushSpriteContainer = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Container();
    var brushSprite = _this._brushSprite.getDisplayObject();
    _this._brushSpriteContainer.addChild(brushSprite);

    _this._outputSprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite();
    _this._outputContainer = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Container();
    _this._outputContainer.addChild(_this._outputSprite);

    _this._maskFilter = new __WEBPACK_IMPORTED_MODULE_8__shared_filters_mask_filter__["a" /* default */]();
    if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
      _this._horizontalFilter = new __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__["a" /* default */]();
      _this._verticalFilter = new __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__["a" /* default */]();
      _this._sprite.setFilters([_this._horizontalFilter, _this._verticalFilter]);

      _this._horizontalFilter.setDelta(new Vector2(1, 1));
      _this._verticalFilter.setDelta(new Vector2(-1, 1));

      var baseTexture = _this._maskRenderTexture.getBaseTexture();
      baseTexture.setGLUnit(_this._maskFilter.getMaskImage());
      renderer.updateTexture(baseTexture, false);

      baseTexture = _this._blurredRenderTexture.getBaseTexture();
      baseTexture.setGLUnit(_this._maskFilter.getFilterImage());
      renderer.updateTexture(baseTexture, false);
    } else if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].CANVAS)) {
      _this._blurFilter = new __WEBPACK_IMPORTED_MODULE_7__shared_filters_blur_filter__["a" /* default */]();

      _this._sprite.setFilters([_this._blurFilter]);

      _this._maskFilter.setMaskCanvas(_this._maskRenderTexture.getRenderTarget().getCanvas());
      _this._maskFilter.setFilterCanvas(_this._blurredRenderTexture.getRenderTarget().getCanvas());
    }

    _this._outputSprite.setFilters([_this._maskFilter]);
    return _this;
  }

  /**
   * Applies a flip to this operation
   * @param  {String} direction
   */


  _createClass(SelectiveBlurOperation, [{
    key: 'flip',
    value: function flip(direction) {
      this._brushSprite.applyFlip(direction);
      this.setDirty(true, true);
      this._lastBlurRadius = null;
    }

    /**
     * Applies a rotation to this operation
     * @param  {Number} degrees
     */

  }, {
    key: 'rotate',
    value: function rotate(degrees) {
      this._brushSprite.applyRotation(degrees);
      this.setDirty(true, true);
      this._lastBlurRadius = null;
    }

    /**
     * Applies a transform to this operation
     * @param  {PhotoEditorSDK.Operation} transformOperation
     * @param  {Object} options
     */

  }, {
    key: 'transform',
    value: function transform(transformOperation, options) {
      this._brushSprite.applyTransform(transformOperation, options);
      this.setDirty(true, true);
      this._lastBlurRadius = null;
    }

    /**
     * Renders this operation
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @override
     * @private
     */

  }, {
    key: '_render',
    value: function _render(inputTexture) {
      this._renderBlur(inputTexture);
      this._renderMask(inputTexture);

      this._outputSprite.setTexture(inputTexture);
      this._renderTexture.render(this._outputContainer);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Renders the mask
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderMask',
    value: function _renderMask(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();

      var maskDimensions = this._maskRenderTexture.getDimensions();
      if (!maskDimensions.equals(inputDimensions)) {
        this._maskRenderTexture.resizeTo(inputDimensions);
      }

      this._brushSprite.update(this._sdk, inputDimensions);
      this._maskRenderTexture.clear(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"].BLACK);
      this._maskRenderTexture.render(this._brushSpriteContainer);

      var renderer = this._sdk.getRenderer();
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        renderer.updateTexture(this._maskRenderTexture.getBaseTexture(), false);
      }
    }

    /**
     * Blurs the input image
     * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
     * @private
     */

  }, {
    key: '_renderBlur',
    value: function _renderBlur(inputTexture) {
      var inputDimensions = inputTexture.getDimensions();

      var blurredDimensions = this._blurredRenderTexture.getDimensions();
      if (!blurredDimensions.equals(inputDimensions)) {
        this._blurredRenderTexture.resizeTo(inputDimensions);
      }

      var blurRadius = this._options.blurRadius;

      if (this._lastBlurRadius !== blurRadius || !blurredDimensions.equals(inputDimensions)) {
        var _renderer = this._sdk.getRenderer();

        var blurOptions = void 0;
        if (_renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
          var shortestSide = inputDimensions.min();
          blurOptions = {
            blurRadius: blurRadius * shortestSide,
            texSize: inputDimensions
          };

          this._horizontalFilter.set(blurOptions);
          this._verticalFilter.set(blurOptions);
        } else if (_renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].CANVAS)) {
          blurOptions = { blurRadius: blurRadius };
          this._blurFilter.set(blurOptions);
        }

        this._blurredRenderTexture.render(this._container);
        this._lastBlurRadius = blurRadius;
      }

      var renderer = this._sdk.getRenderer();
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        renderer.updateTexture(this._blurredRenderTexture.getBaseTexture(), false);
      }
    }

    /**
     * Returns this operation's brush
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite}
     */

  }, {
    key: 'getBrush',
    value: function getBrush() {
      return this._brushSprite;
    }

    /**
     * Creates and adds a new path
     * @param {Number} size
     * @param {Number} hardness = 1
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path}
     */

  }, {
    key: 'createPath',
    value: function createPath(size) {
      var hardness = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

      var brush = new __WEBPACK_IMPORTED_MODULE_6__shared_sprites_brush_sprite__["a" /* default */].Brushes.RadialBrush({ size: size, hardness: hardness, color: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"].WHITE });
      var path = this._brushSprite.createPath(brush);
      this._options.paths.push(path);
      this.setDirty(true);
      return path;
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer, dimensionsChanged) {
      _get(SelectiveBlurOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(SelectiveBlurOperation.prototype), 'setDirtyForRenderer', this).call(this, dirty, renderer, dimensionsChanged);
      this._brushSprite.setDirtyForRenderer(dirty, renderer, dimensionsChanged);
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(SelectiveBlurOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(SelectiveBlurOperation.prototype), 'dispose', this).call(this);

      var renderer = this._sdk.getRenderer();
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        this._verticalFilter.dispose();
        this._horizontalFilter.dispose();
      } else {
        this._blurFilter.dispose();
      }

      this._brushSprite.dispose();
      this._maskFilter.dispose();
      this._blurredRenderTexture.dispose();
      this._maskRenderTexture.dispose();
    }

    /**
     * Checks if the operation has changes/modifications
     * @return {Boolean}
     */

  }, {
    key: 'hasChanges',
    value: function hasChanges() {
      return true;
    }
  }]);

  return SelectiveBlurOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


SelectiveBlurOperation.identifier = 'selective-blur';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
SelectiveBlurOperation.prototype.availableOptions = {
  blurRadius: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.05 },
  paths: {
    type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY,
    default: [],
    setter: function setter(paths) {
      if (this._brushSprite) {
        this._brushSprite.setPaths(paths);
      }
      return paths;
    }
  }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.SelectiveBlurOperation = SelectiveBlurOperation;

/* harmony default export */ __webpack_exports__["a"] = (SelectiveBlurOperation);

/***/ }),
/* 414 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__control_point__ = __webpack_require__(415);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * A path that can be drawn on a {@link PhotoEditorSDK.Operations.SpriteOperation.BrushSprite}. Should only be
 * created using {@link PhotoEditorSDK.Operations.SpriteOperation.BrushSprite#createPath}
 * @class
 * @extends PhotoEditorSDK.EventEmitter
 * @memberof PhotoEditorSDK.Operations.SpriteOperation.BrushSprite
 */

var Path = function (_Configurable) {
  _inherits(Path, _Configurable);

  /**
   * Creates a Path
   * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite} operation
   * @param  {Object} options
   * @param  {HTMLCanvasElement} canvas
   */
  function Path(operation, options, canvas) {
    _classCallCheck(this, Path);

    var _this = _possibleConstructorReturn(this, (Path.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Path)).call(this, options));

    _this._operation = operation;

    _this._canvas = canvas || __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
    _this._context = _this._canvas.getContext('2d');
    return _this;
  }

  /**
   * Returns a serialized version of the given option
   * @param {String} optionName
   * @param {Boolean} toObject = false
   * @return {*}
   */


  _createClass(Path, [{
    key: 'serializeOption',
    value: function serializeOption(optionName) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      if (optionName === 'controlPoints') {
        return this._options.controlPoints.map(function (controlPoint) {
          var position = controlPoint.getPosition();
          return toObject ? position.toObject() : position.clone();
        });
      }

      return _get(Path.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Path.prototype), 'serializeOption', this).call(this, optionName, toObject);
    }

    /**
     * Checks if the given option has the given value
     * @param  {String} optionName
     * @param  {*} value
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_optionEquals',
    value: function _optionEquals(optionName, value) {
      if (optionName === 'controlPoints') {
        var controlPoints = this._options.controlPoints;
        for (var i = 0, l = controlPoints.length; i < l; i++) {
          if (!controlPoints[i].getPosition().equals(value[i])) {
            return false;
          }
        }
        return true;
      }

      return _get(Path.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Path.prototype), '_optionEquals', this).call(this, optionName, value);
    }

    /**
     * Draws this path onto its canvas
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'render',
    value: function render(inputDimensions) {
      var _options = this._options,
          controlPoints = _options.controlPoints,
          size = _options.size;

      if (controlPoints.length < 2) {
        return;
      }

      var brush = this.getBrush();
      var hardness = brush && brush.getHardness ? brush.getHardness() : 1;

      __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(this._canvas, inputDimensions);

      if (!this._brush || this._lastBrushSize !== size || !inputDimensions.equals(this._brushInputDimensions)) {
        this._brushInputDimensions = inputDimensions.clone();
        this._lastBrushSize = size;
      }

      var beforeLastControlPoint = void 0,
          lastControlPoint = void 0,
          controlPoint = void 0,
          nextControlPoint = void 0;
      for (var i = 0; i < controlPoints.length; i++) {
        beforeLastControlPoint = controlPoints[i - 2];
        lastControlPoint = controlPoints[i - 1];
        controlPoint = controlPoints[i];
        nextControlPoint = controlPoints[i + 1];
        controlPoint.renderToCanvas(this._options.brush.getBrushImage(inputDimensions), this._canvas, beforeLastControlPoint, lastControlPoint, nextControlPoint, hardness);
      }
    }

    /**
     * Creates a brush from the given size, hardness and color
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {HTMLCanvasElement}
     * @private
     */

  }, {
    key: '_createBrush',
    value: function _createBrush(inputDimensions) {
      var _options2 = this._options,
          size = _options2.size,
          hardness = _options2.hardness,
          color = _options2.color;

      var canvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
      canvas.width = canvas.height = Math.ceil(size * inputDimensions.min());

      var context = canvas.getContext('2d');

      // Brush always has 100% opacity
      color = color.clone();
      color.a = 1;

      if (canvas.width === 1) {
        context.fillStyle = color.toRGBA();
        context.fillRect(0, 0, 1, 1);
      } else {
        var gradient = context.createRadialGradient(canvas.width / 2, canvas.height / 2, Math.min(canvas.width / 2 - 1, canvas.width / 2 * hardness), canvas.width / 2, canvas.height / 2, canvas.width / 2);

        gradient.addColorStop(0, color.toRGBA());
        var transparentColor = color.clone();
        transparentColor.a = 0;
        gradient.addColorStop(1, transparentColor.toRGBA());

        context.fillStyle = gradient;
        context.fillRect(0, 0, canvas.width, canvas.height);
      }

      return canvas;
    }

    /**
     * Adds a control point at the given position to this path
     * @param {PhotoEditorSDK.Math.Vector2} position
     */

  }, {
    key: 'addControlPoint',
    value: function addControlPoint(position) {
      var controlPoint = new __WEBPACK_IMPORTED_MODULE_6__control_point__["a" /* default */](this, position);
      this._options.controlPoints.push(controlPoint);
      this.emit('update', this);
    }

    /**
     * Returns this path's canvas
     * @return {Canvas}
     */

  }, {
    key: 'getCanvas',
    value: function getCanvas() {
      return this._canvas;
    }

    /**
     * Sets the given canvas
     * @param {HTMLCanvasElement} canvas
     */

  }, {
    key: 'setCanvas',
    value: function setCanvas(canvas) {
      this._canvas = canvas;
      this._context = canvas.getContext('2d');
    }

    /**
     * Sets this path to dirty
     */

  }, {
    key: 'setDirty',
    value: function setDirty() {
      this._context.clearRect(0, 0, this._canvas.width, this._canvas.height);

      this._options.controlPoints.forEach(function (point) {
        point.setDirty();
      });
    }

    /**
     * Calls `iterator` for each control point
     * @param  {Function} iterator
     */

  }, {
    key: 'forEachControlPoint',
    value: function forEachControlPoint(iterator) {
      this._options.controlPoints.forEach(iterator);
    }

    /**
     * Renders this path to the given canvas with the right opacity
     * @param  {Canvas} canvas
     */

  }, {
    key: 'renderToCanvas',
    value: function renderToCanvas(canvas) {
      var context = canvas.getContext('2d');
      context.save();
      context.globalAlpha = this._options.brush.getColor().a;
      context.drawImage(this._canvas, 0, 0);
      context.restore();
    }

    /**
     * Returns the canvas dimension for this path
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getCanvasDimensions',
    value: function getCanvasDimensions() {
      return this._canvasDimensions;
    }
  }]);

  return Path;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Configurable"]);

Path.prototype.availableOptions = {
  id: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: function _default() {
      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].getUUID();
    } },
  brush: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].OBJECT, required: true },
  controlPoints: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: [] },
  closed: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

/* harmony default export */ __webpack_exports__["a"] = (Path);

/***/ }),
/* 415 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].Vector2,
    CubicBezierCurve = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].CubicBezierCurve;

/**
 * A ControlPoint is a part of a {@link PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path}, so a Path
 * consists of multiple ControlPoints. Should only be created using {@link PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path#addControlPoint}
 * @class
 * @memberof PhotoEditorSDK.Operations.SpriteOperation.BrushSprite
 */

var ControlPoint = function () {
  /**
   * Creates a ControlPoint
   * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Path} path
   * @param  {PhotoEditorSDK.Math.Vector2} position
   */
  function ControlPoint(path, position) {
    var smooth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 3;

    _classCallCheck(this, ControlPoint);

    this._path = path;
    this._drawnCanvases = [];
    this._position = position;
    this._smooth = smooth;
  }

  /**
   * Calculates an interpolating cubic bezier  from `lastPoint` to `point`, estimating
   * control points from `beforeLastPoint` and `nextPoint`.
   *
   * @param {PhotoEditorSDK.Math.Vector2} beforeLastPoint
   * @param {PhotoEditorSDK.Math.Vector2} lastPoint
   * @param {PhotoEditorSDK.Math.Vector2} point
   * @param {PhotoEditorSDK.Math.Vector2} nextPoint
   *
   * @returns {PhotoEditorSDK.Math.CubicBezierCurve}
   */


  _createClass(ControlPoint, [{
    key: 'getBezierCurve',
    value: function getBezierCurve(beforeLastPoint, lastPoint, point, nextPoint) {
      if (!lastPoint) {
        return null;
      }

      var pointDx = void 0,
          pointDy = void 0;
      if (!nextPoint) {
        pointDx = (point.x - lastPoint.x) / this._smooth;
        pointDy = (point.y - lastPoint.y) / this._smooth;
      } else {
        pointDx = (nextPoint.x - lastPoint.x) / this._smooth;
        pointDy = (nextPoint.y - lastPoint.y) / this._smooth;
      }

      var lastPointDx = void 0,
          lastPointDy = void 0;
      if (!beforeLastPoint) {
        lastPointDx = (point.x - lastPoint.x) / this._smooth;
        lastPointDy = (point.y - lastPoint.y) / this._smooth;
      } else {
        lastPointDx = (point.x - beforeLastPoint.x) / this._smooth;
        lastPointDy = (point.y - beforeLastPoint.y) / this._smooth;
      }

      var p1 = lastPoint.clone().add(lastPointDx, lastPointDy);
      var p2 = point.clone().subtract(pointDx, pointDy);

      return new CubicBezierCurve(lastPoint, p1, p2, point);
    }

    /**
     * Renders this ControlPoint to the given canvas
     * @param  {HTMLCanvasElement} brush
     * @param  {HTMLCanvasElement} canvas
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.ControlPoint} lastControlPoint
     * @param  {Number} hardness
     */

  }, {
    key: 'renderToCanvas',
    value: function renderToCanvas(brush, canvas, beforeLastControlPoint, lastControlPoint, nextControlPoint) {
      var hardness = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 1.0;

      if (this._drawnCanvases.indexOf(canvas) !== -1) {
        // This control point has already been drawn on this canvas. Ignore.
        return;
      }

      var canvasDimensions = new Vector2(canvas.width, canvas.height);

      var context = canvas.getContext('2d');
      var position = this._position.clone().multiply(canvasDimensions);
      var lastPosition = lastControlPoint ? lastControlPoint.getPosition().clone().multiply(canvasDimensions) : null;
      var beforeLastPosition = beforeLastControlPoint ? beforeLastControlPoint.getPosition().clone().multiply(canvasDimensions) : null;
      var nextPosition = nextControlPoint ? nextControlPoint.getPosition().clone().multiply(canvasDimensions) : null;
      var distance = position.clone().subtract(lastPosition).len();
      var step = brush.width / 10;

      // Calculate the bezier curve from the last control point to the current one
      var curve = this.getBezierCurve(beforeLastPosition, lastPosition, position, nextPosition);

      var sample = void 0;
      if (!curve) {
        sample = [position];
      } else {
        curve.calculateSegments(20);
        var length = curve.getLength();
        sample = curve.arcLengthApproxSample(Math.ceil(length / step));
      }

      for (var i = 0; i < sample.length; i++) {
        var pos = sample[i];

        var alpha = brush.width * 0.5 / (step * 2);
        alpha *= 1 - hardness;
        alpha = 1 / (1 + alpha);
        context.globalAlpha = alpha;

        context.drawImage(brush, pos.x - brush.width / 2, pos.y - brush.height / 2, brush.width, brush.height);
      }
      context.globalAlpha = 1.0;

      this._drawnCanvases.push(canvas);
    }

    /**
     * Sets the position
     * @param {PhotoEditorSDK.Math.Vector2} position
     */

  }, {
    key: 'setPosition',
    value: function setPosition(position) {
      this._position = position;
    }

    /**
     * Returns the position
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getPosition',
    value: function getPosition() {
      return this._position.clone();
    }

    /**
     * Sets this ControlPoint to dirty
     */

  }, {
    key: 'setDirty',
    value: function setDirty() {
      this._drawnCanvases = [];
    }
  }]);

  return ControlPoint;
}();

/* harmony default export */ __webpack_exports__["a"] = (ControlPoint);

/***/ }),
/* 416 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__brush__ = __webpack_require__(176);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var RadialBrush = function (_Brush) {
  _inherits(RadialBrush, _Brush);

  function RadialBrush() {
    _classCallCheck(this, RadialBrush);

    return _possibleConstructorReturn(this, (RadialBrush.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(RadialBrush)).apply(this, arguments));
  }

  _createClass(RadialBrush, [{
    key: 'getBrushImage',

    /**
     * Returns the prepared brush image (colored and resized)
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {HTMLImageElement|HTMLCanvasElement}
     */
    value: function getBrushImage(inputDimensions) {
      if (this._brush && this.optionsEqual(this._lastOptions) && inputDimensions.equals(this._lastInputDimensions)) {
        return this._brush;
      }

      var _options = this._options,
          size = _options.size,
          hardness = _options.hardness,
          color = _options.color;


      var canvas = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].createCanvas();
      canvas.width = canvas.height = Math.ceil(size * inputDimensions.min());

      var context = canvas.getContext('2d');

      // Brush always has 100% opacity
      color = color.clone();
      color.a = 1;

      if (canvas.width === 1) {
        context.fillStyle = color.toRGBA();
        context.fillRect(0, 0, 1, 1);
      } else {
        var gradient = context.createRadialGradient(canvas.width / 2, canvas.height / 2, Math.min(canvas.width / 2 - 1, canvas.width / 2 * hardness), canvas.width / 2, canvas.height / 2, canvas.width / 2);

        gradient.addColorStop(0, color.toRGBA());
        var transparentColor = color.clone();
        transparentColor.a = 0;
        gradient.addColorStop(1, transparentColor.toRGBA());

        context.fillStyle = gradient;
        context.fillRect(0, 0, canvas.width, canvas.height);
      }

      this._lastOptions = this.serializeOptions(['size', 'color', 'hardness']);
      this._brush = canvas;
      this._lastInputDimensions = inputDimensions.clone();

      return canvas;
    }
  }]);

  return RadialBrush;
}(__WEBPACK_IMPORTED_MODULE_5__brush__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (RadialBrush);


RadialBrush.identifier = 'imgly_brush_radial';

RadialBrush.prototype.availableOptions = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Utils"].extend(__WEBPACK_IMPORTED_MODULE_5__brush__["a" /* default */].prototype.availableOptions, {
  hardness: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 }
});

/***/ }),
/* 417 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var MaskFilter = function (_Engine$Filter) {
  _inherits(MaskFilter, _Engine$Filter);

  function MaskFilter() {
    _classCallCheck(this, MaskFilter);

    var _this = _possibleConstructorReturn(this, (MaskFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(MaskFilter)).call(this));

    _this._fragmentSource = __webpack_require__(418);
    return _this;
  }

  /**
   * Applies this filter to the given inputTarget and renders it to
   * the given outputTarget using the CanvasRenderer
   * @param  {PhotoEditorSDK.Engine.CanvasRenderer} renderer
   * @param  {PhotoEditorSDK.Engine.RenderTarget} inputTarget
   * @param  {PhotoEditorSDK.Engine.RenderTarget} outputTarget
   * @param  {Boolean} clear = false
   * @private
   */


  _createClass(MaskFilter, [{
    key: '_applyCanvas',
    value: function _applyCanvas(renderer, inputTarget, outputTarget) {

      var inputCanvas = inputTarget.getCanvas();

      var inputContext = inputTarget.getContext();
      var outputContext = outputTarget.getContext();

      var _options = this._options,
          maskCanvas = _options.maskCanvas,
          filterCanvas = _options.filterCanvas;

      var maskContext = maskCanvas.getContext('2d');
      var filterContext = filterCanvas.getContext('2d');

      var maskPixels = maskContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;
      var existingImageData = inputContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height);
      var existingPixels = existingImageData.data;
      var newPixels = filterContext.getImageData(0, 0, inputCanvas.width, inputCanvas.height).data;

      var alpha = void 0;
      for (var i = 0; i < inputCanvas.width * inputCanvas.height * 4; i += 4) {
        alpha = maskPixels[i] / 255;

        existingPixels[i] = alpha * newPixels[i] + (1 - alpha) * existingPixels[i];
        existingPixels[i + 1] = alpha * newPixels[i + 1] + (1 - alpha) * existingPixels[i + 1];
        existingPixels[i + 2] = alpha * newPixels[i + 2] + (1 - alpha) * existingPixels[i + 2];
      }

      outputContext.putImageData(existingImageData, 0, 0);
    }
  }]);

  return MaskFilter;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Filter);

MaskFilter.prototype.availableOptions = {
  maskImage: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].INT },
  maskCanvas: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: null },
  filterImage: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 2, uniformType: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["UniformType"].INT },
  filterCanvas: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: null }
};

/* harmony default export */ __webpack_exports__["a"] = (MaskFilter);

/***/ }),
/* 418 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_filterImage;\nuniform sampler2D u_maskImage;\n\nvoid main() {\n  vec4 color0 = texture2D(u_image, v_texCoord);\n  vec4 color1 = texture2D(u_filterImage, v_texCoord);\n  vec4 mask = texture2D(u_maskImage, v_texCoord);\n  gl_FragColor = mix(color0, color1, mask);\n}\n";

/***/ }),
/* 419 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_sprite__ = __webpack_require__(74);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__sprites_sticker_sprite__ = __webpack_require__(420);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__sprites_text_sprite__ = __webpack_require__(421);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__shared_sprites_brush_sprite__ = __webpack_require__(175);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__sprites_text_design_sprite__ = __webpack_require__(422);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */









var Vector2 = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw sprites (text and stickers) on the canvas
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var SpriteOperation = function (_Operation) {
  _inherits(SpriteOperation, _Operation);

  /**
   * Creates a new SpriteOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function SpriteOperation() {
    var _ref;

    _classCallCheck(this, SpriteOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = SpriteOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(SpriteOperation)).call.apply(_ref, [this].concat(args)));

    _this.setSmoothDownscaling(_this._sdk.getOptions().smoothDownscaling);

    _this._onSpriteUpdate = _this._onSpriteUpdate.bind(_this);

    _this._maskCanvas = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].createCanvas();

    var sprites = _this._options.sprites.slice();
    sprites.forEach(function (sprite) {
      _this.removeSprite(sprite);
      _this.addSprite(sprite);
    });
    return _this;
  }

  /**
   * Returns the sprites that are instances of the given class
   * @param  {Class} Klass
   * @return {PhotoEditorSDK.Sprite[]}
   */


  _createClass(SpriteOperation, [{
    key: 'getSpritesOfType',
    value: function getSpritesOfType(Klass) {
      return this._options.sprites.filter(function (sprite) {
        return sprite instanceof Klass;
      });
    }

    /**
     * Applies a rotation with the given degrees
     * @param  {Number} degrees
     * @private
     */

  }, {
    key: 'rotate',
    value: function rotate(degrees) {
      this._options.sprites.forEach(function (sprite) {
        sprite.applyRotation(degrees);
      });
    }

    /**
     * Applies a flip with the given direction
     * @param  {String} direction
     * @private
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      this._options.sprites.forEach(function (sprite) {
        sprite.applyFlip(direction);
      });
    }

    /**
     * Gets called when a sprite is flagged as dirty / its options changed
     * @param  {PhotoEditorSDK.Sprite} sprite
     * @param  {Object} options
     * @private
     */

  }, {
    key: '_onSpriteUpdate',
    value: function _onSpriteUpdate(sprite, options) {
      this.emit('update', this);
      this.setDirty(true);
    }

    /**
     * Applies the given rotation change
     * @param  {PhotoEditorSDK.Operations.RotationOperation} operation
     * @param  {Object} options
     * @private
     */

  }, {
    key: '_applyRotation',
    value: function _applyRotation(operation, options) {
      this._options.sprites.forEach(function (sprite) {
        return sprite.applyRotation(operation, options);
      });
    }

    /**
     * Applies the given transform change
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     * @private
     */

  }, {
    key: 'transform',
    value: function transform(transformChange) {
      this._options.sprites.forEach(function (sprite) {
        return sprite.applyTransform(transformChange);
      });
    }

    /**
     * Applies the given scale to all sprites
     * @param  {PhotoEditorSDK.Math.Vector2} scale
     */

  }, {
    key: 'scale',
    value: function scale(_scale) {
      this._options.sprites.forEach(function (sprite) {
        return sprite.applyScale(_scale);
      });
    }

    /**
     * Returns a serialized version of the given option
     * @param {String} optionName
     * @param {Boolean} toObject = false
     * @return {*} optionName
     * @private
     * @override
     */

  }, {
    key: 'serializeOption',
    value: function serializeOption(optionName) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      // Since `sprites` is an array of configurables, we need
      // to serialize them as well
      if (optionName === 'sprites') {
        return this._options.sprites.map(function (sprite) {
          return sprite.serializeOptions(undefined, toObject);
        });
      }
      return _get(SpriteOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(SpriteOperation.prototype), 'serializeOption', this).call(this, optionName, toObject);
    }

    /**
     * Creates a new sticker object and returns it
     * @param  {Object} options
     * @return {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite}
     */

  }, {
    key: 'createSticker',
    value: function createSticker(options) {
      return new __WEBPACK_IMPORTED_MODULE_8__sprites_sticker_sprite__["a" /* default */](this, options);
    }

    /**
     * Creates a new sticker object and returns it
     * @param  {Object} options
     * @return {PhotoEditorSDK.Operations.SpriteOperation.TextSprite}
     */

  }, {
    key: 'createText',
    value: function createText(options) {
      return new __WEBPACK_IMPORTED_MODULE_9__sprites_text_sprite__["a" /* default */](this, options);
    }

    /**
     * Creates a brush object and returns it
     * @param  {Object} options
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite}
     */

  }, {
    key: 'createBrush',
    value: function createBrush(options) {
      return new __WEBPACK_IMPORTED_MODULE_10__shared_sprites_brush_sprite__["a" /* default */](this, options);
    }

    /**
     * Creates a textdesign object and returns it
     * @param  {Object} options
     * @return {PhotoEditorSDK.Operations.SpriteOperation.TextDesignSprite}
     */

  }, {
    key: 'createTextDesign',
    value: function createTextDesign(options) {
      return new __WEBPACK_IMPORTED_MODULE_11__sprites_text_design_sprite__["a" /* default */](this, options);
    }

    /**
     * Gets called when a sprite has been added
     * @param {PhotoEditorSDK.Sprite} sprite
     */

  }, {
    key: 'addSprite',
    value: function addSprite(sprite) {
      this._options.sprites.push(sprite);

      var smoothDownscaling = this.getSmoothDownscaling();
      sprite.setSmoothDownscaling && sprite.setSmoothDownscaling(smoothDownscaling);

      this._container.addChild(sprite.getDisplayObject());

      // This operation needs to be rerendered
      this.setDirty(true);

      sprite.on('update', this._onSpriteUpdate);
      this.emit('update', this, this._options.sprites);
    }

    /**
     * Removes the given sprite from the list of sprites
     * @param  {PhotoEditorSDK.Sprite} sprite
     * @return {Boolean}
     */

  }, {
    key: 'removeSprite',
    value: function removeSprite(sprite) {
      var sprites = this._options.sprites;
      var index = sprites.indexOf(sprite);
      if (index !== -1) {
        sprite.off('update', this._onSpriteUpdate);
        this._container.removeChild(sprite.getDisplayObject());
        sprites.splice(index, 1);

        // This operation needs to be rerendered
        this.setDirty(true);

        return true;
      }
      return false;
    }

    /**
     * Returns the size of the stage, taking into account the current Exif rotation.
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: '_getOrientatedStageSize',
    value: function _getOrientatedStageSize() {
      var frame = this._sdk.getSprite().getTexture().getFrame();
      var orientationOperation = this._sdk.getOperationsStack().getByIdentifier('orientation');

      // Check if there is an orientation change so we have to swap width and height
      var rotation = orientationOperation ? orientationOperation.getRotation() : 0;
      var hasSwappedSize = rotation === 270 || rotation === 90;
      return hasSwappedSize ? new Vector2(frame.height, frame.width) : new Vector2(frame.width, frame.height);
    }

    /**
     * Renders this operation
     * @param {PhotoEditorSDK.Engine.Texture} inputTexture
     * @returns {Promise}
     * @override
     * @private
     */

  }, {
    key: '_render',
    value: function _render(inputTexture) {
      var _this2 = this;

      var container = this._container;
      var sprites = this._options.sprites;

      var inputDimensions = inputTexture.getDimensions().clone().floor();

      var currentContainer = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Container();
      currentContainer.addChild(this._sprite);

      return __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Promise"].all(sprites.map(function (s) {
        return s.validateSettings();
      })).then(function () {
        sprites.forEach(function (sprite) {
          return sprite.update(_this2._sdk, inputDimensions);
        });
      }).then(function () {
        _this2._renderTexture.clear();
        sprites.forEach(function (sprite) {
          if (sprite.getInverted && sprite.getInverted()) {
            _this2._renderTexture.render(currentContainer);

            _this2._renderTexture.render(_this2._renderMaskedSprite(sprite.getDisplayObject(), sprite.getColor ? sprite.getColor() : __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Color"].WHITE, sprite.getPadding ? sprite.getPadding() : -1));

            currentContainer = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Container();
          } else {
            currentContainer.addChild(sprite.getDisplayObject());
          }
        });
        _this2._renderTexture.render(currentContainer);

        container.addChild(_this2._sprite);
        sprites.forEach(function (s) {
          return container.addChild(s.getDisplayObject());
        });
      });
    }

    /**
     * Renders a sprite masked by a solid color area.
     * @param {PhotoEditorSDK.Engine.Sprite} displayObject of the sprite that should be masked.
     * @param {PhotoEditorSDK.Color} color of the solid area.
     * @param padding size relative to the sprite size, -1 means masking of the whole stage.
     * @returns {PhotoEditorSDK.Engine.Container|Container}
     * @private
     */

  }, {
    key: '_renderMaskedSprite',
    value: function _renderMaskedSprite(displayObject, color, padding) {
      var canvas = this._maskCanvas;
      var worldTransform = displayObject.getWorldTransform();

      var canvasSize = this._getOrientatedStageSize();

      __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(canvas, canvasSize);
      var ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      ctx.save();
      ctx.fillStyle = color.toRGBA();
      if (padding < 0) {
        ctx.fillRect(0, 0, canvasSize.x, canvasSize.y);
      } else {
        var spriteWidth = displayObject.getWidth() / displayObject.getScale().x;
        var spriteHeight = displayObject.getHeight() / displayObject.getScale().y;
        var absolutePadding = spriteWidth * padding;
        ctx.transform(worldTransform.a, worldTransform.b, worldTransform.c, worldTransform.d, worldTransform.tx, worldTransform.ty);
        ctx.fillRect(-absolutePadding, -absolutePadding, spriteWidth + absolutePadding * 2, spriteHeight + absolutePadding * 2);
      }

      ctx.restore();
      ctx.save();
      ctx.globalCompositeOperation = 'destination-out';

      displayObject._renderCanvas({
        getCurrentRenderTarget: function getCurrentRenderTarget() {
          return {
            getPixelRatio: function getPixelRatio() {
              return 1;
            }
          };
        },
        getContext: function getContext() {
          return ctx;
        }
      });

      ctx.restore();

      var container = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Container();
      var newSprite = new __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Sprite(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Engine"].Texture.fromCanvas(canvas));

      container.addChild(newSprite);

      return container;
    }

    /**
     * Takes the given Sprite to front
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.Sprite} sprite
     */

  }, {
    key: 'takeSpriteToFront',
    value: function takeSpriteToFront(sprite) {
      var sprites = this._options.sprites;

      var spriteIndex = sprites.indexOf(sprite);
      if (spriteIndex === -1) return;

      __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].moveArrayItem(sprites, spriteIndex, sprites.length - 1);

      var displayObject = sprite.getDisplayObject();
      this._container.removeChild(displayObject);
      this._container.addChild(displayObject);

      this.setDirty(true);
    }

    /**
     * Returns the sprites at the given position on the canvas
     * @param  {PhotoEditorSDK.Math.Vector2} position
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {PhotoEditorSDK.Sprite[]}
     */

  }, {
    key: 'getSpritesAtPosition',
    value: function getSpritesAtPosition(position, inputDimensions) {
      var _this3 = this;

      var intersectingSprites = [];

      this._options.sprites.forEach(function (s) {
        return s.update(_this3._sdk, inputDimensions);
      });

      // Translate canvas position to relative position on sprite by
      // applying the inverse of our outputSprite's world transform matrix
      var outputSprite = this._sdk.getSprite();
      var actualPosition = outputSprite.getWorldTransform().applyInverseToVector(position);

      // Apply anchor

      var _outputSprite$getText = outputSprite.getTexture().getFrame(),
          width = _outputSprite$getText.width,
          height = _outputSprite$getText.height;

      var anchorOffset = outputSprite.getAnchor().clone().multiply(-width, -height);
      actualPosition.subtract(anchorOffset);

      // Note: `actualPosition` is now the pixel position on the output sprite, NOT
      // on the sticker / text / brush

      // Find intersecting sprite
      var sprites = this._options.sprites.slice(0).reverse();
      for (var i = 0, c = sprites.length; i < c; i++) {
        var sprite = sprites[i];
        if (sprite.getHitTestDisplayObject().isAtPosition(actualPosition)) {
          intersectingSprites.push(sprite);
        }
      }

      return intersectingSprites;
    }

    /**
     * Sets the dirtiness for the given renderer
     * @param {Boolean} dirty
     * @param {PhotoEditorSDK.Engine.BaseRenderer} renderer
     * @param {Boolean} dimensionsChanged = false
     */

  }, {
    key: 'setDirtyForRenderer',
    value: function setDirtyForRenderer(dirty, renderer, dimensionsChanged) {
      _get(SpriteOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(SpriteOperation.prototype), 'setDirtyForRenderer', this).call(this, dirty, renderer, dimensionsChanged);
      this._options.sprites.forEach(function (sprite) {
        sprite.setDirtyForRenderer(dirty, renderer, dimensionsChanged);
      });
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(SpriteOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(SpriteOperation.prototype), 'dispose', this).call(this);
      this._options.sprites.forEach(function (sprite) {
        sprite.dispose();
      });
    }
  }]);

  return SpriteOperation;
}(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Operation"]);

SpriteOperation.StickerSprite = __WEBPACK_IMPORTED_MODULE_8__sprites_sticker_sprite__["a" /* default */];
SpriteOperation.TextSprite = __WEBPACK_IMPORTED_MODULE_9__sprites_text_sprite__["a" /* default */];
SpriteOperation.BrushSprite = __WEBPACK_IMPORTED_MODULE_10__shared_sprites_brush_sprite__["a" /* default */];
SpriteOperation.TextDesignSprite = __WEBPACK_IMPORTED_MODULE_11__sprites_text_design_sprite__["a" /* default */];

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */
SpriteOperation.identifier = 'sprite';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
SpriteOperation.prototype.availableOptions = {
  sprites: {
    type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY,
    default: [],
    setter: function setter(sprites, initial) {
      var _this4 = this;

      sprites = sprites.map(function (sprite, i) {
        if (sprite instanceof __WEBPACK_IMPORTED_MODULE_7__shared_sprite__["a" /* default */]) {
          return sprite;
        }

        var spriteData = _extends({}, sprite);
        delete spriteData.type;

        // Create sprite from the given options
        switch (sprite.type) {
          case 'text':
            return new __WEBPACK_IMPORTED_MODULE_9__sprites_text_sprite__["a" /* default */](_this4, spriteData);
          case 'sticker':
            return new __WEBPACK_IMPORTED_MODULE_8__sprites_sticker_sprite__["a" /* default */](_this4, spriteData);
          case 'brush':
            return new __WEBPACK_IMPORTED_MODULE_10__shared_sprites_brush_sprite__["a" /* default */](_this4, spriteData);
          case 'textdesign':
            return new __WEBPACK_IMPORTED_MODULE_11__sprites_text_design_sprite__["a" /* default */](_this4, spriteData);
          default:
            __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Log"].error(_this4.constructor.name, 'Invalid sprite type: ' + sprite.type);
        }
      });

      // Remove all sprites
      if (!initial) {
        if (this._options.sprites) {
          var spritesToRemove = this._options.sprites.slice();
          spritesToRemove.forEach(function (sprite) {
            sprite.dispose();
            _this4.removeSprite(sprite);
          });
        }

        // Add all sprites
        sprites.forEach(function (sprite) {
          _this4.addSprite(sprite);
        });
      }

      return sprites;
    }
  },
  smoothDownscaling: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default.a.Operations.SpriteOperation = SpriteOperation;

/* harmony default export */ __webpack_exports__["a"] = (SpriteOperation);

/***/ }),
/* 420 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_sprite__ = __webpack_require__(74);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_filters_adjustments_filter__ = __webpack_require__(172);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2,
    ColorMatrix = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].ColorMatrix;

/**
 * A sticker that can be drawn by SpriteOperation. Should only be created via {@link PhotoEditorSDK.Operations.SpriteOperation#createSticker}
 * @class
 * @memberof PhotoEditorSDK.Operations.SpriteOperation
 */

var StickerSprite = function (_Sprite) {
  _inherits(StickerSprite, _Sprite);

  /**
   * Creates a new Sticker
   * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
   * @param  {Object} [options]
   */
  function StickerSprite() {
    var _ref;

    _classCallCheck(this, StickerSprite);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = StickerSprite.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(StickerSprite)).call.apply(_ref, [this].concat(args)));

    var image = _this._options.image;


    var src = image.src || image.filePath || image.toDataUrl && image.toDataURL();
    _this._isSVG = src && !!src.match(/\w+\.svg(?=\?|$)/i);
    if (_this._isSVG) {
      _this._canvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
      _this._context = _this._canvas.getContext('2d');
      _this._options.smoothDownscaling = false;
    }

    if (image) {
      _this._onImageUpdate();
    }

    _this._tintFilter = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filters.TintFilter();
    _this._adjustmentsFilter = new __WEBPACK_IMPORTED_MODULE_7__shared_filters_adjustments_filter__["a" /* default */]();
    _this._lastRenderedDimensions = Vector2.NULL;
    _this._lastRenderedInputDimensions = Vector2.NULL;

    _this._onOptionsChange = _this._onOptionsChange.bind(_this);
    _this._options.adjustments.on('update', _this._onOptionsChange);
    return _this;
  }

  /**
   * Applies the given scale to this sprite
   * @param  {PhotoEditorSDK.Math.Vector2} scale
   */


  _createClass(StickerSprite, [{
    key: 'applyScale',
    value: function applyScale(scale) {
      this.setDimensions(this.getDimensions().multiply(scale));
    }

    /**
     * Returns a serialized version of this configurable
     * @param {String[]} keys
     * @param {Boolean} toObject = false
     * @return {Object}
     */

  }, {
    key: 'serializeOptions',
    value: function serializeOptions(keys) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var options = _get(StickerSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(StickerSprite.prototype), 'serializeOptions', this).call(this, keys, toObject);
      if (!keys) options.type = 'sticker';
      return options;
    }

    /**
     * Checks if this sprite should be rendered to a render texture
     * @param  {PhotoEditorSDK} sdk
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_rendersToRenderTexture',
    value: function _rendersToRenderTexture(sdk) {
      var smoothDownscaling = this._options.smoothDownscaling && !this._isSVG && sdk.getRenderer().isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL);
      return smoothDownscaling || this._hasAdjustments() || this._options.tintMode !== 'none';
    }

    /**
     * Returns the texture for the sprite that should be rendered
     * @return {PhotoEditorSDK.Engine.Texture}
     * @private
     * @abstract
     */

  }, {
    key: '_getTexture',
    value: function _getTexture() {
      return this._inputTexture;
    }

    /**
     * Updates this sprite
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'update',
    value: function update(sdk, inputDimensions) {
      var _options = this._options,
          dimensions = _options.dimensions,
          image = _options.image;

      if (dimensions.equals(Vector2.NULL)) {
        dimensions.set(image.width, image.height);
      }

      this._sprite.setSmoothDownscaling(this._isSVG ? false : this.getSmoothDownscaling());

      var isDirty = !this._lastRenderedInputDimensions.equals(inputDimensions) || !this._lastRenderedDimensions.equals(dimensions) || this._lastRenderedImage !== image;

      if (isDirty && this._isSVG && sdk.getRenderer().isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        var imgAspect = image.width / image.height;
        if (dimensions.x > dimensions.y) {
          var maxDimension = Math.min(dimensions.x, 4096);
          image.width = maxDimension;
          image.height = maxDimension / imgAspect;
        } else {
          var _maxDimension = Math.min(dimensions.x, 4096);
          image.width = _maxDimension * imgAspect;
          image.height = _maxDimension;
        }
        // Workaround for Chromium Bug, still present in Safari
        // https://bugs.chromium.org/p/chromium/issues/detail?id=500180
        this._canvas.width = image.width;
        this._canvas.height = image.height;
        this._context.clearRect(0, 0, image.width, image.height);
        this._context.drawImage(image, 0, 0, image.width, image.height);

        this._inputTexture.getBaseTexture().update();
      }

      if (this._rendersToRenderTexture(sdk)) {
        this._prepareRenderTexture(sdk);
      }

      var filters = [];

      // @todo: Don't update the filters every tick, instead update them when options change.
      //        This will shorten this method and clean up the code
      if (this._rendersToRenderTexture(sdk)) {
        // Stickers with adjustments are rendered to a render texture that
        // can be re-used
        if (this._hasAdjustments()) {
          // Apply adjustments
          filters.push(this._adjustmentsFilter);

          var adjustments = this._options.adjustments;

          var colorMatrix = new ColorMatrix();
          colorMatrix.multiply(ColorMatrix.createBrightnessMatrix(adjustments.getBrightness()));
          colorMatrix.multiply(ColorMatrix.createSaturationMatrix(adjustments.getSaturation()));
          colorMatrix.multiply(ColorMatrix.createContrastMatrix(adjustments.getContrast()));

          this._adjustmentsFilter.set({
            colorMatrix: colorMatrix
          });
        }

        if (this._options.tintMode && this._options.tintMode !== 'none') {
          filters.push(this._tintFilter);
          this._tintFilter.set({
            mode: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Filters.TintFilter.MODES[this._options.tintMode.toUpperCase()],
            color: this._options.tintColor
          });
        }
        this._renderTextureSprite.setFilters(filters);
      }

      if (this._rendersToRenderTexture(sdk)) {
        this._renderToRenderTexture(sdk);
      } else {
        this._sprite.setTexture(this._inputTexture);
      }
      this._updateSprite(inputDimensions);
      this._applyFlip();

      this._lastRenderedDimensions.copy(dimensions);
      this._lastRenderedInputDimensions.copy(inputDimensions);
      this._lastRenderedImage = image;
    }

    /**
     * If flip is enabled, this flips the sprite
     * @private
     */

  }, {
    key: '_applyFlip',
    value: function _applyFlip() {
      var scale = this._sprite.getScale();
      var _options2 = this._options,
          flipHorizontally = _options2.flipHorizontally,
          flipVertically = _options2.flipVertically;

      if (flipHorizontally && scale.x > 0 || !flipHorizontally && scale.x < 0) {
        scale.x *= -1;
      }
      if (flipVertically && scale.y > 0 || !flipVertically && scale.y < 0) {
        scale.y *= -1;
      }
      this._sprite.setScale(scale);
    }

    /**
     * Applies a flip in the given direction
     * @param  {String} direction
     */

  }, {
    key: 'applyFlip',
    value: function applyFlip(direction) {
      _get(StickerSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(StickerSprite.prototype), 'applyFlip', this).call(this, direction);

      var options = {
        rotation: this._options.rotation
      };

      var degrees = options.rotation / Math.PI * 180;
      var newDegrees = degrees * -1;
      options.rotation = newDegrees * Math.PI / 180;

      switch (direction) {
        case 'horizontal':
          options.flipHorizontally = !this._options.flipHorizontally;
          this.set(options);
          break;
        case 'vertical':
          options.flipVertically = !this._options.flipVertically;
          this.set(options);
          break;
      }
    }

    /**
     * Checks if this sticker has any adjustments and a filter is needed
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_hasAdjustments',
    value: function _hasAdjustments() {
      var adjustments = this._options.adjustments;
      return adjustments.getBrightness() !== 0 || adjustments.getSaturation() !== 1 || adjustments.getContrast() !== 1;
    }

    /**
     * Gets called when this sticker's image is updated
     * @private
     */

  }, {
    key: '_onImageUpdate',
    value: function _onImageUpdate() {
      var textureImage = this._options.image;
      var renderer = this._operation.getSDK().getRenderer();
      if (this._isSVG && renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        textureImage = this._canvas;
      }
      if (this._inputTexture) {
        this._inputTexture.dispose();
        this._inputTexture = null;
      }
      this._inputTexture = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Texture.fromImage(textureImage);
      this._identitySprite.setTexture(this._inputTexture);
      this._sprite.setTexture(this._inputTexture);

      if (this._renderTexture) {
        this._renderTextureSprite.setTexture(this._inputTexture);
        this._renderTexture.resizeTo(this._inputTexture.getDimensions());
      }
      this.setDirty(true);
    }

    /**
     * Returns whether the sprite should scale uniformly based on its current resizeMode.
     * @returns {boolean}
     */

  }, {
    key: 'scalesUniformly',
    value: function scalesUniformly() {
      return this._options.resizeMode === 'keepAspect';
    }

    /**
     * Sets the value for the given option, validates it
     * @param {String} optionName
     * @param {*} value
     * @param {Boolean} update = true
     * @override
     */

  }, {
    key: 'setOption',
    value: function setOption(optionName, value) {
      var update = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

      _get(StickerSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(StickerSprite.prototype), 'setOption', this).call(this, optionName, value, update);

      if (optionName === 'image' && this._identitySprite) {
        this._onImageUpdate();
      }
    }

    /**
     * Gets called when options have been changed. Sets this sprite to dirty.
     * @private
     */

  }, {
    key: '_onOptionsChange',
    value: function _onOptionsChange() {
      var dirtiness = this._dirtiness;
      for (var id in dirtiness) {
        dirtiness[id] = true;
      }
    }

    /**
     * Disposes this sprite
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(StickerSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(StickerSprite.prototype), 'dispose', this).call(this);
      if (this._inputTexture) {
        this._inputTexture.dispose();
        this._inputTexture = null;
      }
      this._tintFilter.dispose();
      this._adjustmentsFilter.dispose();
      this._options.adjustments.off('updated', this._onOptionsChange);
    }
  }]);

  return StickerSprite;
}(__WEBPACK_IMPORTED_MODULE_6__shared_sprite__["a" /* default */]);

StickerSprite.prototype.availableOptions = {
  id: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: function _default() {
      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].getUUID();
    } },
  identifier: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: '' },
  image: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].IMAGE, required: true },
  position: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: Vector2.NULL },
  dimensions: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: Vector2.NULL },
  anchor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.0, 0.0) },
  pivot: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5) },
  rotation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  flipHorizontally: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  flipVertically: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  smoothDownscaling: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  tintColor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"].WHITE },
  tintMode: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: 'none', available: ['none', 'solid', 'colorized'] },
  resizeMode: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: 'keepAspect', available: ['keepAspect', 'unrestricted'] },
  alpha: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  adjustments: {
    type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].CONFIGURABLE,
    structure: {
      brightness: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
      saturation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
      contrast: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 }
    }
  }
};

StickerSprite.type = 'sticker';

/* harmony default export */ __webpack_exports__["a"] = (StickerSprite);

/***/ }),
/* 421 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_sprite__ = __webpack_require__(74);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_text_renderer__ = __webpack_require__(177);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * A text that can be drawn by SpriteOperation. Should only be created via {@link PhotoEditorSDK.Operations.SpriteOperation#createText}
 * @class
 * @memberof PhotoEditorSDK.Operations.SpriteOperation
 */

var TextSprite = function (_Sprite) {
  _inherits(TextSprite, _Sprite);

  /**
   * Creates a new Text
   * @param  {PhotoEditorSDK.Operations.SpriteOperation} operation
   * @param  {Object} [options]
   * @param  {String} [options.text] - The text that should be rendered
   * @param  {PhotoEditorSDK.Math.Vector2} [options.position = new Vector2(0.5, 0.5)] - The position of the text. Both x and y components are
   *                                      relative to the respective image dimensions.
   * @param  {Number} [options.fontSize = 0.1] - The font size, relative to the height of the output image.
   * @param  {Number} [options.lineHeight = 1.1] - The line height, relative to the font size.
   * @param  {String} [options.fontIdentifier] - Specifies the font that should be used.
   * @param  {String} [options.alignment = 'center'] - Specifies the horizontal text alignment of the text.
   *                                      Possible values are 'left', 'center' and 'right'.
   * @param  {PhotoEditorSDK.Color} [options.color = Color.BLACK] - The color of the text.
   * @param  {Color} [options.backgroundColor = Color.TRANSPARENT] - The background color of the text sprite.
   * @param  {Number} [options.rotation = 0] - The rotation of the text in radians.
   * @param  {Number} [options.maxWidth = 0.5] - The maximum width of the text, relative to the image width.
   */
  function TextSprite() {
    var _ref;

    _classCallCheck(this, TextSprite);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextSprite.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite)).call.apply(_ref, [this].concat(args)));

    _this._textRenderer = new __WEBPACK_IMPORTED_MODULE_7__text_text_renderer__["a" /* default */](_this, _this._operation);
    _this._textRenderer.rotation = _this.getRotation();
    _this._sprite.setTexture(_this._textRenderer.getFinalTexture());
    _this._hitTestSprite.setTexture(_this._textRenderer.getTexture());
    return _this;
  }

  /**
   * Returns a serialized version of this configurable
   * @param {String[]} keys
   * @param {Boolean} toObject = false
   * @return {Object}
   */


  _createClass(TextSprite, [{
    key: 'serializeOptions',
    value: function serializeOptions(keys) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var options = _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'serializeOptions', this).call(this, keys, toObject);
      if (!keys) options.type = 'text';
      return options;
    }

    /**
     * Returns a style object for this text
     * @param {PhotoEditorSDK} SDK
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {Object}
     */
    /* istanbul ignore next */

  }, {
    key: 'getDOMStyle',
    value: function getDOMStyle(sdk, inputDimensions) {
      var actualFontSize = this.getFontSize() * inputDimensions.y;

      return {
        fontWeight: this._options.fontWeight,
        fontSize: actualFontSize + 'px',
        fontStyle: this._options.fontStyle,
        fontFamily: this._options.fontFamily,
        lineHeight: this.getAbsoluteTextHeight(inputDimensions) * this.getLineHeight() + 'px',
        color: this._options.color.toRGBA(),
        backgroundColor: this._options.backgroundColor.toRGBA(),
        textAlign: this._options.alignment
      };
    }

    /**
     * Returns the absolute text height in pixels. The value is calculated
     * using the current fonts metrics, the font size and the given input dimensions.
     * If no font metrics are available, a fallback algorithm is used to determine
     * the absolute text height.
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {Float} Absolute text height in pixels
     */

  }, {
    key: 'getAbsoluteTextHeight',
    value: function getAbsoluteTextHeight(inputDimensions) {
      var actualFontSize = this.getFontSize() * inputDimensions.y;
      var textMetrics = this.getTextMetrics();

      if (textMetrics) {
        // The text height for the current font size is calculated
        // using the given font metrics.
        var scale = 1 / textMetrics.unitsPerEm * actualFontSize;
        var ascent = textMetrics.ascender * scale;
        var descent = textMetrics.descender * scale;
        return ascent + Math.abs(descent);
      } else {
        return actualFontSize * this.getLineHeight() * 1.1;
      }
    }

    /**
     * Returns the dimensions for this text
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */
    /* istanbul ignore next */

  }, {
    key: 'getDimensions',
    value: function getDimensions(sdk, inputDimensions) {
      return this._textRenderer.getDimensions(sdk, inputDimensions);
    }

    /**
     * Applies a flip in the given direction
     * @param  {String} direction
     */

  }, {
    key: 'applyFlip',
    value: function applyFlip(direction) {
      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'applyFlip', this).call(this, direction);

      var rotation = this._options.rotation;
      switch (direction) {
        case 'horizontal':
          rotation += (Math.PI - rotation) * 2;
          this.setRotation(rotation);
          break;
        case 'vertical':
          rotation += (Math.PI / 2 - rotation) * 2;
          this.setRotation(rotation);
          break;
      }
    }

    /**
     * Applies a transform with the given options
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     */

  }, {
    key: 'applyTransform',
    value: function applyTransform(transformChange) {
      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'applyTransform', this).call(this, transformChange);
      this.set({
        fontSize: transformChange.scaleSize(this.getFontSize(), 'y'),
        maxWidth: transformChange.scaleSize(this.getMaxWidth(), 'x')
      }, false);
    }

    /**
     * Applies a rotation with the given degrees
     * @param  {Number} degrees
     */

  }, {
    key: 'applyRotation',
    value: function applyRotation(degrees) {
      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'applyRotation', this).call(this, degrees);

      var actualDegrees = (degrees + 360) % 360;
      var inputDimensions = this._operation.getInputDimensions();
      if (actualDegrees === 90 || actualDegrees === 270) {
        this.setMaxWidth(this.getMaxWidth() / inputDimensions.x * inputDimensions.y);
        this.setFontSize(this.getFontSize() / inputDimensions.y * inputDimensions.x);
      }
    }
  }, {
    key: 'setOption',
    value: function setOption(key, value) {
      var _options = this._options,
          flipHorizontally = _options.flipHorizontally,
          flipVertically = _options.flipVertically;

      if (key === 'rotation') {
        var rotation = value;
        if (flipHorizontally) {
          rotation = Math.PI * 2 - rotation;
        }
        if (flipVertically) {
          rotation = Math.PI * 2 - rotation;
        }

        this._options.rotation = rotation;
        if (this._textRenderer) {
          this._textRenderer.rotation = rotation;
        }
        this._rotation = rotation;
        this.emit('update');
        return;
      }

      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'setOption', this).call(this, key, value);
    }
  }, {
    key: 'getOption',
    value: function getOption(key) {
      if (key === 'rotation') {
        return this._rotation;
      }
      return _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'getOption', this).call(this, key);
    }
  }, {
    key: 'getHitTestDisplayObject',
    value: function getHitTestDisplayObject() {
      return this._hitTestSprite;
    }

    /**
     * Updates this sprite
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'update',
    value: function update(sdk, inputDimensions) {
      this._sprite.setVisible(this._options.visible);
      if (!this._options.visible) return;

      // Re-render text
      this._textRenderer.update(sdk, inputDimensions);

      var textTexture = this._textRenderer.getFinalTexture();
      var baseTexture = textTexture.getBaseTexture();
      baseTexture.update();

      // Upload texture
      var renderer = sdk.getRenderer();

      /* istanbul ignore next */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        renderer.updateTexture(textTexture.getBaseTexture());
      }
      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'update', this).call(this, sdk, inputDimensions);

      this._sprite.setRotation(0);

      this._textRenderer.getTexture().getBaseTexture().update();
      this._hitTestSprite.setRotation(this._rotation);
      this._hitTestSprite.updateTransform();

      this._applyFlip();
    }

    /**
     * If flip is enabled, this flips the sprite
     * @private
     */

  }, {
    key: '_applyFlip',
    value: function _applyFlip() {
      var scale = this._sprite.getScale();
      var _options2 = this._options,
          flipHorizontally = _options2.flipHorizontally,
          flipVertically = _options2.flipVertically;

      if (flipHorizontally && scale.x > 0 || !flipHorizontally && scale.x < 0) {
        scale.x *= -1;
        this.setRotation(this._rotation);
      }
      if (flipVertically && scale.y > 0 || !flipVertically && scale.y < 0) {
        scale.y *= -1;
        this.setRotation(this._rotation);
      }
      this._sprite.setScale(scale);
    }

    /**
     * Returns the texture for the sprite that should be rendered
     * @return {PhotoEditorSDK.Engine.Texture}
     * @private
     * @abstract
     */

  }, {
    key: '_getTexture',
    value: function _getTexture() {
      return this._textRenderer.getFinalTexture();
    }

    /**
     * Cleans up this Sprite
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(TextSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextSprite.prototype), 'dispose', this).call(this);
      this._textRenderer.dispose();
      this._hitTestSprite.dispose();
      this._sprite.dispose();
    }

    /**
     * Defines if sprite can be flipped horizontally
     * @return {Boolean}
     * @memberof Sprite
     * @override
     */

  }, {
    key: 'canBeFlippedHorizontally',
    value: function canBeFlippedHorizontally() {
      return false;
    }

    /**
     * Defines if sprite‘s padding could be changed
     * @return {Boolean}
     * @memberof Sprite
     */

  }, {
    key: 'canAdjustPadding',
    value: function canAdjustPadding() {
      return false;
    }
  }]);

  return TextSprite;
}(__WEBPACK_IMPORTED_MODULE_6__shared_sprite__["a" /* default */]);

TextSprite.prototype.availableOptions = {
  id: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: function _default() {
      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].getUUID();
    } },
  fontSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.1 },
  characterSpacing: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  lineHeight: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 1.1 },
  fontIdentifier: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING },
  fontFamily: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: 'Times New Roman' },
  fontWeight: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ALL, default: 'normal' },
  fontStyle: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: 'normal' },
  textMetrics: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].OBJECT, default: null },
  outlineWidth: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  outlineColor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"].BLACK },
  alignment: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: 'left', available: ['left', 'center', 'right'] },
  verticalAlignment: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: 'top', available: ['top', 'center', 'bottom'] },
  color: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].COLOR, default: new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"](1, 0, 0, 1) },
  backgroundColor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"].TRANSPARENT },
  position: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5) },
  anchor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0) },
  pivot: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5) },
  rotation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  text: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, required: true },
  maxWidth: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.5 },
  maxHeight: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  visible: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: true },
  flipHorizontally: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  flipVertically: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

TextSprite.type = 'text';

/* harmony default export */ __webpack_exports__["a"] = (TextSprite);

/***/ }),
/* 422 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_sprite__ = __webpack_require__(74);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design_models_randomizer__ = __webpack_require__(20);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_design_layout_text_design_blocks__ = __webpack_require__(75);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__text_design_layout_text_design_blocks_condensed__ = __webpack_require__(430);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__text_design_layout_text_design_blocks_light__ = __webpack_require__(179);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__text_design_layout_text_design_blocks_light_v3_1_0__ = __webpack_require__(431);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__text_design_layout_text_design_celebrate__ = __webpack_require__(181);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__text_design_layout_text_design_celebrate_simple__ = __webpack_require__(432);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__text_design_layout_text_design_equal_width__ = __webpack_require__(182);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__text_design_layout_text_design_equal_width_fat__ = __webpack_require__(434);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__text_design_layout_text_design_masked__ = __webpack_require__(53);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__text_design_layout_text_design_masked_badge__ = __webpack_require__(436);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__text_design_layout_text_design_masked_speech_bubble__ = __webpack_require__(128);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__text_design_layout_text_design_masked_speech_bubble_comic__ = __webpack_require__(437);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__text_design_layout_text_design_multiline__ = __webpack_require__(438);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21__text_design_layout_text_design_watercolor__ = __webpack_require__(439);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22__text_design_layout_text_design_sunshine__ = __webpack_require__(129);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23__text_design_layout_text_design_sunshine_v3_1_0__ = __webpack_require__(440);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24__text_design_layout_text_design_particles__ = __webpack_require__(441);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25__text_design_layout_text_design_rotated__ = __webpack_require__(446);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_26__text_design_text_design_asset_manager__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_27__text_design_text_design_renderer__ = __webpack_require__(447);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_28__text_design_models_size_value__ = __webpack_require__(33);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


























var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * A sprite that renders a text design layout.
 * @class
 * @memberof PhotoEditorSDK.Operations.SpriteOperation
 */

var TextDesignSprite = function (_Sprite) {
  _inherits(TextDesignSprite, _Sprite);

  function TextDesignSprite(operation, options) {
    _classCallCheck(this, TextDesignSprite);

    var _this = _possibleConstructorReturn(this, (TextDesignSprite.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSprite)).call(this, operation, options));

    _this._renderer = new __WEBPACK_IMPORTED_MODULE_27__text_design_text_design_renderer__["a" /* TextDesignRenderer */]();
    _this._canvas = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].createCanvas();
    _this._context = _this._canvas.getContext('2d');
    _this._texture = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Texture.fromCanvas(_this._canvas);
    _this._sprite.setTexture(_this._texture);
    _this._aspect = 1;

    if (_this.getSeed() < 0) {
      _this.setSeed(__WEBPACK_IMPORTED_MODULE_7__text_design_models_randomizer__["a" /* Randomizer */].TimeSeed());
    }
    return _this;
  }

  _createClass(TextDesignSprite, [{
    key: 'seed',
    value: function seed(value) {
      this.setSeed(value || __WEBPACK_IMPORTED_MODULE_7__text_design_models_randomizer__["a" /* Randomizer */].TimeSeed());
    }
  }, {
    key: '_updateLayout',
    value: function _updateLayout() {
      var layout = this.getLayout();

      if (!layout) {
        return null;
      }

      this._renderer.createLayout(layout, this.getText(), this.getSeed());

      this._aspect = this._renderer.calculateAspect();

      this._isLayoutDirty = false;

      return true;
    }

    /**
     * Applies a transform with the given options
     * @param  {PhotoEditorSDK.Operations.TransformOperation.TransformChange} transformChange
     */

  }, {
    key: 'applyTransform',
    value: function applyTransform(transformChange) {
      _get(TextDesignSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSprite.prototype), 'applyTransform', this).call(this, transformChange);
      var newOptions = {};
      if (this._options.dimensions) {
        newOptions.width = transformChange.applyToRelativeSize(this.getWidth());
      }
      this.set(newOptions, false);
    }

    /**
     * Applies a flip in the given direction
     * @param  {String} direction
     */

  }, {
    key: 'applyFlip',
    value: function applyFlip(direction) {
      _get(TextDesignSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSprite.prototype), 'applyFlip', this).call(this, direction);

      var rotation = this._options.rotation;
      switch (direction) {
        case 'horizontal':
          rotation += (Math.PI - rotation) * 2;
          this.setRotation(rotation);
          break;
        case 'vertical':
          rotation += (Math.PI / 2 - rotation) * 2;
          this.setRotation(rotation);
          break;
      }
    }
  }, {
    key: 'update',
    value: function update(sdk, inputDimensions) {
      if (this._isLayoutDirty && !this._updateLayout()) {
        return;
      }
      // Transform relative width to (unzoomed) width in pixels
      var width = this.getWidth() * inputDimensions.min() / sdk.getTextureScale();
      var height = width / this._aspect;

      var dimensions = new Vector2(width, height);
      dimensions.clamp(new Vector2(1, 1), new Vector2(Infinity, Infinity));

      __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].ensureCanvasDimensions(this._canvas, dimensions);

      this._context.clearRect(0, 0, this._canvas.width, this._canvas.height);

      this._renderer.draw(this._context, new __WEBPACK_IMPORTED_MODULE_28__text_design_models_size_value__["a" /* SizeValue */](dimensions.x, dimensions.y), this.getColor(), this.getInverted());

      this.setDimensions(dimensions);

      this._texture.getBaseTexture().update();

      // Upload texture
      var renderer = sdk.getRenderer();

      /* istanbul ignore next */
      if (renderer.isOfType(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["RendererType"].WEBGL)) {
        renderer.updateTexture(this._texture.getBaseTexture());
      }

      _get(TextDesignSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSprite.prototype), 'update', this).call(this, sdk, inputDimensions);

      this._applyFlip();
    }

    /**
     * If flip is enabled, this flips the sprite
     * @private
     */

  }, {
    key: '_applyFlip',
    value: function _applyFlip() {
      var scale = this._sprite.getScale();
      var _options = this._options,
          flipHorizontally = _options.flipHorizontally,
          flipVertically = _options.flipVertically;

      if (flipHorizontally && scale.x > 0 || !flipHorizontally && scale.x < 0) {
        scale.x *= -1;
      }
      if (flipVertically && scale.y > 0 || !flipVertically && scale.y < 0) {
        scale.y *= -1;
      }
      this._sprite.setScale(scale);
    }

    /**
     * Checks if the given option has the given value
     * @param  {String} optionName
     * @param  {*} value
     * @return {Boolean}
     * @private
     */

  }, {
    key: '_optionEquals',
    value: function _optionEquals(optionName, value) {
      if (optionName === 'layout') {
        var layout = this._options.layout;

        if (!layout && value || !value && layout) {
          return false;
        }

        if (!value.constructor || !layout.constructor) {
          return false;
        }

        if (layout.constructor.identifier !== value.constructor.identifier) {
          return false;
        }

        return true;
      }

      return _get(TextDesignSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSprite.prototype), '_optionEquals', this).call(this, optionName, value);
    }

    /**
     * Returns a serialized version of this configurable
     * @param {String[]} keys
     * @param {Boolean} toObject = false
     * @return {Object}
     */

  }, {
    key: 'serializeOptions',
    value: function serializeOptions(keys) {
      var toObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      // Remove padding from serialisation if it is not enabled
      if (keys && this.getPadding() < 0) {
        var index = keys.indexOf('padding');
        if (index > -1) {
          keys.splice(index, 1);
        }
      }
      var options = _get(TextDesignSprite.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSprite.prototype), 'serializeOptions', this).call(this, keys, toObject);
      if (!keys) options.type = 'textdesign';
      return options;
    }
    /**
    * Returns the texture for the sprite that should be rendered
    * @return {PhotoEditorSDK.Engine.Texture}
    * @private
    * @abstract
    */

  }, {
    key: '_getTexture',
    value: function _getTexture() {
      return this._texture;
    }

    /**
     * Defines if sprite can be flipped horizontally
     * @return {Boolean}
     * @memberof Sprite
     * @override
     */

  }, {
    key: 'canBeFlippedHorizontally',
    value: function canBeFlippedHorizontally() {
      return false;
    }
  }, {
    key: 'canBeDuplicated',
    value: function canBeDuplicated() {
      return true;
    }
  }, {
    key: 'canMaskCanvas',
    value: function canMaskCanvas() {
      return true;
    }
  }, {
    key: 'canAdjustPadding',
    value: function canAdjustPadding() {
      return true;
    }
  }, {
    key: 'dispose',
    value: function dispose() {
      this._texture.dispose();
      this._sprite.dispose();
    }
  }]);

  return TextDesignSprite;
}(__WEBPACK_IMPORTED_MODULE_6__shared_sprite__["a" /* default */]);

TextDesignSprite.Layouts = {
  TextDesignBlocks: __WEBPACK_IMPORTED_MODULE_8__text_design_layout_text_design_blocks__["a" /* TextDesignBlocks */],
  TextDesignBlocksCondensed: __WEBPACK_IMPORTED_MODULE_9__text_design_layout_text_design_blocks_condensed__["a" /* TextDesignBlocksCondensed */],
  TextDesignBlocksLight: __WEBPACK_IMPORTED_MODULE_10__text_design_layout_text_design_blocks_light__["a" /* TextDesignBlocksLight */],
  TextDesignCelebrate: __WEBPACK_IMPORTED_MODULE_12__text_design_layout_text_design_celebrate__["a" /* TextDesignCelebrate */],
  TextDesignCelebrateSimple: __WEBPACK_IMPORTED_MODULE_13__text_design_layout_text_design_celebrate_simple__["a" /* TextDesignCelebrateSimple */],
  TextDesignEqualWidth: __WEBPACK_IMPORTED_MODULE_14__text_design_layout_text_design_equal_width__["a" /* TextDesignEqualWidth */],
  TextDesignEqualWidthFat: __WEBPACK_IMPORTED_MODULE_15__text_design_layout_text_design_equal_width_fat__["a" /* TextDesignEqualWidthFat */],
  TextDesignMasked: __WEBPACK_IMPORTED_MODULE_16__text_design_layout_text_design_masked__["a" /* TextDesignMasked */],
  TextDesignMaskedBadge: __WEBPACK_IMPORTED_MODULE_17__text_design_layout_text_design_masked_badge__["a" /* TextDesignMaskedBadge */],
  TextDesignMaskedSpeechBubble: __WEBPACK_IMPORTED_MODULE_18__text_design_layout_text_design_masked_speech_bubble__["a" /* TextDesignMaskedSpeechBubble */],
  TextDesignMaskedSpeechBubbleComic: __WEBPACK_IMPORTED_MODULE_19__text_design_layout_text_design_masked_speech_bubble_comic__["a" /* TextDesignMaskedSpeechBubbleComic */],
  TextDesignMultiline: __WEBPACK_IMPORTED_MODULE_20__text_design_layout_text_design_multiline__["a" /* TextDesignMultiline */],
  TextDesignWatercolor: __WEBPACK_IMPORTED_MODULE_21__text_design_layout_text_design_watercolor__["a" /* TextDesignWatercolor */],
  TextDesignSunshine: __WEBPACK_IMPORTED_MODULE_22__text_design_layout_text_design_sunshine__["a" /* TextDesignSunshine */],
  TextDesignParticles: __WEBPACK_IMPORTED_MODULE_24__text_design_layout_text_design_particles__["a" /* TextDesignParticles */],
  TextDesignRotated: __WEBPACK_IMPORTED_MODULE_25__text_design_layout_text_design_rotated__["a" /* TextDesignRotated */]

  // When a specific text design's layout is changed or contains bugs, a legacy, backwards
  // compatible version of it is created and added to this array. This ensures that older
  // serializations can still be loaded with the same look.
};TextDesignSprite.LegacyLayouts = {
  TextDesignBlocksLightV310: __WEBPACK_IMPORTED_MODULE_11__text_design_layout_text_design_blocks_light_v3_1_0__["a" /* TextDesignBlocksLightV310 */],
  TextDesignSunshineV310: __WEBPACK_IMPORTED_MODULE_23__text_design_layout_text_design_sunshine_v3_1_0__["a" /* TextDesignSunshineV310 */]
};

TextDesignSprite.AssetManager = __WEBPACK_IMPORTED_MODULE_26__text_design_text_design_asset_manager__["a" /* AssetManager */];

TextDesignSprite.prototype.availableOptions = {
  id: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: function _default() {
      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].getUUID();
    } },
  position: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5) },
  dimensions: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: Vector2.NULL },
  anchor: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.0, 0.0) },
  pivot: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0.5, 0.5) },
  rotation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  flipHorizontally: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  flipVertically: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },

  layout: {
    type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].OBJECT,
    default: null,
    setter: function setter(layout) {
      this._isLayoutDirty = true;

      return layout;
    }
  },
  text: {
    type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING,
    default: '',
    setter: function setter(text) {
      this._isLayoutDirty = true;

      return text;
    }
  },
  color: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].COLOR, default: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Color"].BLACK },
  padding: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.01, minValue: 0.01 },
  width: {
    type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER,
    default: 0.8
  },
  inverted: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  seed: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: -1 }
};

/* harmony default export */ __webpack_exports__["a"] = (TextDesignSprite);

/***/ }),
/* 423 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(424), __esModule: true };

/***/ }),
/* 424 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(425);
module.exports = 0x1fffffffffffff;


/***/ }),
/* 425 */
/***/ (function(module, exports, __webpack_require__) {

// 20.1.2.6 Number.MAX_SAFE_INTEGER
var $export = __webpack_require__(14);

$export($export.S, 'Number', { MAX_SAFE_INTEGER: 0x1fffffffffffff });


/***/ }),
/* 426 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignLayoutData; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__ = __webpack_require__(21);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__size_value__ = __webpack_require__(33);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var TextDesignLayoutData = function (_Configurable) {
  _inherits(TextDesignLayoutData, _Configurable);

  function TextDesignLayoutData() {
    _classCallCheck(this, TextDesignLayoutData);

    return _possibleConstructorReturn(this, (TextDesignLayoutData.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignLayoutData)).apply(this, arguments));
  }

  _createClass(TextDesignLayoutData, [{
    key: 'getSize',
    value: function getSize() {
      var rows = this.getRows();
      var width = this.getWidth();
      var lineCount = rows.length - 1;
      var height = rows.reduce(function (acc, row) {
        return acc + row.getSize().height;
      }, 0);

      height += (lineCount + 1) * this.getRelativeLineSpacing() * width;

      var insets = this.getRelativeInsets().clone().scale(width);
      height += insets.top + insets.bottom;

      return new __WEBPACK_IMPORTED_MODULE_6__size_value__["a" /* SizeValue */](width, height);
    }
  }]);

  return TextDesignLayoutData;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Configurable"]);

TextDesignLayoutData.prototype.availableOptions = {
  text: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING, default: '' },
  lines: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].ARRAY, default: [] },
  relativeInsets: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: new __WEBPACK_IMPORTED_MODULE_5__rectangle_insets__["a" /* RectangleInsets */]() },
  relativeLineSpacing: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  rows: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: [] },
  background: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: null },
  width: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 }
};

/***/ }),
/* 427 */
/***/ (function(module, exports, __webpack_require__) {

/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

// This method of obtaining a reference to the global object needs to be
// kept identical to the way it is obtained in runtime.js
var g = (function() { return this })() || Function("return this")();

// Use `getOwnPropertyNames` because not all browsers support calling
// `hasOwnProperty` on the global `self` object in a worker. See #183.
var hadRuntime = g.regeneratorRuntime &&
  Object.getOwnPropertyNames(g).indexOf("regeneratorRuntime") >= 0;

// Save the old regeneratorRuntime in case it needs to be restored later.
var oldRuntime = hadRuntime && g.regeneratorRuntime;

// Force reevalutation of runtime.js.
g.regeneratorRuntime = undefined;

module.exports = __webpack_require__(428);

if (hadRuntime) {
  // Restore the original runtime.
  g.regeneratorRuntime = oldRuntime;
} else {
  // Remove the global property added by runtime.js.
  try {
    delete g.regeneratorRuntime;
  } catch(e) {
    g.regeneratorRuntime = undefined;
  }
}


/***/ }),
/* 428 */
/***/ (function(module, exports) {

/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

!(function(global) {

  var Op = Object.prototype;
  var hasOwn = Op.hasOwnProperty;
  var undefined$1; // More compressible than void 0.
  var $Symbol = typeof Symbol === "function" ? Symbol : {};
  var iteratorSymbol = $Symbol.iterator || "@@iterator";
  var asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator";
  var toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";

  var inModule = typeof module === "object";
  var runtime = global.regeneratorRuntime;
  if (runtime) {
    if (inModule) {
      // If regeneratorRuntime is defined globally and we're in a module,
      // make the exports object identical to regeneratorRuntime.
      module.exports = runtime;
    }
    // Don't bother evaluating the rest of this file if the runtime was
    // already defined globally.
    return;
  }

  // Define the runtime globally (as expected by generated code) as either
  // module.exports (if we're in a module) or a new, empty object.
  runtime = global.regeneratorRuntime = inModule ? module.exports : {};

  function wrap(innerFn, outerFn, self, tryLocsList) {
    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.
    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;
    var generator = Object.create(protoGenerator.prototype);
    var context = new Context(tryLocsList || []);

    // The ._invoke method unifies the implementations of the .next,
    // .throw, and .return methods.
    generator._invoke = makeInvokeMethod(innerFn, self, context);

    return generator;
  }
  runtime.wrap = wrap;

  // Try/catch helper to minimize deoptimizations. Returns a completion
  // record like context.tryEntries[i].completion. This interface could
  // have been (and was previously) designed to take a closure to be
  // invoked without arguments, but in all the cases we care about we
  // already have an existing method we want to call, so there's no need
  // to create a new function object. We can even get away with assuming
  // the method takes exactly one argument, since that happens to be true
  // in every case, so we don't have to touch the arguments object. The
  // only additional allocation required is the completion record, which
  // has a stable shape and so hopefully should be cheap to allocate.
  function tryCatch(fn, obj, arg) {
    try {
      return { type: "normal", arg: fn.call(obj, arg) };
    } catch (err) {
      return { type: "throw", arg: err };
    }
  }

  var GenStateSuspendedStart = "suspendedStart";
  var GenStateSuspendedYield = "suspendedYield";
  var GenStateExecuting = "executing";
  var GenStateCompleted = "completed";

  // Returning this object from the innerFn has the same effect as
  // breaking out of the dispatch switch statement.
  var ContinueSentinel = {};

  // Dummy constructor functions that we use as the .constructor and
  // .constructor.prototype properties for functions that return Generator
  // objects. For full spec compliance, you may wish to configure your
  // minifier not to mangle the names of these two functions.
  function Generator() {}
  function GeneratorFunction() {}
  function GeneratorFunctionPrototype() {}

  // This is a polyfill for %IteratorPrototype% for environments that
  // don't natively support it.
  var IteratorPrototype = {};
  IteratorPrototype[iteratorSymbol] = function () {
    return this;
  };

  var getProto = Object.getPrototypeOf;
  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));
  if (NativeIteratorPrototype &&
      NativeIteratorPrototype !== Op &&
      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {
    // This environment has a native %IteratorPrototype%; use it instead
    // of the polyfill.
    IteratorPrototype = NativeIteratorPrototype;
  }

  var Gp = GeneratorFunctionPrototype.prototype =
    Generator.prototype = Object.create(IteratorPrototype);
  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;
  GeneratorFunctionPrototype.constructor = GeneratorFunction;
  GeneratorFunctionPrototype[toStringTagSymbol] =
    GeneratorFunction.displayName = "GeneratorFunction";

  // Helper for defining the .next, .throw, and .return methods of the
  // Iterator interface in terms of a single ._invoke method.
  function defineIteratorMethods(prototype) {
    ["next", "throw", "return"].forEach(function(method) {
      prototype[method] = function(arg) {
        return this._invoke(method, arg);
      };
    });
  }

  runtime.isGeneratorFunction = function(genFun) {
    var ctor = typeof genFun === "function" && genFun.constructor;
    return ctor
      ? ctor === GeneratorFunction ||
        // For the native GeneratorFunction constructor, the best we can
        // do is to check its .name property.
        (ctor.displayName || ctor.name) === "GeneratorFunction"
      : false;
  };

  runtime.mark = function(genFun) {
    if (Object.setPrototypeOf) {
      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);
    } else {
      genFun.__proto__ = GeneratorFunctionPrototype;
      if (!(toStringTagSymbol in genFun)) {
        genFun[toStringTagSymbol] = "GeneratorFunction";
      }
    }
    genFun.prototype = Object.create(Gp);
    return genFun;
  };

  // Within the body of any async function, `await x` is transformed to
  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test
  // `hasOwn.call(value, "__await")` to determine if the yielded value is
  // meant to be awaited.
  runtime.awrap = function(arg) {
    return { __await: arg };
  };

  function AsyncIterator(generator) {
    function invoke(method, arg, resolve, reject) {
      var record = tryCatch(generator[method], generator, arg);
      if (record.type === "throw") {
        reject(record.arg);
      } else {
        var result = record.arg;
        var value = result.value;
        if (value &&
            typeof value === "object" &&
            hasOwn.call(value, "__await")) {
          return Promise.resolve(value.__await).then(function(value) {
            invoke("next", value, resolve, reject);
          }, function(err) {
            invoke("throw", err, resolve, reject);
          });
        }

        return Promise.resolve(value).then(function(unwrapped) {
          // When a yielded Promise is resolved, its final value becomes
          // the .value of the Promise<{value,done}> result for the
          // current iteration. If the Promise is rejected, however, the
          // result for this iteration will be rejected with the same
          // reason. Note that rejections of yielded Promises are not
          // thrown back into the generator function, as is the case
          // when an awaited Promise is rejected. This difference in
          // behavior between yield and await is important, because it
          // allows the consumer to decide what to do with the yielded
          // rejection (swallow it and continue, manually .throw it back
          // into the generator, abandon iteration, whatever). With
          // await, by contrast, there is no opportunity to examine the
          // rejection reason outside the generator function, so the
          // only option is to throw it from the await expression, and
          // let the generator function handle the exception.
          result.value = unwrapped;
          resolve(result);
        }, reject);
      }
    }

    var previousPromise;

    function enqueue(method, arg) {
      function callInvokeWithMethodAndArg() {
        return new Promise(function(resolve, reject) {
          invoke(method, arg, resolve, reject);
        });
      }

      return previousPromise =
        // If enqueue has been called before, then we want to wait until
        // all previous Promises have been resolved before calling invoke,
        // so that results are always delivered in the correct order. If
        // enqueue has not been called before, then it is important to
        // call invoke immediately, without waiting on a callback to fire,
        // so that the async generator function has the opportunity to do
        // any necessary setup in a predictable way. This predictability
        // is why the Promise constructor synchronously invokes its
        // executor callback, and why async functions synchronously
        // execute code before the first await. Since we implement simple
        // async functions in terms of async generators, it is especially
        // important to get this right, even though it requires care.
        previousPromise ? previousPromise.then(
          callInvokeWithMethodAndArg,
          // Avoid propagating failures to Promises returned by later
          // invocations of the iterator.
          callInvokeWithMethodAndArg
        ) : callInvokeWithMethodAndArg();
    }

    // Define the unified helper method that is used to implement .next,
    // .throw, and .return (see defineIteratorMethods).
    this._invoke = enqueue;
  }

  defineIteratorMethods(AsyncIterator.prototype);
  AsyncIterator.prototype[asyncIteratorSymbol] = function () {
    return this;
  };
  runtime.AsyncIterator = AsyncIterator;

  // Note that simple async functions are implemented on top of
  // AsyncIterator objects; they just return a Promise for the value of
  // the final result produced by the iterator.
  runtime.async = function(innerFn, outerFn, self, tryLocsList) {
    var iter = new AsyncIterator(
      wrap(innerFn, outerFn, self, tryLocsList)
    );

    return runtime.isGeneratorFunction(outerFn)
      ? iter // If outerFn is a generator, return the full iterator.
      : iter.next().then(function(result) {
          return result.done ? result.value : iter.next();
        });
  };

  function makeInvokeMethod(innerFn, self, context) {
    var state = GenStateSuspendedStart;

    return function invoke(method, arg) {
      if (state === GenStateExecuting) {
        throw new Error("Generator is already running");
      }

      if (state === GenStateCompleted) {
        if (method === "throw") {
          throw arg;
        }

        // Be forgiving, per 25.3.3.3.3 of the spec:
        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume
        return doneResult();
      }

      context.method = method;
      context.arg = arg;

      while (true) {
        var delegate = context.delegate;
        if (delegate) {
          var delegateResult = maybeInvokeDelegate(delegate, context);
          if (delegateResult) {
            if (delegateResult === ContinueSentinel) continue;
            return delegateResult;
          }
        }

        if (context.method === "next") {
          // Setting context._sent for legacy support of Babel's
          // function.sent implementation.
          context.sent = context._sent = context.arg;

        } else if (context.method === "throw") {
          if (state === GenStateSuspendedStart) {
            state = GenStateCompleted;
            throw context.arg;
          }

          context.dispatchException(context.arg);

        } else if (context.method === "return") {
          context.abrupt("return", context.arg);
        }

        state = GenStateExecuting;

        var record = tryCatch(innerFn, self, context);
        if (record.type === "normal") {
          // If an exception is thrown from innerFn, we leave state ===
          // GenStateExecuting and loop back for another invocation.
          state = context.done
            ? GenStateCompleted
            : GenStateSuspendedYield;

          if (record.arg === ContinueSentinel) {
            continue;
          }

          return {
            value: record.arg,
            done: context.done
          };

        } else if (record.type === "throw") {
          state = GenStateCompleted;
          // Dispatch the exception by looping back around to the
          // context.dispatchException(context.arg) call above.
          context.method = "throw";
          context.arg = record.arg;
        }
      }
    };
  }

  // Call delegate.iterator[context.method](context.arg) and handle the
  // result, either by returning a { value, done } result from the
  // delegate iterator, or by modifying context.method and context.arg,
  // setting context.delegate to null, and returning the ContinueSentinel.
  function maybeInvokeDelegate(delegate, context) {
    var method = delegate.iterator[context.method];
    if (method === undefined$1) {
      // A .throw or .return when the delegate iterator has no .throw
      // method always terminates the yield* loop.
      context.delegate = null;

      if (context.method === "throw") {
        if (delegate.iterator.return) {
          // If the delegate iterator has a return method, give it a
          // chance to clean up.
          context.method = "return";
          context.arg = undefined$1;
          maybeInvokeDelegate(delegate, context);

          if (context.method === "throw") {
            // If maybeInvokeDelegate(context) changed context.method from
            // "return" to "throw", let that override the TypeError below.
            return ContinueSentinel;
          }
        }

        context.method = "throw";
        context.arg = new TypeError(
          "The iterator does not provide a 'throw' method");
      }

      return ContinueSentinel;
    }

    var record = tryCatch(method, delegate.iterator, context.arg);

    if (record.type === "throw") {
      context.method = "throw";
      context.arg = record.arg;
      context.delegate = null;
      return ContinueSentinel;
    }

    var info = record.arg;

    if (! info) {
      context.method = "throw";
      context.arg = new TypeError("iterator result is not an object");
      context.delegate = null;
      return ContinueSentinel;
    }

    if (info.done) {
      // Assign the result of the finished delegate to the temporary
      // variable specified by delegate.resultName (see delegateYield).
      context[delegate.resultName] = info.value;

      // Resume execution at the desired location (see delegateYield).
      context.next = delegate.nextLoc;

      // If context.method was "throw" but the delegate handled the
      // exception, let the outer generator proceed normally. If
      // context.method was "next", forget context.arg since it has been
      // "consumed" by the delegate iterator. If context.method was
      // "return", allow the original .return call to continue in the
      // outer generator.
      if (context.method !== "return") {
        context.method = "next";
        context.arg = undefined$1;
      }

    } else {
      // Re-yield the result returned by the delegate method.
      return info;
    }

    // The delegate iterator is finished, so forget it and continue with
    // the outer generator.
    context.delegate = null;
    return ContinueSentinel;
  }

  // Define Generator.prototype.{next,throw,return} in terms of the
  // unified ._invoke helper method.
  defineIteratorMethods(Gp);

  Gp[toStringTagSymbol] = "Generator";

  // A Generator should always return itself as the iterator object when the
  // @@iterator function is called on it. Some browsers' implementations of the
  // iterator prototype chain incorrectly implement this, causing the Generator
  // object to not be returned from this call. This ensures that doesn't happen.
  // See https://github.com/facebook/regenerator/issues/274 for more details.
  Gp[iteratorSymbol] = function() {
    return this;
  };

  Gp.toString = function() {
    return "[object Generator]";
  };

  function pushTryEntry(locs) {
    var entry = { tryLoc: locs[0] };

    if (1 in locs) {
      entry.catchLoc = locs[1];
    }

    if (2 in locs) {
      entry.finallyLoc = locs[2];
      entry.afterLoc = locs[3];
    }

    this.tryEntries.push(entry);
  }

  function resetTryEntry(entry) {
    var record = entry.completion || {};
    record.type = "normal";
    delete record.arg;
    entry.completion = record;
  }

  function Context(tryLocsList) {
    // The root entry object (effectively a try statement without a catch
    // or a finally block) gives us a place to store values thrown from
    // locations where there is no enclosing try statement.
    this.tryEntries = [{ tryLoc: "root" }];
    tryLocsList.forEach(pushTryEntry, this);
    this.reset(true);
  }

  runtime.keys = function(object) {
    var keys = [];
    for (var key in object) {
      keys.push(key);
    }
    keys.reverse();

    // Rather than returning an object with a next method, we keep
    // things simple and return the next function itself.
    return function next() {
      while (keys.length) {
        var key = keys.pop();
        if (key in object) {
          next.value = key;
          next.done = false;
          return next;
        }
      }

      // To avoid creating an additional object, we just hang the .value
      // and .done properties off the next function object itself. This
      // also ensures that the minifier will not anonymize the function.
      next.done = true;
      return next;
    };
  };

  function values(iterable) {
    if (iterable) {
      var iteratorMethod = iterable[iteratorSymbol];
      if (iteratorMethod) {
        return iteratorMethod.call(iterable);
      }

      if (typeof iterable.next === "function") {
        return iterable;
      }

      if (!isNaN(iterable.length)) {
        var i = -1, next = function next() {
          while (++i < iterable.length) {
            if (hasOwn.call(iterable, i)) {
              next.value = iterable[i];
              next.done = false;
              return next;
            }
          }

          next.value = undefined$1;
          next.done = true;

          return next;
        };

        return next.next = next;
      }
    }

    // Return an iterator with no values.
    return { next: doneResult };
  }
  runtime.values = values;

  function doneResult() {
    return { value: undefined$1, done: true };
  }

  Context.prototype = {
    constructor: Context,

    reset: function(skipTempReset) {
      this.prev = 0;
      this.next = 0;
      // Resetting context._sent for legacy support of Babel's
      // function.sent implementation.
      this.sent = this._sent = undefined$1;
      this.done = false;
      this.delegate = null;

      this.method = "next";
      this.arg = undefined$1;

      this.tryEntries.forEach(resetTryEntry);

      if (!skipTempReset) {
        for (var name in this) {
          // Not sure about the optimal order of these conditions:
          if (name.charAt(0) === "t" &&
              hasOwn.call(this, name) &&
              !isNaN(+name.slice(1))) {
            this[name] = undefined$1;
          }
        }
      }
    },

    stop: function() {
      this.done = true;

      var rootEntry = this.tryEntries[0];
      var rootRecord = rootEntry.completion;
      if (rootRecord.type === "throw") {
        throw rootRecord.arg;
      }

      return this.rval;
    },

    dispatchException: function(exception) {
      if (this.done) {
        throw exception;
      }

      var context = this;
      function handle(loc, caught) {
        record.type = "throw";
        record.arg = exception;
        context.next = loc;

        if (caught) {
          // If the dispatched exception was caught by a catch block,
          // then let that catch block handle the exception normally.
          context.method = "next";
          context.arg = undefined$1;
        }

        return !! caught;
      }

      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        var record = entry.completion;

        if (entry.tryLoc === "root") {
          // Exception thrown outside of any try block that could handle
          // it, so set the completion value of the entire function to
          // throw the exception.
          return handle("end");
        }

        if (entry.tryLoc <= this.prev) {
          var hasCatch = hasOwn.call(entry, "catchLoc");
          var hasFinally = hasOwn.call(entry, "finallyLoc");

          if (hasCatch && hasFinally) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            } else if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else if (hasCatch) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            }

          } else if (hasFinally) {
            if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else {
            throw new Error("try statement without catch or finally");
          }
        }
      }
    },

    abrupt: function(type, arg) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc <= this.prev &&
            hasOwn.call(entry, "finallyLoc") &&
            this.prev < entry.finallyLoc) {
          var finallyEntry = entry;
          break;
        }
      }

      if (finallyEntry &&
          (type === "break" ||
           type === "continue") &&
          finallyEntry.tryLoc <= arg &&
          arg <= finallyEntry.finallyLoc) {
        // Ignore the finally entry if control is not jumping to a
        // location outside the try/catch block.
        finallyEntry = null;
      }

      var record = finallyEntry ? finallyEntry.completion : {};
      record.type = type;
      record.arg = arg;

      if (finallyEntry) {
        this.method = "next";
        this.next = finallyEntry.finallyLoc;
        return ContinueSentinel;
      }

      return this.complete(record);
    },

    complete: function(record, afterLoc) {
      if (record.type === "throw") {
        throw record.arg;
      }

      if (record.type === "break" ||
          record.type === "continue") {
        this.next = record.arg;
      } else if (record.type === "return") {
        this.rval = this.arg = record.arg;
        this.method = "return";
        this.next = "end";
      } else if (record.type === "normal" && afterLoc) {
        this.next = afterLoc;
      }

      return ContinueSentinel;
    },

    finish: function(finallyLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.finallyLoc === finallyLoc) {
          this.complete(entry.completion, entry.afterLoc);
          resetTryEntry(entry);
          return ContinueSentinel;
        }
      }
    },

    "catch": function(tryLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc === tryLoc) {
          var record = entry.completion;
          if (record.type === "throw") {
            var thrown = record.arg;
            resetTryEntry(entry);
          }
          return thrown;
        }
      }

      // The context.catch method must only be called with a location
      // argument that corresponds to a known catch block.
      throw new Error("illegal catch attempt");
    },

    delegateYield: function(iterable, resultName, nextLoc) {
      this.delegate = {
        iterator: values(iterable),
        resultName: resultName,
        nextLoc: nextLoc
      };

      if (this.method === "next") {
        // Deliberately forget the last sent value so that we don't
        // accidentally pass it on to the delegate.
        this.arg = undefined$1;
      }

      return ContinueSentinel;
    }
  };
})(
  // In sloppy mode, unbound `this` refers to the global object, fallback to
  // Function constructor if we're in global strict mode. That is sadly a form
  // of indirect eval which violates Content Security Policy.
  (function() { return this })() || Function("return this")()
);


/***/ }),
/* 429 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignRowTriple; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__default_text_design_row__ = __webpack_require__(92);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_text_design_font__ = __webpack_require__(78);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_design_element__ = __webpack_require__(52);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var Rectangle = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Rectangle;


var TextDesignRowTriple = function (_TextDesignRow) {
  _inherits(TextDesignRowTriple, _TextDesignRow);

  function TextDesignRowTriple() {
    _classCallCheck(this, TextDesignRowTriple);

    return _possibleConstructorReturn(this, (TextDesignRowTriple.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRowTriple)).apply(this, arguments));
  }

  _createClass(TextDesignRowTriple, [{
    key: '_calculateLayoutElements',
    value: function _calculateLayoutElements() {
      if (this.getWords().size() <= 0) {
        return [];
      }

      var _serializeOptions = this.serializeOptions(),
          orientation = _serializeOptions.orientation,
          width = _serializeOptions.width,
          size = _serializeOptions.size,
          relativeRowOffset = _serializeOptions.relativeRowOffset,
          attributes = _serializeOptions.attributes;

      var fontIdentifier = attributes.fontIdentifier;

      var wordGroups = this.getWords().joined(3);

      var lines = orientation === TextDesignRowTriple.Orientations.Left ? [wordGroups[0], wordGroups[1], wordGroups[2]] : [wordGroups[1], wordGroups[2], wordGroups[0]];

      // Dummy fonts for calculating relationships between elements dimensions
      var dummyFonts = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].Array.range(0, 2).map(function (i) {
        return new __WEBPACK_IMPORTED_MODULE_7__text_text_design_font__["a" /* TextDesignFont */]({
          text: lines[i],
          fontIdentifier: fontIdentifier,
          fontSize: 60
        });
      });

      var dummySizes = dummyFonts.map(function (font) {
        return font.getSizeValue();
      });

      // Find out which one has the largest width
      var largestWidthIndex = dummySizes[0].width > dummySizes[1].width ? 0 : 1;
      var smallestWidthIndex = (largestWidthIndex + 1) % 2;

      // Resize the smallest width piece to match the largest one
      dummyFonts[smallestWidthIndex].fitWidth(dummySizes[largestWidthIndex].width);
      dummySizes[smallestWidthIndex] = dummyFonts[smallestWidthIndex].getSizeValue();

      // Get the final height of the "dummy" row
      var dummyHeight = (dummySizes[smallestWidthIndex].height + dummySizes[largestWidthIndex].height) / (1 - relativeRowOffset);

      // Dummy font for the single row calculations
      var dummySingleRowFont = new __WEBPACK_IMPORTED_MODULE_7__text_text_design_font__["a" /* TextDesignFont */]({ text: lines[2], fontIdentifier: fontIdentifier });

      // Fit the single row to the double row's height and get the width
      dummySingleRowFont.fitHeight(dummyHeight);
      var dummySingleRowWidth = dummySingleRowFont.getSizeValue().width;
      var dummyDoubleRowWidth = dummySizes[largestWidthIndex].width;

      // Calculate the actual width of single and double rows, based on the given row width
      var scale = width / (dummySingleRowWidth + dummyDoubleRowWidth);
      var singleRowWidth = scale * dummySingleRowWidth;
      var doubleRowWidth = scale * dummyDoubleRowWidth;

      // Calculate the heights
      var rowHeight = scale * dummyHeight;
      var offset = relativeRowOffset * rowHeight;

      size.set(width, rowHeight);

      // Final fonts
      var fonts = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].Array.range(0, 3).map(function (i) {
        return new __WEBPACK_IMPORTED_MODULE_7__text_text_design_font__["a" /* TextDesignFont */]({ text: lines[i], fontIdentifier: fontIdentifier });
      });

      fonts[0].fitWidth(doubleRowWidth);
      fonts[1].fitWidth(doubleRowWidth);
      fonts[2].fitWidth(singleRowWidth);

      // Calculate the frames
      var doubleRowX = orientation === TextDesignRowTriple.Orientations.Left ? 0 : singleRowWidth;
      var singleRowX = orientation === TextDesignRowTriple.Orientations.Left ? doubleRowWidth : 0;

      var xOffsets = [doubleRowX, doubleRowX, singleRowX];
      var yOffsets = [0, fonts[0].getSizeValue().height + offset, 0];

      var frames = fonts.map(function (font, i) {
        return new Rectangle(xOffsets[i], yOffsets[i], font.getSizeValue().width, font.getSizeValue().height);
      });

      return fonts.map(function (font, i) {
        return new __WEBPACK_IMPORTED_MODULE_8__text_design_element__["a" /* TextDesignElement */]({
          text: lines[i],
          font: fonts[i],
          frame: frames[i]
        });
      });
    }
  }]);

  return TextDesignRowTriple;
}(__WEBPACK_IMPORTED_MODULE_6__default_text_design_row__["a" /* TextDesignRow */]);

TextDesignRowTriple.Orientations = {
  Right: 'RIGHT',
  Left: 'LEFT'
};
TextDesignRowTriple.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_6__default_text_design_row__["a" /* TextDesignRow */].prototype.availableOptions, {
  orientation: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].STRING, default: TextDesignRowTriple.Orientations.Left, available: [TextDesignRowTriple.Orientations.Right, TextDesignRowTriple.Orientations.Left] },
  relativeRowOffset: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.05 }
});

/***/ }),
/* 430 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignBlocksCondensed; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design_blocks__ = __webpack_require__(75);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__models_rows_default_text_design_row_single__ = __webpack_require__(26);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var TextDesignBlocksCondensed = function (_TextDesignBlocks) {
  _inherits(TextDesignBlocksCondensed, _TextDesignBlocks);

  function TextDesignBlocksCondensed() {
    var _ref;

    _classCallCheck(this, TextDesignBlocksCondensed);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignBlocksCondensed.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignBlocksCondensed)).call.apply(_ref, [this].concat(args)));

    _this._exclusiveFont = null;
    return _this;
  }

  _createClass(TextDesignBlocksCondensed, [{
    key: 'generateLayoutData',
    value: function generateLayoutData(text, width) {
      this._exclusiveFont = this._fontRandomizer.pickNext(this.getFontIdentifiers());
      return _get(TextDesignBlocksCondensed.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignBlocksCondensed.prototype), 'generateLayoutData', this).call(this, text, width);
    }
  }, {
    key: '_fontForRow',
    value: function _fontForRow(index, words) {
      return this._exclusiveFont || _get(TextDesignBlocksCondensed.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignBlocksCondensed.prototype), '_fontForRow', this).call(this, index, words);
    }
  }, {
    key: '_layoutRow',
    value: function _layoutRow(words, width, attributes, isMasked) {
      return new __WEBPACK_IMPORTED_MODULE_8__models_rows_default_text_design_row_single__["a" /* TextDesignRowSingle */]({ words: words, width: width, attributes: attributes });
    }
  }]);

  return TextDesignBlocksCondensed;
}(__WEBPACK_IMPORTED_MODULE_7__text_design_blocks__["a" /* TextDesignBlocks */]);

TextDesignBlocksCondensed.defaultFontIdentifiers = ['imgly_font_ostrich_sans_heavy', 'imgly_font_ostrich_sans_bold', 'imgly_font_ostrich_sans_black'];
TextDesignBlocksCondensed.identifier = 'imgly_text_design_blocks_condensed';
TextDesignBlocksCondensed.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_7__text_design_blocks__["a" /* TextDesignBlocks */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignBlocksCondensed.defaultFontIdentifiers }
});

/***/ }),
/* 431 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignBlocksLightV310; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_blocks_light__ = __webpack_require__(179);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__models_text_design_attributes__ = __webpack_require__(77);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__models_rows_default_text_design_row_single__ = __webpack_require__(26);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






// Named v3.1.0 because iOS released their fix with 3.2.0
// On Web, this legacy version without the decorative lines was only
// replaced with the current design starting with serialization version 3.5.0
var TextDesignBlocksLightV310 = function (_TextDesignBlocksLigh) {
  _inherits(TextDesignBlocksLightV310, _TextDesignBlocksLigh);

  function TextDesignBlocksLightV310() {
    _classCallCheck(this, TextDesignBlocksLightV310);

    return _possibleConstructorReturn(this, (TextDesignBlocksLightV310.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignBlocksLightV310)).apply(this, arguments));
  }

  _createClass(TextDesignBlocksLightV310, [{
    key: '_layoutRows',
    value: function _layoutRows(lines, width) {
      var _this2 = this;

      return lines.map(function (line, index) {
        return _this2._randomLayoutRow(line, index, width, new __WEBPACK_IMPORTED_MODULE_7__models_text_design_attributes__["a" /* TextDesignAttributes */]({ fontIdentifier: _this2._fontForRow(index, line) })).layout();
      });
    }
  }, {
    key: '_layoutRow',
    value: function _layoutRow(words, width, attributes, isMasked) {
      return new __WEBPACK_IMPORTED_MODULE_8__models_rows_default_text_design_row_single__["a" /* TextDesignRowSingle */]({ words: words, width: width, attributes: attributes });
    }
  }]);

  return TextDesignBlocksLightV310;
}(__WEBPACK_IMPORTED_MODULE_6__text_design_blocks_light__["a" /* TextDesignBlocksLight */]);

TextDesignBlocksLightV310.defaultFontIdentifiers = ['imgly_font_summer_font_light'];
TextDesignBlocksLightV310.identifier = 'imgly_text_design_blocks_light-v3_1_0';
TextDesignBlocksLightV310.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_6__text_design_blocks_light__["a" /* TextDesignBlocksLight */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignBlocksLightV310.defaultFontIdentifiers }
});

/***/ }),
/* 432 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignCelebrateSimple; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_design_blocks__ = __webpack_require__(75);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__models_rows_default_text_design_row_single__ = __webpack_require__(26);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__models_text_design_banderole__ = __webpack_require__(123);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__text_words__ = __webpack_require__(47);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__models_rows_image_text_design_row_image__ = __webpack_require__(125);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__text_design_celebrate__ = __webpack_require__(181);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__models_rows_image_text_design_row_single_image__ = __webpack_require__(126);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__text_design_asset_manager__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__models_randomizer__ = __webpack_require__(20);








var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */












var TextDesignCelebrateSimple = function (_TextDesignCelebrate) {
  _inherits(TextDesignCelebrateSimple, _TextDesignCelebrate);

  function TextDesignCelebrateSimple() {
    var _ref;

    _classCallCheck(this, TextDesignCelebrateSimple);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignCelebrateSimple.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignCelebrateSimple)).call.apply(_ref, [this].concat(args)));

    _this.getImagePaths = function () {
      var banderoles = _this.getBanderoles();
      return [].concat(_toConsumableArray(banderoles && banderoles.map(function (b) {
        return b.getImagePath();
      }) || []), _toConsumableArray(_this._celebrateTypes));
    };

    _this.onImagesLoaded = function () {
      var banderoles = _this.getBanderoles();
      banderoles && banderoles.forEach(function (b) {
        var image = __WEBPACK_IMPORTED_MODULE_15__text_design_asset_manager__["a" /* AssetManager */].getImage(b.getImagePath());
        if (!image) {
          __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Log"].warn('TextDesignBlocks#onImagesLoaded: Image not found \'' + b.getImagePath() + '\'');
          return;
        }

        b.setImage(image);
      });
    };

    _this._celebrateTypes = [__WEBPACK_IMPORTED_MODULE_14__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */].RowImages.celebrate1, __WEBPACK_IMPORTED_MODULE_14__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */].RowImages.celebrate2, __WEBPACK_IMPORTED_MODULE_14__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */].RowImages.celebrate3];

    _this._exclusiveFont = null;

    _this._typeRandomizer = new __WEBPACK_IMPORTED_MODULE_16__models_randomizer__["a" /* Randomizer */](0);
    _this._useMaskedRandomizer = new __WEBPACK_IMPORTED_MODULE_16__models_randomizer__["a" /* Randomizer */](0);

    _this._seedPool.push(_this._typeRandomizer);
    _this._seedPool.push(_this._useMaskedRandomizer);
    return _this;
  }

  _createClass(TextDesignCelebrateSimple, [{
    key: '_fontForRow',
    value: function _fontForRow(index, words) {
      var fonts = this.getFontIdentifiers();
      return fonts[index % (fonts.length - 1)];
    }
  }, {
    key: '_layoutRows',
    value: function _layoutRows(lines, width) {
      var imagePath = this._typeRandomizer.pickNext(this._celebrateTypes);
      var image = __WEBPACK_IMPORTED_MODULE_15__text_design_asset_manager__["a" /* AssetManager */].getImage(imagePath);

      if (!image) {
        __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Log"].warn('TextDesignCelebrateSimple#_layoutRows: Image not fount \'' + imagePath + '\'');
      }

      var firstRow = new __WEBPACK_IMPORTED_MODULE_14__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */]({
        width: width,
        height: width * 0.5,
        drawingModeAspectFit: true,
        image: image
      }).layout();

      var rows = _get(TextDesignCelebrateSimple.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignCelebrateSimple.prototype), '_layoutRows', this).call(this, lines, width);

      return [firstRow].concat(_toConsumableArray(rows));
    }
  }, {
    key: '_randomLayoutRow',
    value: function _randomLayoutRow(words, index, width, attributes) {
      var numberOfCharacters = words.countNumberOfCharacters();

      var maximumNumberOfCharacters = 13;
      var minimumNumberOfCharacters = 4;

      if (numberOfCharacters < minimumNumberOfCharacters) {
        attributes.setFontIdentifier('imgly_font_rasa_regular');
      }

      var isMasked = this._useMaskedRandomizer.nextBool(2, 1);

      if (numberOfCharacters < maximumNumberOfCharacters && isMasked && !this.getHasMaskedText()) {
        return this._layoutRow(words, width, attributes, true);
      }

      return _get(TextDesignCelebrateSimple.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignCelebrateSimple.prototype), '_randomLayoutRow', this).call(this, words, index, width, attributes);
    }
  }]);

  return TextDesignCelebrateSimple;
}(__WEBPACK_IMPORTED_MODULE_13__text_design_celebrate__["a" /* TextDesignCelebrate */]);

TextDesignCelebrateSimple.identifier = 'imgly_text_design_celebrate_simple';
TextDesignCelebrateSimple.defaultFontIdentifiers = ['imgly_font_amberlight', 'imgly_font_rasa_regular', 'imgly_font_rasa_500'];
TextDesignCelebrateSimple.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_13__text_design_celebrate__["a" /* TextDesignCelebrate */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignCelebrateSimple.defaultFontIdentifiers }
});

/***/ }),
/* 433 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignEqualWidthBackground; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__text_design_background__ = __webpack_require__(183);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_asset_manager__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_canvas__ = __webpack_require__(48);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var Rectangle = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Rectangle;


var TextDesignEqualWidthBackground = function (_TextDesignBackground) {
  _inherits(TextDesignEqualWidthBackground, _TextDesignBackground);

  function TextDesignEqualWidthBackground() {
    _classCallCheck(this, TextDesignEqualWidthBackground);

    return _possibleConstructorReturn(this, (TextDesignEqualWidthBackground.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignEqualWidthBackground)).apply(this, arguments));
  }

  _createClass(TextDesignEqualWidthBackground, [{
    key: 'getImagePaths',
    value: function getImagePaths() {
      var _options = this._options,
          topImagePath = _options.topImagePath,
          bottomImagePath = _options.bottomImagePath,
          leftImagePath = _options.leftImagePath,
          rightImagePath = _options.rightImagePath;


      return [topImagePath, bottomImagePath, leftImagePath, rightImagePath].filter(function (path) {
        return path !== '';
      });
    }
  }, {
    key: 'render',
    value: function render(context, size, relativeInsets, color, randomizer) {
      var absoluteInsets = relativeInsets.clone().scale(size.width);
      var frame = size.rectangle(0, 0);

      var topImage = __WEBPACK_IMPORTED_MODULE_6__text_design_asset_manager__["a" /* AssetManager */].getImage(this.getTopImagePath());
      var leftImage = __WEBPACK_IMPORTED_MODULE_6__text_design_asset_manager__["a" /* AssetManager */].getImage(this.getLeftImagePath());
      var rightImage = __WEBPACK_IMPORTED_MODULE_6__text_design_asset_manager__["a" /* AssetManager */].getImage(this.getRightImagePath());
      var bottomImage = __WEBPACK_IMPORTED_MODULE_6__text_design_asset_manager__["a" /* AssetManager */].getImage(this.getBottomImagePath());

      if (topImage) {
        var aspect = topImage.width / topImage.height;

        var destHeight = absoluteInsets.top * this.getTopImageFillRate();
        var destWidth = destHeight * aspect;

        var xCenter = frame.width / 2;
        var xOrigin = xCenter - destWidth / 2;

        var topFrame = new Rectangle(xOrigin, 0, destWidth, destHeight);

        Object(__WEBPACK_IMPORTED_MODULE_7__utils_canvas__["a" /* drawImageFrame */])(context, topImage, topFrame, color);
      }

      if (bottomImage) {
        var _aspect = bottomImage.width / bottomImage.height;

        var _destHeight = absoluteInsets.bottom * this.getBottomImageFillRate();
        var _destWidth = _destHeight * _aspect;

        var _xCenter = frame.width / 2;
        var _xOrigin = _xCenter - _destWidth / 2;

        var bottomFrame = new Rectangle(_xOrigin, frame.height - _destHeight, _destWidth, _destHeight);
        Object(__WEBPACK_IMPORTED_MODULE_7__utils_canvas__["a" /* drawImageFrame */])(context, bottomImage, bottomFrame, color);
      }

      if (leftImage) {
        var _aspect2 = leftImage.width / leftImage.height;

        var _destWidth2 = absoluteInsets.left * this.getLeftImageFillRate();
        var _destHeight2 = _destWidth2 / _aspect2;

        var yCenter = frame.height / 2;
        var yOrigin = yCenter - _destHeight2 / 2;

        var leftFrame = new Rectangle(0, yOrigin, _destWidth2, _destHeight2);
        Object(__WEBPACK_IMPORTED_MODULE_7__utils_canvas__["a" /* drawImageFrame */])(context, leftImage, leftFrame, color);
      }

      if (rightImage) {
        var _aspect3 = rightImage.width / rightImage.height;

        var _destWidth3 = absoluteInsets.right * this.getRightImageFillRate();
        var _destHeight3 = _destWidth3 / _aspect3;

        var _yCenter = frame.height / 2;
        var _yOrigin = _yCenter - _destHeight3 / 2;

        var rightFrame = new Rectangle(frame.width - _destWidth3, _yOrigin, _destWidth3, _destHeight3);
        Object(__WEBPACK_IMPORTED_MODULE_7__utils_canvas__["a" /* drawImageFrame */])(context, rightImage, rightFrame, color);
      }
    }
  }]);

  return TextDesignEqualWidthBackground;
}(__WEBPACK_IMPORTED_MODULE_5__text_design_background__["a" /* TextDesignBackground */]);

TextDesignEqualWidthBackground.prototype.availableOptions = {
  topImagePath: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING, default: '' },
  leftImagePath: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING, default: '' },
  bottomImagePath: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING, default: '' },
  rightImagePath: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING, default: '' },
  topImageFillRate: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  leftImageFillRate: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  bottomImageFillRate: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  rightImageFillRate: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 }
};

TextDesignEqualWidthBackground.Backgrounds = [new TextDesignEqualWidthBackground({
  topImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background1_1.png',
  leftImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png',
  rightImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png',
  bottomImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background1_3.png',
  topImageFillRate: 0.8,
  leftImageFillRate: 0.6,
  rightImageFillRate: 0.6,
  bottomImageFillRate: 0.8
}), new TextDesignEqualWidthBackground({
  leftImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png',
  rightImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png',
  bottomImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background2_2.png',
  leftImageFillRate: 0.6,
  rightImageFillRate: 0.6,
  bottomImageFillRate: 0.6
}), new TextDesignEqualWidthBackground({
  topImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background3_1.png',
  bottomImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background3_2.png',
  topImageFillRate: 0.6,
  bottomImageFillRate: 0.6
}), new TextDesignEqualWidthBackground({
  topImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background4_1.png',
  leftImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png',
  rightImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png',
  bottomImagePath: 'text-design/images/imgly_xib_image_text_design_equal_width_background4_2.png',
  topImageFillRate: 0.1,
  leftImageFillRate: 0.6,
  rightImageFillRate: 0.6,
  bottomImageFillRate: 0.6
})];

/***/ }),
/* 434 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignEqualWidthFat; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_equal_width__ = __webpack_require__(182);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__models_rectangle_insets__ = __webpack_require__(21);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var TextDesignEqualWidthFat = function (_TextDesignEqualWidth) {
  _inherits(TextDesignEqualWidthFat, _TextDesignEqualWidth);

  function TextDesignEqualWidthFat() {
    var _ref;

    _classCallCheck(this, TextDesignEqualWidthFat);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignEqualWidthFat.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignEqualWidthFat)).call.apply(_ref, [this].concat(args)));

    _this._relativeInsets = new __WEBPACK_IMPORTED_MODULE_7__models_rectangle_insets__["a" /* RectangleInsets */]();
    return _this;
  }

  _createClass(TextDesignEqualWidthFat, [{
    key: '_getBackground',
    value: function _getBackground() {
      return null;
    }
  }]);

  return TextDesignEqualWidthFat;
}(__WEBPACK_IMPORTED_MODULE_6__text_design_equal_width__["a" /* TextDesignEqualWidth */]);

TextDesignEqualWidthFat.defaultFontIdentifiers = ['imgly_font_ultra'];
TextDesignEqualWidthFat.identifier = 'imgly_text_design_equal_width_fat';
TextDesignEqualWidthFat.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_6__text_design_equal_width__["a" /* TextDesignEqualWidth */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignEqualWidthFat.defaultFontIdentifiers }
});

/***/ }),
/* 435 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignFontMultiline; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design_asset_manager__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_text_splitter__ = __webpack_require__(178);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__models_size_value__ = __webpack_require__(33);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var Vector2 = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Math"].Vector2;


var TextDesignFontMultiline = function (_Configurable) {
  _inherits(TextDesignFontMultiline, _Configurable);

  function TextDesignFontMultiline(options) {
    _classCallCheck(this, TextDesignFontMultiline);

    var _this = _possibleConstructorReturn(this, (TextDesignFontMultiline.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignFontMultiline)).call(this, options));

    _this._textOptions = {};
    _this._createCanvas();
    return _this;
  }

  /**
   * Creates the canvas and initializes the text splitter
   * @private
   */


  _createClass(TextDesignFontMultiline, [{
    key: '_createCanvas',
    value: function _createCanvas() {
      this._canvas = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].createCanvas();
      this._context = this._canvas.getContext('2d');
      this._textSplitter = new __WEBPACK_IMPORTED_MODULE_8__text_text_splitter__["a" /* default */](this._context);

      this._finalCanvas = __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].createCanvas();
      this._finalContext = this._finalCanvas.getContext('2d');

      this.updateFontVariation();
    }
  }, {
    key: 'setOption',
    value: function setOption(optionName, value) {
      var update = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
      var initial = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

      _get(TextDesignFontMultiline.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignFontMultiline.prototype), 'setOption', this).call(this, optionName, value, update, initial);

      if (optionName === 'fontIdentifier' && !initial) {
        this.updateFontVariation();
      }
    }

    /**
     * Updates the font variation for the current font identifier.
     *
     */

  }, {
    key: 'updateFontVariation',
    value: function updateFontVariation() {
      var fontVariation = __WEBPACK_IMPORTED_MODULE_7__text_design_asset_manager__["a" /* AssetManager */].getVariation(this.getFontIdentifier());
      if (!fontVariation) {
        __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Log"].warn('TextDesignFont: Unable to find font \'' + this._fontIdentifier + '\'');
      }

      this.setFontVariation(fontVariation);
      return fontVariation;
    }

    /**
     * Applies the text options on the given context
     * @param  {Object} textOptions
     * @param  {CanvasRenderingContext2D} context
     * @private
     */
    // _applyTextOptions (textOptions, context) {
    // context.font = this._text.getFontStyle() + ' ' + this._text.getFontWeight() + ' ' +
    //   textOptions.fontSize + 'px ' + '"' +
    //   this._text.getFontFamily() + '"'

    //   context.textBaseline = 'top'
    //   context.textAlign = this._text.getAlignment()
    //   context.fillStyle = this._text.getColor().toRGBA()

    //   context.strokeStyle = this._text.getOutlineColor().toRGBA()
    //   const outlineWidth = this._text.getOutlineWidth()
    //   if (outlineWidth > 0) {
    //     context.lineWidth = outlineWidth
    //   }
    // }

  }, {
    key: '_applyTextOptions',
    value: function _applyTextOptions() {
      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      var ctx = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._context;

      var _options$options = _extends({}, this._options, options),
          fontSize = _options$options.fontSize,
          fontVariation = _options$options.fontVariation,
          lineHeight = _options$options.lineHeight,
          textColor = _options$options.textColor,
          alignment = _options$options.alignment;

      var _fontVariation$serial = fontVariation.serializeOptions(),
          fontStyle = _fontVariation$serial.fontStyle,
          fontWeight = _fontVariation$serial.fontWeight,
          fontFamily = _fontVariation$serial.fontFamily;

      ctx.font = fontStyle + ' ' + fontWeight + ' ' + fontSize + 'px ' + '"' + fontFamily + '"';

      ctx.fillStyle = textColor;
      ctx.textBaseline = 'top'; // textBaseline
      ctx.textAlign = alignment || 'left';
    }

    /**
     * Iterate over all lines and split them into multiple lines, depending
     * on the width they need
     * @param {Number} maxWidth
     * @return {Array.<string>}
     * @private
     */

  }, {
    key: '_buildOutputLines',
    value: function _buildOutputLines(maxWidth) {
      this._textSplitter.setText(this.getText());
      this._textSplitter.setMaxWidth(maxWidth);
      return this._textSplitter.getLines();
    }

    /**
     * Draws the given line onto context at the given Y position
     * @param  {String} text
     * @param  {Number} y
     * @private
     */

  }, {
    key: '_renderTextLine',
    value: function _renderTextLine(text, y) {
      var textAlignment = this.getAlignment();
      var drawPosition = new Vector2(0, y); // Left alignment

      switch (textAlignment) {
        case 'center':
          drawPosition.x = this._canvas.width / 2;
          break;
        case 'right':
          drawPosition.x = this._canvas.width;
          break;
      }

      this._context.fillText(text, drawPosition.x, drawPosition.y);
    }

    /**
     * Renders this sprite
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'update',
    value: function update() {
      var textOptions = this.calculateFontStyles();
      if (textOptions) {
        var _calculateText2 = this._calculateText(textOptions),
            dimensions = _calculateText2.dimensions,
            lines = _calculateText2.lines;

        this._dimensions = dimensions;
        this._renderText(dimensions, lines, textOptions);
      }
    }
  }, {
    key: 'draw',
    value: function draw(ctx) {
      var x = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      var y = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

      this.update();

      ctx.drawImage(this._canvas, x, y, this._dimensions.x, this._dimensions.y);
    }

    // /**
    //  * Renders the rotated text on the final texture
    //  * @private
    //  */
    // _updateFinalTexture () {
    //   const { width, height } = this._canvas
    //   const rotation = this.rotation
    //   const cos = Math.cos(rotation)
    //   const sin = Math.sin(rotation)

    //   const finalDimensions = new Vector2(
    //     Math.abs(width * cos) + Math.abs(height * sin),
    //     Math.abs(width * sin) + Math.abs(height * cos)
    //   )

    //   this._finalCanvas.width = finalDimensions.x
    //   this._finalCanvas.height = finalDimensions.y

    //   this._finalContext.save()
    //   this._finalContext.translate(this._finalCanvas.width / 2, this._finalCanvas.height / 2)
    //   this._finalContext.rotate(rotation)
    //   this._finalContext.drawImage(this._canvas, -width / 2, -height / 2)
    //   this._finalContext.restore()
    // }

    /**
     * Renders the text
     * @param  {PhotoEditorSDK} sdk
     * @param  {Vector2} dimensions
     * @param  {Array.<String>} lines
     * @param  {Object} textOptions
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @private
     */

  }, {
    key: '_renderText',
    value: function _renderText(dimensions, lines, textOptions) {
      // Resize the canvas

      this._canvas.width = dimensions.x;
      this._canvas.height = dimensions.y;

      // if (this._text.getMaxHeight()) {

      //   this._canvas.height = Math.min(
      //     this._text.getMaxHeight(),
      //     this._canvas.height
      //   )
      // }

      // Update the context
      this._context = this._canvas.getContext('2d');

      // Apply text options
      this._applyTextOptions(textOptions, this._context);

      // Draw lines
      for (var lineNum = 0; lineNum < lines.length; lineNum++) {
        var line = lines[lineNum];
        this._renderTextLine(line, textOptions.topPadding + textOptions.lineHeight * lineNum);
      }
    }
  }, {
    key: 'getFontFamily',
    value: function getFontFamily() {
      var variation = this.getFontVariation();
      return variation.getFontFamily();
    }

    /**
     * Calculates the actual font size and line height
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     */

  }, {
    key: 'calculateFontStyles',
    value: function calculateFontStyles() {
      var fontFamily = this.getFontFamily();
      var fontSize = this.getFontSize();
      var textHeight = this.getAbsoluteTextHeight();
      var lineHeight = textHeight * this.getLineHeight();
      var topPadding = textHeight * (this.getLineHeight() - 1.0) / 2.0;

      var textOptions = { fontFamily: fontFamily, fontSize: fontSize, textHeight: textHeight, lineHeight: lineHeight, topPadding: topPadding };
      this._textOptions = _extends({}, textOptions);
      // if (this._textOptions.fontFamily !== fontFamily ||
      //     this._textOptions.fontSize !== fontSize ||
      //     this._textOptions.lineHeight !== lineHeight) {
      //   this._textOptions = textOptions
      // }

      return textOptions;
    }
  }, {
    key: 'getTextMetrics',
    value: function getTextMetrics() {
      var variation = this.getFontVariation();
      return variation.getTextMetrics();
    }
  }, {
    key: 'getAbsoluteTextHeight',
    value: function getAbsoluteTextHeight() {
      var actualFontSize = this.getFontSize();
      var textMetrics = this.getTextMetrics();

      if (textMetrics) {
        // The text height for the current font size is calculated
        // using the given font metrics.
        var scale = 1 / textMetrics.unitsPerEm * actualFontSize;
        var ascent = textMetrics.ascender * scale;
        var descent = textMetrics.descender * scale;
        return ascent + Math.abs(descent);
      } else {
        return actualFontSize * this.getLineHeight() * 1.1;
      }
    }

    /**
     * Calculates the dimensions and new lines according to max width
     * @param  {PhotoEditorSDK} sdk
     * @param  {Object} textOptions
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {Object}
     * @private
     */

  }, {
    key: '_calculateText',
    value: function _calculateText(textOptions) {
      // Calculate max width
      // let maxWidth = this.getMaxWidth()

      // Apply text options
      this._applyTextOptions(textOptions, this._context);

      // Calculate bounding box
      var dimensions = new Vector2();
      var lines = this.getText().split('\n');
      {
        for (var lineNum = 0; lineNum < lines.length; lineNum++) {
          var line = lines[lineNum];
          dimensions.x = Math.max(dimensions.x, this._context.measureText(line).width);
        }
      }

      // Calculate boundingbox height
      var lineHeight = textOptions.lineHeight;

      dimensions.y = lines.length * lineHeight;

      return { dimensions: dimensions, lines: lines };
    }

    /**
     * Returns the dimensions for this text
     * @param  {PhotoEditorSDK} sdk
     * @param  {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {Vector2}
     */

  }, {
    key: 'getDimensions',
    value: function getDimensions() {
      var textOptions = this.calculateFontStyles();

      var _calculateText3 = this._calculateText(textOptions),
          dimensions = _calculateText3.dimensions;

      return dimensions;
    }
  }, {
    key: 'fitMaxHeight',
    value: function fitMaxHeight() {
      this.update();
      var dimensions = this.getDimensions();
      var lines = this.getText().split('\n');
      var scale = this.getMaxHeight() / dimensions.y;
    }
  }, {
    key: 'fitMaxWidth',
    value: function fitMaxWidth() {
      var width = this.getDimensions().x;
      var scale = this.getMaxWidth() / width;

      this.setFontSize(this.getFontSize() * scale);
      this._textOptions.fontSize = this.getFontSize();
    }
  }, {
    key: 'fitInFrame',
    value: function fitInFrame(frame) {
      this.setMaxWidth(frame.width);
      this.setMaxHeight(frame.height);

      this.fitMaxWidth();
      this.fitMaxHeight();
    }
  }, {
    key: 'getSize',
    value: function getSize() {
      var dimensions = this.getDimensions();
      return new __WEBPACK_IMPORTED_MODULE_9__models_size_value__["a" /* SizeValue */](dimensions.x, dimensions.y);
    }
  }]);

  return TextDesignFontMultiline;
}(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Configurable"]);

TextDesignFontMultiline.prototype.availableOptions = {
  text: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: '' },
  fontIdentifier: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: 'imgly_font_open_sans_bold' },
  fontVariation: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].OBJECT, default: null },
  lineHeight: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  fontSize: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 22 },
  textColor: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: 'black' },
  strokeStyle: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: 'black' },
  outlineWidth: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  textBaseline: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: 'alphabetic' },
  excludeAccents: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].BOOLEAN, default: true },
  maxWidth: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 100 },
  maxHeight: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  alignment: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].STRING, default: 'left', available: ['left', 'center', 'right'] }
};

/***/ }),
/* 436 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignMaskedBadge; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__models_masked_row_type__ = __webpack_require__(80);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_design_masked__ = __webpack_require__(53);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__models_randomizer__ = __webpack_require__(20);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var TextDesignMaskedBadge = function (_TextDesignMasked) {
  _inherits(TextDesignMaskedBadge, _TextDesignMasked);

  function TextDesignMaskedBadge() {
    var _ref;

    _classCallCheck(this, TextDesignMaskedBadge);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignMaskedBadge.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignMaskedBadge)).call.apply(_ref, [this].concat(args)));

    _this._possibleRowTypes = [__WEBPACK_IMPORTED_MODULE_7__models_masked_row_type__["a" /* RowType */].Badge1, __WEBPACK_IMPORTED_MODULE_7__models_masked_row_type__["a" /* RowType */].Badge2, __WEBPACK_IMPORTED_MODULE_7__models_masked_row_type__["a" /* RowType */].Badge3, __WEBPACK_IMPORTED_MODULE_7__models_masked_row_type__["a" /* RowType */].Badge4];

    _this._rowTypesRandomizer = new __WEBPACK_IMPORTED_MODULE_9__models_randomizer__["a" /* Randomizer */](0);
    _this._isMaskedRandomizer = new __WEBPACK_IMPORTED_MODULE_9__models_randomizer__["a" /* Randomizer */](0);

    _this._seedPool.push(_this._rowTypesRandomizer);
    _this._seedPool.push(_this._isMaskedRandomizer);
    return _this;
  }

  _createClass(TextDesignMaskedBadge, [{
    key: 'getImagePaths',
    value: function getImagePaths() {
      return this._possibleRowTypes.map(function (rowType) {
        return rowType.getImagePath();
      });
    }
  }, {
    key: '_randomLayoutRow',
    value: function _randomLayoutRow(words, index, width, attributes) {
      this._rowType = this._rowTypesRandomizer.pickNext(this._possibleRowTypes);

      attributes.setLineSpacing(0.9);

      var row = _get(TextDesignMaskedBadge.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignMaskedBadge.prototype), '_randomLayoutRow', this).call(this, words, index, width, attributes);

      row.set({ textScaleFactor: 0.9 });

      return row;
    }
  }]);

  return TextDesignMaskedBadge;
}(__WEBPACK_IMPORTED_MODULE_8__text_design_masked__["a" /* TextDesignMasked */]);

TextDesignMaskedBadge.defaultFontIdentifiers = ['imgly_font_campton_bold'];
TextDesignMaskedBadge.identifier = 'imgly_text_design_masked_badge';
TextDesignMaskedBadge.ValidAlignments = [__WEBPACK_IMPORTED_MODULE_8__text_design_masked__["a" /* TextDesignMasked */].Alignment.Center];
TextDesignMaskedBadge.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_8__text_design_masked__["a" /* TextDesignMasked */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignMaskedBadge.defaultFontIdentifiers }
});

/***/ }),
/* 437 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignMaskedSpeechBubbleComic; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__models_masked_row_type__ = __webpack_require__(80);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design_masked__ = __webpack_require__(53);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_design_masked_speech_bubble__ = __webpack_require__(128);






var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






// TODO: Config fonts

var TextDesignMaskedSpeechBubbleComic = function (_TextDesignMaskedSpee) {
  _inherits(TextDesignMaskedSpeechBubbleComic, _TextDesignMaskedSpee);

  function TextDesignMaskedSpeechBubbleComic() {
    var _ref;

    _classCallCheck(this, TextDesignMaskedSpeechBubbleComic);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignMaskedSpeechBubbleComic.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignMaskedSpeechBubbleComic)).call.apply(_ref, [this].concat(args)));

    _this._possibleRowTypes = [__WEBPACK_IMPORTED_MODULE_6__models_masked_row_type__["a" /* RowType */].SpeechBubble2, __WEBPACK_IMPORTED_MODULE_6__models_masked_row_type__["a" /* RowType */].SpeechBubble4, __WEBPACK_IMPORTED_MODULE_6__models_masked_row_type__["a" /* RowType */].SpeechBubble2, __WEBPACK_IMPORTED_MODULE_6__models_masked_row_type__["a" /* RowType */].SpeechBubble4, __WEBPACK_IMPORTED_MODULE_6__models_masked_row_type__["a" /* RowType */].SpeechBubble5];

    _this._possibleRowTypesForMin15 = _this._possibleRowTypes.slice(0, 2);
    _this._possibleRowTypesForMax14 = _this._possibleRowTypes.slice(2);
    return _this;
  }

  _createClass(TextDesignMaskedSpeechBubbleComic, [{
    key: '_rowTypes',
    value: function _rowTypes(words) {
      return words.countNumberOfCharacters() < 15 ? this._possibleRowTypesForMax14 : this._possibleRowTypesForMin15;
    }
  }]);

  return TextDesignMaskedSpeechBubbleComic;
}(__WEBPACK_IMPORTED_MODULE_8__text_design_masked_speech_bubble__["a" /* TextDesignMaskedSpeechBubble */]);

TextDesignMaskedSpeechBubbleComic.defaultFontIdentifiers = ['imgly_font_gagalin_regular'];
TextDesignMaskedSpeechBubbleComic.identifier = 'imgly_text_design_masked_speech_bubble_comic';
TextDesignMaskedSpeechBubbleComic.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_8__text_design_masked_speech_bubble__["a" /* TextDesignMaskedSpeechBubble */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignMaskedSpeechBubbleComic.defaultFontIdentifiers }
});

/***/ }),
/* 438 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignMultiline; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design_masked__ = __webpack_require__(53);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__models_rows_masked_text_design_row_multiline__ = __webpack_require__(127);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var TextDesignMultiline = function (_TextDesignMasked) {
  _inherits(TextDesignMultiline, _TextDesignMasked);

  function TextDesignMultiline() {
    _classCallCheck(this, TextDesignMultiline);

    return _possibleConstructorReturn(this, (TextDesignMultiline.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignMultiline)).apply(this, arguments));
  }

  _createClass(TextDesignMultiline, [{
    key: '_modifiedText',
    value: function _modifiedText(text) {
      return _get(TextDesignMultiline.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignMultiline.prototype), '_modifiedText', this).call(this, text).toUpperCase();
    }
  }, {
    key: '_randomLayoutRow',
    value: function _randomLayoutRow(words, index, width, attributes) {
      var alignment = this._alignmentRandomizer.pickNext(__WEBPACK_IMPORTED_MODULE_7__text_design_masked__["a" /* TextDesignMasked */].ValidAlignments);

      attributes.setAlignment(alignment);

      return new __WEBPACK_IMPORTED_MODULE_8__models_rows_masked_text_design_row_multiline__["a" /* TextDesignRowMultiline */]({
        words: words,
        width: width,
        attributes: attributes,
        image: null,
        backgroundColor: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Color"].WHITE,
        centerOffset: 0,
        sizeToFitContent: true,
        isMasked: false,
        autoAdjustTextColor: false
      });
    }
  }]);

  return TextDesignMultiline;
}(__WEBPACK_IMPORTED_MODULE_7__text_design_masked__["a" /* TextDesignMasked */]);

TextDesignMultiline.defaultFontIdentifiers = ['imgly_font_abril_fatface_regular'];
TextDesignMultiline.identifier = 'imgly_text_design_multiline';
TextDesignMultiline.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_7__text_design_masked__["a" /* TextDesignMasked */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignMultiline.defaultFontIdentifiers }
});

/***/ }),
/* 439 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignWatercolor; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__models_masked_row_type__ = __webpack_require__(80);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_masked__ = __webpack_require__(53);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design_masked_speech_bubble__ = __webpack_require__(128);





var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






// TODO: Config fonts

var TextDesignWatercolor = function (_TextDesignMaskedSpee) {
  _inherits(TextDesignWatercolor, _TextDesignMaskedSpee);

  // NOTE: Order and position is important for serialization
  function TextDesignWatercolor() {
    var _ref;

    _classCallCheck(this, TextDesignWatercolor);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignWatercolor.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignWatercolor)).call.apply(_ref, [this].concat(args)));

    _this._possibleRowTypes = [__WEBPACK_IMPORTED_MODULE_5__models_masked_row_type__["a" /* RowType */].Watercolor1, __WEBPACK_IMPORTED_MODULE_5__models_masked_row_type__["a" /* RowType */].Watercolor2, __WEBPACK_IMPORTED_MODULE_5__models_masked_row_type__["a" /* RowType */].Watercolor3];
    return _this;
  }

  return TextDesignWatercolor;
}(__WEBPACK_IMPORTED_MODULE_7__text_design_masked_speech_bubble__["a" /* TextDesignMaskedSpeechBubble */]);

TextDesignWatercolor.defaultFontIdentifiers = ['imgly_font_permanent_marker', 'imgly_font_wolesbro', 'imgly_font_wolesbro'];
TextDesignWatercolor.identifier = 'imgly_text_design_watercolor';
TextDesignWatercolor.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_7__text_design_masked_speech_bubble__["a" /* TextDesignMaskedSpeechBubble */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignWatercolor.defaultFontIdentifiers },
  alignment: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].STRING, default: __WEBPACK_IMPORTED_MODULE_6__text_design_masked__["a" /* TextDesignMasked */].Alignment.Center, available: __WEBPACK_IMPORTED_MODULE_6__text_design_masked__["a" /* TextDesignMasked */].ValidAlignments }
});

/***/ }),
/* 440 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignSunshineV310; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_sunshine__ = __webpack_require__(129);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design_asset_manager__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__models_rectangle_insets__ = __webpack_require__(21);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__models_rows_image_text_design_row_single_image__ = __webpack_require__(126);







var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





var TextDesignSunshineV310 = function (_TextDesignSunshine) {
  _inherits(TextDesignSunshineV310, _TextDesignSunshine);

  function TextDesignSunshineV310() {
    var _ref;

    _classCallCheck(this, TextDesignSunshineV310);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignSunshineV310.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSunshineV310)).call.apply(_ref, [this].concat(args)));

    _this._relativeInsets = new __WEBPACK_IMPORTED_MODULE_8__models_rectangle_insets__["a" /* RectangleInsets */](0, 0.3, 0, 0.3);
    return _this;
  }

  _createClass(TextDesignSunshineV310, [{
    key: '_layoutRows',
    value: function _layoutRows(lines, width) {
      var elements = _get(TextDesignSunshineV310.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignSunshineV310.prototype), '_layoutRows', this).call(this, lines, width);

      if (!this.getDecorationsVisible()) {
        return elements;
      }

      var formHeight = 25;
      var firstRow = new __WEBPACK_IMPORTED_MODULE_9__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */]({
        width: width,
        height: formHeight,
        image: __WEBPACK_IMPORTED_MODULE_7__text_design_asset_manager__["a" /* AssetManager */].getImage(this._rowTypeRandomizer.pickNext(__WEBPACK_IMPORTED_MODULE_6__text_design_sunshine__["a" /* TextDesignSunshine */].RowImages))
      }).layout();

      var lastRow = new __WEBPACK_IMPORTED_MODULE_9__models_rows_image_text_design_row_single_image__["a" /* TextDesignRowSingleImage */]({
        width: width,
        height: formHeight,
        image: __WEBPACK_IMPORTED_MODULE_7__text_design_asset_manager__["a" /* AssetManager */].getImage(this._rowTypeRandomizer.pickNext(__WEBPACK_IMPORTED_MODULE_6__text_design_sunshine__["a" /* TextDesignSunshine */].RowImages))
      }).layout();

      return [firstRow].concat(_toConsumableArray(elements), [lastRow]);
    }
  }]);

  return TextDesignSunshineV310;
}(__WEBPACK_IMPORTED_MODULE_6__text_design_sunshine__["a" /* TextDesignSunshine */]);
TextDesignSunshineV310.identifier = 'imgly_text_design_sunshine-v3_1_0';

/***/ }),
/* 441 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignParticles; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__text_design_asset_manager__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__models_rectangle_insets__ = __webpack_require__(21);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__text_design_sunshine__ = __webpack_require__(129);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__models_background_text_design_particles_background_brush__ = __webpack_require__(442);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__models_background_text_design_particles_background_circle__ = __webpack_require__(444);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__models_background_text_design_particles_background_triangle__ = __webpack_require__(445);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__models_randomizer__ = __webpack_require__(20);







var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */









var TextDesignParticles = function (_TextDesignSunshine) {
  _inherits(TextDesignParticles, _TextDesignSunshine);

  // NOTE: Order and position is important for serialization
  function TextDesignParticles() {
    var _ref;

    _classCallCheck(this, TextDesignParticles);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignParticles.__proto__ || __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignParticles)).call.apply(_ref, [this].concat(args)));

    _this._relativeInsets = new __WEBPACK_IMPORTED_MODULE_8__models_rectangle_insets__["a" /* RectangleInsets */](0.3, 0.3, 0.3, 0.3);

    _this._backgroundRandomizer = new __WEBPACK_IMPORTED_MODULE_13__models_randomizer__["a" /* Randomizer */](0);
    _this._decoTypeRandomizer = new __WEBPACK_IMPORTED_MODULE_13__models_randomizer__["a" /* Randomizer */](0);

    _this._seedPool.push(_this._backgroundRandomizer);
    _this._seedPool.push(_this._decoTypeRandomizer);
    return _this;
  }

  _createClass(TextDesignParticles, [{
    key: 'getImagePaths',
    value: function getImagePaths() {
      return [].concat(_toConsumableArray(__WEBPACK_IMPORTED_MODULE_9__text_design_sunshine__["a" /* TextDesignSunshine */].RowImages), _toConsumableArray(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Utils"].Array.flatten(TextDesignParticles.Backgrounds.map(function (b) {
        return b.getImagePaths();
      }))), _toConsumableArray(TextDesignParticles.DecoratorImages));
    }
  }, {
    key: '_getBackground',
    value: function _getBackground() {
      return this._backgroundRandomizer.pickNext(TextDesignParticles.Backgrounds);
    }
  }, {
    key: '_randomDecoratorImages',
    value: function _randomDecoratorImages() {
      switch (this._decoTypeRandomizer.nextInRange(0, 2)) {
        case 0:
          return TextDesignParticles.DecoratorImages.slice(0, 2).map(function (path) {
            return __WEBPACK_IMPORTED_MODULE_7__text_design_asset_manager__["a" /* AssetManager */].getImage(path);
          });

        case 1:
        case 2:
          return TextDesignParticles.DecoratorImages.slice(2).map(function (path) {
            return __WEBPACK_IMPORTED_MODULE_7__text_design_asset_manager__["a" /* AssetManager */].getImage(path);
          });

        default:
          __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["Log"].warn('TextDesignParticles#_randomDecoratorImages: Number generated not in valid range.');
          return TextDesignParticles.DecoratorImages.slice(2).map(function (path) {
            return __WEBPACK_IMPORTED_MODULE_7__text_design_asset_manager__["a" /* AssetManager */].getImage(path);
          });
      }
    }
  }]);

  return TextDesignParticles;
}(__WEBPACK_IMPORTED_MODULE_9__text_design_sunshine__["a" /* TextDesignSunshine */]);

TextDesignParticles.defaultFontIdentifiers = ['imgly_font_permanent_marker', 'imgly_font_wolesbro', 'imgly_font_wolesbro', 'imgly_font_montserrat_light'];
TextDesignParticles.identifier = 'imgly_text_design_particles';
TextDesignParticles.Backgrounds = [new __WEBPACK_IMPORTED_MODULE_10__models_background_text_design_particles_background_brush__["a" /* TextDesignParticlesBackgroundBrush */](), new __WEBPACK_IMPORTED_MODULE_11__models_background_text_design_particles_background_circle__["a" /* TextDesignParticlesBackgroundCircle */](), new __WEBPACK_IMPORTED_MODULE_12__models_background_text_design_particles_background_triangle__["a" /* TextDesignParticlesBackgroundTriangle */]()];
TextDesignParticles.DecoratorImages = ['text-design/images/imgly_text_design_particle_holder_01.png', 'text-design/images/imgly_text_design_particle_holder_02.png', 'text-design/images/imgly_text_design_particle_holder_03.png', 'text-design/images/imgly_text_design_particle_holder_04.png'];
TextDesignParticles.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_9__text_design_sunshine__["a" /* TextDesignSunshine */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignParticles.defaultFontIdentifiers },
  decorationsVisible: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  decorativeRowsInTheMiddleOnly: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].BOOLEAN, default: true }
});

/***/ }),
/* 442 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignParticlesBackgroundBrush; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_particles_background__ = __webpack_require__(130);






var _extends = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var TextDesignParticlesBackgroundBrush = function (_TextDesignParticlesB) {
  _inherits(TextDesignParticlesBackgroundBrush, _TextDesignParticlesB);

  function TextDesignParticlesBackgroundBrush() {
    _classCallCheck(this, TextDesignParticlesBackgroundBrush);

    return _possibleConstructorReturn(this, (TextDesignParticlesBackgroundBrush.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignParticlesBackgroundBrush)).apply(this, arguments));
  }

  return TextDesignParticlesBackgroundBrush;
}(__WEBPACK_IMPORTED_MODULE_6__text_design_particles_background__["a" /* TextDesignParticlesBackground */]);

TextDesignParticlesBackgroundBrush.Images = ['text-design/images/imgly_text_design_particle_brush_01.png', 'text-design/images/imgly_text_design_particle_brush_02.png', 'text-design/images/imgly_text_design_particle_brush_03.png', 'text-design/images/imgly_text_design_particle_brush_04.png', 'text-design/images/imgly_text_design_particle_brush_05.png', 'text-design/images/imgly_text_design_particle_brush_06.png', 'text-design/images/imgly_text_design_particle_brush_07.png', 'text-design/images/imgly_text_design_particle_brush_08.png', 'text-design/images/imgly_text_design_particle_brush_09.png', 'text-design/images/imgly_text_design_particle_brush_10.png'];
TextDesignParticlesBackgroundBrush.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_6__text_design_particles_background__["a" /* TextDesignParticlesBackground */].prototype.availableOptions, {
  imagePaths: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: [].concat(_toConsumableArray(TextDesignParticlesBackgroundBrush.Images)) },
  relativeParticleSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.12 }
});

/***/ }),
/* 443 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignParticle; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Rectangle = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Rectangle;


var TextDesignParticle = function (_Configurable) {
  _inherits(TextDesignParticle, _Configurable);

  function TextDesignParticle() {
    _classCallCheck(this, TextDesignParticle);

    return _possibleConstructorReturn(this, (TextDesignParticle.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignParticle)).apply(this, arguments));
  }

  _createClass(TextDesignParticle, [{
    key: 'getContentFrame',
    value: function getContentFrame() {
      var frame = this.getFrame().clone();
      var inset = frame.width * 0.1;

      return frame.insetBy(inset, inset);
    }
  }, {
    key: 'intersects',
    value: function intersects(particle) {
      return this.getFrame().intersects(particle.getFrame());
    }
  }]);

  return TextDesignParticle;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Configurable"]);

TextDesignParticle.prototype.availableOptions = {
  frame: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].OBJECT, default: new Rectangle() }
};

/***/ }),
/* 444 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignParticlesBackgroundCircle; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_particles_background__ = __webpack_require__(130);






var _extends = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var TextDesignParticlesBackgroundCircle = function (_TextDesignParticlesB) {
  _inherits(TextDesignParticlesBackgroundCircle, _TextDesignParticlesB);

  function TextDesignParticlesBackgroundCircle() {
    _classCallCheck(this, TextDesignParticlesBackgroundCircle);

    return _possibleConstructorReturn(this, (TextDesignParticlesBackgroundCircle.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignParticlesBackgroundCircle)).apply(this, arguments));
  }

  return TextDesignParticlesBackgroundCircle;
}(__WEBPACK_IMPORTED_MODULE_6__text_design_particles_background__["a" /* TextDesignParticlesBackground */]);

TextDesignParticlesBackgroundCircle.Images = ['text-design/images/imgly_text_design_particle_circle_01.png', 'text-design/images/imgly_text_design_particle_circle_02.png', 'text-design/images/imgly_text_design_particle_circle_03.png', 'text-design/images/imgly_text_design_particle_circle_04.png', 'text-design/images/imgly_text_design_particle_circle_05.png', 'text-design/images/imgly_text_design_particle_circle_06.png', 'text-design/images/imgly_text_design_particle_circle_07.png', 'text-design/images/imgly_text_design_particle_circle_08.png', 'text-design/images/imgly_text_design_particle_circle_09.png', 'text-design/images/imgly_text_design_particle_circle_10.png'];
TextDesignParticlesBackgroundCircle.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_6__text_design_particles_background__["a" /* TextDesignParticlesBackground */].prototype.availableOptions, {
  imagePaths: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: [].concat(_toConsumableArray(TextDesignParticlesBackgroundCircle.Images)) },
  relativeParticleSize: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.12 }
});

/***/ }),
/* 445 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignParticlesBackgroundTriangle; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__text_design_particles_background__ = __webpack_require__(130);






var _extends = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var TextDesignParticlesBackgroundTriangle = function (_TextDesignParticlesB) {
  _inherits(TextDesignParticlesBackgroundTriangle, _TextDesignParticlesB);

  function TextDesignParticlesBackgroundTriangle() {
    _classCallCheck(this, TextDesignParticlesBackgroundTriangle);

    return _possibleConstructorReturn(this, (TextDesignParticlesBackgroundTriangle.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignParticlesBackgroundTriangle)).apply(this, arguments));
  }

  return TextDesignParticlesBackgroundTriangle;
}(__WEBPACK_IMPORTED_MODULE_6__text_design_particles_background__["a" /* TextDesignParticlesBackground */]);

TextDesignParticlesBackgroundTriangle.Images = ['text-design/images/imgly_text_design_particle_triangle_01.png', 'text-design/images/imgly_text_design_particle_triangle_02.png', 'text-design/images/imgly_text_design_particle_triangle_03.png', 'text-design/images/imgly_text_design_particle_triangle_04.png', 'text-design/images/imgly_text_design_particle_triangle_05.png', 'text-design/images/imgly_text_design_particle_triangle_06.png', 'text-design/images/imgly_text_design_particle_triangle_07.png', 'text-design/images/imgly_text_design_particle_triangle_08.png', 'text-design/images/imgly_text_design_particle_triangle_09.png', 'text-design/images/imgly_text_design_particle_triangle_10.png'];
TextDesignParticlesBackgroundTriangle.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_6__text_design_particles_background__["a" /* TextDesignParticlesBackground */].prototype.availableOptions, {
  imagePaths: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].ARRAY, default: [].concat(_toConsumableArray(TextDesignParticlesBackgroundTriangle.Images)) }
});

/***/ }),
/* 446 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignRotated; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__text_design__ = __webpack_require__(76);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__models_rectangle_insets__ = __webpack_require__(21);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__models_rows_shearing_text_design_row_form__ = __webpack_require__(180);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__models_randomizer__ = __webpack_require__(20);








var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_5_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var TextDesignRotated = function (_TextDesign) {
  _inherits(TextDesignRotated, _TextDesign);

  function TextDesignRotated() {
    var _ref;

    _classCallCheck(this, TextDesignRotated);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = TextDesignRotated.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRotated)).call.apply(_ref, [this].concat(args)));

    _this._relativeInsets = new __WEBPACK_IMPORTED_MODULE_9__models_rectangle_insets__["a" /* RectangleInsets */](0.1, 0, 0, 0);

    _this._rowTypeRandomizer = new __WEBPACK_IMPORTED_MODULE_11__models_randomizer__["a" /* Randomizer */](0);

    _this._seedPool.push(_this._rowTypeRandomizer);
    return _this;
  }

  _createClass(TextDesignRotated, [{
    key: '_modifiedText',
    value: function _modifiedText(text) {
      return _get(TextDesignRotated.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRotated.prototype), '_modifiedText', this).call(this, text).toUpperCase();
    }
  }, {
    key: '_randomLayoutRow',
    value: function _randomLayoutRow(words, index, width, attributes) {
      var row = _get(TextDesignRotated.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRotated.prototype), '_randomLayoutRow', this).call(this, words, index, width, attributes);
      row.setShearingAngle(this.getShearingAngle());
      return row;
    }
  }, {
    key: '_layoutRows',
    value: function _layoutRows(lines, width) {
      var elements = _get(TextDesignRotated.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(TextDesignRotated.prototype), '_layoutRows', this).call(this, lines, width);
      var types = __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Utils"].values(__WEBPACK_IMPORTED_MODULE_10__models_rows_shearing_text_design_row_form__["a" /* TextDesignRowForm */].FormType);

      var formHeight = 30;

      var firstRow = new __WEBPACK_IMPORTED_MODULE_10__models_rows_shearing_text_design_row_form__["a" /* TextDesignRowForm */]({
        width: width,
        height: formHeight,
        type: this._rowTypeRandomizer.pickNext(types),
        shearingAngle: this.getShearingAngle()
      }).layout();

      var lastRow = new __WEBPACK_IMPORTED_MODULE_10__models_rows_shearing_text_design_row_form__["a" /* TextDesignRowForm */]({
        width: width,
        height: formHeight,
        type: this._rowTypeRandomizer.pickNext(types),
        shearingAngle: this.getShearingAngle()
      }).layout();

      return [firstRow].concat(_toConsumableArray(elements), [lastRow]);
    }
  }]);

  return TextDesignRotated;
}(__WEBPACK_IMPORTED_MODULE_8__text_design__["a" /* TextDesign */]);

TextDesignRotated.defaultFontIdentifiers = ['imgly_font_campton_bold'];
TextDesignRotated.identifier = 'imgly_text_design_rotated';
TextDesignRotated.prototype.availableOptions = _extends({}, __WEBPACK_IMPORTED_MODULE_8__text_design__["a" /* TextDesign */].prototype.availableOptions, {
  fontIdentifiers: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].ARRAY, default: TextDesignRotated.defaultFontIdentifiers },
  relativeLineSpacing: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.025 / 3 },
  shearingAngle: { type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER, default: -0.1 }
});

/***/ }),
/* 447 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TextDesignRenderer; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__models_size_value__ = __webpack_require__(33);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__models_rows_masked_text_design_row_masked__ = __webpack_require__(124);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_canvas__ = __webpack_require__(48);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__models_randomizer__ = __webpack_require__(20);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__models_rows_masked_text_design_row_multiline__ = __webpack_require__(127);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */








var Rectangle = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].Rectangle;


var REFERENCE_WIDTH = 1000;

var TextDesignRenderer = function () {
  function TextDesignRenderer() {
    _classCallCheck(this, TextDesignRenderer);

    this._layoutData = null;
    this._layout = null;
    this._text = '';
    this._seed = 0;
    this._debugMode = false;
    this.randomizer = new __WEBPACK_IMPORTED_MODULE_5__models_randomizer__["a" /* Randomizer */]();
  }

  _createClass(TextDesignRenderer, [{
    key: 'createLayout',
    value: function createLayout(layout, text, seed) {
      this._layout = layout;
      this._text = text;

      this._seed = seed;
      layout.seed(seed);

      this._layoutData = layout.generateLayoutData(text, REFERENCE_WIDTH);
    }
  }, {
    key: 'calculateAspect',
    value: function calculateAspect() {
      if (!this._layoutData) {
        __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Log"].warn('TextDesignRenderer#calculateAspect: No layout data');
        return 1;
      }

      return this._layoutData.getSize().aspect();
    }
  }, {
    key: 'draw',
    value: function draw(context, destinationSize, color, isInverted) {
      var _this = this;

      // The layout is calculated width `renderSize` width
      var renderSize = new __WEBPACK_IMPORTED_MODULE_2__models_size_value__["a" /* SizeValue */](REFERENCE_WIDTH, REFERENCE_WIDTH / destinationSize.aspect());

      // Used to scale from renderSize to destinationSize
      var scale = destinationSize.width / REFERENCE_WIDTH;

      // Get insets and line spacing in renderSize scale
      var insets = this._layoutData.getRelativeInsets().clone().scale(renderSize.width);
      var lineSpacing = this._layoutData.getRelativeLineSpacing() * renderSize.width;

      // Start from the top inset limit
      var yOrigin = insets.top;

      context.save();

      this.randomizer.seed(this._seed);

      var background = this._layoutData.getBackground();
      if (background) {
        background.render(context, destinationSize, this._layoutData.getRelativeInsets(), isInverted ? __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Color"].WHITE : color, this.randomizer);
      }

      // Scale to destinationSize
      context.scale(scale, scale);

      // Go trough each layout row
      this._layoutData.getRows().forEach(function (row) {
        context.save();

        var attributes = row.getAttributes();

        // Apply row transform (skew + positioning)
        context.transform(1, row.getShearingAngle(), 0, 1, insets.left, yOrigin);

        attributes.setTextColor(isInverted ? __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Color"].WHITE : color.clone());
        attributes.setTintColor(isInverted ? __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Color"].WHITE : color.clone());

        if (row instanceof __WEBPACK_IMPORTED_MODULE_3__models_rows_masked_text_design_row_masked__["a" /* TextDesignRowMasked */] || row instanceof __WEBPACK_IMPORTED_MODULE_6__models_rows_masked_text_design_row_multiline__["a" /* TextDesignRowMultiline */]) {
          row.setBackgroundColor(isInverted ? __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Color"].WHITE : color.clone());
          row.setIsUsedInInvertedLayout(isInverted);
        }

        if (_this._debugMode) {
          row._debugMode = true;
        }

        // Render the row
        row.willRender(context);
        row.render(context);
        row.didRender(context);

        if (_this._debugMode) {
          var frame = row._getFrame();
          var textFrame = row._getTextFrame();

          Object(__WEBPACK_IMPORTED_MODULE_4__utils_canvas__["f" /* strokeRect */])(context, frame, __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Color"].GREEN);
          Object(__WEBPACK_IMPORTED_MODULE_4__utils_canvas__["f" /* strokeRect */])(context, textFrame, __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Color"].BLUE);

          row._getLayoutElements().forEach(function (element) {
            var frame = element.getFrame();
            var textFrame = row._getTextFrameForElement(element);

            Object(__WEBPACK_IMPORTED_MODULE_4__utils_canvas__["f" /* strokeRect */])(context, frame, new __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Color"](1, 1, 0));
            Object(__WEBPACK_IMPORTED_MODULE_4__utils_canvas__["f" /* strokeRect */])(context, textFrame, new __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Color"](0, 1, 1));
          });
        }

        // Set yOrigin for the next row
        yOrigin += row.getSize().height + lineSpacing;

        context.restore();
      });

      if (this._debugMode) {
        Object(__WEBPACK_IMPORTED_MODULE_4__utils_canvas__["f" /* strokeRect */])(context, new Rectangle(0, 0, renderSize.width, renderSize.height), __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Color"].RED);
      }

      context.restore();

      // if (isInverted) {
      //   fillRect(context, destinationSize.rectangle(), color, 'source-out')
      // }
    }
  }]);

  return TextDesignRenderer;
}();

/***/ }),
/* 448 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__transform_change__ = __webpack_require__(449);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can transform out a part of the image
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var TransformOperation = function (_Operation) {
  _inherits(TransformOperation, _Operation);

  function TransformOperation() {
    _classCallCheck(this, TransformOperation);

    return _possibleConstructorReturn(this, (TransformOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(TransformOperation)).apply(this, arguments));
  }

  _createClass(TransformOperation, [{
    key: '_render',

    // -------------------------------------------------------------------------- RENDERING

    /**
     * Transforms the image
     * @param {PhotoEditorSDK.Engine.RenderTexture} inputTexture
     * @returns {Promise}
     * @override
     * @private
     */
    value: function _render(inputTexture) {
      this._sprite.setRotation(0);

      var inputDimensions = inputTexture.getDimensions();
      var _options = this._options,
          start = _options.start,
          end = _options.end,
          rotation = _options.rotation,
          textureScale = _options.textureScale;


      var size = end.clone().subtract(start);
      var offset = size.clone().divide(2);
      var middle = start.clone().add(offset);
      var scale = this.calculateScale();
      var finalScale = scale * textureScale;

      var outputMiddle = inputDimensions.clone().multiply(finalScale).multiply(offset);

      this._sprite.setAnchor(middle);
      this._sprite.setRotation(rotation);

      this._sprite.setScale(finalScale, finalScale);
      this._sprite.setPosition(outputMiddle);

      // Render the container to this Operation's RenderTexture
      this._renderTexture.render(this._container);
      return __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Calculates the scale adjustment required to be applied
     * to the current inputDimensions to fill the texture after
     * a given rotation has been applied to the current dimensions
     * @param {Number} [rotation = this._options.rotation] - The rotation in radians
     */

  }, {
    key: 'calculateScale',
    value: function calculateScale() {
      var rotation = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._options.rotation;

      var inputDimensions = this.getInputDimensions(false);

      var rotatedDimensions = new Vector2(Math.abs(inputDimensions.x * Math.cos(rotation)) + Math.abs(inputDimensions.y * Math.sin(rotation)), Math.abs(inputDimensions.x * Math.sin(rotation)) + Math.abs(inputDimensions.y * Math.cos(rotation)));

      var distanceToCorner = inputDimensions.clone().subtract(rotatedDimensions.clone()).divide(2).abs();

      var scale = 1;
      if (distanceToCorner.y > distanceToCorner.x) {
        scale = distanceToCorner.y * 2 / inputDimensions.y + 1;
      } else {
        scale = distanceToCorner.x * 2 / inputDimensions.x + 1;
      }
      return scale;
    }

    /**
     * Returns the dimensions the given dimensions will have after this operation
     * has been applied
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     * @override
     */

  }, {
    key: 'getNewDimensions',
    value: function getNewDimensions(inputDimensions) {
      var _options2 = this._options,
          start = _options2.start,
          end = _options2.end,
          textureScale = _options2.textureScale;

      var scale = this.calculateScale();
      var newDimensions = inputDimensions.clone().multiply(textureScale * scale).multiply(end.clone().subtract(start));

      return newDimensions.round();
    }

    /**
     * Flips this operation into the given direction
     * @param  {String} direction
     */

  }, {
    key: 'flip',
    value: function flip(direction) {
      var _options3 = this._options,
          start = _options3.start,
          end = _options3.end;

      var tmpStart = start.clone();

      if (direction === 'horizontal') {
        start.set(1.0 - end.x, start.y);
        end.set(1.0 - tmpStart.x, end.y);
      } else if (direction === 'vertical') {
        start.set(start.x, 1.0 - end.y);
        end.set(end.x, 1.0 - tmpStart.y);
      }
    }

    /**
     * Rotates this operation with the given degrees
     * @param {Number} degrees
     */

  }, {
    key: 'rotate',
    value: function rotate(degrees) {
      var _options4 = this._options,
          start = _options4.start,
          end = _options4.end;

      var degreesDifference = (degrees + 360) % 360;

      var steps = Math.floor(degreesDifference / 90);
      for (var i = 0; i < steps; i++) {
        var tempStart = start.clone();
        start.set(1.0 - end.y, tempStart.x);
        end.set(1.0 - tempStart.y, end.x);
      }
    }

    /**
     * Is called before the SDK begins exporting
     * @protected
     */

  }, {
    key: '_onBeforeExport',
    value: function _onBeforeExport() {
      this._wasEnabledBeforeExport = this.getEnabled();
      this.setEnabled(true);
    }

    /**
     * Is called after the SDK finishes exporting
     * @protected
     */

  }, {
    key: '_onAfterExport',
    value: function _onAfterExport() {
      this.setEnabled(this._wasEnabledBeforeExport, true);
    }
  }]);

  return TransformOperation;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


TransformOperation.identifier = 'transform';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
TransformOperation.prototype.availableOptions = {
  start: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0) },
  end: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 1) },
  textureScale: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 1 },
  rotation: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 }
};

TransformOperation.TransformChange = __WEBPACK_IMPORTED_MODULE_5__transform_change__["a" /* default */];
__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default.a.Operations.TransformOperation = TransformOperation;

/* harmony default export */ __webpack_exports__["a"] = (TransformOperation);

/***/ }),
/* 449 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].Vector2;

/**
 * A TransformChange represents the change between two sets of TransformOperation options.
 * @class
 * @memberof PhotoEditorSDK.Operations.TransformOperation
 */

var TransformChange = function () {
  /**
   * Creates a new TransformChange instance with the difference
   * between the operation's current state and the specified new options
   * @param {PhotoEditorSDK.Operations.TransformOperation} operation - The transform operation with the state before the changes are applied
   * @param {Object} options - The new transform options (start, end, textureScale, rotation)
   */
  function TransformChange(operation, options) {
    _classCallCheck(this, TransformChange);

    this._options = options;
    this._oldOptions = {
      start: operation.getStart().clone(),
      end: operation.getEnd().clone(),
      rotation: operation.getRotation(),
      textureScale: operation.getTextureScale()
    };

    this._inputDimensions = operation.getInputDimensions(false);
    this._rotationDelta = options.rotation - operation.getRotation();
    this._deltaCos = Math.cos(this._rotationDelta);
    this._deltaSin = Math.sin(this._rotationDelta);

    this._oldAbsoluteSize = this._oldOptions.end.clone().subtract(this._oldOptions.start).multiply(this._inputDimensions);
    this._newAbsoluteSize = options.end.clone().subtract(options.start).multiply(this._inputDimensions);
    this._absoluteStartDiff = this._oldOptions.start.clone().subtract(options.start).multiply(this._inputDimensions);
    this._scaleRatio = operation.calculateScale(options.rotation) / operation.calculateScale();
    this._sizeFactor = this._newAbsoluteSize.clone().divide(this._oldAbsoluteSize);
    this._textureScaleFactor = this._options.textureScale / operation.getTextureScale();
  }

  /**
   * Applies this transform change to the given relative point
   * @param  {PhotoEditorSDK.Math.Vector2} point
   * @return {PhotoEditorSDK.Math.Vector2}
   */


  _createClass(TransformChange, [{
    key: 'applyToRelativePoint',
    value: function applyToRelativePoint(point) {
      var oldStart = this._oldOptions.start;
      var oldEnd = this._oldOptions.end;

      var cropCenter = oldStart.clone().add(oldEnd.clone().subtract(oldStart).divide(2));

      // Find point's pixel position relative to image center:
      //  - a: Find point's pixel position relative to crop center
      var pixelCropCenter = cropCenter.multiply(this._inputDimensions);

      var pointPixelDistanceToCropCenter = point.clone().multiply(this._oldAbsoluteSize).subtract(this._oldAbsoluteSize.clone().divide(2));

      //  - b: Find crop center's pixel position relative to image center
      //    (Point's pixel position relative to image center = a + b)
      var pointPixelPositionOnImage = pixelCropCenter.clone().add(pointPixelDistanceToCropCenter);
      var pointPixelDistanceToImageCenter = pointPixelPositionOnImage.clone().subtract(this._inputDimensions.clone().divide(2));

      // Rotate (_rotationDelta) and scale (_scaleRatio) distance to image center
      var rotatedPointPixelDistanceToImageCenter = new Vector2(pointPixelDistanceToImageCenter.x * this._deltaCos - pointPixelDistanceToImageCenter.y * this._deltaSin, pointPixelDistanceToImageCenter.x * this._deltaSin + pointPixelDistanceToImageCenter.y * this._deltaCos);

      var rotatedPointPixelPositionOnImage = this._inputDimensions.clone().divide(2).add(rotatedPointPixelDistanceToImageCenter);

      // Apply new crop
      var newAbsoluteStart = this._options.start.clone().multiply(this._inputDimensions);
      return rotatedPointPixelPositionOnImage.clone().subtract(newAbsoluteStart).divide(this._newAbsoluteSize);
    }

    /**
     * Applies this transform change to the given relative size
     * @param  {Number} number
     * @return {Number}
     */

  }, {
    key: 'applyToRelativeSize',
    value: function applyToRelativeSize(size) {
      return size * this._oldAbsoluteSize.min() / this._newAbsoluteSize.min();
    }

    /**
     * Applies this transform change to the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'applyToDimensions',
    value: function applyToDimensions(dimensions) {
      dimensions = dimensions.clone().multiply(this._scaleRatio);
      if (this._options.textureScale) {
        dimensions.multiply(this._textureScaleFactor);
      }
      return dimensions;
    }

    /**
     * Returns the new relative size value for the given relative size value
     * @param  {Number} size
     * @param  {String} side
     * @return {Number}
     */

  }, {
    key: 'scaleSize',
    value: function scaleSize(size) {
      var side = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'y';

      return size / this._sizeFactor[side];
    }

    /**
     * Applies the transform rotation to the given rotation
     * @param  {Number} rotation
     * @return {Number}
     */

  }, {
    key: 'applyToRotation',
    value: function applyToRotation(rotation) {
      return (rotation + this._rotationDelta) % (Math.PI * 2);
    }

    /**
     * Inverts the TransformChange
     */

  }, {
    key: 'invert',
    value: function invert() {
      var newStart = this._options.start.clone();
      var newEnd = this._options.end.clone();

      var newInputDimensions = this._inputDimensions;
      var invRotationDelta = -this._rotationDelta;
      var invDeltaCos = Math.cos(invRotationDelta);
      var invDeltaSin = Math.sin(invRotationDelta);

      var newAbsoluteSize = this._oldAbsoluteSize;
      var oldAbsoluteSize = this._newAbsoluteSize;
      var invAbsoluteStartDiff = newStart.clone().subtract(newEnd).multiply(newInputDimensions);
      var invScaleRatio = 1 / this._scaleRatio;
      var invSizeFactor = new Vector2(1 / this._sizeFactor.x, 1 / this._sizeFactor.y);
      var invTextureScaleFactor = 1 / this._textureScaleFactor;

      var newOptions = this._oldOptions;
      this._oldOptions = this._options;
      this._options = newOptions;

      this._inputDimensions = newInputDimensions;
      this._rotationDelta = invRotationDelta;
      this._deltaCos = invDeltaCos;
      this._deltaSin = invDeltaSin;

      this._oldAbsoluteSize = oldAbsoluteSize;
      this._newAbsoluteSize = newAbsoluteSize;
      this._absoluteStartDiff = invAbsoluteStartDiff;
      this._scaleRatio = invScaleRatio;
      this._sizeFactor = invSizeFactor;
      this._textureScaleFactor = invTextureScaleFactor;

      return this;
    }
  }]);

  return TransformChange;
}();

/* harmony default export */ __webpack_exports__["a"] = (TransformChange);

/***/ }),
/* 450 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that can draw a watermark on top of the image
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var WatermarkOperation = function (_Operation) {
  _inherits(WatermarkOperation, _Operation);

  /**
   * Creates a new WatermarkOperation
   * @param  {PhotoEditorSDK} sdk
   * @param  {Object} [options]
   */
  function WatermarkOperation() {
    var _ref;

    _classCallCheck(this, WatermarkOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = WatermarkOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(WatermarkOperation)).call.apply(_ref, [this].concat(args)));

    _this._watermarkSprite = new __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Sprite();
    _this._watermarkSprite.setAnchor(0.5, 0.5);
    _this._container.addChild(_this._watermarkSprite);
    return _this;
  }

  /**
   * Renders the watermark
   * @param  {PhotoEditorSDK.Engine.Texture} inputTexture
   * @private
   * @override
   */


  _createClass(WatermarkOperation, [{
    key: '_render',
    value: function _render(inputTexture) {
      if (!this._watermarkTexture) {
        this._watermarkTexture = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Engine"].Texture.fromImage(this._options.image);
        this._watermarkSprite.setTexture(this._watermarkTexture);
      }

      var textureDimensions = inputTexture.getDimensions();

      var _options$image = this._options.image,
          width = _options$image.width,
          height = _options$image.height;

      var dimensions = __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Utils"].resizeVectorToFit(new Vector2(width, height), textureDimensions);
      this._watermarkSprite.setPosition(textureDimensions.clone().divide(2));
      this._watermarkSprite.setWidth(dimensions.x);
      this._watermarkSprite.setHeight(dimensions.y);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Disposes this operation
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(WatermarkOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(WatermarkOperation.prototype), 'dispose', this).call(this);
      this._watermarkSprite.dispose();
    }
  }]);

  return WatermarkOperation;
}(__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


WatermarkOperation.identifier = 'watermark';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
WatermarkOperation.prototype.availableOptions = {
  image: { type: __WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core__["OptionType"].OBJECT, required: true }
};

__WEBPACK_IMPORTED_MODULE_5_photoeditorsdk_core___default.a.Operations.WatermarkOperation = WatermarkOperation;

/* harmony default export */ __webpack_exports__["a"] = (WatermarkOperation);

/***/ }),
/* 451 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator__ = __webpack_require__(79);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__style_transfer_model__ = __webpack_require__(452);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__core_constants__ = __webpack_require__(40);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__managers_environment_manager__ = __webpack_require__(187);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__filters_index__ = __webpack_require__(472);








var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Promise"](function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Promise"].resolve(value).then(function (value) { step("next", value); }, function (err) { step("throw", err); }); } } return step("next"); }); }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2018 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */






var OverlayFilter = __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Filters.OverlayFilter;

var GL_UNIT = 5;

/**
 * An operation that uses a pretrained neural network to style an image.
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 */

var ArtFilterOperation = function (_Operation) {
  _inherits(ArtFilterOperation, _Operation);

  _createClass(ArtFilterOperation, null, [{
    key: 'isSupported',


    /**
     * Whether this operation is supported in the given SDK environment.
     * @param {PhotoEditorSDK} sdk
     * @return {Bool}
     */
    value: function isSupported(sdk) {
      if (sdk.getRenderer().isOfType(__WEBPACK_IMPORTED_MODULE_9__core_constants__["RendererType"].WEBGL)) {
        var gl = sdk.getRenderer().getContext();

        var _EnvironmentManager$d = __WEBPACK_IMPORTED_MODULE_10__managers_environment_manager__["a" /* default */].determineSupportedConfiguration(gl),
            environmentSupported = _EnvironmentManager$d.environmentSupported;

        var notMobile = !__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Utils"].isMobile();

        return environmentSupported && notMobile;
      }

      return false;
    }

    /* Operation */

  }]);

  function ArtFilterOperation() {
    var _ref;

    _classCallCheck(this, ArtFilterOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = ArtFilterOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(ArtFilterOperation)).call.apply(_ref, [this].concat(args)));

    _this._renderStart = null;


    _this._renderedOverlaySprite = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Sprite();
    _this._renderedOverlayContainer = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].Container();
    _this._renderedOverlayContainer.addChild(_this._renderedOverlaySprite);
    _this._overlayFilter = new OverlayFilter();
    _this._overlayFilter.getShaderForRenderer(_this._sdk.getRenderer());

    // Once the image changes, we need to recreate our render targets and
    // the model to compensate for changed input dimensions
    _this._sdk.on('new-image', _this._onNewImage.bind(_this));
    _this._prepareRenderTargets();
    return _this;
  }

  _createClass(ArtFilterOperation, [{
    key: 'setOption',
    value: function setOption(name, value) {
      var _this2 = this;

      // Ensure clean overlay texture upon model replacement
      if (name === 'styleTransferModel') {
        var currentStyleTransferModel = this._options.styleTransferModel;
        if (currentStyleTransferModel && currentStyleTransferModel !== value) {
          this._renderInputImageIntoOverlayTarget();
        }
      }

      // Register for weight updates of current model to update render targets
      _get(ArtFilterOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(ArtFilterOperation.prototype), 'setOption', this).call(this, name, value);
      if (name === 'identifier' || name === 'styleTransferModel') {
        var _currentStyleTransferModel = this._options.styleTransferModel;
        if (_currentStyleTransferModel) {
          _currentStyleTransferModel.onWeightsUpdated(function () {
            _this2._renderInputImageIntoOverlayTarget();
          });
        }
      }
    }
  }, {
    key: '_onNewImage',
    value: function _onNewImage() {
      this.dispose();
      this._prepareRenderTargets();
      var styleTransferModel = this.getStyleTransferModel();
      if (styleTransferModel) {
        styleTransferModel.updateInputDimensions(this._exifAdjustedInputDimensions);
      }
    }

    /**
     * Creates two render targets. One for the original input image and
     * one for the overlay texture. The overlay texture is initially filled
     * with the input image to allow feathered masking.
     * @private
     */

  }, {
    key: '_prepareRenderTargets',
    value: function _prepareRenderTargets() {
      var renderer = this._sdk.getRenderer();
      var gl = renderer.getContext();
      var fullResolutionInputTexture = this._sdk.getInputTexture();
      var inputDimensions = fullResolutionInputTexture.getDimensions();

      // Target to extract individual tiles from. Holds the original image in full
      // resolution, adjusted for any exif orientation changes
      var exifOrientationOperation = this._sdk.getOperationsStack().getByIdentifier('exif-orientation');
      if (exifOrientationOperation) {
        // There are existing EXIF normalization operations on the stack, reapply them to the
        // original input image and upload the result to the input target's texture
        inputDimensions = exifOrientationOperation.getNewDimensions(inputDimensions);
        var inputTarget = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].WebGLRenderTarget(renderer, inputDimensions.x, inputDimensions.y, 1);
        inputTarget.setFrame(new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Math"].Rectangle(0, 0, inputDimensions.x, inputDimensions.y));
        var inputTargetsGLTexture = renderer.getOrCreateGLTexture(inputTarget.getBaseTexture());
        var normalizedImage = exifOrientationOperation.applyTo(this._sdk.getImage());
        gl.bindTexture(gl.TEXTURE_2D, inputTargetsGLTexture);
        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, normalizedImage);
        this._modelInputTarget = inputTarget;
      } else {
        // No EXIF corrections needed, we reuse the existing `inputTexture` by binding them to the
        // input targets framebuffer
        var _inputTarget = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].WebGLRenderTarget(renderer, inputDimensions.x, inputDimensions.y, 1);
        _inputTarget.setFrame(new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Math"].Rectangle(0, 0, inputDimensions.x, inputDimensions.y));
        _inputTarget._baseTexture = fullResolutionInputTexture.getBaseTexture();
        var inputTargetGLTexture = _inputTarget._baseTexture.getGLTextureForRenderer(renderer);
        if (!inputTargetGLTexture) {
          inputTargetGLTexture = gl.createTexture();
          _inputTarget._baseTexture.setGLTextureForRenderer(inputTargetGLTexture, renderer);
        }
        _inputTarget._texture = inputTargetGLTexture;
        gl.bindTexture(gl.TEXTURE_2D, inputTargetGLTexture);
        gl.bindFramebuffer(gl.FRAMEBUFFER, _inputTarget._framebuffer);
        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, inputTargetGLTexture, 0);
        this._modelInputTarget = _inputTarget;
      }

      this._overlayRenderTexture = new __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Engine"].RenderTexture(renderer, inputDimensions.x, inputDimensions.y);
      var baseTexture = this._overlayRenderTexture.getBaseTexture();
      baseTexture.setGLUnit(GL_UNIT);
      this._sdk.getRenderer().updateTexture(baseTexture, false);
      this._overlayRenderTarget = this._overlayRenderTexture.getRenderTarget();
      this._renderedOverlaySprite.setTexture(this._overlayRenderTexture);

      this._exifAdjustedInputDimensions = inputDimensions;
      this._renderInputImageIntoOverlayTarget();
    }

    /**
     * Copies the contents of the original input image into the
     * overlay render texture. This allows feathered masking.
     * @private
     */

  }, {
    key: '_renderInputImageIntoOverlayTarget',
    value: function _renderInputImageIntoOverlayTarget() {
      var renderer = this._sdk.getRenderer();
      var gl = renderer.getContext();
      var inputDimensions = this._modelInputTarget.getFrame().getSize();

      this._modelInputTarget.activate();
      gl.bindTexture(gl.TEXTURE_2D, this._overlayRenderTarget.getTexture());
      gl.copyTexImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 0, 0, inputDimensions.x, inputDimensions.y, 0);
    }

    /**
     * Applies this operation
     * @param {PhotoEditorSDK.Engine.RenderTexture} inputTexture
     * @return {Promise}
     * @private
     */

  }, {
    key: '_render',
    value: function () {
      var _ref2 = _asyncToGenerator( /*#__PURE__*/__WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator___default.a.mark(function _callee(inputTexture) {
        var _options, intensity, blendMode, styleTransferModel;

        return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator___default.a.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _options = this._options, intensity = _options.intensity, blendMode = _options.blendMode;
                styleTransferModel = this.getStyleTransferModel();

                // Do nothing if no model is present

                if (styleTransferModel) {
                  _context.next = 6;
                  break;
                }

                this._sprite.setFilters([]);
                this._renderTexture.render(this._container);
                return _context.abrupt('return', __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Promise"].resolve());

              case 6:
                if (!styleTransferModel.isDisposed()) {
                  _context.next = 9;
                  break;
                }

                _context.next = 9;
                return styleTransferModel.initGraph(this._sdk.getRenderer());

              case 9:
                if (!styleTransferModel.isDirty()) {
                  _context.next = 12;
                  break;
                }

                _context.next = 12;
                return styleTransferModel.execute(this._sdk.getRenderer(), this._modelInputTarget, this._overlayRenderTarget);

              case 12:

                // Render styled image on top of current image
                this._overlayFilter.set({
                  blendMode: blendMode,
                  overlayImage: this._overlayRenderTarget.getBaseTexture().getGLUnit(),
                  overlayTexture: this._overlayRenderTexture,
                  alpha: intensity
                });
                this._sprite.setFilters([this._overlayFilter]);
                this._renderTexture.render(this._container);

                return _context.abrupt('return', __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Promise"].resolve(styleTransferModel.isDirty()));

              case 16:
              case 'end':
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function _render(_x) {
        return _ref2.apply(this, arguments);
      }

      return _render;
    }()

    /* Housekeeping */

  }, {
    key: 'dispose',
    value: function dispose() {
      _get(ArtFilterOperation.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_object_get_prototype_of___default()(ArtFilterOperation.prototype), 'dispose', this).call(this);
      this._renderedOverlaySprite.dispose();
      this._overlayFilter.dispose();
      this._overlayRenderTarget.dispose();

      // ModelInputTarget bound to input texture, only dispose framebuffer
      if (this._modelInputTarget) {
        var framebuffer = this._modelInputTarget._framebuffer;
        var gl = this._sdk.getRenderer().getContext();
        gl.deleteFramebuffer(framebuffer);
        this._modelInputTarget = null;
      }

      var styleTransferModel = this._options.styleTransferModel;

      if (styleTransferModel) styleTransferModel.dispose();
    }
  }]);

  return ArtFilterOperation;
}(__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select
 * operations.
 * @type {String}
 * @default
 */


ArtFilterOperation.identifier = 'artfilter';

/**
 * Specifies the available options for this operation
 * @type {Object}
 * @ignore
 */
ArtFilterOperation.prototype.availableOptions = {
  identifier: {
    type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].STRING,
    default: ''
  },
  styleTransferModel: {
    type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].OBJECT,
    default: null
  },
  intensity: {
    type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER,
    default: 1
  },
  blendMode: {
    type: __WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core__["OptionType"].NUMBER,
    default: OverlayFilter.BLEND_MODES.NORMAL,
    available: __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(OverlayFilter.BLEND_MODES).map(function (o) {
      return OverlayFilter.BLEND_MODES[o];
    })
  }
};

ArtFilterOperation.StyleTransferModel = __WEBPACK_IMPORTED_MODULE_8__style_transfer_model__["a" /* default */];
ArtFilterOperation.TensorFilters = __WEBPACK_IMPORTED_MODULE_11__filters_index__["a" /* default */];
__WEBPACK_IMPORTED_MODULE_7_photoeditorsdk_core___default.a.Operations.ArtFilterOperation = ArtFilterOperation;

/* harmony default export */ __webpack_exports__["a"] = (ArtFilterOperation);

/***/ }),
/* 452 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__ = __webpack_require__(29);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator__ = __webpack_require__(79);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__tensor_filter_graph__ = __webpack_require__(453);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__tiling_controller__ = __webpack_require__(471);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__filters_add_filter__ = __webpack_require__(188);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__filters_finalize_style_filter__ = __webpack_require__(189);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__filters_conv2d_filter__ = __webpack_require__(190);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__filters_conv2d_depthwise_filter__ = __webpack_require__(191);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__filters_reduce_sum_filter__ = __webpack_require__(192);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__filters_variance_preparation_filter__ = __webpack_require__(193);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__filters_instance_norm_relu_filter__ = __webpack_require__(194);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__filters_resize_bilinear_filter__ = __webpack_require__(195);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__core_globals__ = __webpack_require__(38);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21__shared_loaders_index__ = __webpack_require__(171);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22__filters_tensor_utils__ = __webpack_require__(54);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23__filters_pad_utils__ = __webpack_require__(133);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24__filters_edge_pad_filter__ = __webpack_require__(196);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25__filters_sharpen_filter__ = __webpack_require__(197);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_26__filters_pack_rgba_filter__ = __webpack_require__(132);









var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(arr), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_is_iterable___default()(Object(arr))) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_promise___default.a(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_promise___default.a.resolve(value).then(function (value) { step("next", value); }, function (err) { step("throw", err); }); } } return step("next"); }); }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */





















/**
 * This class implements a neural network used for Style Transfer and
 * encapsules all weight loading, shader precompilation, render size
 * management and disposal.
 *
 * @private
 * @class
 * @extends Configurable
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation
 */

var StyleTransferModel = function (_Configurable) {
  _inherits(StyleTransferModel, _Configurable);

  _createClass(StyleTransferModel, [{
    key: 'isDirty',


    /* Accessors */

    /**
     * Controls whether the model still needs more rendering.
     * @returns {Boolean}
     */
    value: function isDirty() {
      if (this._tilingController) {
        return !this._tilingController.hasRenderedAllTiles();
      }

      return true;
    }

    /**
     * Whether the underlying operation graph was disposed. If
     * true, the model needs to be reloaded using `initGraph`
     * before use.
     * @returns {Boolean}
     */

  }, {
    key: 'isDisposed',
    value: function isDisposed() {
      return this._graph === null;
    }

    /**
     * Whether the model is ready to be executed.
     * @returns {Boolean}
     */

  }, {
    key: 'isReady',
    value: function isReady() {
      return !this.isDisposed() && this._graph.isFinished();
    }
  }, {
    key: 'getTilingController',
    value: function getTilingController() {
      return this._tilingController;
    }
  }, {
    key: 'onWeightsUpdated',
    value: function onWeightsUpdated(cb) {
      this._onWeightsUpdatedCallback = cb;
    }

    /* Model Creation Interface */

    /**
     * Prepares an existing model using the weights at the given URL.
     * @param {Object} options
     * @param {SDK.Engine.Renderer} renderer
     * @returns {Promise} Fullfills when a graph was created and loaded.
     */

  }], [{
    key: 'createWithOptions',
    value: function createWithOptions(options, exifAdjustedOriginalInputDimensions, renderer) {
      var tileEdgeLength = options.tileEdgeLength || StyleTransferModel.prototype.availableOptions.tileEdgeLength.default;
      var overlappingFactor = options.overlappingFactor || StyleTransferModel.prototype.availableOptions.overlappingFactor.default;
      var tilingController = new __WEBPACK_IMPORTED_MODULE_10__tiling_controller__["a" /* default */](exifAdjustedOriginalInputDimensions, tileEdgeLength, overlappingFactor);

      // Create graph
      var model = new StyleTransferModel(options, tilingController);

      // Load weights, compile shaders etc.
      return model.initGraph(renderer).then(function () {
        return model;
      });
    }
  }]);

  function StyleTransferModel() {
    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var tilingController = arguments[1];

    _classCallCheck(this, StyleTransferModel);

    var _this = _possibleConstructorReturn(this, (StyleTransferModel.__proto__ || __WEBPACK_IMPORTED_MODULE_7_babel_runtime_core_js_object_get_prototype_of___default()(StyleTransferModel)).call(this, options));

    _this._onWeightsUpdatedCallback = null;
    _this._finalConvIndex = -1;

    _this._tilingController = tilingController;
    _this._disposed = false;
    return _this;
  }

  _createClass(StyleTransferModel, [{
    key: 'updateInputDimensions',
    value: function updateInputDimensions(exifAdjustedOriginalInputDimensions) {
      var tileEdgeLength = this._options.tileEdgeLength || StyleTransferModel.prototype.availableOptions.tileEdgeLength.default;
      var overlappingFactor = this._options.overlappingFactor || StyleTransferModel.prototype.availableOptions.overlappingFactor.default;
      this._tilingController = new __WEBPACK_IMPORTED_MODULE_10__tiling_controller__["a" /* default */](exifAdjustedOriginalInputDimensions, tileEdgeLength, overlappingFactor);
    }

    /**
     * Asks the model to update it's weights with the ones from the given url. If
     * those weights are compatible, the tiling state will be reset and any
     * previously rendered data are cleared.
     * @param {string} url - The weights to load
     * @returns {Promise} - Resolves after graph and tiling controller were updated
     */

  }, {
    key: 'updateWithWeightsFromURL',
    value: function () {
      var _ref = _asyncToGenerator( /*#__PURE__*/__WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator___default.a.mark(function _callee(url) {
        var weightLoader, weightMap, newResidualBlockCount, updatedFinalConvWeightShape, currentFInalConvWeightShape, finalConvolutionFiltersMatch, residualBlockCountsMatch, self;
        return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator___default.a.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                weightLoader = new __WEBPACK_IMPORTED_MODULE_21__shared_loaders_index__["JSONLoader"](url);
                _context.next = 3;
                return weightLoader.load();

              case 3:
                weightMap = _context.sent;

                if (weightMap) {
                  _context.next = 6;
                  break;
                }

                return _context.abrupt('return', __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_promise___default.a.reject(new Error('Could not load weight map from ' + url)));

              case 6:

                // Verify weight maps have same requirements
                newResidualBlockCount = 0;

                while (weightMap['transform/residual/res_' + (newResidualBlockCount + 1) + '/conv1/depthwise_weights']) {
                  newResidualBlockCount++;
                }
                updatedFinalConvWeightShape = weightMap['transform/expand/final_conv/depthwise_weights'].logicalShape;
                currentFInalConvWeightShape = this._graph._filterStack[this._finalConvIndex]._getInputWithName('w').logicalShape;
                finalConvolutionFiltersMatch = __WEBPACK_IMPORTED_MODULE_22__filters_tensor_utils__["a" /* default */].isSameShape(currentFInalConvWeightShape, updatedFinalConvWeightShape);
                residualBlockCountsMatch = this._residualBlockCount === newResidualBlockCount;
                self = this;

                if (!(finalConvolutionFiltersMatch && residualBlockCountsMatch)) {
                  _context.next = 17;
                  break;
                }

                return _context.abrupt('return', this._graph.updateWeights(weightMap).then(function () {
                  self._onWeightsUpdatedCallback && self._onWeightsUpdatedCallback();
                  self.getTilingController().reset();
                }));

              case 17:
                return _context.abrupt('return', __WEBPACK_IMPORTED_MODULE_6_babel_runtime_core_js_promise___default.a.reject(new Error('Model architectures differ.')));

              case 18:
              case 'end':
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function updateWithWeightsFromURL(_x2) {
        return _ref.apply(this, arguments);
      }

      return updateWithWeightsFromURL;
    }()

    /* Inference */

    /**
     * Perform style transfer on the given tile and update
     * the target data with the styled values.
     * @param {WebGLRenderer} - renderer
     * @param {WebGLRenderTarget} - inputTarget
     * @param {WebGLRenderTarget} - outputTarget
     * @param {Number} - index
     */

  }, {
    key: 'execute',
    value: function execute(renderer, inputTarget, outputTarget) {
      var tilingController = this._tilingController;
      var graph = this._graph;
      var index = tilingController.getNextTileIndex();

      if (!graph.isFinished()) {
        throw new Error("Can't execute an unfinished graph.");
      }

      // Determine tile dimensions and blending rules

      var _tilingController$get = this._tilingController.getOriginalInputCoordinatesForTileAtIndex(index),
          x = _tilingController$get.x,
          y = _tilingController$get.y,
          height = _tilingController$get.height,
          width = _tilingController$get.width;

      var tileRectangle = new __WEBPACK_IMPORTED_MODULE_20__core_globals__["Rectangle"](x, y, width, height);
      var blendLeftTopRightBottom = this._tilingController.getBlendLeftTopRightBottomForTile(index);

      var _tilingController$get2 = this._tilingController.getTilingConfiguration(),
          overlappingFactor = _tilingController$get2.overlappingFactor;

      // Render the tile


      return graph.render(renderer, inputTarget, outputTarget, tileRectangle, blendLeftTopRightBottom, overlappingFactor).then(function () {
        tilingController.markTileAsRendered(index);
      });
    }

    /* Graph Creation */

    /**
     * Loads the models weights from a json file
     * @returns {Promise} Fullfills upon successful load.
     * @private
     */

  }, {
    key: 'initGraph',
    value: function () {
      var _ref2 = _asyncToGenerator( /*#__PURE__*/__WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator___default.a.mark(function _callee2(renderer) {
        var _this2 = this;

        var _options, weightURL, tileEdgeLength, tilingController, largestInputTileSize, originalTileDimensions, weightLoader, weightMap, residualBlockCount;

        return __WEBPACK_IMPORTED_MODULE_5_babel_runtime_regenerator___default.a.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                _options = this._options, weightURL = _options.weightURL, tileEdgeLength = _options.tileEdgeLength;
                tilingController = this.getTilingController();
                largestInputTileSize = tilingController.calculateMaximumTileDimensions();
                originalTileDimensions = tilingController.getOriginalInputCoordinatesForTileAtIndex(0).getSize();

                // Load weight values from file

                weightLoader = new __WEBPACK_IMPORTED_MODULE_21__shared_loaders_index__["JSONLoader"](weightURL);
                _context2.next = 7;
                return weightLoader.load();

              case 7:
                weightMap = _context2.sent;


                // Different styles use different residual block counts. The required count
                // can be determined by counting the weights of the corresponding layers
                residualBlockCount = 0;

                while (weightMap['transform/residual/res_' + (residualBlockCount + 1) + '/conv1/depthwise_weights']) {
                  residualBlockCount++;
                }
                this._residualBlockCount = residualBlockCount;

                // Create a new filter graph
                this._graph = new __WEBPACK_IMPORTED_MODULE_9__tensor_filter_graph__["a" /* default */](renderer, weightMap, largestInputTileSize, tileEdgeLength);

                // Scale input image to inference edge length
                this._graph.addFilter(new __WEBPACK_IMPORTED_MODULE_18__filters_resize_bilinear_filter__["a" /* default */]({
                  inputs: [{
                    name: 'x',
                    type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS
                  }],
                  size: [tileEdgeLength, tileEdgeLength]
                }));

                // Construct the filter hierarchy for a style transform network
                this._addStyleTransferOperationsToGraph(this._graph, weightMap, originalTileDimensions);

                // Load supplementary textures and compile filters
                return _context2.abrupt('return', this._graph.load(renderer).then(function () {
                  _this2._tilingController.reset();
                }));

              case 15:
              case 'end':
                return _context2.stop();
            }
          }
        }, _callee2, this);
      }));

      function initGraph(_x3) {
        return _ref2.apply(this, arguments);
      }

      return initGraph;
    }()

    /**
     * Adds all operations required for a transform model to the given graph.
     * @param {TensorFilterGraph} graph
     * @param {Vector2} originalTileDimensions
     */

  }, {
    key: '_addStyleTransferOperationsToGraph',
    value: function _addStyleTransferOperationsToGraph(graph, weightMap, originalTileDimensions) {
      this._weightMap = weightMap;

      // Contract
      var conv1Index = this._addDepthwiseSeparableConvolution('transform/contract/conv1', graph, 1, 1, 'same');
      var conv2Index = this._addDepthwiseSeparableConvolution('transform/contract/conv2', graph, conv1Index, 2, 'same');
      var conv3Index = this._addDepthwiseSeparableConvolution('transform/contract/conv3', graph, conv2Index, 2, 'same');

      // Residuals
      var lastResidualIndex = conv3Index;
      for (var residualBlockIndex = 1; residualBlockIndex <= this._residualBlockCount; residualBlockIndex++) {
        var name = 'transform/residual/res_' + residualBlockIndex;
        lastResidualIndex = this._addResidualBlock(name, graph, lastResidualIndex);
      }

      // Expand
      var up1Index = this._addUpsampling('transform/expand/up_1', graph, lastResidualIndex);
      var up2Index = this._addUpsampling('transform/expand/up_2', graph, up1Index);
      this._addDepthwiseSeparableConvolution('transform/expand/final_conv', graph, up2Index, 1, 'same', false);

      // Perform tanh, and bring into [0, 255]
      graph.addFilter(new __WEBPACK_IMPORTED_MODULE_12__filters_finalize_style_filter__["a" /* default */]({
        inputs: [{
          name: 'x',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS
        }]
      }));

      // Scale back to original input dimensions
      var resizeBilinearIndex = graph.addFilter(new __WEBPACK_IMPORTED_MODULE_18__filters_resize_bilinear_filter__["a" /* default */]({
        inputs: [{
          name: 'x',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS
        }],
        size: [originalTileDimensions.y, originalTileDimensions.x]
      }));

      // Add padding for sharpening
      var paddedIndex = this._addEdgePadding(graph, resizeBilinearIndex, 3, 1);

      // Pack back into RGBA channels
      var packedIndex = this._addPackFilterToStack(graph, paddedIndex);

      // Apply final sharpening
      this._addSharpening(graph, packedIndex);

      this._weightMap = null;
    }

    /**
     * A depthwise separable convolution consists of a depthwise convolution, where each kernel
     * in the filter array is applied to the corresponding input channel, followed by a pointwise
     * convolution consisting of a 1x1 kernel convolving all output channels of the depthwise
     * convolution. The result is then normalized using instance normalization and a RelU unit.
     * @param {String} name - The modules name
     * @param {PhotoEditorSDK.Engine.TensorFilterGraph} graph - The graph where the filters should be added to
     * @param {Number} inputIndex - The filter index to read data from
     * @param {Number} stride - The stride to use within the depthwise convolution
     * @param {String} padding - The padding algorithm to use 'same' (default) or 'valid'
     */

  }, {
    key: '_addDepthwiseSeparableConvolution',
    value: function _addDepthwiseSeparableConvolution(name, graph, inputIndex, stride, padding) {
      var addRelu = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : true;

      var depthwiseWeightsKey = name + '/depthwise_weights';
      var pointwiseWeightsKey = name + '/pointwise_weights';

      var inputIsPrevious = graph.getLastIndex() === inputIndex;
      var dwConvIndex = graph.addFilter(new __WEBPACK_IMPORTED_MODULE_14__filters_conv2d_depthwise_filter__["a" /* default */]({
        inputs: [{
          name: 'x',
          type: inputIsPrevious ? __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS : __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].DATA,
          data: inputIndex
        }, {
          name: 'w',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].DATA,
          data: depthwiseWeightsKey
        }],
        stride: stride,
        padding: 'same',
        padMethod: 'edge' // Enforces edge padding within the filter
      }));
      if (depthwiseWeightsKey.indexOf('final_conv') >= 0) {
        this._finalConvIndex = dwConvIndex;
      }

      var pwConv2DIndex = graph.addFilter(new __WEBPACK_IMPORTED_MODULE_13__filters_conv2d_filter__["a" /* default */]({
        inputs: [{
          name: 'x',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS
        }, {
          name: 'w',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].DATA,
          data: pointwiseWeightsKey
        }],
        stride: 1,
        padding: 'valid'
      }));

      // Calculate the sum across all channels
      var reduceSumIndex = __WEBPACK_IMPORTED_MODULE_15__filters_reduce_sum_filter__["a" /* default */].addFiltersForReduceSumOperationToGraph(graph, pwConv2DIndex, [1, 2]);

      // Calculate variance
      var variancePrepResultIndex = graph.addFilter(new __WEBPACK_IMPORTED_MODULE_16__filters_variance_preparation_filter__["a" /* default */]({
        inputs: [{
          name: 'sum',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS
        }, {
          name: 'x',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].INDEX,
          data: pwConv2DIndex
        }]
      }));
      __WEBPACK_IMPORTED_MODULE_15__filters_reduce_sum_filter__["a" /* default */].addFiltersForReduceSumOperationToGraph(graph, variancePrepResultIndex, [1, 2]);

      // Use sum, variance and x to perform instance normalization
      var shiftWeightsKey = name + '/instance_norm/shift';
      var scaleWeightsKey = name + '/instance_norm/scale';
      graph.addFilter(new __WEBPACK_IMPORTED_MODULE_17__filters_instance_norm_relu_filter__["a" /* default */]({
        inputs: [{
          name: 'variance',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS
        }, {
          name: 'sum',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].INDEX,
          data: reduceSumIndex
        }, {
          name: 'x',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].INDEX,
          data: pwConv2DIndex
        }, {
          name: 'shift',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].DATA,
          data: shiftWeightsKey
        }, {
          name: 'scale',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].DATA,
          data: scaleWeightsKey
        }],
        addRelu: addRelu
      }));

      return graph.getLastIndex();
    }

    /**
     * A residual block consists of two depthwise separable convolutions in a row,
     * followed by a residual connection that adds the original input of the block
     * to the outputs of the second conv:
     *
     *      ┌───────────────────────────────┐  ┌─────┐
     *      │  ┌───────────┐  ┌───────────┐ ├─▶│ Add │──■
     *    ■─┴─▶│DW Sep Conv│─▶│DW Sep Conv│─┘  └─────┘
     *         └───────────┘  └───────────┘
     *
     * @param {String} name - This modules name/scope
     * @param {TensorFilterGraph} graph - The graph to add the filters to
     * @param {Number} inputIndex - The filter index to read data from
     */

  }, {
    key: '_addResidualBlock',
    value: function _addResidualBlock(name, graph, inputIndex) {
      var conv1Index = this._addDepthwiseSeparableConvolution(name + '/conv1', graph, inputIndex, 1, 'same');
      var conv2Index = this._addDepthwiseSeparableConvolution(name + '/conv2', graph, conv1Index, 1, 'same', false);
      var conv2IndexIsPreviousFilter = graph.getLastIndex() === conv2Index;
      graph.addFilter(new __WEBPACK_IMPORTED_MODULE_11__filters_add_filter__["a" /* default */]({
        inputs: [{
          name: 'x',
          type: __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].INDEX,
          data: inputIndex
        }, {
          name: 'y',
          type: conv2IndexIsPreviousFilter ? __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS : __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].INDEX,
          data: conv2Index
        }]
      }));

      return graph.getLastIndex();
    }

    /**
     * 'Trainable' upsampling consisting of a bilinear upsample followed by
     * a depthwise separable convolution block.
     * @param {String} name - This modules name/scope
     * @param {TensorFilterGraph} graph - The graph to add the filters to
     * @param {Number} inputIndex - The filter index to read data from
     */

  }, {
    key: '_addUpsampling',
    value: function _addUpsampling(name, graph, inputIndex) {
      var _graph$getLogicalShap = graph.getLogicalShapeAtIndex(inputIndex),
          _graph$getLogicalShap2 = _slicedToArray(_graph$getLogicalShap, 3),
          _ = _graph$getLogicalShap2[0],
          height = _graph$getLogicalShap2[1],
          width = _graph$getLogicalShap2[2];

      var inputIsPreviousFilter = graph.getLastIndex() === inputIndex;
      var resizeFilterIndex = graph.addFilter(new __WEBPACK_IMPORTED_MODULE_18__filters_resize_bilinear_filter__["a" /* default */]({
        inputs: [{
          name: 'x',
          type: inputIsPreviousFilter ? __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS : __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].INDEX,
          data: inputIndex
        }],
        size: [height * 2, width * 2]
      }));

      return this._addDepthwiseSeparableConvolution(name + '/conv', graph, resizeFilterIndex, 1, 'same');
    }
  }, {
    key: '_addEdgePadding',
    value: function _addEdgePadding(graph, inputIndex, kernelSize, stride) {
      var _graph$getLogicalShap3 = graph.getLogicalShapeAtIndex(inputIndex),
          _graph$getLogicalShap4 = _slicedToArray(_graph$getLogicalShap3, 4),
          inHeight = _graph$getLogicalShap4[1],
          inWidth = _graph$getLogicalShap4[2],
          _ = _graph$getLogicalShap4[3];

      var inputIsPreviousFilter = graph.getLastIndex() === inputIndex;
      var padInfo = __WEBPACK_IMPORTED_MODULE_23__filters_pad_utils__["a" /* default */].calculatePadding('same', inHeight, inWidth, stride, stride, kernelSize, kernelSize).padInfo;
      var paddings = [[0, 0], [padInfo.top, padInfo.bottom], [padInfo.left, padInfo.right], [0, 0]];
      return graph.addFilter(new __WEBPACK_IMPORTED_MODULE_24__filters_edge_pad_filter__["a" /* default */]({
        inputs: [{
          name: 'x',
          type: inputIsPreviousFilter ? __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS : __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].INDEX,
          data: inputIndex
        }],
        paddings: paddings
      }));
    }

    // Pack results back into RGBA order

  }, {
    key: '_addPackFilterToStack',
    value: function _addPackFilterToStack(graph, resultIndex) {
      var logicalInputShape = graph.getLogicalShapeAtIndex(resultIndex);
      var inputIsPrevious = graph.getLastIndex() === resultIndex;
      var packFilter = new __WEBPACK_IMPORTED_MODULE_26__filters_pack_rgba_filter__["a" /* default */]({
        inputs: [{
          name: 'x',
          type: inputIsPrevious ? __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS : __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].INDEX,
          data: resultIndex
        }],
        outputSize: logicalInputShape.slice(1, 3)
      });

      // Don't attempt to pack the results, if they do not fit into the texture
      if (logicalInputShape[3] === 3) {
        return graph.addFilter(packFilter);
      } else {
        throw new Error("Couldn't add pack filter due to channel count mismatch (expected RGB output).");
      }
    }
  }, {
    key: '_addSharpening',
    value: function _addSharpening(graph, inputIndex) {
      var inputIsPreviousFilter = graph.getLastIndex() === inputIndex;
      graph.addFilter(new __WEBPACK_IMPORTED_MODULE_25__filters_sharpen_filter__["a" /* default */]({
        inputs: [{
          name: 'x',
          type: inputIsPreviousFilter ? __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].PREVIOUS : __WEBPACK_IMPORTED_MODULE_19__filters_tensor_filter__["a" /* InputType */].INDEX,
          data: inputIndex
        }]
      }));
    }

    /* Housekeeping */

  }, {
    key: 'dispose',
    value: function dispose() {
      this._graph && this._graph.dispose();
      this._graph = null;
    }
  }]);

  return StyleTransferModel;
}(__WEBPACK_IMPORTED_MODULE_8_photoeditorsdk_core__["Configurable"]);

StyleTransferModel.prototype.availableOptions = {
  // The root directory containing the models weight map and weights
  weightURL: { type: __WEBPACK_IMPORTED_MODULE_8_photoeditorsdk_core__["OptionType"].STRING, required: true },

  // The edge length of the individual tiles which are styled
  tileEdgeLength: { type: __WEBPACK_IMPORTED_MODULE_8_photoeditorsdk_core__["OptionType"].NUMBER, default: 256 },

  // The overlapping to use when merging tiles
  overlappingFactor: { type: __WEBPACK_IMPORTED_MODULE_8_photoeditorsdk_core__["OptionType"].NUMBER, default: 0.4 }
};

/* harmony default export */ __webpack_exports__["a"] = (StyleTransferModel);

/***/ }),
/* 453 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_regenerator__ = __webpack_require__(79);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_regenerator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_keys__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_map__ = __webpack_require__(131);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_map___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_map__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__core_globals__ = __webpack_require__(38);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__filters_tensor_filter__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__filters_unpack_rgba_filter__ = __webpack_require__(185);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__filters_tensor_utils__ = __webpack_require__(54);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_9_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__filters_pack_rgba_filter__ = __webpack_require__(132);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__core_engine_globals__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__core_engine_utils_quad__ = __webpack_require__(160);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__filters_feathered_masking_filter__ = __webpack_require__(186);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__managers_render_target_manager__ = __webpack_require__(469);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__managers_texture_manager__ = __webpack_require__(470);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__managers_environment_manager__ = __webpack_require__(187);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve(value).then(function (value) { step("next", value); }, function (err) { step("throw", err); }); } } return step("next"); }); }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* global performance */

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */














/**
 * A TensorFilterGraph consists of a set of operations, implemented using
 * TensorFilter subclasses. Each filter has a set of inputs, a single
 * output and is executed in a single draw call. As certain filters, e.g.
 * a sum reduce, require multiple passes, the TensorFilterGraph holds a
 * collection of such filters and manages their dependencies and required
 * input textures.
 *
 * @class
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.StyleTransferModel
 */

var TensorFilterGraph = function () {

  // The internal filter stack, consisting of all filters in their execution order
  function TensorFilterGraph(renderer, weightMap, tileDimensions, inferenceEdgeLength) {
    _classCallCheck(this, TensorFilterGraph);

    this._measurePerformance = false;
    this._filterStack = [];
    this._intermediateReadDependencies = [];
    this._intermediateWriteDependencies = [];
    this._finished = false;

    this._renderer = renderer;
    this._gl = renderer.getContext();

    var textureConfig = __WEBPACK_IMPORTED_MODULE_16__managers_environment_manager__["a" /* default */].determineSupportedConfiguration(this._gl);
    this._renderTargetManager = new __WEBPACK_IMPORTED_MODULE_14__managers_render_target_manager__["b" /* default */](renderer, textureConfig);
    this._textureManager = new __WEBPACK_IMPORTED_MODULE_15__managers_texture_manager__["a" /* default */](renderer, textureConfig);

    this._weightMap = weightMap;
    this._shaderCache = new __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_map___default.a();

    this._inputTileDimensions = tileDimensions;
    this._inferenceEdgeLength = inferenceEdgeLength;

    // The feathering filter is handled seperately as it makes use
    // of targets outside the render graph
    this._featheredMaskFilter = new __WEBPACK_IMPORTED_MODULE_13__filters_feathered_masking_filter__["a" /* default */]({
      inputs: [{
        name: 'x',
        type: __WEBPACK_IMPORTED_MODULE_6__filters_tensor_filter__["a" /* InputType */].PREVIOUS,
        logicalShape: [tileDimensions.y, tileDimensions.x]
      }, {
        name: 'y',
        type: __WEBPACK_IMPORTED_MODULE_6__filters_tensor_filter__["a" /* InputType */].INDEX,
        logicalShape: [tileDimensions.y, tileDimensions.x]
      }]
    });

    this._setupRGBAUnpackFilter();
  }

  /**
   * Adds this filter to the graph and configures the main input
   * @param {PhotoEditorSDK.Engine.TensorFilter} filter
   * @param {Boolean} inferLogicalShapeForInputs - Whether the logical shapes for the inputs should be inferred or remain untouched
   * @returns {Number} - The index of the newly added filter within the graph
   */


  // Marks this graph as fully loaded and ready to render


  // Per filter cross dependencies to other filters in the stack. Each input in the
  // array at the current filters dependency translates to the filter
  // Read: [filterIndex]: [readFromIndex0, readFromIndex1, ...]
  // Write: [filterIndex]: [writeToIndex0, writeToIndex1 ]


  _createClass(TensorFilterGraph, [{
    key: 'addFilter',
    value: function addFilter(filter) {
      var _this = this;

      var inferLogicalShapeForInputs = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      if (this._finished) {
        throw new Error("Can't add filters to an already finished graph.");
      }

      var currentFilterIndex = this._filterStack.length;
      var previousIndex = currentFilterIndex - 1;
      var previousFilter = this._filterStack[previousIndex];

      // Prepare entries in filter stack structure
      this._filterStack.push(filter);
      this._intermediateReadDependencies.push([]);
      this._intermediateWriteDependencies.push([]);

      // Iterate input requirements and update structures
      filter.getInputs().forEach(function (input, index, array) {
        switch (input.type) {
          case __WEBPACK_IMPORTED_MODULE_6__filters_tensor_filter__["a" /* InputType */].PREVIOUS:
            if (inferLogicalShapeForInputs) {
              input.logicalShape = previousFilter.outputLogicalShape();
            }
            break;
          case __WEBPACK_IMPORTED_MODULE_6__filters_tensor_filter__["a" /* InputType */].INDEX:
            if (input.data === previousIndex) {
              throw new Error('Accessing the previous filter through indexing is not supported. Use InputType.PREVIOUS instead.');
            }

            var indexedFilter = _this._filterStack[input.data];
            if (!indexedFilter) {
              throw new Error('Indexed input does not exist: ' + input.data + ' for input ' + input.name + ' in ' + filter.constructor.name + ' at ' + currentFilterIndex + '.');
            }
            if (inferLogicalShapeForInputs) {
              input.logicalShape = indexedFilter.outputLogicalShape();
            }

            // The current filter needs to read the output of the filter at the
            // given index and the corresponding results need to be stored
            _this._intermediateReadDependencies[currentFilterIndex].push(input);
            _this._intermediateWriteDependencies[input.data].push(currentFilterIndex);

            break;
          case __WEBPACK_IMPORTED_MODULE_6__filters_tensor_filter__["a" /* InputType */].DATA:
            var key = input.data;
            var weights = _this._weightMap[key];
            array[index].logicalShape = weights.logicalShape;
            array[index].data = new Float32Array(weights.data);
            array[index].key = key;
            delete _this._weightMap[key];
            break;
        }
      }, this);
      filter.prepareUniforms();

      return currentFilterIndex;
    }

    /**
     * Finalizes the filter stack, compiles filters and uploads data into textures etc. Once done,
     * the graph is ready to be executed
     * @param {WebGLRenderer} renderer
     * @return {Promise}
     */

  }, {
    key: 'load',
    value: function load(renderer) {
      var _this2 = this;

      var measurePerformance = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._measurePerformance;

      this._renderer = renderer;
      this._gl = renderer.getContext();
      var gl = this._gl;
      var availableTextureUnitCount = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);
      this._maxRequiredTextureDimensions = this._calculateMaximumIntermediateTextureDimensions();

      var self = this;
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve().then(function () {
        return self._loadTextures(measurePerformance);
      }).then(function () {
        return self._compileShaders(renderer, availableTextureUnitCount, measurePerformance);
      }).then(function () {
        return self._prepareRenderTargets(measurePerformance);
      }).then(function () {
        self._intermediateResults = self._filterStack.map(function () {
          return null;
        });
        self._quad = new __WEBPACK_IMPORTED_MODULE_12__core_engine_utils_quad__["a" /* default */](renderer);
        _this2._weightMap = null;

        self._finished = true;
        return self;
      }).then(function () {
        if (measurePerformance) {
          performance.measure('texture_loading', 'begin_texture_loading', 'finish_texture_loading');
          performance.measure('shader_compilation', 'begin_shader_compilation', 'finish_shader_compilation');
          performance.measure('target_preparation', 'begin_target_preparation', 'finish_target_preparation');

          performance.getEntriesByType('measure').forEach(function (item) {
            console.log(item.name + ': ' + item.duration + 'ms');
            performance.clearMarks();
            performance.clearMeasures();
          });
        }
      });
    }
  }, {
    key: 'dispose',
    value: function dispose() {
      if (this._disposed) return;

      this._textureManager.dispose();
      this._renderTargetManager.dispose();
      this._shaderCache.forEach(function (shader) {
        shader.dispose();
      });

      this._textureManager = null;
      this._renderTargetManager = null;
      this._shaderCache = null;
      this._intermediateReadDependencies = null;
      this._intermediateWriteDependencies = null;
      this._filterStack = null;

      this._disposed = true;
    }
  }, {
    key: '_loadTextures',
    value: function _loadTextures(measurePerformance) {
      var _this3 = this;

      if (measurePerformance) performance.mark('begin_texture_loading');
      var texturesLoadPromises = [];
      this._filterStack.forEach(function (filter, index) {
        texturesLoadPromises.push(_this3._textureManager.createAndLoadTexturesForFilter(filter, index));
      }, this);

      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.all(texturesLoadPromises).then(function () {
        if (measurePerformance) performance.mark('finish_texture_loading');
      });
    }
  }, {
    key: '_compileShaders',
    value: function _compileShaders(renderer, availableTextureUnitCount, measurePerformance) {
      var _this4 = this;

      if (measurePerformance) performance.mark('begin_shader_compilation');
      var shaderCompilePromises = [];
      var allFilters = this._filterStack.concat([this._featheredMaskFilter]);
      allFilters.forEach(function (filter, index) {
        if (index < _this4._filterStack.length) {
          var requiredTextureUnits = 1 + filter.getInputs().filter(function (f) {
            return f.type === __WEBPACK_IMPORTED_MODULE_6__filters_tensor_filter__["a" /* InputType */].DATA;
          }).length + _this4._intermediateReadDependencies[index].length;
          if (requiredTextureUnits > availableTextureUnitCount) {
            throw new Error('This environment does only offer support for ' + availableTextureUnitCount + ', but filter ' + filter.constructor.name + ' requires ' + requiredTextureUnits + '.');
          }
        }

        var shaderKey = filter.getShaderIdentifier();
        var self = _this4;
        if (!_this4._shaderCache.has(shaderKey)) {
          shaderCompilePromises.push(new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function (resolve) {
            var shader = filter.getShaderForRenderer(renderer);
            if (!shader) {
              throw new Error('Could not compile filter: ' + filter.constructor.name + '!');
            }
            self._shaderCache.set(shaderKey, shader);
            renderer.getContext().finish();
            resolve(shader);
          }));
        }
      });

      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.all(shaderCompilePromises).then(function () {
        if (measurePerformance) performance.mark('finish_shader_compilation');
      });
    }
  }, {
    key: '_prepareRenderTargets',
    value: function _prepareRenderTargets(measurePerformance) {
      var _this5 = this;

      if (measurePerformance) performance.mark('begin_target_preparation');
      var intermediateTargetDimensions = this._maxRequiredTextureDimensions;
      var inputTileDimensions = this._inputTileDimensions;
      var intermediateFloatTargetCount = 5;
      var inputOutputIntTargetCount = 3;
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve().then(function (_) {
        return _this5._renderTargetManager.prebuildRenderTargets(intermediateFloatTargetCount, intermediateTargetDimensions, __WEBPACK_IMPORTED_MODULE_14__managers_render_target_manager__["a" /* Format */].FLOAT);
      }).then(function (_) {
        return _this5._renderTargetManager.prebuildRenderTargets(inputOutputIntTargetCount, inputTileDimensions, __WEBPACK_IMPORTED_MODULE_14__managers_render_target_manager__["a" /* Format */].INT);
      }).then(function (_) {
        if (measurePerformance) performance.mark('finish_target_preparation');
      });
    }
  }, {
    key: 'isFinished',
    value: function isFinished() {
      return this._finished;
    }

    /* WEIGHT UPDATES */

    /**
     * Replaces the weights of this graph with new ones from the given map. Fails if architectures
     * do not match.
     * @param {Object} newWeightMap
     */

  }, {
    key: 'updateWeights',
    value: function updateWeights(newWeightMap) {
      var _this6 = this;

      if (!this._finished) {
        return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.reject(new Error("Graph hasn't been loaded. Unable to update weights."));
      }

      this._filterStack.forEach(function (filter, filterIndex, filterStack) {
        var updatedFilter = false;
        filter.getInputs().forEach(function (input, inputIndex) {
          if (input.type === __WEBPACK_IMPORTED_MODULE_6__filters_tensor_filter__["a" /* InputType */].DATA && input.key) {
            var updatedData = newWeightMap[input.key];
            if (!updatedData) {
              return;
            }

            filterStack[filterIndex].getInputs()[inputIndex].data = new Float32Array(updatedData.data);
            updatedFilter = true;
            delete newWeightMap[input.key];
          }
        });

        if (updatedFilter) _this6._textureManager.updateTexturesForFilter(filter, filterIndex);
      });

      if (!__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_keys___default()(newWeightMap).length === 0) {
        __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.reject(new Error('Not all weights in the given weight map were in use.'));
      }

      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve();
    }

    /* RENDERING */

    /**
     * This method performs style transfer on a single tile and renders the styled result to the given
     * output target. Styling is performed on the subrect specified by `tileRectangle` and borders of
     * the result are feathered according to `overlappingFactor` and `blendLeftTopRightBottom`.
     * @param {Engine.WebGLRenderer} renderer
     * @param {Engine.WebGLRenderTarget} inputTarget
     * @param {Engine.WebGLRenderTarget}} outputTarget
     * @param {Engine.Rectangle} tileRectangle
     * @param {number[]} blendLeftTopRightBottom
     * @param {number} overlappingFactor
     * @param {boolean} measurePerformance
     */

  }, {
    key: 'render',
    value: function () {
      var _ref = _asyncToGenerator( /*#__PURE__*/__WEBPACK_IMPORTED_MODULE_1_babel_runtime_regenerator___default.a.mark(function _callee(renderer, inputTarget, outputTarget, tileRectangle, blendLeftTopRightBottom, overlappingFactor) {
        var _this7 = this;

        var measurePerformance = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : this._measurePerformance;
        var gl, intermediateTargetDimensions, pingTarget, pongTarget, partiallyStyledTileTarget, firstFilter, firstFilterInputName, height, width, lastLogicalOutputSize, previousInputRectangle, previousOutputRectangle, index;
        return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_regenerator___default.a.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (!this._disposed) {
                  _context.next = 2;
                  break;
                }

                return _context.abrupt('return', __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve(outputTarget));

              case 2:

                if (measurePerformance) performance.mark('begin_render');
                gl = this._gl;


                if (measurePerformance) performance.mark('begin_preparation');
                this._featheredMaskFilter.setBlendLeftTopRightBottom(blendLeftTopRightBottom);
                this._featheredMaskFilter.setBlendRadius(overlappingFactor * 0.5);

                intermediateTargetDimensions = this._maxRequiredTextureDimensions;
                pingTarget = this._renderTargetManager.popRenderTarget(this._inputTileDimensions, __WEBPACK_IMPORTED_MODULE_14__managers_render_target_manager__["a" /* Format */].INT);
                pongTarget = this._renderTargetManager.popRenderTarget(intermediateTargetDimensions, __WEBPACK_IMPORTED_MODULE_14__managers_render_target_manager__["a" /* Format */].FLOAT);
                partiallyStyledTileTarget = this._renderTargetManager.popRenderTarget(this._inputTileDimensions, __WEBPACK_IMPORTED_MODULE_14__managers_render_target_manager__["a" /* Format */].INT);


                this._copyTextureContents(inputTarget, pingTarget, tileRectangle, __WEBPACK_IMPORTED_MODULE_5__core_globals__["Vector2"].NULL);
                this._copyTextureContents(outputTarget, partiallyStyledTileTarget, tileRectangle, __WEBPACK_IMPORTED_MODULE_5__core_globals__["Vector2"].NULL);

                // The first filter needs the original tiles size as input dimensions
                firstFilter = this._filterStack[0];
                firstFilterInputName = firstFilter.getInputs()[0].name;
                height = tileRectangle.height, width = tileRectangle.width;
                lastLogicalOutputSize = [height, width];

                firstFilter.setTextureSizeForInputWithName(this._inputTileDimensions.asArray(true), firstFilterInputName);
                firstFilter.setLogicalSizeForInputWithName(lastLogicalOutputSize, firstFilterInputName);
                if (measurePerformance) performance.mark('finish_preparation');

                // Initially start with image input
                previousInputRectangle = new __WEBPACK_IMPORTED_MODULE_11__core_engine_globals__["h" /* Rectangle */]();
                previousOutputRectangle = new __WEBPACK_IMPORTED_MODULE_11__core_engine_globals__["h" /* Rectangle */]();

                this._filterStack.forEach(function (filter, index) {
                  /**
                   * For each filter, this loop binds all required inputs, prepares render targets
                   * and configures the filter accordingly. Once rendered, the targets are flipped
                   * or saved for later use. This makes use of dedicated managers for textures and
                   * render targets while managing the overall texture units.
                   */
                  var nextTextureUnit = 1;

                  // Ensure we're rendering to a target of the correct type
                  if (measurePerformance) performance.mark('begin_conversion_' + index);
                  var desiredFormat = filter.requiresFloatTextures() ? __WEBPACK_IMPORTED_MODULE_14__managers_render_target_manager__["a" /* Format */].FLOAT : __WEBPACK_IMPORTED_MODULE_14__managers_render_target_manager__["a" /* Format */].INT;
                  var desiredDimensions = index === _this7.getLastIndex() ? _this7._inputTileDimensions : _this7._maxRequiredTextureDimensions;
                  var pongFormat = _this7._renderTargetManager.getFormatOfRenderTarget(pongTarget);
                  if (pongTarget === null) {
                    pongTarget = _this7._renderTargetManager.popRenderTarget(desiredDimensions, desiredFormat);
                  } else if (pongFormat !== desiredFormat) {
                    _this7._renderTargetManager.pushRenderTarget(pongTarget);
                    pongTarget = _this7._renderTargetManager.popRenderTarget(desiredDimensions, desiredFormat);
                  }
                  if (measurePerformance) performance.mark('finish_conversion_' + index);

                  var pingSize = pingTarget.getFrame().getSize().asArray(true);
                  var pongSize = pongTarget.getFrame().getSize().asArray(true);

                  // Keep track of input dimensions to update uniforms
                  var previousInput = __WEBPACK_IMPORTED_MODULE_5__core_globals__["Utils"].Array.find(filter.getInputs(), function (input) {
                    return input.type === __WEBPACK_IMPORTED_MODULE_6__filters_tensor_filter__["a" /* InputType */].PREVIOUS;
                  });
                  if (previousInput !== undefined) {
                    filter.setTextureSizeForInputWithName(pingSize, previousInput.name);
                    filter.setLogicalSizeForInputWithName(lastLogicalOutputSize, previousInput.name);
                  }

                  // Bind any supplementary textures to their texture units
                  if (measurePerformance) performance.mark('begin_suppl_' + index + '_prep');
                  var boundWeightTextureCount = _this7._textureManager.bindTexturesForFilter(filter, index, nextTextureUnit);
                  nextTextureUnit += boundWeightTextureCount;
                  if (measurePerformance) performance.mark('finish_suppl_' + index + '_prep');

                  // Bind any intermediate dependencies to corresponding units
                  // Ping target is always bound at 0, therefore we bind supplementary
                  // textures starting at 1 and read dependencies behind those.
                  if (measurePerformance) performance.mark('begin_intermediate_' + index + '_prep');
                  var currentReadDependencies = _this7._intermediateReadDependencies[index];
                  _this7._bindIntermediateReadDependencies(filter, currentReadDependencies, nextTextureUnit);
                  if (measurePerformance) performance.mark('finish_intermediate_' + index + '_prep');

                  // Determine in/output dimensions and update vertex shader accordingly
                  var inputRectangle = pingTarget.getFrame();
                  var outputRectangle = pongTarget.getFrame();
                  if (!inputRectangle.equals(previousInputRectangle) || !outputRectangle.equals(previousOutputRectangle)) {
                    _this7._quad.map(inputRectangle, outputRectangle);
                    _this7._configureVertexAttributesForShader(filter.getShaderForRenderer(renderer));
                    previousInputRectangle = inputRectangle;
                    previousOutputRectangle = outputRectangle;
                  }

                  // Select target, adjust viewPort to match filters expected texture dimensions and prepare vertex attributes
                  renderer.setRenderTarget(pongTarget);
                  var logicalOutputSize = __WEBPACK_IMPORTED_MODULE_8__filters_tensor_utils__["a" /* default */].getTextureDimensionsForLogicalShape(filter.outputLogicalShape());
                  filter.setTargetTextureSize(pongSize);
                  filter.setTargetLogicalSize(logicalOutputSize);
                  gl.viewport(0, 0, logicalOutputSize[1], logicalOutputSize[0]);

                  // Apply filter
                  // If we do not clear the render target, binding previously used render targets
                  // doesn't work at all. No idea why, but clear doesn't seem to be very expensive
                  // so future Malte needs to take care of this someday.
                  if (measurePerformance) performance.mark('begin_filter_' + index);
                  var cachedShader = _this7._shaderCache.get(filter.getShaderIdentifier());
                  gl.useProgram(cachedShader.getProgram());
                  filter._applyWebGL(renderer, pingTarget, pongTarget, true, cachedShader);
                  if (measurePerformance) performance.mark('finish_filter_' + index);

                  if (measurePerformance) performance.mark('begin_postprocess_' + index);
                  // Store intermediate results if needed and remove ping to force replacement
                  var storedPing = _this7._storeIntermediateResultsIfNeeded(pingTarget, index, lastLogicalOutputSize, pingSize);
                  if (storedPing) {
                    pingTarget = null;
                  }

                  // If we used any intermediate textures, check their pendingReads and eventually push them back to the pool
                  currentReadDependencies.forEach(function (input) {
                    var intermediateResult = _this7._intermediateResults[input.data];
                    if (intermediateResult && intermediateResult.pendingReads === 0) {
                      _this7._renderTargetManager.pushRenderTarget(intermediateResult.target);
                      _this7._intermediateResults.slice(input.data, 1);
                    }
                  }, _this7);

                  // Flip ping and pong
                  var tmp = pongTarget;
                  pongTarget = pingTarget;
                  pingTarget = tmp;

                  lastLogicalOutputSize = logicalOutputSize;
                  if (measurePerformance) performance.mark('finish_postprocess_' + index);
                }, this);

                if (measurePerformance) performance.mark('begin_masking');
                this._renderTargetManager.pushRenderTarget(pongTarget);
                pongTarget = this._renderTargetManager.popRenderTarget(this._inputTileDimensions, __WEBPACK_IMPORTED_MODULE_14__managers_render_target_manager__["a" /* Format */].INT);
                this._applyFeatheredMasking(renderer, pingTarget, partiallyStyledTileTarget, pongTarget, [height, width], blendLeftTopRightBottom);
                if (measurePerformance) performance.mark('finish_masking');

                if (measurePerformance) performance.mark('begin_out_copy');
                this._copyTextureContents(pongTarget, outputTarget, new __WEBPACK_IMPORTED_MODULE_11__core_engine_globals__["h" /* Rectangle */](0, 0, width, height), tileRectangle.getPosition());
                if (measurePerformance) performance.mark('finish_out_copy');

                this._renderTargetManager.pushRenderTarget(pingTarget);
                this._renderTargetManager.pushRenderTarget(pongTarget);
                this._renderTargetManager.pushRenderTarget(partiallyStyledTileTarget);

                if (measurePerformance) performance.mark('finish_render');
                if (measurePerformance) {
                  performance.measure('total', 'begin_render', 'finish_render');
                  performance.measure('preparation', 'begin_preparation', 'finish_preparation');
                  performance.measure('masking', 'begin_masking', 'finish_masking');
                  performance.measure('out_copy', 'begin_out_copy', 'finish_out_copy');
                  for (index = 0; index < this._filterStack.length; index++) {
                    performance.measure('conversion_' + index, 'begin_conversion_' + index, 'finish_conversion_' + index);
                    performance.measure('suppl_' + index + '_prep', 'begin_suppl_' + index + '_prep', 'finish_suppl_' + index + '_prep');
                    performance.measure('intermediate_' + index + '_prep', 'begin_intermediate_' + index + '_prep', 'finish_intermediate_' + index + '_prep');
                    performance.measure('filter_' + index + '_' + this._filterStack[index].constructor.name, 'begin_filter_' + index, 'finish_filter_' + index);
                    performance.measure('postprocess_' + index, 'begin_postprocess_' + index, 'finish_postprocess_' + index);
                  }
                  performance.getEntriesByType('measure').forEach(function (item) {
                    if (item.duration > 50) {
                      console.log(item.name + ': ' + item.duration + 'ms');
                    }
                  });
                  performance.clearMarks();
                  performance.clearMeasures();
                }

                return _context.abrupt('return', __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve(outputTarget));

              case 37:
              case 'end':
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function render(_x3, _x4, _x5, _x6, _x7, _x8) {
        return _ref.apply(this, arguments);
      }

      return render;
    }()
  }, {
    key: '_applyFeatheredMasking',
    value: function _applyFeatheredMasking(renderer, source, blendSource, target, targetLogicalSize) {
      var gl = this._gl;
      gl.activeTexture(gl.TEXTURE0 + 1);
      gl.bindTexture(gl.TEXTURE_2D, blendSource.getTexture());
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

      var targetTextureSize = target.getFrame().getSize().asArray(true);
      this._featheredMaskFilter.setTargetTextureSize(targetTextureSize);
      this._featheredMaskFilter.setTargetLogicalSize(targetLogicalSize);
      this._featheredMaskFilter.setTextureSizeForInputWithName(targetTextureSize, 'x');
      this._featheredMaskFilter.setLogicalSizeForInputWithName(targetLogicalSize, 'x');
      this._featheredMaskFilter.setTextureSizeForInputWithName(targetTextureSize, 'y');
      this._featheredMaskFilter.setLogicalSizeForInputWithName(targetLogicalSize, 'y');
      var identifier = this._featheredMaskFilter.getShaderIdentifier();
      var shader = this._shaderCache.get(identifier);
      gl.useProgram(shader.getProgram());
      this._featheredMaskFilter._applyWebGL(renderer, source, target, true, shader);
    }

    /**
     * Copies the pixel data from the given rectangle in source to
     * the target at the given targetOffset
     * @param {Engine.WebGLRenderTarget} source
     * @param {Engine.WebGLRenderTarget} target
     * @param {Rectangle} rectangle
     * @param {Vector2} targetOffset
     * @private
     */

  }, {
    key: '_copyTextureContents',
    value: function _copyTextureContents(source, target, sourceRectangle, targetOffset) {
      var gl = this._gl;
      source.activate();
      gl.bindTexture(gl.TEXTURE_2D, target.getTexture());
      gl.copyTexSubImage2D(gl.TEXTURE_2D, 0, targetOffset.x, targetOffset.y, sourceRectangle.x, sourceRectangle.y, sourceRectangle.width, sourceRectangle.height);
    }

    /**
     * Binds any intermediate read dependencies to the units behind the given offset
     * and updates the filters expected dimensions accordingly.
     * @param {Engine.TensorFilter} filter
     * @param {InputDescription[]} dependencies
     * @param {Number} textureUnitOffset
     * @private
     */

  }, {
    key: '_bindIntermediateReadDependencies',
    value: function _bindIntermediateReadDependencies(filter, dependencies, textureUnitOffset) {
      var _this8 = this;

      var gl = this._gl;
      var offset = textureUnitOffset;
      dependencies.forEach(function (input) {
        var intermediateResult = _this8._intermediateResults[input.data];
        gl.activeTexture(gl.TEXTURE0 + offset);
        gl.bindTexture(gl.TEXTURE_2D, intermediateResult.target.getTexture());
        filter.setTextureSizeForInputWithName(intermediateResult.textureSize, input.name);
        filter.setLogicalSizeForInputWithName(intermediateResult.logicalSize, input.name);
        intermediateResult.pendingReads--;
        offset++;
      });
    }

    /**
     * Updates the vertex and index buffers from the global quad and pass
     * them to the given shader.
     * @param {Engine.Shader} shader
     * @private
     */

  }, {
    key: '_configureVertexAttributesForShader',
    value: function _configureVertexAttributesForShader(shader) {
      var gl = this._gl;
      var vertexBuffer = this._quad.getVertexBuffer();
      var indexBuffer = this._quad.getIndexBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);

      var attributeLocations = shader.getAttributeLocations();
      gl.vertexAttribPointer(attributeLocations.a_position, 2, gl.FLOAT, false, 0, 0);
      gl.vertexAttribPointer(attributeLocations.a_texCoord, 2, gl.FLOAT, false, 0, 2 * 4 * 4);
      gl.vertexAttribPointer(attributeLocations.a_color, 4, gl.FLOAT, false, 0, 4 * 4 * 4);
    }

    /**
     * Once we finished rendering and would overwrite the current ping target in the next step,
     * as it'd become the pong target. If any upcoming filter has stated a dependency to
     * the previous filter, we need to save ping as an intermediate result and recreate the
     * the render target from scratch:
     *
     *   [...]
     * [Filter 4]
     *    ||| <- Output target of 4 is input of 5, when 5 is done, we store the outputs
     *    |||    for a later filter and replace them with a new render target
     * [Filter 5]
     *   [...]
     *
     * @param {Number} index
     * @param {Number[]} lastLogicalOutputSize - [height, width]
     * @private
     */

  }, {
    key: '_storeIntermediateResultsIfNeeded',
    value: function _storeIntermediateResultsIfNeeded(renderTarget, index, lastLogicalOutputSize, textureSize) {
      var previousIndex = index - 1;
      if (previousIndex >= 0 && this._intermediateWriteDependencies[previousIndex].length > 0) {
        this._intermediateResults[previousIndex] = {
          target: renderTarget,
          pendingReads: this._intermediateWriteDependencies[previousIndex].length,
          textureSize: textureSize,
          logicalSize: lastLogicalOutputSize
        };

        return true;
      }

      return false;
    }

    /* ACCESSORS */

    /**
     * @return {Number} The logical shape of the unpacked input image - [4].
     */

  }, {
    key: 'getInitialInputLogicalShape',
    value: function getInitialInputLogicalShape() {
      return this._filterStack[0].outputLogicalShape();
    }
  }, {
    key: 'getLastFilterLogicalShape',
    value: function getLastFilterLogicalShape() {
      return this.getLogicalShapeAtIndex(this._filterStack.length - 1);
    }
  }, {
    key: 'getFilterCount',
    value: function getFilterCount() {
      return this._filterStack.length;
    }
  }, {
    key: 'getLastIndex',
    value: function getLastIndex() {
      return this._filterStack.length - 1;
    }
  }, {
    key: 'getLogicalShapeAtIndex',
    value: function getLogicalShapeAtIndex(index) {
      return this._filterStack[index].outputLogicalShape();
    }
  }, {
    key: 'getDebugDescription',
    value: function getDebugDescription() {
      var _this9 = this;

      var result = '';
      var intermediateTargetCount = 0;
      var supplementaryTextureCount = 0;
      this._filterStack.forEach(function (filter, index) {
        var className = filter.constructor.name;
        var inputShapes = filter._options.inputs.map(function (input) {
          return input.name + ': [' + input.logicalShape + ']';
        }).join(', ');
        var outputShape = 'Out: [' + filter.outputLogicalShape() + ']';
        var supplTextures = '[' + _this9._supplementaryTextures[index].map(function (texDescription) {
          return texDescription.loadedTexture.getGLUnit() + ': ' + texDescription.loadedTexture.id;
        }).join(', ') + ']';
        var dependencies = 'R: [' + _this9._intermediateReadDependencies[index].map(function (dep) {
          return dep.data;
        }).join(', ') + '] | W: [' + _this9._intermediateWriteDependencies[index].join(', ') + ']';
        result += '[' + index + '] - ' + className + ' | ' + inputShapes + ' | ' + outputShape + ' | ' + supplTextures + ' | ' + dependencies + '\n';

        intermediateTargetCount += _this9._intermediateReadDependencies[index].length;
        supplementaryTextureCount += _this9._supplementaryTextures[index].length;
      });
      result += 'Max intermediate texture size: ' + this._maxRequiredTextureDimensions + '\n';
      result += 'Required render targets: ' + (intermediateTargetCount + 2) + '\n';
      result += 'Required weight textures: ' + supplementaryTextureCount;

      return result;
    }

    /* INTERNAL HELPERS */

  }, {
    key: '_setupRGBAUnpackFilter',
    value: function _setupRGBAUnpackFilter() {
      var maxInputDimensions = this._inputTileDimensions;
      var inputImageShape = [maxInputDimensions.y, maxInputDimensions.x];
      var filter = new __WEBPACK_IMPORTED_MODULE_7__filters_unpack_rgba_filter__["a" /* default */]({
        inputs: [{
          name: 'x',
          logicalShape: inputImageShape,
          type: __WEBPACK_IMPORTED_MODULE_6__filters_tensor_filter__["a" /* InputType */].PREVIOUS
        }]
      });
      this.addFilter(filter, false);
    }
  }, {
    key: '_removeLastFilter',
    value: function _removeLastFilter() {
      this._filterStack.pop();
      this._supplementaryTextures.pop();
      this._intermediateReadDependencies.pop();
      this._intermediateWriteDependencies.pop();
    }
  }, {
    key: '_calculateMaximumIntermediateTextureDimensions',
    value: function _calculateMaximumIntermediateTextureDimensions() {
      var maxDimensions = new __WEBPACK_IMPORTED_MODULE_5__core_globals__["Vector2"](this._inputTileDimensions.x, this._inputTileDimensions.y); // We need at least the input tile size to render the final result at 'real' size
      this._filterStack.forEach(function (filter) {
        var requiredTextureDimensions = __WEBPACK_IMPORTED_MODULE_8__filters_tensor_utils__["a" /* default */].getTextureDimensionsForLogicalShape(filter.outputLogicalShape());
        if (requiredTextureDimensions[1] > maxDimensions.x) {
          maxDimensions.x = requiredTextureDimensions[1];
        }
        if (requiredTextureDimensions[0] > maxDimensions.y) {
          maxDimensions.y = requiredTextureDimensions[0];
        }
      });

      return maxDimensions;
    }
  }]);

  return TensorFilterGraph;
}();

/* harmony default export */ __webpack_exports__["a"] = (TensorFilterGraph);

/***/ }),
/* 454 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(109);
__webpack_require__(50);
__webpack_require__(62);
__webpack_require__(455);
__webpack_require__(461);
__webpack_require__(464);
__webpack_require__(466);
module.exports = __webpack_require__(11).Map;


/***/ }),
/* 455 */
/***/ (function(module, exports, __webpack_require__) {

var strong = __webpack_require__(456);
var validate = __webpack_require__(184);
var MAP = 'Map';

// 23.1 Map Objects
module.exports = __webpack_require__(457)(MAP, function (get) {
  return function Map() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };
}, {
  // 23.1.3.6 Map.prototype.get(key)
  get: function get(key) {
    var entry = strong.getEntry(validate(this, MAP), key);
    return entry && entry.v;
  },
  // 23.1.3.9 Map.prototype.set(key, value)
  set: function set(key, value) {
    return strong.def(validate(this, MAP), key === 0 ? 0 : key, value);
  }
}, strong, true);


/***/ }),
/* 456 */
/***/ (function(module, exports, __webpack_require__) {

var dP = __webpack_require__(22).f;
var create = __webpack_require__(81);
var redefineAll = __webpack_require__(114);
var ctx = __webpack_require__(30);
var anInstance = __webpack_require__(110);
var forOf = __webpack_require__(63);
var $iterDefine = __webpack_require__(104);
var step = __webpack_require__(142);
var setSpecies = __webpack_require__(150);
var DESCRIPTORS = __webpack_require__(19);
var fastKey = __webpack_require__(106).fastKey;
var validate = __webpack_require__(184);
var SIZE = DESCRIPTORS ? '_s' : 'size';

var getEntry = function (that, key) {
  // fast case
  var index = fastKey(key);
  var entry;
  if (index !== 'F') return that._i[index];
  // frozen object case
  for (entry = that._f; entry; entry = entry.n) {
    if (entry.k == key) return entry;
  }
};

module.exports = {
  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {
    var C = wrapper(function (that, iterable) {
      anInstance(that, C, NAME, '_i');
      that._t = NAME;         // collection type
      that._i = create(null); // index
      that._f = undefined;    // first entry
      that._l = undefined;    // last entry
      that[SIZE] = 0;         // size
      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);
    });
    redefineAll(C.prototype, {
      // 23.1.3.1 Map.prototype.clear()
      // 23.2.3.2 Set.prototype.clear()
      clear: function clear() {
        for (var that = validate(this, NAME), data = that._i, entry = that._f; entry; entry = entry.n) {
          entry.r = true;
          if (entry.p) entry.p = entry.p.n = undefined;
          delete data[entry.i];
        }
        that._f = that._l = undefined;
        that[SIZE] = 0;
      },
      // 23.1.3.3 Map.prototype.delete(key)
      // 23.2.3.4 Set.prototype.delete(value)
      'delete': function (key) {
        var that = validate(this, NAME);
        var entry = getEntry(that, key);
        if (entry) {
          var next = entry.n;
          var prev = entry.p;
          delete that._i[entry.i];
          entry.r = true;
          if (prev) prev.n = next;
          if (next) next.p = prev;
          if (that._f == entry) that._f = next;
          if (that._l == entry) that._l = prev;
          that[SIZE]--;
        } return !!entry;
      },
      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)
      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)
      forEach: function forEach(callbackfn /* , that = undefined */) {
        validate(this, NAME);
        var f = ctx(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3);
        var entry;
        while (entry = entry ? entry.n : this._f) {
          f(entry.v, entry.k, this);
          // revert to the last existing entry
          while (entry && entry.r) entry = entry.p;
        }
      },
      // 23.1.3.7 Map.prototype.has(key)
      // 23.2.3.7 Set.prototype.has(value)
      has: function has(key) {
        return !!getEntry(validate(this, NAME), key);
      }
    });
    if (DESCRIPTORS) dP(C.prototype, 'size', {
      get: function () {
        return validate(this, NAME)[SIZE];
      }
    });
    return C;
  },
  def: function (that, key, value) {
    var entry = getEntry(that, key);
    var prev, index;
    // change existing entry
    if (entry) {
      entry.v = value;
    // create new entry
    } else {
      that._l = entry = {
        i: index = fastKey(key, true), // <- index
        k: key,                        // <- key
        v: value,                      // <- value
        p: prev = that._l,             // <- previous entry
        n: undefined,                  // <- next entry
        r: false                       // <- removed
      };
      if (!that._f) that._f = entry;
      if (prev) prev.n = entry;
      that[SIZE]++;
      // add to index
      if (index !== 'F') that._i[index] = entry;
    } return that;
  },
  getEntry: getEntry,
  setStrong: function (C, NAME, IS_MAP) {
    // add .keys, .values, .entries, [@@iterator]
    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11
    $iterDefine(C, NAME, function (iterated, kind) {
      this._t = validate(iterated, NAME); // target
      this._k = kind;                     // kind
      this._l = undefined;                // previous
    }, function () {
      var that = this;
      var kind = that._k;
      var entry = that._l;
      // revert to the last existing entry
      while (entry && entry.r) entry = entry.p;
      // get next entry
      if (!that._t || !(that._l = entry = entry ? entry.n : that._t._f)) {
        // or finish the iteration
        that._t = undefined;
        return step(1);
      }
      // return step by kind
      if (kind == 'keys') return step(0, entry.k);
      if (kind == 'values') return step(0, entry.v);
      return step(0, [entry.k, entry.v]);
    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);

    // add [@@species], 23.1.2.2, 23.2.2.2
    setSpecies(NAME);
  }
};


/***/ }),
/* 457 */
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__(16);
var $export = __webpack_require__(14);
var meta = __webpack_require__(106);
var fails = __webpack_require__(42);
var hide = __webpack_require__(34);
var redefineAll = __webpack_require__(114);
var forOf = __webpack_require__(63);
var anInstance = __webpack_require__(110);
var isObject = __webpack_require__(23);
var setToStringTag = __webpack_require__(61);
var dP = __webpack_require__(22).f;
var each = __webpack_require__(458)(0);
var DESCRIPTORS = __webpack_require__(19);

module.exports = function (NAME, wrapper, methods, common, IS_MAP, IS_WEAK) {
  var Base = global[NAME];
  var C = Base;
  var ADDER = IS_MAP ? 'set' : 'add';
  var proto = C && C.prototype;
  var O = {};
  if (!DESCRIPTORS || typeof C != 'function' || !(IS_WEAK || proto.forEach && !fails(function () {
    new C().entries().next();
  }))) {
    // create collection constructor
    C = common.getConstructor(wrapper, NAME, IS_MAP, ADDER);
    redefineAll(C.prototype, methods);
    meta.NEED = true;
  } else {
    C = wrapper(function (target, iterable) {
      anInstance(target, C, NAME, '_c');
      target._c = new Base();
      if (iterable != undefined) forOf(iterable, IS_MAP, target[ADDER], target);
    });
    each('add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON'.split(','), function (KEY) {
      var IS_ADDER = KEY == 'add' || KEY == 'set';
      if (KEY in proto && !(IS_WEAK && KEY == 'clear')) hide(C.prototype, KEY, function (a, b) {
        anInstance(this, C, KEY);
        if (!IS_ADDER && IS_WEAK && !isObject(a)) return KEY == 'get' ? undefined : false;
        var result = this._c[KEY](a === 0 ? 0 : a, b);
        return IS_ADDER ? this : result;
      });
    });
    IS_WEAK || dP(C.prototype, 'size', {
      get: function () {
        return this._c.size;
      }
    });
  }

  setToStringTag(C, NAME);

  O[NAME] = C;
  $export($export.G + $export.W + $export.F, O);

  if (!IS_WEAK) common.setStrong(C, NAME, IS_MAP);

  return C;
};


/***/ }),
/* 458 */
/***/ (function(module, exports, __webpack_require__) {

// 0 -> Array#forEach
// 1 -> Array#map
// 2 -> Array#filter
// 3 -> Array#some
// 4 -> Array#every
// 5 -> Array#find
// 6 -> Array#findIndex
var ctx = __webpack_require__(30);
var IObject = __webpack_require__(97);
var toObject = __webpack_require__(44);
var toLength = __webpack_require__(82);
var asc = __webpack_require__(459);
module.exports = function (TYPE, $create) {
  var IS_MAP = TYPE == 1;
  var IS_FILTER = TYPE == 2;
  var IS_SOME = TYPE == 3;
  var IS_EVERY = TYPE == 4;
  var IS_FIND_INDEX = TYPE == 6;
  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;
  var create = $create || asc;
  return function ($this, callbackfn, that) {
    var O = toObject($this);
    var self = IObject(O);
    var f = ctx(callbackfn, that, 3);
    var length = toLength(self.length);
    var index = 0;
    var result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;
    var val, res;
    for (;length > index; index++) if (NO_HOLES || index in self) {
      val = self[index];
      res = f(val, index, O);
      if (TYPE) {
        if (IS_MAP) result[index] = res;   // map
        else if (res) switch (TYPE) {
          case 3: return true;             // some
          case 5: return val;              // find
          case 6: return index;            // findIndex
          case 2: result.push(val);        // filter
        } else if (IS_EVERY) return false; // every
      }
    }
    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;
  };
};


/***/ }),
/* 459 */
/***/ (function(module, exports, __webpack_require__) {

// 9.4.2.3 ArraySpeciesCreate(originalArray, length)
var speciesConstructor = __webpack_require__(460);

module.exports = function (original, length) {
  return new (speciesConstructor(original))(length);
};


/***/ }),
/* 460 */
/***/ (function(module, exports, __webpack_require__) {

var isObject = __webpack_require__(23);
var isArray = __webpack_require__(143);
var SPECIES = __webpack_require__(17)('species');

module.exports = function (original) {
  var C;
  if (isArray(original)) {
    C = original.constructor;
    // cross-realm fallback
    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;
    if (isObject(C)) {
      C = C[SPECIES];
      if (C === null) C = undefined;
    }
  } return C === undefined ? Array : C;
};


/***/ }),
/* 461 */
/***/ (function(module, exports, __webpack_require__) {

// https://github.com/DavidBruant/Map-Set.prototype.toJSON
var $export = __webpack_require__(14);

$export($export.P + $export.R, 'Map', { toJSON: __webpack_require__(462)('Map') });


/***/ }),
/* 462 */
/***/ (function(module, exports, __webpack_require__) {

// https://github.com/DavidBruant/Map-Set.prototype.toJSON
var classof = __webpack_require__(84);
var from = __webpack_require__(463);
module.exports = function (NAME) {
  return function toJSON() {
    if (classof(this) != NAME) throw TypeError(NAME + "#toJSON isn't generic");
    return from(this);
  };
};


/***/ }),
/* 463 */
/***/ (function(module, exports, __webpack_require__) {

var forOf = __webpack_require__(63);

module.exports = function (iter, ITERATOR) {
  var result = [];
  forOf(iter, false, result.push, result, ITERATOR);
  return result;
};


/***/ }),
/* 464 */
/***/ (function(module, exports, __webpack_require__) {

// https://tc39.github.io/proposal-setmap-offrom/#sec-map.of
__webpack_require__(465)('Map');


/***/ }),
/* 465 */
/***/ (function(module, exports, __webpack_require__) {

// https://tc39.github.io/proposal-setmap-offrom/
var $export = __webpack_require__(14);

module.exports = function (COLLECTION) {
  $export($export.S, COLLECTION, { of: function of() {
    var length = arguments.length;
    var A = new Array(length);
    while (length--) A[length] = arguments[length];
    return new this(A);
  } });
};


/***/ }),
/* 466 */
/***/ (function(module, exports, __webpack_require__) {

// https://tc39.github.io/proposal-setmap-offrom/#sec-map.from
__webpack_require__(467)('Map');


/***/ }),
/* 467 */
/***/ (function(module, exports, __webpack_require__) {

// https://tc39.github.io/proposal-setmap-offrom/
var $export = __webpack_require__(14);
var aFunction = __webpack_require__(56);
var ctx = __webpack_require__(30);
var forOf = __webpack_require__(63);

module.exports = function (COLLECTION) {
  $export($export.S, COLLECTION, { from: function from(source /* , mapFn, thisArg */) {
    var mapFn = arguments[1];
    var mapping, A, n, cb;
    aFunction(this);
    mapping = mapFn !== undefined;
    if (mapping) aFunction(mapFn);
    if (source == undefined) return new this();
    A = [];
    if (mapping) {
      n = 0;
      cb = ctx(mapFn, arguments[2], 2);
      forOf(source, false, function (nextItem) {
        A.push(cb(nextItem, n++));
      });
    } else {
      forOf(source, false, A.push, A);
    }
    return new this(A);
  } });
};


/***/ }),
/* 468 */
/***/ (function(module, exports) {

module.exports = "varying vec2 v_texCoord;\n\n// Added to the calculated (x,y) texture coordinates, to actually sample the 'center' of a pixel\nconst vec2 halfCR = vec2(0.5, 0.5);\n\n// A uniform holding the dimensions (height/rows, width/cols) of the texture we're rendering to\nuniform vec2 output_texRC;\n\n// A uniform holding the virtual output dimensions when rendering to larger textures. This allows\n// making use of the viewport and only two very large textures to perform all tensor rendering.\nuniform vec2 output_sizeRC;\n\nbool isNaN(float val) {\n    return (val < 0.0 || 0.0 < val || val == 0.0) ? false : true;\n}\n\nbool hasNaN(vec4 values) {\n    vec4 v1 = values * values;\n    vec4 v2 = values * values;\n    return any(notEqual(v1, v2));\n}\n\nfloat getNaN(vec4 values) {\n    return dot(vec4(1), values);\n}\n\nint round(float value) {\n    return int(floor(value + 0.5));\n}\n\nint imod(int x, int y) {\n    return x - y * (x / y);\n}\n\n//Based on the work of Dave Hoskins\n//https://www.shadertoy.com/view/4djSRW\n#define HASHSCALE1 443.8975\nfloat random(float seed){\n    vec2 p = v_texCoord * seed;\n    vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\nvec2 UVfrom1D(vec2 texNumRC, vec2 sizeRC, int index) {\n    int logR = index / int(sizeRC.y);\n    int logC = index - logR * int(sizeRC.y);\n    return (vec2(logC, logR) + halfCR) / texNumRC.yx;\n}\n\nvec2 UVfrom2D(vec2 texNumRC, vec2 sizeRC, int numC, int row, int col) {\n  // Calculate x & y in logical size\n  int index = row * numC + col;\n  int logR = index / int(sizeRC.y);\n  int logC = index - logR * int(sizeRC.y);\n\n  // Return relative positions of row & col in texture size\n  return (vec2(logC, logR) + halfCR) / texNumRC.yx;\n}\n\nvec2 UVfrom4D(vec2 texNumRC, vec2 sizeRC, int stride0,\n    int stride1, int stride2, int row, int col, int depth,\n    int depth2) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * stride0 + col * stride1 + depth * stride2 + depth2;\n    int logR = index / int(sizeRC.y);\n    int logC = index - logR * int(sizeRC.y);\n\n    return (vec2(logC, logR) + halfCR) / texNumRC.yx;\n}\n\nfloat sampleTexture(sampler2D textureSampler, vec2 uv) {\n    return texture2D(textureSampler, uv).r;\n}\n";

/***/ }),
/* 469 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Format; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_map__ = __webpack_require__(131);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_map___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_map__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__core_globals__ = __webpack_require__(38);




var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * Manages a set of render targets used throughout the render graph.
 *
 * @class
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.Managers
 * @private
 */

var RenderTargetManager = function () {
  function RenderTargetManager(renderer, config) {
    _classCallCheck(this, RenderTargetManager);

    this._targetTextureFormatMap = new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_map___default.a();
    this._floatTargetPool = [];
    this._intTargetPool = [];

    this._renderer = renderer;
    this._internalFloatType = config.renderTextureType;
    this._internalFloatTextureFormat = config.renderTextureFormat;
  }

  /**
   * Fill up cache with the requested number of render targets.
   * @param {Number} count - Targets to create
   * @param {Vector2} dimensions - Dimensions of the targets
   * @param {RenderTargetManager.Format} format - Format of the targets
   */


  _createClass(RenderTargetManager, [{
    key: 'prebuildRenderTargets',
    value: function prebuildRenderTargets(count, dimensions, format) {
      var _this = this;

      var promises = [];
      for (var i = 0; i < count; i++) {
        promises.push(new __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a(function (resolve) {
          var target = _this._createRenderTarget(dimensions, format);
          var id = _this._uniqueIDForTarget(target);
          _this._targetTextureFormatMap.set(id, format);
          _this.pushRenderTarget(target);
          resolve();
        }));
      }

      return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.all(promises);
    }

    /**
     * Push a disposable render target to the pool for later reuse.
     * @param {PhotoEditorSDK.Engine.WebGLRenderTarget} target
     */

  }, {
    key: 'pushRenderTarget',
    value: function pushRenderTarget(target) {
      var id = this._uniqueIDForTarget(target);
      var format = this._targetTextureFormatMap.get(id);
      if (!format) ; else {
        switch (format) {
          case Format.FLOAT:
            this._floatTargetPool.push(target);
            break;
          case Format.INT:
            this._intTargetPool.push(target);
            break;
        }
      }
    }

    /**
     * Request a render target with a certain dimension and format. The
     * manager will try to fetch a matching target from it's pool or
     * create a new one if neccessary.
     * @param {Vector} dimensions
     * @param {RenderTargetManager.Format} format
     */

  }, {
    key: 'popRenderTarget',
    value: function popRenderTarget(dimensions, format) {
      var target = null;
      if (format === Format.FLOAT) {
        target = this._extractTargetFromPool(this._floatTargetPool, dimensions);
      } else if (format === Format.INT) {
        target = this._extractTargetFromPool(this._intTargetPool, dimensions);
      }

      if (!target) {
        target = this._createRenderTarget(dimensions, format);
      }

      var id = this._uniqueIDForTarget(target);
      this._targetTextureFormatMap.set(id, format);

      return target;
    }

    /**
     * Returns the format of any target created by this manager or null for others.
     * @param {PhotoEditorSDK.Engine.WebGLRenderTarget} target
     * @return {RenderTargetManager.Format} - The targets format or null if unknown.
     */

  }, {
    key: 'getFormatOfRenderTarget',
    value: function getFormatOfRenderTarget(target) {
      if (target === null) {
        return null;
      }

      return this._targetTextureFormatMap.get(target._baseTexture.id);
    }
  }, {
    key: 'dispose',
    value: function dispose() {
      this._targetTextureFormatMap.clear();
      this._floatTargetPool.forEach(function (target) {
        target.dispose();
      });
      this._floatTargetPool = null;
      this._intTargetPool.forEach(function (target) {
        target.dispose();
      });
      this._intTargetPool = null;
    }
  }, {
    key: '_uniqueIDForTarget',
    value: function _uniqueIDForTarget(target) {
      if (target === null) {
        return null;
      } else if (target.getBaseTexture() !== null) {
        return target.getBaseTexture().id;
      } else {
        return null;
      }
    }
  }, {
    key: '_extractTargetFromPool',
    value: function _extractTargetFromPool(pool, desiredDimensions) {
      var target = pool.filter(function (target) {
        var targetSize = target.getFrame().getSize();
        return targetSize.x === desiredDimensions.x && targetSize.y && desiredDimensions.y;
      }).shift();
      if (target) {
        var index = pool.indexOf(target);
        pool.splice(index, 1);
      }

      return target;
    }
  }, {
    key: '_createRenderTarget',
    value: function _createRenderTarget(dimensions, format) {
      var result = new __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Engine"].WebGLRenderTarget(this._renderer, dimensions.x, dimensions.y, 1);
      result.getBaseTexture().setMinFilter(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Engine"].BaseTexture.NearestFilter);
      result.getBaseTexture().setMagFilter(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk_core__["Engine"].BaseTexture.NearestFilter);
      result.getBaseTexture().setMipMappingEnabled(false);
      result.setFrame(new __WEBPACK_IMPORTED_MODULE_4__core_globals__["Rectangle"](0, 0, dimensions.x, dimensions.y));

      // Initialize target to avoid expensive buffer creation during rendering
      var gl = this._renderer.getContext();
      gl.bindTexture(gl.TEXTURE_2D, result.getBaseTexture().getGLTextureForRenderer(this._renderer));
      var type = format === Format.FLOAT ? this._internalFloatType : gl.UNSIGNED_BYTE;
      // Always use RGBA for int textures, as those are used for actual images
      var internalFormat = format === Format.FLOAT ? this._internalFloatTextureFormat : gl.RGBA;
      gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, dimensions.x, dimensions.y, 0, internalFormat, type, null);

      return result;
    }
  }]);

  return RenderTargetManager;
}();

var Format = {
  FLOAT: 'float',
  INT: 'int'
};

/* harmony default export */ __webpack_exports__["b"] = (RenderTargetManager);

/***/ }),
/* 470 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_map__ = __webpack_require__(131);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_map___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_map__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__filters_tensor_filter__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__filters_tensor_utils__ = __webpack_require__(54);




var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * This manager keeps track of weight textures and creates/updates and
 * fill them.
 *
 * @class
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.Managers
 * @private
 */

var TextureManager = function () {
  function TextureManager(renderer, config) {
    _classCallCheck(this, TextureManager);

    this._filterInputToTextureMap = new __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_map___default.a();

    this._renderer = renderer;
    var gl = this._renderer.getContext();
    this._internalFloatType = config.weightTextureType;
    this._internalFloatTextureFormat = config.weightTextureFormat;
    this._numChannels = config.weightTextureFormat === gl.RGBA ? 4 : 1;

    var usingHalfFloats = this._internalFloatType !== gl.FLOAT;
    if (usingHalfFloats) this._prepareFloatConversionTables();
  }

  /**
   * Create textures and upload weight data for the given filter.
   * @param {TensorFilter} filter
   * @param {Number} filterIndex
   */


  _createClass(TextureManager, [{
    key: 'createAndLoadTexturesForFilter',
    value: function createAndLoadTexturesForFilter(filter, filterIndex) {
      var _this = this;

      return new __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a(function (resolve) {
        filter.getInputs().forEach(function (input, index) {
          if (input.type === __WEBPACK_IMPORTED_MODULE_3__filters_tensor_filter__["a" /* InputType */].DATA) {
            var data = input.data,
                logicalShape = input.logicalShape;

            var texture = _this._createTexture();
            var textureWithSize = _this._uploadDataToTexture(texture, data, logicalShape, _this._numChannels);
            var key = filterIndex + '_' + input.name;
            _this._filterInputToTextureMap.set(key, textureWithSize);
            _this._renderer.getContext().flush(); // Ensure the upload is done

            filter.getInputs()[index].data = null;
          }
        });

        resolve();
      });
    }

    /**
     * Bind the filter's input textures to successive texture units starting
     * at the given offset.
     * @param {TensorFilter} filter
     * @param {Number} filterIndex
     * @param {Number} textureUnitOffset
     */

  }, {
    key: 'bindTexturesForFilter',
    value: function bindTexturesForFilter(filter, filterIndex, textureUnitOffset) {
      var _this2 = this;

      var gl = this._renderer.getContext();
      var boundTextureCount = 0;
      filter.getInputs().forEach(function (input, index) {
        if (input.type !== __WEBPACK_IMPORTED_MODULE_3__filters_tensor_filter__["a" /* InputType */].DATA) return;

        var _filterInputToTexture = _this2._filterInputToTextureMap.get(filterIndex + '_' + input.name),
            texture = _filterInputToTexture.texture,
            size = _filterInputToTexture.size;

        if (!texture) throw new Error('Missing texture for filter ' + index + '.');
        gl.activeTexture(gl.TEXTURE0 + textureUnitOffset + boundTextureCount);
        gl.bindTexture(gl.TEXTURE_2D, texture);

        // For dedicated weight textures, texture and logical dimensions match
        filter.setTextureSizeForInputWithName(size, input.name);
        filter.setLogicalSizeForInputWithName(size, input.name);

        boundTextureCount++;
      });

      return boundTextureCount;
    }

    /**
     * Reupload any data stored in the inputs of the given filter.
     * @param {TensorFilter} filter
     * @param {Number} filterIndex
     */

  }, {
    key: 'updateTexturesForFilter',
    value: function updateTexturesForFilter(filter, filterIndex) {
      var _this3 = this;

      filter.getInputs().forEach(function (input) {
        if (input.type === __WEBPACK_IMPORTED_MODULE_3__filters_tensor_filter__["a" /* InputType */].DATA && input.data !== null) {
          var _filterInputToTexture2 = _this3._filterInputToTextureMap.get(filterIndex + '_' + input.name),
              texture = _filterInputToTexture2.texture;

          _this3._uploadDataToTexture(texture, input.data, input.logicalShape, _this3._numChannels);
        }
      }, this);
    }
  }, {
    key: 'dispose',
    value: function dispose() {
      var renderer = this._renderer;
      var gl = renderer.getContext();
      this._filterInputToTextureMap.forEach(function (textureWithSize) {
        if (textureWithSize !== 'undefined') {
          gl.deleteTexture(textureWithSize.texture);
        }
      });
      this._filterInputToTextureMap.clear();
    }
  }, {
    key: '_createTexture',
    value: function _createTexture() {
      var gl = this._renderer.getContext();

      var texture = gl.createTexture();
      gl.activeTexture(gl.TEXTURE0);
      gl.bindTexture(gl.TEXTURE_2D, texture);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

      return texture;
    }
  }, {
    key: '_uploadDataToTexture',
    value: function _uploadDataToTexture(texture, data, logicalShape, numChannels) {
      var textureSize = __WEBPACK_IMPORTED_MODULE_4__filters_tensor_utils__["a" /* default */].getTextureDimensionsForLogicalShape(logicalShape);
      var logicalSize = __WEBPACK_IMPORTED_MODULE_4__filters_tensor_utils__["a" /* default */].getSizeOfLogicalShape(logicalShape);

      if (data.length !== logicalSize) {
        throw new Error('Not enough or too many values (' + data.length + ') for shape ' + logicalShape + '.');
      }

      var gl = this._renderer.getContext();
      var asHalfFloats = this._internalFloatType !== gl.FLOAT;
      var dataToUpload = this._createArrayBufferForUpload(data, textureSize, numChannels, asHalfFloats);

      gl.bindTexture(gl.TEXTURE_2D, texture);
      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false); // Disable alpha upload fuckery
      if (numChannels === 1) gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);
      gl.texImage2D(gl.TEXTURE_2D, 0, this._internalFloatTextureFormat, textureSize[1], textureSize[0], 0, this._internalFloatTextureFormat, this._internalFloatType, dataToUpload);
      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);
      gl.pixelStorei(gl.UNPACK_ALIGNMENT, 4);

      return { texture: texture, size: textureSize };
    }
  }, {
    key: '_createArrayBufferForUpload',
    value: function _createArrayBufferForUpload(data, textureDimensions, numChannels, asHalfFloats) {
      // Short circuit for matching data
      if (numChannels === 1 && asHalfFloats === false) return data;

      var byteCount = textureDimensions[0] * textureDimensions[1] * numChannels;
      var dataToUpload = asHalfFloats ? new Uint16Array(byteCount) : new Float32Array(byteCount);
      var hasAlphaChannel = numChannels === 4;
      var dst = 0;
      for (var src = 0; src < data.length; src++) {
        dataToUpload[dst] = asHalfFloats ? this._toHalfFloat(data[src]) : data[src];
        if (hasAlphaChannel) {
          dataToUpload[dst + 3] = 1.0;
        }
        dst += numChannels;
      }

      return dataToUpload;
    }

    /**
     * Prepares lookup tables for float32 > float16 conversion as described
     * in this paper: ftp://ftp.fox-toolkit.org/pub/fasthalffloatconversion.pdf
     */

  }, {
    key: '_prepareFloatConversionTables',
    value: function _prepareFloatConversionTables() {
      var buffer = new ArrayBuffer(4);
      this._floatView = new Float32Array(buffer);
      this._uint32View = new Uint32Array(buffer);

      var baseTable = new Uint32Array(512);
      var shiftTable = new Uint32Array(512);

      for (var i = 0; i < 256; ++i) {
        var e = i - 127;

        // very small number (0, -0)
        if (e < -27) {
          baseTable[i | 0x000] = 0x0000;
          baseTable[i | 0x100] = 0x8000;
          shiftTable[i | 0x000] = 24;
          shiftTable[i | 0x100] = 24;

          // small number (denorm)
        } else if (e < -14) {
          baseTable[i | 0x000] = 0x0400 >> -e - 14;
          baseTable[i | 0x100] = 0x0400 >> -e - 14 | 0x8000;
          shiftTable[i | 0x000] = -e - 1;
          shiftTable[i | 0x100] = -e - 1;

          // normal number
        } else if (e <= 15) {
          baseTable[i | 0x000] = e + 15 << 10;
          baseTable[i | 0x100] = e + 15 << 10 | 0x8000;
          shiftTable[i | 0x000] = 13;
          shiftTable[i | 0x100] = 13;

          // large number (Infinity, -Infinity)
        } else if (e < 128) {
          baseTable[i | 0x000] = 0x7c00;
          baseTable[i | 0x100] = 0xfc00;
          shiftTable[i | 0x000] = 24;
          shiftTable[i | 0x100] = 24;

          // stay (NaN, Infinity, -Infinity)
        } else {
          baseTable[i | 0x000] = 0x7c00;
          baseTable[i | 0x100] = 0xfc00;
          shiftTable[i | 0x000] = 13;
          shiftTable[i | 0x100] = 13;
        }
      }

      this._baseTable = baseTable;
      this._shiftTable = shiftTable;
    }
  }, {
    key: '_toHalfFloat',
    value: function _toHalfFloat(value) {
      this._floatView[0] = value;
      var f = this._uint32View[0];
      var e = f >> 23 & 0x1ff;

      return this._baseTable[e] + ((f & 0x007fffff) >> this._shiftTable[e]);
    }
  }]);

  return TextureManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (TextureManager);

/***/ }),
/* 471 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module
 *
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2018 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].Vector2;

/**
 * Manages feathered tiling across an image and coordinate conversions.
 *
 * @private
 * @class
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.StyleTransferModel
 */

var TilingController = function () {

  /* PUBLIC API */

  /**
   * Create a new tiling controller for the given input size and
   * tiling parameters.
   * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
   * @param {Number} tileEdgeLength - defaults to 256
   * @param {Number} overlappingFactor - defaults to 0.4
   */
  function TilingController(inputDimensions) {
    var tileEdgeLength = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 256;
    var overlappingFactor = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0.4;

    _classCallCheck(this, TilingController);

    this._renderedTileIndices = [];
    this._unrenderedTileIndices = [];

    this._originalInputDimensions = inputDimensions;
    this._tilingConfiguration = this._calculateTilingConfiguration(inputDimensions, tileEdgeLength, overlappingFactor);
    this._unrenderedTileIndices = this._generateSpiralingTileIndices(this._tilingConfiguration);
    this._maskCache = {};
  }

  _createClass(TilingController, [{
    key: '_generateRandomTileIndices',
    value: function _generateRandomTileIndices(config) {
      var _this = this;

      var totalTileCount = config.totalTileCount;

      var generateRandomIndex = function generateRandomIndex() {
        return Math.floor(Math.random() * _this._tilingConfiguration.totalTileCount);
      };

      var result = [];
      while (result.length < totalTileCount) {
        var newIndex = generateRandomIndex();
        while (result.indexOf(newIndex) > -1) {
          newIndex = generateRandomIndex();
        }
        result.push(newIndex);
      }

      return result;
    }
  }, {
    key: '_generateSpiralingTileIndices',
    value: function _generateSpiralingTileIndices(config) {
      var numHorizontalTiles = config.numHorizontalTiles,
          numVerticalTiles = config.numVerticalTiles;

      var indices = this._generateSpiralingIndicies(numHorizontalTiles, numVerticalTiles);

      return indices;
    }
  }, {
    key: '_generateSpiralingIndicies',
    value: function _generateSpiralingIndicies(width, height) {
      var indices = [];
      var x = 0;
      var y = 0;
      var delta = [0, -1];

      var shiftWidth = width % 2 === 0;
      var shiftHeight = height % 2 === 0;
      var widthOffset = Math.floor(width / 2) - shiftWidth;
      var heightOffset = Math.floor(height / 2) - shiftHeight;

      for (var i = Math.pow(Math.max(width, height), 2); i > 0; i--) {
        if (-width / 2 < x && x <= width / 2 && -height / 2 < y && y <= height / 2) {
          indices.push((heightOffset + y) * width + (widthOffset + x));
        }
        if (x === y || x < 0 && x === -y || x > 0 && x === 1 - y) {
          delta = [-delta[1], delta[0]];
        }

        x += delta[0];
        y += delta[1];
      }

      return indices.reverse();
    }

    /**
     * Calculate the largest original dimensions created by this controllers configuration.
     * @return {Vector2} dimensions
     */

  }, {
    key: 'calculateMaximumTileDimensions',
    value: function calculateMaximumTileDimensions() {
      var totalTileCount = this._tilingConfiguration.totalTileCount;

      var largestTileDimensions = new Vector2(0, 0);

      for (var tileIndex = 0; tileIndex < totalTileCount; tileIndex++) {
        var tileDimensions = this.getOriginalInputCoordinatesForTileAtIndex(tileIndex).getSize();
        largestTileDimensions.x = Math.max(tileDimensions.x, largestTileDimensions.x);
        largestTileDimensions.y = Math.max(tileDimensions.y, largestTileDimensions.y);
      }

      return largestTileDimensions;
    }

    /**
     * Resets the controller to the initial state.
     */

  }, {
    key: 'reset',
    value: function reset() {
      var _tilingConfiguration = this._tilingConfiguration,
          tileEdgeLength = _tilingConfiguration.tileEdgeLength,
          overlappingFactor = _tilingConfiguration.overlappingFactor;

      // We're able to reuse the original input dimensions, as any change to the inputs
      // will lead to a full reload of the SDK anyway.

      this._tilingConfiguration = this._calculateTilingConfiguration(this._originalInputDimensions, tileEdgeLength, overlappingFactor);
      this._unrenderedTileIndices = this._generateSpiralingTileIndices(this._tilingConfiguration);
      this._renderedTileIndices = [];
      this._nextTileIndex = null;
    }

    /**
     * Returns the image dimensions prior to fitting it to the next tile size
     * multiple.
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getOriginalInputDimensions',
    value: function getOriginalInputDimensions() {
      return this._originalInputDimensions;
    }

    /**
     * Returns a randomly selected, not yet rendered tile index or
     * -1 if all tiles were rendered.
     * @return {Number}
     */

  }, {
    key: 'getNextTileIndex',
    value: function getNextTileIndex() {
      if (this.hasRenderedAllTiles()) {
        return -1;
      }

      if (!this._nextTileIndex) {
        this._nextTileIndex = this._unrenderedTileIndices.pop();
      }

      return this._nextTileIndex;
    }

    /**
     * Returns the current configuration:
     * @return {Object}:
     *   tileEdgeLength: {Number}
     *   overlappingFactor: {Number}
     *   fittedInputDimensions: {Math.Vector2}
     *   numVerticalTiles: {Number}
     *   numHorizontalTiles: {Number}
     *   totalTileCount: {Number}
     */

  }, {
    key: 'getTilingConfiguration',
    value: function getTilingConfiguration() {
      return this._tilingConfiguration;
    }

    /**
     * Returns the count of all tiles that were
     * marked as rendered.
     * @return {Number}
     */

  }, {
    key: 'getRenderedTileCount',
    value: function getRenderedTileCount() {
      return this._renderedTileIndices.length;
    }

    /**
     * Computes the overall rendering progress.
     * @return {Number}
     */

  }, {
    key: 'getRenderingProgress',
    value: function getRenderingProgress() {
      return this.getRenderedTileCount() / this._tilingConfiguration.totalTileCount;
    }

    /**
     * Calculates the row and column index for the tile at the given index.
     * @param {Number} index
     * @return {Object}: { rowIndex, columnIndex }
     */

  }, {
    key: 'getTileCoordinates',
    value: function getTileCoordinates(index) {
      var rowIndex = Math.floor(index / this._tilingConfiguration.numHorizontalTiles);
      var columnIndex = Math.floor(index % this._tilingConfiguration.numHorizontalTiles);

      return {
        rowIndex: rowIndex,
        columnIndex: columnIndex
      };
    }

    /**
     * Calculates the pixel coordinates and dimensions in the original input image
     * for the tile at the given index.
     * @param {Number} index
     * @return {PMath.Rectangle}
     */

  }, {
    key: 'getOriginalInputCoordinatesForTileAtIndex',
    value: function getOriginalInputCoordinatesForTileAtIndex(index) {
      var _tilingConfiguration2 = this._tilingConfiguration,
          tileEdgeLength = _tilingConfiguration2.tileEdgeLength,
          overlappingFactor = _tilingConfiguration2.overlappingFactor,
          fittedInputDimensions = _tilingConfiguration2.fittedInputDimensions,
          numHorizontalTiles = _tilingConfiguration2.numHorizontalTiles,
          numVerticalTiles = _tilingConfiguration2.numVerticalTiles;

      var _getTileCoordinates = this.getTileCoordinates(index),
          rowIndex = _getTileCoordinates.rowIndex,
          columnIndex = _getTileCoordinates.columnIndex;

      // Calculate the pixel offsets within the whole image


      var yOffset = Math.ceil(rowIndex * (tileEdgeLength * (1 - overlappingFactor)));
      var xOffset = Math.ceil(columnIndex * (tileEdgeLength * (1 - overlappingFactor)));

      // Calculate vertical and horizontal scaling factor
      var xScale = this._originalInputDimensions.x / fittedInputDimensions.x;
      var yScale = this._originalInputDimensions.y / fittedInputDimensions.y;

      // Translate fitted coordinates to original coordinates
      var scaledY = Math.ceil(yOffset * yScale);
      var scaledX = Math.ceil(xOffset * xScale);
      var scaledHeight = Math.ceil(tileEdgeLength * yScale);
      var scaledWidth = Math.ceil(tileEdgeLength * xScale);

      // Shift outer right and bottom tiles to fully fill the image. The amount
      // of missing pixels in usually in the 1-3 range, which shouldn't be an
      // issue.
      // @TODO: Make tiling calculations more precise to avoid this hack.
      if (rowIndex === numVerticalTiles - 1 && scaledY + scaledHeight < this._originalInputDimensions.y) {
        scaledY += this._originalInputDimensions.y - (scaledY + scaledHeight);
      }
      if (columnIndex === numHorizontalTiles - 1 && scaledX + scaledWidth < this._originalInputDimensions.x) {
        scaledX += this._originalInputDimensions.x - (scaledX + scaledWidth);
      }

      return new __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].Rectangle(scaledX, scaledY, scaledWidth, scaledHeight);
    }

    /**
     * Returns whether all tiles were rendered.
     * @return {Boolean}
     */

  }, {
    key: 'hasRenderedAllTiles',
    value: function hasRenderedAllTiles() {
      if (this._tilingConfiguration && this._renderedTileIndices) {
        return this._tilingConfiguration.totalTileCount - this._renderedTileIndices.length === 0;
      }

      return false;
    }

    /**
     * Marks the current tile as rendered
     */

  }, {
    key: 'markTileAsRendered',
    value: function markTileAsRendered() {
      if (this._nextTileIndex === null) {
        return;
      }
      if (!this._renderedTileIndices.indexOf(this._nextTileIndex) > -1) {
        this._renderedTileIndices.push(this._nextTileIndex);
      }

      this._nextTileIndex = null;
    }

    /* HELPERS */

    /**
     * Calculates a fitted size, the number of vertical and horizontal
     * tiles, and the total tile count for the given tiling parameters.
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @param {Number} tileEdgeLength
     * @param {Number} overlappingFactor
     */

  }, {
    key: '_calculateTilingConfiguration',
    value: function _calculateTilingConfiguration(inputDimensions, tileEdgeLength, overlappingFactor) {
      // The width of a tile that's overlapped by `overlappingFactor`
      var overlappedTileCoverage = Math.ceil((1 - overlappingFactor) * tileEdgeLength);
      // The input width fitted to a multiple of overlapped tiles, excluding the last tile
      // which is added in full width
      var fittedWidthWithoutLastTile = Math.ceil((inputDimensions.x - tileEdgeLength) / overlappedTileCoverage) * overlappedTileCoverage;
      var fittedWidth = tileEdgeLength + fittedWidthWithoutLastTile;

      var fittedHeightWithoutFirstTile = Math.ceil((inputDimensions.y - tileEdgeLength) / overlappedTileCoverage) * overlappedTileCoverage;
      var fittedHeight = tileEdgeLength + fittedHeightWithoutFirstTile;

      var fittedInputDimensions = new __WEBPACK_IMPORTED_MODULE_1_photoeditorsdk_core__["Math"].Vector2(fittedWidth, fittedHeight);
      var numVerticalTiles = Math.max(1, 1 + Math.round(fittedHeightWithoutFirstTile / overlappedTileCoverage));
      var numHorizontalTiles = Math.max(1, 1 + Math.round(fittedWidthWithoutLastTile / overlappedTileCoverage));
      var totalTileCount = numVerticalTiles * numHorizontalTiles;

      return {
        tileEdgeLength: tileEdgeLength,
        overlappingFactor: overlappingFactor,
        fittedInputDimensions: fittedInputDimensions,
        numVerticalTiles: numVerticalTiles,
        numHorizontalTiles: numHorizontalTiles,
        totalTileCount: totalTileCount
      };
    }

    /* Mask Handling */

    /**
     * Determines which borders of the given tile need to be blended.
     * @param {Number} index - The tiles index
     * @returns {Boolean} - An option mask where to blend - [4]
     */

  }, {
    key: 'getBlendLeftTopRightBottomForTile',
    value: function getBlendLeftTopRightBottomForTile(index) {
      var _getTileCoordinates2 = this.getTileCoordinates(index),
          rowIndex = _getTileCoordinates2.rowIndex,
          columnIndex = _getTileCoordinates2.columnIndex;

      var _tilingConfiguration3 = this._tilingConfiguration,
          numVerticalTiles = _tilingConfiguration3.numVerticalTiles,
          numHorizontalTiles = _tilingConfiguration3.numHorizontalTiles;

      var blendTop = rowIndex !== 0 ? 1 : 0;
      var blendRight = columnIndex !== numHorizontalTiles - 1 ? 1 : 0;
      var blendBottom = rowIndex !== numVerticalTiles - 1 ? 1 : 0;
      var blendLeft = columnIndex !== 0 ? 1 : 0;

      return [blendLeft, blendTop, blendRight, blendBottom];
    }
  }]);

  return TilingController;
}();

/* harmony default export */ __webpack_exports__["a"] = (TilingController);

/***/ }),
/* 472 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__add_filter__ = __webpack_require__(188);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__conv2d_depthwise_filter__ = __webpack_require__(191);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__conv2d_filter__ = __webpack_require__(190);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__edge_pad_filter__ = __webpack_require__(196);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__encode_float_filter__ = __webpack_require__(473);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__feathered_masking_filter__ = __webpack_require__(186);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__finalize_style_filter__ = __webpack_require__(189);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__instance_norm_relu_filter__ = __webpack_require__(194);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__pack_rgba_filter__ = __webpack_require__(132);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__reduce_sum_filter__ = __webpack_require__(192);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__reflection_pad_filter__ = __webpack_require__(474);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__resize_bilinear_filter__ = __webpack_require__(195);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__sharpen_filter__ = __webpack_require__(197);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__tensor_filter__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__unpack_rgba_filter__ = __webpack_require__(185);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__variance_preparation_filter__ = __webpack_require__(193);

















var TensorFilters = {
  AddFilter: __WEBPACK_IMPORTED_MODULE_0__add_filter__["a" /* default */],
  Conv2DDepthwiseFilter: __WEBPACK_IMPORTED_MODULE_1__conv2d_depthwise_filter__["a" /* default */],
  Conv2DFilter: __WEBPACK_IMPORTED_MODULE_2__conv2d_filter__["a" /* default */],
  EdgePadFilter: __WEBPACK_IMPORTED_MODULE_3__edge_pad_filter__["a" /* default */],
  EncodeFloatFilter: __WEBPACK_IMPORTED_MODULE_4__encode_float_filter__["a" /* default */],
  FeatheredMaskingFilter: __WEBPACK_IMPORTED_MODULE_5__feathered_masking_filter__["a" /* default */],
  FinalizeStyleFilter: __WEBPACK_IMPORTED_MODULE_6__finalize_style_filter__["a" /* default */],
  InstanceNormReluFilter: __WEBPACK_IMPORTED_MODULE_7__instance_norm_relu_filter__["a" /* default */],
  PackRGBAFilter: __WEBPACK_IMPORTED_MODULE_8__pack_rgba_filter__["a" /* default */],
  ReduceSumFilter: __WEBPACK_IMPORTED_MODULE_9__reduce_sum_filter__["a" /* default */],
  ReflectionPadFilter: __WEBPACK_IMPORTED_MODULE_10__reflection_pad_filter__["a" /* default */],
  ResizeBilinearFilter: __WEBPACK_IMPORTED_MODULE_11__resize_bilinear_filter__["a" /* default */],
  SharpenFilter: __WEBPACK_IMPORTED_MODULE_12__sharpen_filter__["a" /* default */],
  TensorFilter: __WEBPACK_IMPORTED_MODULE_13__tensor_filter__["b" /* default */],
  UnpackRGBAFilter: __WEBPACK_IMPORTED_MODULE_14__unpack_rgba_filter__["a" /* default */],
  VariancePreparationFilter: __WEBPACK_IMPORTED_MODULE_15__variance_preparation_filter__["a" /* default */]
};

/* harmony default export */ __webpack_exports__["a"] = (TensorFilters);

/***/ }),
/* 473 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__tensor_filter__ = __webpack_require__(13);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



/**
 * Encodes any float inputs in the given input texture to a binary
 * format spanning all four output channels. This allows interpreting
 * the bytes as floats for downloads from the texture.
 *
 * Inputs: x - 4D or 2D tensor
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var EncodeFloatFilter = function (_TensorFilter) {
  _inherits(EncodeFloatFilter, _TensorFilter);

  function EncodeFloatFilter() {
    _classCallCheck(this, EncodeFloatFilter);

    return _possibleConstructorReturn(this, (EncodeFloatFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(EncodeFloatFilter)).apply(this, arguments));
  }

  _createClass(EncodeFloatFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      return this._options.inputs[0].logicalShape;
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      var source = '\nconst float FLOAT_MAX = 1.70141184e38;\nconst float FLOAT_MIN = 1.17549435e-38;\n\nlowp vec4 encode_float(highp float v) {\n  if (isNaN(v)) {\n    return vec4(255, 255, 255, 255);\n  }\n\n  highp float av = abs(v);\n\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  highp float e = floor(log2(av));\n  highp float m = exp2(fract(log2(av))) - 1.0;\n\n  c[2] = floor(128.0 * m);\n  m -= c[2] / 128.0;\n  c[1] = floor(32768.0 * m);\n  m -= c[1] / 32768.0;\n  c[0] = floor(8388608.0 * m);\n\n  highp float ebias = e + 127.0;\n  c[3] = floor(ebias / 2.0);\n  ebias -= c[3] * 2.0;\n  c[2] += floor(ebias) * 128.0;\n\n  c[3] += 128.0 * step(0.0, -v);\n\n  return c / 255.0;\n}\n    ';
      if (this._options.inputs[0].logicalShape.length === 4) {
        source += '\nvoid main ()\n{\n  ivec4 coords = getOutputCoords();\n  float xVal = getX(coords.x, coords.y, coords.z, coords.w);\n  gl_FragColor = encode_float(xVal);\n}\n    ';
      } else {
        source += '\nvoid main ()\n{\n  ivec2 coords = getOutputCoords();\n  float xVal = getX(coords.x, coords.y);\n  gl_FragColor = encode_float(xVal);\n}\n    ';
      }

      return source;
    }
  }]);

  return EncodeFloatFilter;
}(__WEBPACK_IMPORTED_MODULE_4__tensor_filter__["b" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (EncodeFloatFilter);

/***/ }),
/* 474 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__tensor_filter__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * This filter performs 'reflection' or 'mirrored' padding, e.g.
 * [1, 2, 3] with paddings [2, 1] (before, after) becomes
 * [3, 2, 1, 2, 3, 2]. The boundaries are *not* repeated, which
 * resembles TensorFlows behaviour.
 *
 * The current implementation is large and rather slow, adding
 * ~2 seconds overhead to a full style model run for the default
 * sample image on my machine.
 *
 * Inputs:
 *  x: <1,2,4>D tensor
 *  paddings: number[[number, number]] - Before/after pad for each dim
 *
 * @class
 * @extends PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters.TensorFilter
 * @memberof PhotoEditorSDK.Operations.ArtFilterOperation.TensorFilters
 */

var ReflectionPadFilter = function (_TensorFilter) {
  _inherits(ReflectionPadFilter, _TensorFilter);

  function ReflectionPadFilter() {
    _classCallCheck(this, ReflectionPadFilter);

    return _possibleConstructorReturn(this, (ReflectionPadFilter.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(ReflectionPadFilter)).apply(this, arguments));
  }

  _createClass(ReflectionPadFilter, [{
    key: '_calculateOutputShape',
    value: function _calculateOutputShape() {
      var paddings = this._options.paddings;

      // Ensure single input

      if (!this.getInputs().length === 1 || this.getInputs().length === 0) {
        throw new Error('ReflectionPadFilter requires single input.');
      }
      var inputShape = this.getInputs()[0].logicalShape;

      // Ensure paddings match input dimensions
      if (paddings.length !== inputShape.length) {
        throw new Error('Not enough or too many paddings for input shape ' + inputShape);
      }

      return paddings.map(function (dim, i) {
        return dim[0] + inputShape[i] + dim[1];
      });
    }
  }, {
    key: '_getTensorOperationSource',
    value: function _getTensorOperationSource() {
      var inputShape = this.getInputs()[0].logicalShape;

      var rank = inputShape.length;
      var start = this._options.paddings.map(function (p) {
        return p[0];
      }).join(','); // [1, 4, 3, 1] BeforePad in dim 0 to 3
      var afterPad = this._options.paddings.map(function (p) {
        return p[1];
      }).join(','); // [4, 2, 1, 2] AfterPad in dim 0 to 3

      var indexCalculationMethods = '\n      int reflectedIndexInInputForPadBefore(int coord, int start) {\n        return int(abs(float(start - coord)));\n      }\n\n      int reflectedIndexInInputForPadAfter(int coord, int start,\n        int length, int afterPad) {\n        int indexInPad = coord - start - length;\n        int index = length - indexInPad - 2;\n        return index;\n      }\n    ';

      var pad2dFunction = '\n      ivec2 get2DCoordinates(\n        ivec2 outC,\n        ivec2 coords,\n        ivec2 start,\n        ivec2 end,\n        ivec2 afterPad,\n        int height,\n        int width) {\n\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          // Select non-padding rows\n          if (outC.x >= start.x && outC.x < start.x + height) {\n            // Select before pad columns\n            if (outC.y < start.y) {\n              int yIndex =\n                reflectedIndexInInputForPadBefore(outC.y, start.y);\n              return ivec2(coords.x, yIndex);\n            // Select after pad columns\n            } else if (outC.y >= start.y + width) {\n              int yIndex =\n                reflectedIndexInInputForPadAfter(outC.y, start.y,\n                  width, afterPad.y);\n              return ivec2(coords.x, yIndex);\n            }\n\n          // Select top and bottom rows, but only non-padding columns\n          } else if (outC.y >= start.y && outC.y < start.y + height) {\n            // Select top padding rows\n            if (outC.x < start.x) {\n              int xIndex =\n                reflectedIndexInInputForPadBefore(outC.x, start.x);\n              return ivec2(xIndex, coords.y);\n            // Select bottom padding rows\n            } else {\n              int xIndex =\n                reflectedIndexInInputForPadAfter(outC.x, start.x, height,\n                  afterPad.x);\n              return ivec2(xIndex, coords.y);\n            }\n\n          // Handle diagonal corner cases\n          } else if (outC.x < start.x && outC.y < end.y) { // Top Left\n            ivec2 index = outC - start;\n            vec2 absIndex = vec2(abs(float(index.x)), abs(float(index.y)));\n            return ivec2(int(absIndex.x), int(absIndex.y));\n          } else if (outC.x < start.x && outC.y >= end.y) { // Top Right\n            int targetCol =\n              reflectedIndexInInputForPadAfter(outC.y, start.y, width,\n                afterPad.y);\n            int targetRow =\n              reflectedIndexInInputForPadBefore(outC.x, start.x);\n            return ivec2(targetRow, targetCol);\n          } else if (outC.x >= end.x && outC.y < end.y) { // Bottom Left\n            int targetRow =\n              reflectedIndexInInputForPadAfter(outC.x, start.x, height,\n                afterPad.x);\n            int targetCol =\n              reflectedIndexInInputForPadBefore(outC.y, start.y);\n            return ivec2(targetRow, targetCol);\n          } else if (outC.x >= end.x && outC.y >= end.y) { // Bottom Right\n            int targetRow =\n              reflectedIndexInInputForPadAfter(outC.x, start.x, height,\n                afterPad.x);\n            int targetCol =\n              reflectedIndexInInputForPadAfter(outC.y, start.y, width,\n                afterPad.y);\n            return ivec2(targetRow, targetCol);\n          }\n        } else {\n          return coords;\n        }\n      }\n    ';

      var pad3dFunction = '\n      ivec3 get3DCoordinates(\n        ivec3 outC,\n        ivec3 coords,\n        ivec3 start,\n        ivec3 end,\n        ivec3 afterPad,\n        int length,\n        int height,\n        int width) {\n        if (any(lessThan(outC, start))\n          || any(greaterThanEqual(outC, end))) {\n\n          // Calculate the current positions inner indices in the original\n          // input tensor\n          ivec2 innerIndices = get2DCoordinates(\n            ivec2(outC.y, outC.z),\n            ivec2(coords.y, coords.z),\n            ivec2(start.y, start.z),\n            ivec2(end.y, end.z),\n            ivec2(afterPad.y, afterPad.z),\n            height,\n            width\n          );\n\n          if (outC.x < start.x) {\n            int outerIndex =\n              reflectedIndexInInputForPadBefore(outC.x, start.x);\n            return ivec3(outerIndex, innerIndices.x, innerIndices.y);\n          } else if (outC.x >= end.x) {\n            int outerIndex = reflectedIndexInInputForPadAfter(\n              outC.x, start.x, length, afterPad.x);\n            return ivec3(outerIndex, innerIndices.x, innerIndices.y);\n          } else {\n            return ivec3(coords.x, innerIndices.x, innerIndices.y);\n          }\n        } else {\n          return coords;\n        }\n      }\n    ';

      if (rank === 1) {
        return '\n        int start = ' + start + ';\n        int end = start + x_shape;\n        int width = x_shape[0];\n        int afterPad = ' + afterPad + ';\n\n        ' + indexCalculationMethods + '\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            int index = reflectedIndexInInputForPadBefore(outC, start);\n            setOutput(getX(index));\n          } else if (outC >= end) {\n            int index =\n            reflectedIndexInInputForPadAfter(outC, start, width, afterPad);\n            setOutput(getX(index));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ';
      } else if (rank === 2) {
        return '\n        ivec2 start = ivec2(' + start + ');\n        ivec2 end = start + x_shape;\n        ivec2 afterPad = ivec2(' + afterPad + ');\n        int height = x_shape[0];\n        int width = x_shape[1];\n\n        ' + indexCalculationMethods + '\n        ' + pad2dFunction + '\n\n        void main() {\n          ivec2 outC = getOutputCoords();\n          ivec2 coords = outC - start;\n          ivec2 coordsInSrcVec = get2DCoordinates(\n            outC,\n            coords,\n            start,\n            end,\n            afterPad,\n            height,\n            width\n          );\n          setOutput(getX(coordsInSrcVec.x, coordsInSrcVec.y));\n        }\n      ';
      } else if (rank === 4) {
        return '\n        ivec4 start = ivec4(' + start + ');\n        ivec4 end = start + x_shape;\n        ivec4 afterPad = ivec4(' + afterPad + ');\n        int length = x_shape[0];\n\n        ' + indexCalculationMethods + '\n        ' + pad2dFunction + '\n        ' + pad3dFunction + '\n\n        void main() {\n          ivec4 outC = getOutputCoords();\n          ivec4 coords = outC - start; // Coords in input\n\n          if (any(lessThan(outC, start))\n              || any(greaterThanEqual(outC, end))) {\n\n            ivec3 innerIndices = get3DCoordinates(\n              ivec3(outC.y, outC.z, outC.w),\n              ivec3(coords.y, coords.z, coords.w),\n              ivec3(start.y, start.z, start.w),\n              ivec3(end.y, end.z, end.w),\n              ivec3(afterPad.y, afterPad.z, afterPad.w),\n              x_shape[1],\n              x_shape[2],\n              x_shape[3]\n            );\n\n            if (outC.x < start.x) {\n              int outerIndex =\n                reflectedIndexInInputForPadBefore(outC.x, start.x);\n              setOutput(getX(\n                  outerIndex,\n                  innerIndices.x,\n                  innerIndices.y,\n                  innerIndices.z\n                ));\n            } else if (outC.x >= end.x) {\n              int outerIndex = reflectedIndexInInputForPadAfter(\n                outC.x, start.x, length, afterPad.x);\n              setOutput(getX(\n                outerIndex,\n                innerIndices.x,\n                innerIndices.y,\n                innerIndices.z\n              ));\n            } else {\n              setOutput(getX(\n                coords.x,\n                innerIndices.x,\n                innerIndices.y,\n                innerIndices.z));\n            }\n          } else {\n            setOutput(getX(coords.x, coords.y, coords.z, coords.w));\n          }\n        }\n      ';
      }
    }
  }]);

  return ReflectionPadFilter;
}(__WEBPACK_IMPORTED_MODULE_5__tensor_filter__["b" /* default */]);

ReflectionPadFilter.prototype.availableOptions = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default()({
  paddings: { type: __WEBPACK_IMPORTED_MODULE_6_photoeditorsdk_core__["OptionType"].ARRAY, required: true // e.g. 2D [[0-before, 0-after], [1-before, 1-after]]
  } }, __WEBPACK_IMPORTED_MODULE_5__tensor_filter__["b" /* default */].prototype.availableOptions);

/* harmony default export */ __webpack_exports__["a"] = (ReflectionPadFilter);

/***/ }),
/* 475 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that combines the transform and orientation-operation
 * with a more straightforward implementation.
 * This class should only be used by the LegacyEngineAdapter
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 * @private
 */

var OutputOperation = function (_Operation) {
  _inherits(OutputOperation, _Operation);

  /**
   * Creates a new OutputOperation
   * @param {PhotoEditorSDK} sdk
   * @param {Object} [options]
   * @private
   */
  function OutputOperation() {
    var _ref;

    _classCallCheck(this, OutputOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = OutputOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(OutputOperation)).call.apply(_ref, [this].concat(args)));

    _this._flipContainer = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Container();
    return _this;
  }

  /**
   * Renders the transformed output
   * @param {PhotoEditorSDK.Engine.RenderTexture} inputTexture
   * @returns {Promise}
   * @override
   * @private
   */


  _createClass(OutputOperation, [{
    key: '_render',
    value: function _render(inputTexture) {
      var _options = this._options,
          position = _options.position,
          rotation = _options.rotation,
          scale = _options.scale,
          pivot = _options.pivot,
          outputResolution = _options.outputResolution;


      var textureScale = this._sdk.getTextureScale();
      var resolution = outputResolution.clone().multiply(textureScale).ceil();

      this._renderTexture.resizeTo(resolution);

      this._sprite.setRotation(rotation);
      this._sprite.setPosition(position);
      this._sprite.setPivot(pivot);
      this._sprite.setScale(scale);

      this._renderTexture.render(this._container);

      return __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Promise"].resolve();
    }

    /**
     * Returns the output dimensions of this operation
     * @param {PhotoEditorSDK.Math.Vector2} inputDimensions
     * @return {PhotoEditorSDK.Math.Vector2}
     * @override
     */

  }, {
    key: 'getNewDimensions',
    value: function getNewDimensions(inputDimensions) {
      var textureScale = this._sdk.getTextureScale();
      return this._options.outputResolution.clone().multiply(textureScale).ceil();
    }
  }]);

  return OutputOperation;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select operations.
 * @type {String}
 * @default
 */


OutputOperation.identifier = 'output';

OutputOperation.prototype.availableOptions = {
  position: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0) },
  rotation: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].NUMBER, default: 0 },
  scale: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(1, 1) },
  pivot: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(0, 0) },
  outputResolution: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].VECTOR2, default: new Vector2(100, 100) }
};

__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default.a.Operations.OutputOperation = OutputOperation;

/* harmony default export */ __webpack_exports__["a"] = (OutputOperation);

/***/ }),
/* 476 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__);





var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */


var Vector2 = __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Math"].Vector2;

/**
 * An operation that combines the transform and orientation-operation
 * with a more straightforward implementation.
 * This class should only be used by the LegacyEngineAdapter
 * @class
 * @extends PhotoEditorSDK.Operation
 * @memberof PhotoEditorSDK.Operations
 * @private
 */

var FlipOperation = function (_Operation) {
  _inherits(FlipOperation, _Operation);

  /**
   * Creates a new OutputOperation
   * @param {PhotoEditorSDK} sdk
   * @param {Object} [options]
   * @private
   */
  function FlipOperation() {
    var _ref;

    _classCallCheck(this, FlipOperation);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = _possibleConstructorReturn(this, (_ref = FlipOperation.__proto__ || __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_get_prototype_of___default()(FlipOperation)).call.apply(_ref, [this].concat(args)));

    _this._flipContainer = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Container();
    return _this;
  }
  /**
   * Renders the transformed output
   * @param {PhotoEditorSDK.Engine.RenderTexture} inputTexture
   * @returns {Promise}
   * @override
   * @private
   */


  _createClass(FlipOperation, [{
    key: '_render',
    value: function _render(inputTexture) {
      var _options = this._options,
          outputResolution = _options.outputResolution,
          flipHorizontally = _options.flipHorizontally,
          flipVertically = _options.flipVertically;


      if (flipHorizontally || flipVertically) {
        var dimensions = inputTexture.getDimensions();
        if (!this._flipRenderTexture) {
          this._flipRenderTexture = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].RenderTexture(this._sdk.getRenderer(), dimensions.x, dimensions.y);
          this._flipSprite = new __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Engine"].Sprite(this._flipRenderTexture);
          this._flipContainer.addChild(this._flipSprite);
        } else {
          this._flipRenderTexture.resizeTo(dimensions);
        }

        var scaleX = flipHorizontally ? -1 : 1;
        var scaleY = flipVertically ? -1 : 1;
        this._flipSprite.setScale(scaleX, scaleY);
        this._flipSprite.setPivot(0, 0);
        this._flipSprite.setPosition(dimensions.x * (1 - scaleX) * 0.5, dimensions.y * (1 - scaleY) * 0.5);

        this._flipRenderTexture.clear();
        this._flipRenderTexture.render(this._container);
        this._renderTexture.render(this._flipContainer);
      } else {
        this._renderTexture.render(this._container);
      }

      return __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Promise"].resolve();
    }
  }]);

  return FlipOperation;
}(__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["Operation"]);

/**
 * A unique string that identifies this operation. Can be used to select operations.
 * @type {String}
 * @default
 */


FlipOperation.identifier = 'flip';

FlipOperation.prototype.availableOptions = {
  flipHorizontally: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false },
  flipVertically: { type: __WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core__["OptionType"].BOOLEAN, default: false }
};

__WEBPACK_IMPORTED_MODULE_4_photoeditorsdk_core___default.a.Operations.FlipOperation = FlipOperation;

/* harmony default export */ __webpack_exports__["a"] = (FlipOperation);

/***/ }),
/* 477 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/**
 * Returns the internet explorer version or false, if browser is not an IE
 * @return {String|Boolean}
 */
function getIEVersion() {
  var _navigator = navigator,
      userAgent = _navigator.userAgent,
      appVersion = _navigator.appVersion;

  if (appVersion.indexOf('MSIE') !== -1) {
    return appVersion.match(/MSIE\s+?([0-9]+)/i)[1];
  } else if (userAgent.indexOf('Trident') !== -1) {
    return userAgent.match(/rv:([0-9]+)/i)[1];
  } else {
    return false;
  }
}

/**
 * Checks if the current browser is an IE 10
 * @return {Boolean}
 */
function isIE10() {
  var version = this.getIEVersion();
  return version !== false && version === 10;
}

/**
 * Checks if the current browser is an IE 11
 * @return {Boolean}
 */
function isIE11() {
  var version = this.getIEVersion();
  return version !== false && version === 11;
}

/**
 * Checks if the current browser is an IE with a version number lower than or equal to the given
 * version
 * @param  {String}  version
 * @return {Boolean}
 */
function isIElte(version) {
  var browserVersion = this.getIEVersion();
  if (browserVersion === false) return false;
  return browserVersion <= version;
}

/* harmony default export */ __webpack_exports__["a"] = ({
  getIEVersion: getIEVersion,
  isIE10: isIE10,
  isIE11: isIE11,
  isIElte: isIElte
});

/***/ }),
/* 478 */
/***/ (function(module, exports) {

module.exports = {"pesdk.adjustments.button.reset":"editor.controls.adjustments.reset","pesdk.adjustments.text.brightness":"editor.controls.adjustments.items.brightness","pesdk.adjustments.text.clarity":"editor.controls.adjustments.items.clarity","pesdk.adjustments.text.contrast":"editor.controls.adjustments.items.contrast","pesdk.adjustments.text.exposure":"editor.controls.adjustments.items.exposure","pesdk.adjustments.text.gamma":"editor.controls.adjustments.items.gamma","pesdk.adjustments.text.highlights":"editor.controls.adjustments.items.highlights","pesdk.adjustments.text.saturation":"editor.controls.adjustments.items.saturation","pesdk.adjustments.text.shadows":"editor.controls.adjustments.items.shadows","pesdk.adjustments.title.basics":"editor.controls.adjustments.sections.basics","pesdk.adjustments.title.name":"editor.controls.adjustments.title","pesdk.adjustments.title.refinements":"editor.controls.adjustments.sections.refinements","pesdk.brush.title.hardness":"editor.controls.brush.hardness","pesdk.brush.title.name":"editor.controls.brush.title","pesdk.brush.title.settings":"editor.controls.brush.settings","pesdk.brush.title.width":"editor.controls.brush.width","pesdk.common.button.cancel":"editor.cancel","pesdk.common.text.loading":"loading.loading","pesdk.common.title.error":"errors.title","pesdk.editor.button.discardChangesWarningDiscard":"warnings.discardChanges.buttons.discard","pesdk.editor.button.discardChangesWarningKeep":"warnings.discardChanges.buttons.keep","pesdk.editor.button.export":"editor.export","pesdk.editor.button.newImageChangesLostWarningNo":"warnings.newImage_changesLost.buttons.no","pesdk.editor.button.newImageChangesLostWarningYes":"warnings.newImage_changesLost.buttons.yes","pesdk.editor.text.discardChangesWarning":"warnings.discardChanges.text","pesdk.editor.text.fontLoadingError":"errors.fontLoadingError.text","pesdk.editor.text.imageLoadingError":"errors.imageLoadingError.text","pesdk.editor.text.imageResizedWarning_maxDimensions":"warnings.imageResized_maxDimensions.text","pesdk.editor.text.imageResizedWarning_maxMegaPixels":"warnings.imageResized_maxMegaPixels.text","pesdk.editor.text.invalidFileTypeError":"errors.invalidFileType.text","pesdk.editor.text.loadingFonts":"loading.fonts","pesdk.editor.text.newImageChangesLostWarning":"warnings.newImage_changesLost.text","pesdk.editor.text.renderingError":"errors.renderingError.text","pesdk.editor.text.resizing":"loading.resizing","pesdk.editor.text.webcamUnavailableError":"errors.webcamUnavailable.text","pesdk.editor.title.discardChangesWarning":"warnings.discardChanges.title","pesdk.editor.title.fontLoadingError":"errors.fontLoadingError.title","pesdk.editor.title.imageResizedWarning_maxDimensions":"warnings.imageResized_maxDimensions.title","pesdk.editor.title.imageResizedWarning_maxMegaPixels":"warnings.imageResized_maxMegaPixels.title","pesdk.editor.title.newImageChangesLostWarning":"warnings.newImage_changesLost.title","pesdk.filter.asset.identity":"editor.controls.filter.filters.identity","pesdk.filter.asset.imgly_lut_ad1920":"editor.controls.filter.filters.imgly_lut_ad1920","pesdk.filter.asset.imgly_lut_ancient":"editor.controls.filter.filters.imgly_lut_ancient","pesdk.filter.asset.imgly_lut_bleached":"editor.controls.filter.filters.imgly_lut_bleached","pesdk.filter.asset.imgly_lut_bleachedblue":"editor.controls.filter.filters.imgly_lut_bleachedblue","pesdk.filter.asset.imgly_lut_blues":"editor.controls.filter.filters.imgly_lut_blues","pesdk.filter.asset.imgly_lut_blueshadows":"editor.controls.filter.filters.imgly_lut_blueshadows","pesdk.filter.asset.imgly_lut_breeze":"editor.controls.filter.filters.imgly_lut_breeze","pesdk.filter.asset.imgly_lut_bw":"editor.controls.filter.filters.imgly_lut_bw","pesdk.filter.asset.imgly_lut_celsius":"editor.controls.filter.filters.imgly_lut_celsius","pesdk.filter.asset.imgly_lut_chest":"editor.controls.filter.filters.imgly_lut_chest","pesdk.filter.asset.imgly_lut_classic":"editor.controls.filter.filters.imgly_lut_classic","pesdk.filter.asset.imgly_lut_colorful":"editor.controls.filter.filters.imgly_lut_colorful","pesdk.filter.asset.imgly_lut_cool":"editor.controls.filter.filters.imgly_lut_cool","pesdk.filter.asset.imgly_lut_cottoncandy":"editor.controls.filter.filters.imgly_lut_cottoncandy","pesdk.filter.asset.imgly_lut_creamy":"editor.controls.filter.filters.imgly_lut_creamy","pesdk.filter.asset.imgly_lut_eighties":"editor.controls.filter.filters.imgly_lut_eighties","pesdk.filter.asset.imgly_lut_elder":"editor.controls.filter.filters.imgly_lut_elder","pesdk.filter.asset.imgly_lut_evening":"editor.controls.filter.filters.imgly_lut_evening","pesdk.filter.asset.imgly_lut_fall":"editor.controls.filter.filters.imgly_lut_fall","pesdk.filter.asset.imgly_lut_fixie":"editor.controls.filter.filters.imgly_lut_fixie","pesdk.filter.asset.imgly_lut_food":"editor.controls.filter.filters.imgly_lut_food","pesdk.filter.asset.imgly_lut_fridge":"editor.controls.filter.filters.imgly_lut_fridge","pesdk.filter.asset.imgly_lut_front":"editor.controls.filter.filters.imgly_lut_front","pesdk.filter.asset.imgly_lut_glam":"editor.controls.filter.filters.imgly_lut_glam","pesdk.filter.asset.imgly_lut_gobblin":"editor.controls.filter.filters.imgly_lut_gobblin","pesdk.filter.asset.imgly_lut_highcarb":"editor.controls.filter.filters.imgly_lut_highcarb","pesdk.filter.asset.imgly_lut_highcontrast":"editor.controls.filter.filters.imgly_lut_highcontrast","pesdk.filter.asset.imgly_lut_k1":"editor.controls.filter.filters.imgly_lut_k1","pesdk.filter.asset.imgly_lut_k2":"editor.controls.filter.filters.imgly_lut_k2","pesdk.filter.asset.imgly_lut_k6":"editor.controls.filter.filters.imgly_lut_k6","pesdk.filter.asset.imgly_lut_kdynamic":"editor.controls.filter.filters.imgly_lut_kdynamic","pesdk.filter.asset.imgly_lut_keen":"editor.controls.filter.filters.imgly_lut_keen","pesdk.filter.asset.imgly_lut_lenin":"editor.controls.filter.filters.imgly_lut_lenin","pesdk.filter.asset.imgly_lut_litho":"editor.controls.filter.filters.imgly_lut_litho","pesdk.filter.asset.imgly_lut_lomo100":"editor.controls.filter.filters.imgly_lut_lomo100","pesdk.filter.asset.imgly_lut_lucid":"editor.controls.filter.filters.imgly_lut_lucid","pesdk.filter.asset.imgly_lut_mellow":"editor.controls.filter.filters.imgly_lut_mellow","pesdk.filter.asset.imgly_lut_neat":"editor.controls.filter.filters.imgly_lut_neat","pesdk.filter.asset.imgly_lut_nogreen":"editor.controls.filter.filters.imgly_lut_nogreen","pesdk.filter.asset.imgly_lut_orchid":"editor.controls.filter.filters.imgly_lut_orchid","pesdk.filter.asset.imgly_lut_pale":"editor.controls.filter.filters.imgly_lut_pale","pesdk.filter.asset.imgly_lut_pitched":"editor.controls.filter.filters.imgly_lut_pitched","pesdk.filter.asset.imgly_lut_plate":"editor.controls.filter.filters.imgly_lut_plate","pesdk.filter.asset.imgly_lut_pola669":"editor.controls.filter.filters.imgly_lut_pola669","pesdk.filter.asset.imgly_lut_polasx":"editor.controls.filter.filters.imgly_lut_polasx","pesdk.filter.asset.imgly_lut_pro400":"editor.controls.filter.filters.imgly_lut_pro400","pesdk.filter.asset.imgly_lut_quozi":"editor.controls.filter.filters.imgly_lut_quozi","pesdk.filter.asset.imgly_lut_sepiahigh":"editor.controls.filter.filters.imgly_lut_sepiahigh","pesdk.filter.asset.imgly_lut_settled":"editor.controls.filter.filters.imgly_lut_settled","pesdk.filter.asset.imgly_lut_seventies":"editor.controls.filter.filters.imgly_lut_seventies","pesdk.filter.asset.imgly_lut_sin":"editor.controls.filter.filters.imgly_lut_sin","pesdk.filter.asset.imgly_lut_soft":"editor.controls.filter.filters.imgly_lut_soft","pesdk.filter.asset.imgly_lut_steel":"editor.controls.filter.filters.imgly_lut_steel","pesdk.filter.asset.imgly_lut_summer":"editor.controls.filter.filters.imgly_lut_summer","pesdk.filter.asset.imgly_lut_sunset":"editor.controls.filter.filters.imgly_lut_sunset","pesdk.filter.asset.imgly_lut_tender":"editor.controls.filter.filters.imgly_lut_tender","pesdk.filter.asset.imgly_lut_texas":"editor.controls.filter.filters.imgly_lut_texas","pesdk.filter.asset.imgly_lut_twilight":"editor.controls.filter.filters.imgly_lut_twilight","pesdk.filter.asset.imgly_lut_winter":"editor.controls.filter.filters.imgly_lut_winter","pesdk.filter.asset.imgly_lut_x400":"editor.controls.filter.filters.imgly_lut_x400","pesdk.filter.title.name":"editor.controls.filter.title","pesdk.focus.button.gaussian":"editor.controls.focus.items.gaussian","pesdk.focus.button.linear":"editor.controls.focus.items.linear","pesdk.focus.button.mirrored":"editor.controls.focus.items.mirrored","pesdk.focus.button.none":"editor.controls.focus.items.none","pesdk.focus.button.radial":"editor.controls.focus.items.radial","pesdk.focus.title.name":"editor.controls.focus.title","pesdk.frame.asset.imgly_frame_art_decor":"editor.controls.frame.frames.imgly_frame_art_decor","pesdk.frame.asset.imgly_frame_black_passepartout":"editor.controls.frame.frames.imgly_frame_black_passepartout","pesdk.frame.asset.imgly_frame_dia":"editor.controls.frame.frames.imgly_frame_dia","pesdk.frame.asset.imgly_frame_lowpoly_shadow":"editor.controls.frame.frames.imgly_frame_lowpoly_shadow","pesdk.frame.asset.imgly_frame_wood_passepartout":"editor.controls.frame.frames.imgly_frame_wood_passepartout","pesdk.frame.button.fill":"editor.controls.frame.fill","pesdk.frame.button.replace":"editor.controls.frame.replace","pesdk.frame.title.name":"editor.controls.frame.title","pesdk.frame.title.opacity":"editor.controls.frame.opacity","pesdk.frame.title.width":"editor.controls.frame.width","pesdk.library.button.fileDropZone":"editor.controls.library.fileDropZone","pesdk.library.button.fileDropZoneHovered":"editor.controls.library.fileDropZoneHovered","pesdk.library.placeholder.search":"editor.controls.library.search","pesdk.library.text.noResults":"editor.controls.library.noResults","pesdk.library.title.name":"editor.controls.library.title","pesdk.overlay.asset.imgly_overlay_bokeh":"editor.controls.overlay.overlays.imgly_overlay_bokeh","pesdk.overlay.asset.imgly_overlay_chop":"editor.controls.overlay.overlays.imgly_overlay_chop","pesdk.overlay.asset.imgly_overlay_clouds":"editor.controls.overlay.overlays.imgly_overlay_clouds","pesdk.overlay.asset.imgly_overlay_golden":"editor.controls.overlay.overlays.imgly_overlay_golden","pesdk.overlay.asset.imgly_overlay_grain":"editor.controls.overlay.overlays.imgly_overlay_grain","pesdk.overlay.asset.imgly_overlay_hearts":"editor.controls.overlay.overlays.imgly_overlay_hearts","pesdk.overlay.asset.imgly_overlay_lightleak1":"editor.controls.overlay.overlays.imgly_overlay_lightleak1","pesdk.overlay.asset.imgly_overlay_lightleak2":"editor.controls.overlay.overlays.imgly_overlay_lightleak2","pesdk.overlay.asset.imgly_overlay_metal":"editor.controls.overlay.overlays.imgly_overlay_metal","pesdk.overlay.asset.imgly_overlay_mosaic":"editor.controls.overlay.overlays.imgly_overlay_mosaic","pesdk.overlay.asset.imgly_overlay_painting":"editor.controls.overlay.overlays.imgly_overlay_painting","pesdk.overlay.asset.imgly_overlay_paper":"editor.controls.overlay.overlays.imgly_overlay_paper","pesdk.overlay.asset.imgly_overlay_rain":"editor.controls.overlay.overlays.imgly_overlay_rain","pesdk.overlay.asset.imgly_overlay_vintage":"editor.controls.overlay.overlays.imgly_overlay_vintage","pesdk.overlay.asset.imgly_overlay_wall1":"editor.controls.overlay.overlays.imgly_overlay_wall1","pesdk.overlay.asset.imgly_overlay_wall2":"editor.controls.overlay.overlays.imgly_overlay_wall2","pesdk.overlay.asset.imgly_overlay_wood":"editor.controls.overlay.overlays.imgly_overlay_wood","pesdk.overlay.button.none":"editor.controls.overlay.overlays.none","pesdk.overlay.title.blending":"editor.controls.overlay.blendModes.blending","pesdk.overlay.title.colorBurn":"editor.controls.overlay.blendModes.colorBurn","pesdk.overlay.title.darken":"editor.controls.overlay.blendModes.darken","pesdk.overlay.title.hardLight":"editor.controls.overlay.blendModes.hardLight","pesdk.overlay.title.lighten":"editor.controls.overlay.blendModes.lighten","pesdk.overlay.title.multiply":"editor.controls.overlay.blendModes.multiply","pesdk.overlay.title.name":"editor.controls.overlay.title","pesdk.overlay.title.none":"editor.controls.overlay.blendModes.none","pesdk.overlay.title.normal":"editor.controls.overlay.blendModes.normal","pesdk.overlay.title.overlay":"editor.controls.overlay.blendModes.overlay","pesdk.overlay.title.screen":"editor.controls.overlay.blendModes.screen","pesdk.overlay.title.softLight":"editor.controls.overlay.blendModes.softLight","pesdk.sticker.asset.imgly_sticker_emoticons":"editor.controls.sticker.stickerCategories.imgly_sticker_emoticons","pesdk.sticker.asset.imgly_sticker_emoticons_alien":"editor.controls.sticker.stickers.imgly_sticker_emoticons_alien","pesdk.sticker.asset.imgly_sticker_emoticons_angel":"editor.controls.sticker.stickers.imgly_sticker_emoticons_angel","pesdk.sticker.asset.imgly_sticker_emoticons_angry":"editor.controls.sticker.stickers.imgly_sticker_emoticons_angry","pesdk.sticker.asset.imgly_sticker_emoticons_anxious":"editor.controls.sticker.stickers.imgly_sticker_emoticons_anxious","pesdk.sticker.asset.imgly_sticker_emoticons_asleep":"editor.controls.sticker.stickers.imgly_sticker_emoticons_asleep","pesdk.sticker.asset.imgly_sticker_emoticons_attention":"editor.controls.sticker.stickers.imgly_sticker_emoticons_attention","pesdk.sticker.asset.imgly_sticker_emoticons_baby_chicken":"editor.controls.sticker.stickers.imgly_sticker_emoticons_baby_chicken","pesdk.sticker.asset.imgly_sticker_emoticons_batman":"editor.controls.sticker.stickers.imgly_sticker_emoticons_batman","pesdk.sticker.asset.imgly_sticker_emoticons_beer":"editor.controls.sticker.stickers.imgly_sticker_emoticons_beer","pesdk.sticker.asset.imgly_sticker_emoticons_black":"editor.controls.sticker.stickers.imgly_sticker_emoticons_black","pesdk.sticker.asset.imgly_sticker_emoticons_blue":"editor.controls.sticker.stickers.imgly_sticker_emoticons_blue","pesdk.sticker.asset.imgly_sticker_emoticons_blush":"editor.controls.sticker.stickers.imgly_sticker_emoticons_blush","pesdk.sticker.asset.imgly_sticker_emoticons_boxer":"editor.controls.sticker.stickers.imgly_sticker_emoticons_boxer","pesdk.sticker.asset.imgly_sticker_emoticons_business":"editor.controls.sticker.stickers.imgly_sticker_emoticons_business","pesdk.sticker.asset.imgly_sticker_emoticons_chicken":"editor.controls.sticker.stickers.imgly_sticker_emoticons_chicken","pesdk.sticker.asset.imgly_sticker_emoticons_cool":"editor.controls.sticker.stickers.imgly_sticker_emoticons_cool","pesdk.sticker.asset.imgly_sticker_emoticons_cry":"editor.controls.sticker.stickers.imgly_sticker_emoticons_cry","pesdk.sticker.asset.imgly_sticker_emoticons_deceased":"editor.controls.sticker.stickers.imgly_sticker_emoticons_deceased","pesdk.sticker.asset.imgly_sticker_emoticons_devil":"editor.controls.sticker.stickers.imgly_sticker_emoticons_devil","pesdk.sticker.asset.imgly_sticker_emoticons_duckface":"editor.controls.sticker.stickers.imgly_sticker_emoticons_duckface","pesdk.sticker.asset.imgly_sticker_emoticons_furious":"editor.controls.sticker.stickers.imgly_sticker_emoticons_furious","pesdk.sticker.asset.imgly_sticker_emoticons_grin":"editor.controls.sticker.stickers.imgly_sticker_emoticons_grin","pesdk.sticker.asset.imgly_sticker_emoticons_guitar":"editor.controls.sticker.stickers.imgly_sticker_emoticons_guitar","pesdk.sticker.asset.imgly_sticker_emoticons_harry_potter":"editor.controls.sticker.stickers.imgly_sticker_emoticons_harry_potter","pesdk.sticker.asset.imgly_sticker_emoticons_hippie":"editor.controls.sticker.stickers.imgly_sticker_emoticons_hippie","pesdk.sticker.asset.imgly_sticker_emoticons_hitman":"editor.controls.sticker.stickers.imgly_sticker_emoticons_hitman","pesdk.sticker.asset.imgly_sticker_emoticons_humourous":"editor.controls.sticker.stickers.imgly_sticker_emoticons_humourous","pesdk.sticker.asset.imgly_sticker_emoticons_idea":"editor.controls.sticker.stickers.imgly_sticker_emoticons_idea","pesdk.sticker.asset.imgly_sticker_emoticons_impatient":"editor.controls.sticker.stickers.imgly_sticker_emoticons_impatient","pesdk.sticker.asset.imgly_sticker_emoticons_kiss":"editor.controls.sticker.stickers.imgly_sticker_emoticons_kiss","pesdk.sticker.asset.imgly_sticker_emoticons_kisses":"editor.controls.sticker.stickers.imgly_sticker_emoticons_kisses","pesdk.sticker.asset.imgly_sticker_emoticons_laugh":"editor.controls.sticker.stickers.imgly_sticker_emoticons_laugh","pesdk.sticker.asset.imgly_sticker_emoticons_loud_cry":"editor.controls.sticker.stickers.imgly_sticker_emoticons_loud_cry","pesdk.sticker.asset.imgly_sticker_emoticons_loving":"editor.controls.sticker.stickers.imgly_sticker_emoticons_loving","pesdk.sticker.asset.imgly_sticker_emoticons_masked":"editor.controls.sticker.stickers.imgly_sticker_emoticons_masked","pesdk.sticker.asset.imgly_sticker_emoticons_music":"editor.controls.sticker.stickers.imgly_sticker_emoticons_music","pesdk.sticker.asset.imgly_sticker_emoticons_nerd":"editor.controls.sticker.stickers.imgly_sticker_emoticons_nerd","pesdk.sticker.asset.imgly_sticker_emoticons_ninja":"editor.controls.sticker.stickers.imgly_sticker_emoticons_ninja","pesdk.sticker.asset.imgly_sticker_emoticons_not_speaking_to_you":"editor.controls.sticker.stickers.imgly_sticker_emoticons_not_speaking_to_you","pesdk.sticker.asset.imgly_sticker_emoticons_pig":"editor.controls.sticker.stickers.imgly_sticker_emoticons_pig","pesdk.sticker.asset.imgly_sticker_emoticons_pumpkin":"editor.controls.sticker.stickers.imgly_sticker_emoticons_pumpkin","pesdk.sticker.asset.imgly_sticker_emoticons_question":"editor.controls.sticker.stickers.imgly_sticker_emoticons_question","pesdk.sticker.asset.imgly_sticker_emoticons_rabbit":"editor.controls.sticker.stickers.imgly_sticker_emoticons_rabbit","pesdk.sticker.asset.imgly_sticker_emoticons_sad":"editor.controls.sticker.stickers.imgly_sticker_emoticons_sad","pesdk.sticker.asset.imgly_sticker_emoticons_sick":"editor.controls.sticker.stickers.imgly_sticker_emoticons_sick","pesdk.sticker.asset.imgly_sticker_emoticons_skateboard":"editor.controls.sticker.stickers.imgly_sticker_emoticons_skateboard","pesdk.sticker.asset.imgly_sticker_emoticons_skull":"editor.controls.sticker.stickers.imgly_sticker_emoticons_skull","pesdk.sticker.asset.imgly_sticker_emoticons_sleepy":"editor.controls.sticker.stickers.imgly_sticker_emoticons_sleepy","pesdk.sticker.asset.imgly_sticker_emoticons_smile":"editor.controls.sticker.stickers.imgly_sticker_emoticons_smile","pesdk.sticker.asset.imgly_sticker_emoticons_smoking":"editor.controls.sticker.stickers.imgly_sticker_emoticons_smoking","pesdk.sticker.asset.imgly_sticker_emoticons_sobbing":"editor.controls.sticker.stickers.imgly_sticker_emoticons_sobbing","pesdk.sticker.asset.imgly_sticker_emoticons_star":"editor.controls.sticker.stickers.imgly_sticker_emoticons_star","pesdk.sticker.asset.imgly_sticker_emoticons_steaming_furious":"editor.controls.sticker.stickers.imgly_sticker_emoticons_steaming_furious","pesdk.sticker.asset.imgly_sticker_emoticons_sunbathing":"editor.controls.sticker.stickers.imgly_sticker_emoticons_sunbathing","pesdk.sticker.asset.imgly_sticker_emoticons_tired":"editor.controls.sticker.stickers.imgly_sticker_emoticons_tired","pesdk.sticker.asset.imgly_sticker_emoticons_tongue_out_wink":"editor.controls.sticker.stickers.imgly_sticker_emoticons_tongue_out_wink","pesdk.sticker.asset.imgly_sticker_emoticons_wave":"editor.controls.sticker.stickers.imgly_sticker_emoticons_wave","pesdk.sticker.asset.imgly_sticker_emoticons_wide_grin":"editor.controls.sticker.stickers.imgly_sticker_emoticons_wide_grin","pesdk.sticker.asset.imgly_sticker_emoticons_wink":"editor.controls.sticker.stickers.imgly_sticker_emoticons_wink","pesdk.sticker.asset.imgly_sticker_emoticons_wrestler":"editor.controls.sticker.stickers.imgly_sticker_emoticons_wrestler","pesdk.sticker.asset.imgly_sticker_shapes":"editor.controls.sticker.stickerCategories.imgly_sticker_shapes","pesdk.sticker.asset.imgly_sticker_shapes_arrow_02":"editor.controls.sticker.stickers.imgly_sticker_shapes_arrow_02","pesdk.sticker.asset.imgly_sticker_shapes_arrow_03":"editor.controls.sticker.stickers.imgly_sticker_shapes_arrow_03","pesdk.sticker.asset.imgly_sticker_shapes_badge_01":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_01","pesdk.sticker.asset.imgly_sticker_shapes_badge_04":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_04","pesdk.sticker.asset.imgly_sticker_shapes_badge_06":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_06","pesdk.sticker.asset.imgly_sticker_shapes_badge_08":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_08","pesdk.sticker.asset.imgly_sticker_shapes_badge_11":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_11","pesdk.sticker.asset.imgly_sticker_shapes_badge_12":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_12","pesdk.sticker.asset.imgly_sticker_shapes_badge_13":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_13","pesdk.sticker.asset.imgly_sticker_shapes_badge_15":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_15","pesdk.sticker.asset.imgly_sticker_shapes_badge_18":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_18","pesdk.sticker.asset.imgly_sticker_shapes_badge_19":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_19","pesdk.sticker.asset.imgly_sticker_shapes_badge_20":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_20","pesdk.sticker.asset.imgly_sticker_shapes_badge_28":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_28","pesdk.sticker.asset.imgly_sticker_shapes_badge_32":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_32","pesdk.sticker.asset.imgly_sticker_shapes_badge_35":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_35","pesdk.sticker.asset.imgly_sticker_shapes_badge_36":"editor.controls.sticker.stickers.imgly_sticker_shapes_badge_36","pesdk.sticker.asset.imgly_sticker_shapes_spray_01":"editor.controls.sticker.stickers.imgly_sticker_shapes_spray_01","pesdk.sticker.asset.imgly_sticker_shapes_spray_03":"editor.controls.sticker.stickers.imgly_sticker_shapes_spray_03","pesdk.sticker.asset.imgly_sticker_shapes_spray_04":"editor.controls.sticker.stickers.imgly_sticker_shapes_spray_04","pesdk.sticker.button.fill":"editor.controls.sticker.fill","pesdk.sticker.button.new":"editor.controls.sticker.new","pesdk.sticker.button.replace":"editor.controls.sticker.replace","pesdk.sticker.text.stickerLoadingError":"errors.stickerLoadingError.text","pesdk.sticker.title.name":"editor.controls.sticker.title","pesdk.sticker.title.opacity":"editor.controls.sticker.opacity","pesdk.text.button.new":"editor.controls.text.new","pesdk.text.placeholder.defaultText":"editor.controls.text.defaultText","pesdk.text.title.background":"editor.controls.text.background","pesdk.text.title.font":"editor.controls.text.font","pesdk.text.title.line":"editor.controls.text.line","pesdk.text.title.name":"editor.controls.text.title","pesdk.text.title.size":"editor.controls.text.size","pesdk.text.title.spacing":"editor.controls.text.spacing","pesdk.textdesign.title.name":"editor.controls.textdesign.title","pesdk.transform.asset.imgly_transforms_common.imgly_transform_common_16-9":"editor.controls.transform.ratios.imgly_transforms_common.imgly_transform_common_16-9","pesdk.transform.asset.imgly_transforms_common.imgly_transform_common_4-3":"editor.controls.transform.ratios.imgly_transforms_common.imgly_transform_common_4-3","pesdk.transform.asset.imgly_transforms_common.imgly_transform_common_custom":"editor.controls.transform.ratios.imgly_transforms_common.imgly_transform_common_custom","pesdk.transform.asset.imgly_transforms_common.imgly_transform_common_square":"editor.controls.transform.ratios.imgly_transforms_common.imgly_transform_common_square","pesdk.transform.asset.imgly_transforms_common.name":"editor.controls.transform.ratios.imgly_transforms_common.name","pesdk.transform.asset.imgly_transforms_facebook.imgly_transform_facebook_ad":"editor.controls.transforms.ratios.imgly_transforms_facebook.imgly_transform_facebook_ad","pesdk.transform.asset.imgly_transforms_facebook.imgly_transform_facebook_cover":"editor.controls.transforms.ratios.imgly_transforms_facebook.imgly_transform_facebook_cover","pesdk.transform.asset.imgly_transforms_facebook.imgly_transform_facebook_post":"editor.controls.transforms.ratios.imgly_transforms_facebook.imgly_transform_facebook_post","pesdk.transform.asset.imgly_transforms_facebook.imgly_transform_facebook_profile":"editor.controls.transforms.ratios.imgly_transforms_facebook.imgly_transform_facebook_profile","pesdk.transform.asset.imgly_transforms_facebook.name":"editor.controls.transform.ratios.imgly_transforms_facebook.name","pesdk.transform.button.reset":"editor.controls.transform.reset","pesdk.transform.placeholder.height":"editor.controls.transform.dimensions.height","pesdk.transform.placeholder.width":"editor.controls.transform.dimensions.width","pesdk.transform.title.name":"editor.controls.transform.title"};

/***/ }),
/* 479 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__events__ = __webpack_require__(480);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__defaults__ = __webpack_require__(481);
/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




/**
 * @todo Harmonize keys: Don't wrap them in quotes
 */
/* harmony default export */ __webpack_exports__["a"] = ({
  EVENTS: __WEBPACK_IMPORTED_MODULE_0__events__["a" /* default */],
  DEFAULTS: __WEBPACK_IMPORTED_MODULE_1__defaults__["a" /* default */]
});

/***/ }),
/* 480 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_constants_index__ = __webpack_require__(90);


var _extends = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default.a || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };



/**
 * Events used by the UI
 * @typedef {Object} Events
 * @enum {String}
 * @alias Events
 * @memberof PhotoEditorSDK.UI.DesktopUI
 *
 * @property {String} EXPORT  - Emitted when an image is exported from the editor
 * @property {String} LOAD    - Emitted when a previously saved editor serialization is loaded
 * @property {String} SAVE    - Emitted when the current editor configuration was serialized to a document
 * @property {String} CLOSE   - Emitted when the editor is closed
 *
 * @property {String} OPERATION_CREATED - Emitted when an {@link Operation} is created
 * @property {String} OPERATION_UPDATED - Emitted when an {@link Operation} is updated
 * @property {String} OPERATION_REMOVED - Emitted when an {@link Operation} is removed
 *
 * @property {String} EDITOR_READY - Emitted when the editor has finished loading and is ready to be used
 *
 * @property {String} WINDOW_RESIZE - Emitted when the window (not the editor) is resized
 * @property {String} EDITOR_RESIZE - Emitted when the editor is resized
 *
 * @property {String} ZOOM          - Emitted when the editor image zoom level starts changing
 * @property {String} ZOOM_CHANGED  - Emitted every time the editor image zoom level changes
 * @property {String} ZOOM_DONE     - Emitted when the zoom level has finished changing
 *
 * @property {String} HISTORY_UNDO        - Emitted after the last edit operation is undone
 * @property {String} HISTORY_UPDATED     - Emitted when the edit history is updated with a new snapshot
 * @property {String} HISTORY_REDO        - Emitted after the previously undone operation is reapplied
 * @property {String} HISTORY_BEFORE_REDO - Emitted before the previously undone operation is reapplied
 *
 * @property {String} FEATURES_DISABLED   - Emitted when editor features have been disabled
 * @property {String} FEATURES_ENABLED    - Emitted when editor features have been enabled
 * @property {String} FEATURES_UPDATED    - Emitted when the available editor features have changed
 *
 * @property {String} TEXT_SCALED - Emitted when text is scaled in the editor
 *
 * @property {String} TRANSFORM_RESIZE        - Emitted when the image has been resized using the dimension inputs
 * @property {String} TRANSFORM_REAPPLY_RATIO - Emitted when the original transform ratio has been reapplied
 * @property {String} TRANSFORM_AFTER_EDIT    - Emitted after the transform has been edited (resized or shifted)
 *
 * @property {String} ADDED_STICKER - Emitted when a new sticker has been added to the image
 *
 * @property {String} SPRITES_DESELECTED - Emitted when the selected sprite has been manually deselected in the editor (and no other sprite is selected afterwards)
 *
 */
// Figure out a way to share documentation as well
var Events = _extends({}, __WEBPACK_IMPORTED_MODULE_1__shared_constants_index__["a" /* Events */], {

  LOAD: 'load',
  SAVE: 'save',

  EDITOR_RESIZE: 'editor:resize',

  ZOOM: 'editor:zoom',
  ZOOM_CHANGED: 'editor:zoom_changed',

  HISTORY_REDO: 'history:redo',
  HISTORY_BEFORE_REDO: 'history:before-redo',

  TEXT_SCALED: 'editor:text:scaled',

  TRANSFORM_RESIZE: 'transform:resize',
  TRANSFORM_AFTER_EDIT: 'transform:after-edit',

  ADDED_STICKER: 'sticker:added-sticker',

  SPRITES_DESELECTED: 'editor:sprite:deselected-all',

  CANVAS_FOCUS: 'canvas:focus'
});

/* harmony default export */ __webpack_exports__["a"] = (Events);

/***/ }),
/* 481 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk__ = __webpack_require__(31);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_photoeditorsdk__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__fonts__ = __webpack_require__(482);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__text_design_fonts__ = __webpack_require__(483);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__transform_ratio_categories__ = __webpack_require__(484);





var BRUSHES = [];
if (typeof __WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default.a.Operations.SpriteOperation !== 'undefined') {
  BRUSHES.push(__WEBPACK_IMPORTED_MODULE_0_photoeditorsdk___default.a.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush);
}

/* harmony default export */ __webpack_exports__["a"] = ({
  TRANSFORM_RATIO_CATEGORIES: __WEBPACK_IMPORTED_MODULE_3__transform_ratio_categories__["a" /* default */],
  FONTS: __WEBPACK_IMPORTED_MODULE_1__fonts__["a" /* default */],
  TEXT_DESIGN_FONTS: __WEBPACK_IMPORTED_MODULE_2__text_design_fonts__["a" /* default */],
  BRUSHES: BRUSHES
});

/***/ }),
/* 482 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony default export */ __webpack_exports__["a"] = ([{
  fontFamily: 'Aleo',
  variations: [{
    identifier: 'imgly_font_aleo_bold',
    fontWeight: 'bold',
    provider: 'file',
    filePath: 'fonts/imgly_font_aleo_bold.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1919,
      descender: -409
    }
  }]
}, {
  fontFamily: 'Amatic SC',
  variations: [{
    identifier: 'imgly_font_amaticsc',
    fontWeight: 'normal',
    provider: 'file',
    filePath: 'fonts/imgly_font_amaticsc.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 2332,
      descender: -583
    }
  }]
}, {
  fontFamily: 'Bernier',
  variations: [{
    identifier: 'imgly_font_bernier_regular',
    fontWeight: 'normal',
    provider: 'file',
    filePath: 'fonts/imgly_font_bernier_regular.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 2007,
      descender: -552
    }
  }]
}, {
  fontFamily: 'Cheque',
  variations: [{
    identifier: 'imgly_font_cheque_regular',
    fontWeight: 'normal',
    provider: 'file',
    filePath: 'fonts/imgly_font_cheque_regular.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1853,
      descender: -495
    }
  }]
}, {
  fontFamily: 'Open Sans',
  variations: [{
    identifier: 'imgly_font_open_sans_bold',
    fontWeight: 'bold',
    provider: 'file',
    filePath: 'fonts/imgly_font_open_sans_bold.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 2189,
      descender: -640
    }
  }]
}, {
  fontFamily: 'Gagalin',
  variations: [{
    identifier: 'imgly_font_gagalin_regular',
    fontWeight: 'normal',
    provider: 'file',
    filePath: 'fonts/imgly_font_gagalin_regular.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1987,
      descender: -628
    }
  }]
}, {
  fontFamily: 'Hagin',
  variations: [{
    identifier: 'imgly_font_hagin_caps_thin',
    fontWeight: 200,
    provider: 'file',
    filePath: 'fonts/imgly_font_hagin_caps_thin.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1964,
      descender: -482
    }
  }]
}, {
  fontFamily: 'Intro',
  variations: [{
    identifier: 'imgly_font_intro_inline',
    fontWeight: 'normal',
    provider: 'file',
    filePath: 'fonts/imgly_font_intro_inline.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1944,
      descender: -548
    }
  }]
}, {
  fontFamily: 'Lobster',
  variations: [{
    identifier: 'imgly_font_lobster',
    fontWeight: 'normal',
    provider: 'file',
    filePath: 'fonts/imgly_font_lobster.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 2048,
      descender: -552
    }
  }]
}, {
  fontFamily: 'Nexa',
  variations: [{
    identifier: 'imgly_font_nexa_script',
    fontWeight: 'normal',
    provider: 'file',
    filePath: 'fonts/imgly_font_nexa_script.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1835,
      descender: -663
    }
  }]
}, {
  fontFamily: 'Ostrich',
  variations: [{
    identifier: 'imgly_font_ostrich_sans_black',
    fontWeight: 800,
    provider: 'file',
    filePath: 'fonts/imgly_font_ostrich_sans_black.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1513,
      descender: -235
    }
  }, {
    identifier: 'imgly_font_ostrich_sans_bold',
    fontWeight: 'bold',
    provider: 'file',
    filePath: 'fonts/imgly_font_ostrich_sans_bold.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1513,
      descender: -235
    }
  }]
}, {
  fontFamily: 'Panton',
  variations: [{
    identifier: 'imgly_font_panton_black_italic_caps',
    fontWeight: 800,
    fontStyle: 'italic',
    provider: 'file',
    filePath: 'fonts/imgly_font_panton_blackitalic_caps.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 2033,
      descender: -572
    }
  }, {
    identifier: 'imgly_font_panton_light_italic_caps',
    fontWeight: 200,
    fontStyle: 'italic',
    provider: 'file',
    filePath: 'fonts/imgly_font_panton_lightitalic_caps.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1961,
      descender: -556
    }
  }]
}, {
  fontFamily: 'Perfograma',
  variations: [{
    identifier: 'imgly_font_perfograma',
    fontWeight: 'normal',
    provider: 'file',
    filePath: 'fonts/imgly_font_perfograma.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1982,
      descender: -842
    }
  }]
}, {
  fontFamily: 'Trashhand',
  variations: [{
    identifier: 'imgly_font_trash_hand',
    fontWeight: 'normal',
    provider: 'file',
    filePath: 'fonts/imgly_font_trash_hand.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1554,
      descender: -663
    }
  }]
}]);

/***/ }),
/* 483 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony default export */ __webpack_exports__["a"] = ([{
  fontFamily: 'Open Sans',
  variations: [{
    identifier: 'imgly_font_open_sans_bold',
    fontWeight: 'bold',
    provider: 'file',
    filePath: 'fonts/imgly_font_open_sans_bold.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 2189,
      descender: -640
    }
  }]
}, {
  fontFamily: 'Gagalin',
  variations: [{
    identifier: 'imgly_font_gagalin_regular',
    fontWeight: 'normal',
    provider: 'file',
    filePath: 'fonts/imgly_font_gagalin_regular.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1987,
      descender: -628
    }
  }]
}, {
  fontFamily: 'Abril Fatface',
  variations: [{
    identifier: 'imgly_font_abril_fatface_regular',
    fontWeight: 'normal',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_abril_fatface_regular.woff',
    textMetrics: {
      unitsPerEm: 1000,
      ascender: 1058,
      descender: -291
    }
  }]
}, {
  fontFamily: 'Montserrat Light',
  variations: [{
    identifier: 'imgly_font_montserrat_light',
    fontWeight: 'normal',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_montserrat_light.woff',
    textMetrics: {
      unitsPerEm: 1000,
      ascender: 968,
      descender: -251
    }
  }]
}, {
  fontFamily: 'Wolesbro',
  variations: [{
    identifier: 'imgly_font_wolesbro',
    fontWeight: 'normal',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_wolesbro.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1849,
      descender: -1123
    }
  }]
}, {
  fontFamily: 'Permanent Marker',
  variations: [{
    identifier: 'imgly_font_permanent_marker',
    fontWeight: 'normal',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_permanent_marker.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 2272,
      descender: -686
    }
  }]
}, {
  fontFamily: 'Panton Caps',
  variations: [{
    identifier: 'imgly_font_panton_light_italic_caps',
    fontWeight: 'lighter',
    fontStyle: 'italic',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_panton_light_italic_caps.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 1000,
      ascender: 940,
      descender: -260
    }
  }, {
    identifier: 'imgly_font_panton_black_italic_caps',
    fontWeight: 800,
    fontStyle: 'italic',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_panton_black_italic_caps.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 1000,
      ascender: 940,
      descender: -260
    }
  }, {
    identifier: 'imgly_font_panton_light_caps',
    fontWeight: 'lighter',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_panton_light_caps.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 1000,
      ascender: 940,
      descender: -260
    }
  }, {
    identifier: 'imgly_font_panton_black_caps',
    fontWeight: 800,
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_panton_black_caps.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 1000,
      ascender: 940,
      descender: -260
    }
  }]
}, {
  fontFamily: 'Amberlight',
  variations: [{
    identifier: 'imgly_font_amberlight',
    fontWeight: 'normal',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_amberlight.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 1000,
      ascender: 750,
      descender: -250
    }
  }]
}, {
  fontFamily: 'Ultra',
  variations: [{
    identifier: 'imgly_font_ultra',
    fontWeight: 'normal',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_ultra.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 2066,
      descender: -561
    }
  }]
}, {
  fontFamily: 'Galano Grotesque',
  variations: [{
    identifier: 'imgly_font_galano_grotesque_bold',
    fontWeight: 'bold',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_galano_grotesque_bold.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 1000,
      ascender: 800,
      descender: -200
    }
  }]
}, {
  fontFamily: 'Bungee Inline',
  variations: [{
    identifier: 'imgly_font_bungee_inline',
    fontWeight: 'normal',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_bungee_inline.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 1000,
      ascender: 860,
      descender: -140
    }
  }]
}, {
  fontFamily: 'Petit Formal Script',
  variations: [{
    identifier: 'imgly_font_petit_formal_script',
    fontWeight: 'normal',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_petit_formal_script.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 2033,
      descender: -527
    }
  }]
}, {
  fontFamily: 'Summer Font',
  variations: [{
    identifier: 'imgly_font_summer_font_light',
    fontWeight: 'normal',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_summer_font_light.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 2189,
      descender: -600
    }
  }]
}, {
  fontFamily: 'Handycheera',
  variations: [{
    identifier: 'imgly_font_handycheera_regular',
    fontWeight: 'normal',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_handycheera_regular.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 2199,
      descender: -808
    }
  }]
}, {
  fontFamily: 'Rasa',
  variations: [{
    identifier: 'imgly_font_rasa_regular',
    fontWeight: 'normal',
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_rasa_regular.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 2750,
      ascender: 2300,
      descender: -1050
    }
  }, {
    identifier: 'imgly_font_rasa_500',
    fontWeight: 500,
    fontStyle: 'normal',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_rasa_500.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 2750,
      ascender: 2300,
      descender: -1050
    }
  }]
}, {
  fontFamily: 'Campton Book',
  variations: [{
    identifier: 'imgly_font_campton_bold',
    fontWeight: 'bold',
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_campton_bold.woff',
    default: true,
    textMetrics: {
      unitsPerEm: 1000,
      ascender: 770,
      descender: -294
    }
  }]
}, {
  fontFamily: 'Ostrich',
  variations: [{
    identifier: 'imgly_font_ostrich_sans_black',
    fontWeight: 800,
    provider: 'file',
    filePath: 'fonts/imgly_font_ostrich_sans_black.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1513,
      descender: -235
    }
  }, {
    identifier: 'imgly_font_ostrich_sans_bold',
    fontWeight: 'bold',
    provider: 'file',
    filePath: 'fonts/imgly_font_ostrich_sans_bold.woff',
    textMetrics: {
      unitsPerEm: 2048,
      ascender: 1513,
      descender: -235
    }
  }, {
    identifier: 'imgly_font_ostrich_sans_heavy',
    fontWeight: 900,
    provider: 'file',
    filePath: 'text-design/fonts/imgly_font_ostrich_sans_heavy.woff',
    textMetrics: {
      unitsPerEm: 1000,
      ascender: 674,
      descender: 0
    }
  }]
}]);

/***/ }),
/* 484 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony default export */ __webpack_exports__["a"] = ([{
  identifier: 'imgly_transforms_common',
  defaultName: 'Common Ratios',
  ratios: [{
    identifier: 'imgly_transform_common_custom',
    defaultName: 'Custom',
    ratio: '*',
    selected: true
  }, {
    identifier: 'imgly_transform_common_square',
    defaultName: 'Square',
    ratio: 1
  }, {
    identifier: 'imgly_transform_common_4-3',
    defaultName: '4:3',
    ratio: 4 / 3
  }, {
    identifier: 'imgly_transform_common_16-9',
    defaultName: '16:9',
    ratio: 16 / 9
  }]
}, {
  identifier: 'imgly_transforms_facebook',
  defaultName: 'Facebook',
  ratios: [{
    identifier: 'imgly_transform_facebook_profile',
    defaultName: 'Profile Pic',
    dimensions: { x: 300, y: 300 },
    forceDimensions: false,
    lockDimensions: true
  }, {
    identifier: 'imgly_transform_facebook_ad',
    defaultName: 'Ad',
    dimensions: { x: 1200, y: 627 }
  }, {
    identifier: 'imgly_transform_facebook_post',
    defaultName: 'Post',
    dimensions: { x: 940, y: 788 }
  }, {
    identifier: 'imgly_transform_facebook_cover',
    defaultName: 'Cover',
    dimensions: { x: 851, y: 315 }
  }]
}]);

/***/ }),
/* 485 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_json_stringify__ = __webpack_require__(153);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_json_stringify___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_json_stringify__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_shared_exporter__ = __webpack_require__(486);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_shared_managers_font_manager__ = __webpack_require__(41);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__image_resizer__ = __webpack_require__(488);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_shared_downloader_file_downloader__ = __webpack_require__(198);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__editor_operations__ = __webpack_require__(489);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */









/**
 * The Editor class is an interface to the SDK (managing operations)
 * @class
 * @memberof PhotoEditorSDK.Server
 */

var Editor = function (_EventEmitter) {
  _inherits(Editor, _EventEmitter);

  function Editor(ui, options, mediator) {
    var shallow = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;

    _classCallCheck(this, Editor);

    var _this = _possibleConstructorReturn(this, (Editor.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Editor)).call(this));

    _this._ui = ui;
    _this._options = options;
    _this._mediator = mediator;
    _this._shallow = shallow;

    // this._initFonts()

    if (!shallow) {
      _this._initSDK();

      _this.operations = new __WEBPACK_IMPORTED_MODULE_10__editor_operations__["a" /* default */](_this, _this._sdk, _this._mediator);

      // this._initSerializers()
    }
    return _this;
  }

  // -------------------------------------------------------------------------- INITIALIZATION

  _createClass(Editor, [{
    key: '_initFonts',
    value: function _initFonts() {
      var options = __WEBPACK_IMPORTED_MODULE_5__globals__["k" /* SDKUtils */].defaults(this._options.editor.controlsOptions.text, {
        additionalFonts: [],
        replaceFonts: false,
        availableVariations: null
      });

      this._fontManager = new __WEBPACK_IMPORTED_MODULE_7_shared_managers_font_manager__["a" /* default */](this._ui, options);
      var fonts = this._fontManager.getFonts();
      var fontLoader = this._ui.getFontLoader();
      fontLoader.setFonts(fonts);
      fontLoader.load();
    }

    /**
     * Sets the given image to be rendered. If the image needs to be resized to fit into a
     * WebGL texture or to match the `maxMegaPixels` option, resizing is done before setting
     * the image.
     * @param {Image} image
     * @param {Boolean} resetEditor [description]
     */

  }, {
    key: 'setImage',
    value: function setImage() {
      var image = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._options.editor.image;
      var resetEditor = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      if (resetEditor) {
        this.reset();
      }

      var exif = null;
      exif = this._sdk.parseExif(image);
      this._setImage(image, exif);
      this._initWatermark();
    }

    /**
     * Initializes the watermark operation
     * @private
     */

  }, {
    key: '_initWatermark',
    value: function _initWatermark() {
      if (this._options.editor.watermarkImage) {
        this._watermarkOperation = this.operations.getOrCreate('watermark', {
          image: this._options.editor.watermarkImage
        });
      }
    }

    /**
     * Initializes the SDK
     * @private
     */

  }, {
    key: '_initSDK',
    value: function _initSDK() {
      var _options = this._options,
          logLevel = _options.logLevel,
          displayWelcomeMessage = _options.displayWelcomeMessage,
          debug = _options.debug,
          license = _options.license,
          crossOrigin = _options.crossOrigin;
      var _options$editor = this._options.editor,
          smoothDownscaling = _options$editor.smoothDownscaling,
          smoothUpscaling = _options$editor.smoothUpscaling,
          preferredRenderer = _options$editor.preferredRenderer,
          pixelRatio = _options$editor.pixelRatio,
          transparent = _options$editor.transparent,
          clearColor = _options$editor.clearColor;


      var clearColorInstance = void 0;
      if (Array.isArray(clearColor)) {
        clearColorInstance = __WEBPACK_IMPORTED_MODULE_5__globals__["b" /* Color */].fromArray(clearColor);
      } else if (typeof clearColor === 'string') {
        clearColorInstance = __WEBPACK_IMPORTED_MODULE_5__globals__["b" /* Color */].fromHex(clearColor);
      } else if (clearColor instanceof __WEBPACK_IMPORTED_MODULE_5__globals__["b" /* Color */]) {
        clearColorInstance = clearColor.clone();
      }

      var rendererOptions = {
        logLevel: logLevel,
        debug: debug,
        displayWelcomeMessage: displayWelcomeMessage,
        pixelRatio: pixelRatio,
        smoothDownscaling: smoothDownscaling,
        smoothUpscaling: smoothUpscaling,
        transparent: transparent,
        crossOrigin: crossOrigin,
        clearColor: clearColorInstance,
        license: license
      };
      this._sdk = new __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* SDK */](preferredRenderer, rendererOptions);
    }

    /**
     * Returns the maximum mega pixels
     * @return {Number}
     * @private
     */

  }, {
    key: 'getMaxMegapixels',
    value: function getMaxMegapixels() {
      var maxMegaPixels = this._options.editor.maxMegaPixels;

      return maxMegaPixels;
    }

    /**
     * Returns the crossOrigin value to be set to image elements, according
     * to the passed `crossOrigin` option.
     *
     * @returns String
     */

  }, {
    key: 'getCrossOrigin',
    value: function getCrossOrigin() {
      return __WEBPACK_IMPORTED_MODULE_5__globals__["k" /* SDKUtils */].getCrossOriginValue(this._options.crossOrigin || 'anonymous');
    }

    // -------------------------------------------------------------------------- MISC PUBLIC API

    /**
     * Returns the output sprite's current dimensions
     * @param {Boolean} incorporateSpriteScale = false
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getOutputDimensions',
    value: function getOutputDimensions() {
      var incorporateSpriteScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      return this._sdk.getOutputDimensions(incorporateSpriteScale);
    }

    /**
     * Returns the output texture's current dimensions
     * @param  {Boolean} incorporateSpriteScale = false
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getOutputTextureDimensions',
    value: function getOutputTextureDimensions() {
      var incorporateSpriteScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      return this._sdk.getOutputTextureDimensions(incorporateSpriteScale);
    }

    /**
     * Returns the final dimensions that the input image would have
     * after all existing operations have been applied
     * @param {Boolean} incorporateSpriteScale = false
     * @return {PhotoEditorSDK.Math.Vector2}
     */

  }, {
    key: 'getFinalDimensions',
    value: function getFinalDimensions() {
      var incorporateSpriteScale = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      return this._sdk.getFinalDimensions(incorporateSpriteScale);
    }

    /**
     * Sets the given image
     * @param {Image} image
     * @param {PhotoEditorSDK.EXIF} [exif]
     * @param {PhotoEditorSDK.Math.Vector2} [dimensions]
     * @private
     */

  }, {
    key: '_setImage',
    value: function _setImage() {
      var image = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._options.editor.image;
      var exif = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

      // Invalidate caches
      this._sdk.setAllOperationsToDirty();

      this._options.editor.image = image;
      this._sdk.setImage(image, exif);
    }
  }, {
    key: '_ensureImageIsResized',
    value: function _ensureImageIsResized() {
      var _this2 = this;

      var inputImage = this._sdk.getImage();
      var renderer = this._sdk.getRenderer();
      var maxMegaPixels = this.getMaxMegapixels();
      var maxPixels = maxMegaPixels ? maxMegaPixels * 1000000 : null;
      var maxDimensions = renderer.getMaxDimensions();
      var imageResizer = new __WEBPACK_IMPORTED_MODULE_8__image_resizer__["a" /* default */](inputImage, maxPixels, maxDimensions);

      if (!this._resizedImage && imageResizer.needsResize()) {
        return imageResizer.resize().then(function (_ref) {
          var canvas = _ref.canvas,
              dimensions = _ref.dimensions,
              reason = _ref.reason;

          _this2._resizedImage = canvas;
          _this2._sdk.setImage(canvas);
          return canvas;
        });
      } else {
        return __WEBPACK_IMPORTED_MODULE_5__globals__["h" /* Promise */].resolve(inputImage);
      }
    }

    /**
     * Exports an image
     * @param {Boolean} download = false
     * @return {Promise}
     */

  }, {
    key: 'export',
    value: function _export() {
      var _this3 = this;

      var download = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      if (this._watermarkOperation) {
        this._watermarkOperation.setEnabled(false);
      }

      // Invalidate caches
      this._sdk.setAllOperationsToDirty();

      return this._ensureImageIsResized().then(function (image) {
        var options = _this3._options.editor.export;
        var exporter = new __WEBPACK_IMPORTED_MODULE_6_shared_exporter__["a" /* default */](_this3._sdk, options, download);
        return exporter.export().then(function (output) {
          _this3.emit('export', output);
          _this3._mediator.emit(__WEBPACK_IMPORTED_MODULE_5__globals__["c" /* Constants */].EVENTS.EXPORT, output, _this3);

          if (_this3._watermarkOperation) {
            _this3._watermarkOperation.setEnabled(true);
            _this3._sdk.render();
          }

          // Invalidate caches
          _this3._sdk.setAllOperationsToDirty();

          return output;
        });
      });
    }

    /**
     * Broadcasts a transform to all operations that need to be changed
     * @param  {PhotoEditorSDK.Operations.TransformOperation} transformOperation
     * @param  {Object} options
     */

  }, {
    key: 'broadcastTransform',
    value: function broadcastTransform(transformOperation, options) {
      var _this4 = this;

      var transformChange = new __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* SDK */].Operations.TransformOperation.TransformChange(transformOperation, options);
      var transformableOperations = ['sprite', 'selective-blur', 'radial-focus', 'mirrored-focus', 'linear-focus', 'blur'];
      transformableOperations.forEach(function (identifier) {
        var operation = _this4.operations.get(identifier);
        if (!operation) {
          return;
        }
        operation.transform(transformChange);
      });
    }

    /**
     * Broadcasts a flip to all operations that need to be changed
     * @param  {String} direction
     */

  }, {
    key: 'broadcastFlip',
    value: function broadcastFlip(direction) {
      var _this5 = this;

      var flippableOperations = ['mirrored-focus', 'radial-focus', 'linear-focus', 'sprite', 'selective-blur'];
      flippableOperations.forEach(function (identifier) {
        var operation = _this5.operations.get(identifier);
        if (!operation) {
          return;
        }
        operation.flip(direction);
      });
    }

    /**
     * Broadcasts a rotation to all operations that need to be changed
     * @param  {Number} degrees
     */

  }, {
    key: 'broadcastRotate',
    value: function broadcastRotate(degrees) {
      var _this6 = this;

      var flippableOperations = ['transform', 'mirrored-focus', 'linear-focus', 'radial-focus', 'sprite', 'selective-blur'];
      flippableOperations.forEach(function (identifier) {
        var operation = _this6.operations.get(identifier);
        if (!operation) {
          return;
        }
        operation.rotate(degrees);
      });
    }

    // -------------------------------------------------------------------------- SERIALIZATION

    /**
     * Initializes the serializers and deserializers
     * @private
     */

  }, {
    key: '_initSerializers',
    value: function _initSerializers() {
      this._serializers = {
        '1.0.0': __webpack_require__(490).default,
        '1.0.1': __webpack_require__(497).default,
        '2.0.0': __webpack_require__(498).default,
        '3.0.0': __webpack_require__(502).default,
        '3.1.0': __webpack_require__(508).default,
        '3.2.0': __webpack_require__(509).default,
        '3.4.0': __webpack_require__(510).default,
        '3.5.0': __webpack_require__(512).default,
        '3.6.0': __webpack_require__(513).default,
        '3.7.0': __webpack_require__(514).default,
        '3.8.0': __webpack_require__(515).default
      };
    }

    /**
     * Serializes the editor state for the given version
     * @param  {Object} options = {}
     * @param  {String} version = '3.4.0'
     * @return {Promise}
     */

  }, {
    key: 'serialize',
    value: function serialize() {
      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      var version = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '3.8.0';

      var Serializer = this._serializers[version];
      if (!Serializer) {
        return __WEBPACK_IMPORTED_MODULE_5__globals__["h" /* Promise */].reject(new Error('No serializer for version ' + version + ' found.'));
      }
      var serializer = new Serializer(this);
      return serializer.serialize(options);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var Serializer = this._serializers[data.version];
      if (!Serializer) {
        return __WEBPACK_IMPORTED_MODULE_5__globals__["h" /* Promise */].reject(new Error('No serializer for version ' + data.version + ' found.'));
      }
      var serializer = new Serializer(this);
      return serializer.deserialize(data);
    }

    /**
     * Creates a serialization and optionally downloads it to a file
     * @param {Boolean} download = false
     * @return {Promise}
     */

  }, {
    key: 'save',
    value: function save() {
      var download = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
      var includeImage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var options = this._options.editor.save;
      // return this.serialize({image: options.image})
      return this.serialize({ image: includeImage }).then(function (output) {
        var json = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_json_stringify___default()(output, null, 2);
        // this.emit(Constants.EVENTS.SAVE, output)
        // this._mediator.emit(Constants.EVENTS.SAVE, output, this)
        if (download) {
          var dataStr = 'data:text/json;charset=utf-8;base64,' + window.encodeURI(window.btoa(json));
          __WEBPACK_IMPORTED_MODULE_9_shared_downloader_file_downloader__["a" /* default */].downloadDataURL(dataStr, options.fileBasename);
        }
        return json;
      });
    }

    // -------------------------------------------------------------------------- RENDERING

    /**
     * Resets everything
     */

  }, {
    key: 'reset',
    value: function reset() {
      this._sdk.reset();
      this.operations.reset();
    }

    // -------------------------------------------------------------------------- DISPOSAL

    /**
     * Cleans this instance up
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      this.stop();

      this._sdk.dispose();
    }

    // -------------------------------------------------------------------------- GETTERS / SETTERS

    /**
     * Returns the renderer
     * @return {PhotoEditorSDK.Engine.BaseRenderer}
     */

  }, {
    key: 'getRenderer',
    value: function getRenderer() {
      return this._sdk.getRenderer();
    }

    /**
     * Returns the SDK
     * @return {PhotoEditorSDK}
     */

  }, {
    key: 'getSDK',
    value: function getSDK() {
      return this._sdk;
    }

    /**
     * Returns the input image dimensions
     * @return {PhotoEditorSDK.Math.Vector2}s
     */

  }, {
    key: 'getInputDimensions',
    value: function getInputDimensions() {
      return this._sdk.getInputDimensions();
    }

    /**
     * Returns the image
     * @return {Image}
     */

  }, {
    key: 'getImage',
    value: function getImage() {
      return this._sdk.getImage();
    }

    /**
     * Returns the options
     * @return {Object}
     */

  }, {
    key: 'getOptions',
    value: function getOptions() {
      return this._options;
    }

    /**
     * Returns the UI
     * @return {EngineWrapper}
     */

  }, {
    key: 'getUI',
    value: function getUI() {
      return this._ui;
    }
  }, {
    key: 'getMediator',
    value: function getMediator() {
      return this._mediator;
    }
  }]);

  return Editor;
}(__WEBPACK_IMPORTED_MODULE_5__globals__["d" /* EventEmitter */]);

/* harmony default export */ __webpack_exports__["a"] = (Editor);

/***/ }),
/* 486 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_shared_downloader_file_downloader__ = __webpack_require__(198);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Exporter = function () {
  function Exporter(sdk, options, download) {
    _classCallCheck(this, Exporter);

    this._sdk = sdk;
    this._options = options;
    this._download = download;
  }

  /**
   * Exports the image / data url
   * @return {Promise}
   */


  _createClass(Exporter, [{
    key: 'export',
    value: function _export() {
      var _this = this;

      var renderType = this._getRenderType();
      return this._sdk.export(renderType, this._options.format, this._options.quality).then(function (data) {
        if (_this._download) {
          _this._downloadData(renderType, data);
        }
        return data;
      });
    }

    /**
     * Downloads the data using the given render type
     * @param  {RenderType} renderType
     * @param  {String} data
     * @private
     */

  }, {
    key: '_downloadData',
    value: function _downloadData(renderType, data) {
      switch (renderType) {
        case __WEBPACK_IMPORTED_MODULE_1_globals__["i" /* RenderType */].DATAURL:
          __WEBPACK_IMPORTED_MODULE_2_shared_downloader_file_downloader__["a" /* default */].downloadDataURL(data, this._options.fileBasename);
          break;
        case __WEBPACK_IMPORTED_MODULE_1_globals__["i" /* RenderType */].MSBLOB:
          __WEBPACK_IMPORTED_MODULE_2_shared_downloader_file_downloader__["a" /* default */].downloadMSBlob(data, this._options.fileBasename);
          break;
      }
    }

    /**
     * Returns the render type for this export
     * @return {RenderType}
     * @private
     */

  }, {
    key: '_getRenderType',
    value: function _getRenderType() {
      var options = this._options;
      if (options.type !== __WEBPACK_IMPORTED_MODULE_1_globals__["i" /* RenderType */].IMAGE || !this._download) {
        return options.type;
      } else {
        if (__WEBPACK_IMPORTED_MODULE_1_globals__["m" /* Utils */].supportsMSBlob()) {
          return __WEBPACK_IMPORTED_MODULE_1_globals__["i" /* RenderType */].MSBLOB;
        } else {
          return __WEBPACK_IMPORTED_MODULE_1_globals__["i" /* RenderType */].DATAURL;
        }
      }
    }
  }]);

  return Exporter;
}();

/* harmony default export */ __webpack_exports__["a"] = (Exporter);

/***/ }),
/* 487 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__ = __webpack_require__(31);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var Font = function (_Configurable) {
  _inherits(Font, _Configurable);

  function Font() {
    _classCallCheck(this, Font);

    return _possibleConstructorReturn(this, (Font.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(Font)).apply(this, arguments));
  }

  return Font;
}(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["Configurable"]);

/**
 * Specifies the available options for the Font class
 * @type {Object}
 * @ignore
 */


/* harmony default export */ __webpack_exports__["a"] = (Font);
Font.prototype.availableOptions = {
  fontFamily: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["OptionType"].STRING, required: true },
  variations: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["OptionType"].ARRAY, required: true }
};

/***/ }),
/* 488 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__globals__ = __webpack_require__(9);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var ImageResizer = function () {
  function ImageResizer(image, maxPixels, maxDimensions) {
    _classCallCheck(this, ImageResizer);

    this._image = image;
    this._maxPixels = maxPixels;
    this._maxDimensions = maxDimensions;
  }

  /**
   * Checks if the image needs to be resized
   * @return {Boolean}
   */


  _createClass(ImageResizer, [{
    key: 'needsResize',
    value: function needsResize() {
      var dimensions = new __WEBPACK_IMPORTED_MODULE_1__globals__["n" /* Vector2 */](this._image.width, this._image.height);
      var pixels = dimensions.x * dimensions.y;
      var exceedsMaxPixels = pixels > this._maxPixels;
      var exceedsMaxDimensions = this._maxDimensions !== null && (dimensions.x > this._maxDimensions || dimensions.y > this._maxDimensions);

      return exceedsMaxPixels || exceedsMaxDimensions;
    }

    /**
     * Resizes the image to match the maximum amount of pixels
     * @return {Promise}
     */

  }, {
    key: 'resize',
    value: function resize() {
      var _this = this;

      var reason = null;
      var canvas = null;
      var maxDimensions = this._maxDimensions;

      return new __WEBPACK_IMPORTED_MODULE_1__globals__["h" /* Promise */](function (resolve, reject) {
        window.setTimeout(function () {
          var initialDimensions = new __WEBPACK_IMPORTED_MODULE_1__globals__["n" /* Vector2 */](_this._image.width, _this._image.height);
          var dimensions = initialDimensions.clone();

          // If max pixels is exceeded, resize to fit the max pixels
          if (dimensions.x * dimensions.y > _this._maxPixels) {
            dimensions.copy(_this._getDimensionsByMaxPixels());
            reason = 'maxMegaPixels';
          }

          // If max dimensions (maximum texture size) is exceeded,
          // make sure the shorter side equals the maximum texture
          // size
          if (maxDimensions !== null && (dimensions.x > maxDimensions || dimensions.y > maxDimensions)) {
            var scale = Math.min(maxDimensions / dimensions.x, maxDimensions / dimensions.y);
            dimensions.multiply(scale);
            reason = 'maxDimensions';
          }

          dimensions.floor();
          canvas = _this._createResizedImageCanvas(dimensions);

          resolve({ canvas: canvas, dimensions: dimensions, reason: reason });
        }, 1000);
      });
    }

    /**
     * Creates a resized canvas with the given dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} dimensions
     * @param  {PhotoEditorSDK.Math.Vector2} [imageDimensions] = dimensions
     * @return {Canvas}
     * @private
     */

  }, {
    key: '_createResizedImageCanvas',
    value: function _createResizedImageCanvas(dimensions) {
      var imageDimensions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : dimensions;

      var image = this._image;

      var canvas = document.createElement('canvas');
      canvas.width = dimensions.x;
      canvas.height = dimensions.y;

      var offset = dimensions.clone().subtract(imageDimensions).divide(2);

      var context = canvas.getContext('2d');
      context.drawImage(image, 0, 0, image.width, image.height, offset.x, offset.y, imageDimensions.x, imageDimensions.y);
      return canvas;
    }

    /**
     * Returns the dimensions that match the max pixel count
     * @return {Vector2}
     * @private
     */

  }, {
    key: '_getDimensionsByMaxPixels',
    value: function _getDimensionsByMaxPixels() {
      var image = this._image;
      var maxPixels = this._maxPixels;

      var ratioHV = image.width / image.height;
      var ratioVH = image.height / image.width;

      return new __WEBPACK_IMPORTED_MODULE_1__globals__["n" /* Vector2 */](Math.sqrt(maxPixels * ratioHV), Math.sqrt(maxPixels * ratioVH)).floor();
    }
  }]);

  return ImageResizer;
}();

/* harmony default export */ __webpack_exports__["a"] = (ImageResizer);

/***/ }),
/* 489 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__globals__ = __webpack_require__(9);




var _typeof = typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && typeof __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_symbol_iterator___default.a === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a === "function" && obj.constructor === __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a && obj !== __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_symbol___default.a.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var EditorOperations = function () {
  function EditorOperations(editor, sdk, mediator) {
    _classCallCheck(this, EditorOperations);

    this._editor = editor;
    this._sdk = sdk;
    this._mediator = mediator;

    this._available = this._sdk.getOperations();
    this._map = {};
    this._stack = this._sdk.getOperationsStack();
    this._preferredOrder = this._editor.getOptions().editor.operationsOrder;

    this._fixStack();
  }

  /**
   * Checks whether an operation with the given identifier exists
   * @param {String} identifier
   * @return {Boolean}
   */


  _createClass(EditorOperations, [{
    key: 'exists',
    value: function exists(identifier) {
      return !!this._map[identifier];
    }

    /**
     * Adds the given operation to the stack
     * @param {PhotoEditorSDK.Operation} operation
     */

  }, {
    key: 'add',
    value: function add(operation) {
      var _this = this;

      var identifier = operation.constructor.identifier;
      operation.on('update', function () {
        _this._mediator.emit(__WEBPACK_IMPORTED_MODULE_3__globals__["c" /* Constants */].EVENTS.OPERATION_UPDATED, operation);
      });
      var index = this._preferredOrder.indexOf(identifier);
      if (index === -1) {
        throw new Error('EditorOperations#add: `' + identifier + '` does not appear in `operationsOrder`');
      }
      this._stack.set(index, operation);
      this._map[identifier] = operation;

      this._mediator.emit(__WEBPACK_IMPORTED_MODULE_3__globals__["c" /* Constants */].EVENTS.OPERATION_CREATED, operation);
    }

    /**
     * Removes the given operation from the stack
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {Boolean} broadcast = true
     */

  }, {
    key: 'remove',
    value: function remove(operation) {
      var broadcast = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      var identifier = (typeof operation === 'undefined' ? 'undefined' : _typeof(operation)) === 'object' ? operation.constructor.identifier : operation;
      var stack = this._stack.getStack();
      operation = this.get(identifier);

      // Remove operation from map
      delete this._map[identifier];

      // Remove operation from stack
      var index = stack.map(function (op) {
        return op.constructor.identifier;
      }).indexOf(identifier);

      if (index !== -1) {
        this._stack.removeAt(index);

        // Set all following operations to dirty, since they might
        // have cached stuff drawn by the removed operation
        for (var i = index + 1; i < stack.length; i++) {
          var _operation = stack[i];
          if (!_operation) continue;
          _operation.setDirty(true);
        }

        if (broadcast) {
          this._mediator.emit(__WEBPACK_IMPORTED_MODULE_3__globals__["c" /* Constants */].EVENTS.OPERATION_REMOVED, operation);
        }
      }
    }

    /**
     * Returns the operation with the given identifier
     * @param  {String} identifier
     * @return {PhotoEditorSDK.Operation}
     */

  }, {
    key: 'get',
    value: function get(identifier) {
      return this._map[identifier];
    }

    /**
     * If the operation with the given identifier already exists, it returns
     * the existing operation. Otherwise, it creates and returns a new one.
     * @param  {String} identifier
     * @param  {Object} options
     * @return {PhotoEditorSDK.Operation}
     */

  }, {
    key: 'getOrCreate',
    value: function getOrCreate(identifier) {
      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      if (this._map[identifier]) {
        var operation = this._map[identifier];
        operation.set(options, false);
        return operation;
      } else {
        var Operation = this._available[identifier];
        var _operation2 = new Operation(this._sdk, options);
        this.add(_operation2);
        return _operation2;
      }
    }

    /**
     * Returns the operations stack
     * @return {PhotoEditorSDK.OperationsStack}
     */

  }, {
    key: 'getStack',
    value: function getStack() {
      return this._stack;
    }

    /**
     * Resets the operations
     */

  }, {
    key: 'reset',
    value: function reset() {
      this._map = {};
    }

    /**
     * Since the SDK might create some operations upfront (e.g. to fix the EXIF orientation),
     * we might have operations at array positions where they should not be. This method
     * moves them to their appropriate position
     * @private
     */

  }, {
    key: '_fixStack',
    value: function _fixStack() {
      var _this2 = this;

      var stack = this._stack.getStack().slice();
      this._stack.clear();

      stack.forEach(function (s) {
        _this2.add(s);
      });
    }
  }]);

  return EditorOperations;
}();

/* harmony default export */ __webpack_exports__["a"] = (EditorOperations);

/***/ }),
/* 490 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__serializer__ = __webpack_require__(200);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deserializer__ = __webpack_require__(201);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '1.0.0';

/***/ }),
/* 491 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

var AssetLibrary = function () {
  function AssetLibrary() {
    _classCallCheck(this, AssetLibrary);

    this._assetsByGroupId = {};
  }

  /**
   * Appends the specified asset to the list of assets of
   * the group with the given id
   * @param {string} groupID
   * @param {Object} asset
   * @param {boolean} atBeginning - Whether to insert the asset at the beginning of the array
   */


  _createClass(AssetLibrary, [{
    key: "addAsset",
    value: function addAsset(groupID, asset) {
      var atBeginning = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

      if (!this._assetsByGroupId[groupID]) {
        this._assetsByGroupId[groupID] = [asset];
      } else {
        if (atBeginning) {
          this._assetsByGroupId[groupID].unshift(asset);
        } else {
          this._assetsByGroupId[groupID].push(asset);
        }
      }
    }

    /**
     * Sets the given assets as the list of assets of the group
     * with the given id
     * @param {string} groupID
     * @param {Array} assets
     */

  }, {
    key: "setAssets",
    value: function setAssets(groupID, assets) {
      this._assetsByGroupId[groupID] = assets;
    }

    /**
     * Returns the list of assets of the group with the given
     * id
     * @param {string} groupID
     * @returns {Array}
     */

  }, {
    key: "getAssets",
    value: function getAssets(groupID) {
      // Make sure we don't create new arrays on each request
      this._assetsByGroupId[groupID] = this._assetsByGroupId[groupID] || [];
      return this._assetsByGroupId[groupID];
    }
  }]);

  return AssetLibrary;
}();

/* harmony default export */ __webpack_exports__["a"] = (AssetLibrary);

/***/ }),
/* 492 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var BrushManager = function () {
  function BrushManager(ui, options) {
    _classCallCheck(this, BrushManager);

    this._ui = ui;
    this._options = options;
    this._brushes = [];
    this._brushesById = {};

    this._addBrushes(__WEBPACK_IMPORTED_MODULE_1_globals__["c" /* Constants */].DEFAULTS.BRUSHES);

    var _options = this._options,
        brushes = _options.brushes,
        replaceBrushes = _options.replaceBrushes,
        availableBrushes = _options.availableBrushes;

    if (this._options.brushes) {
      this._addBrushes(brushes, replaceBrushes);
    }

    if (availableBrushes) {
      this._brushes = this._brushes.filter(function (brush) {
        return availableBrushes.indexOf(brush.identifier) !== -1;
      });
    }
  }

  _createClass(BrushManager, [{
    key: '_addBrushes',
    value: function _addBrushes(brushes, replaceBrushes) {
      var _this = this;

      if (replaceBrushes) {
        this._brushes = [];
        this._brushesById = {};
      }

      brushes.forEach(function (brush) {
        _this._brushes.push(brush);
        _this._brushesById[brush.identifier] = brush;
      });
    }

    /**
     * Returns the brush with the given identifier
     * @param  {String} identifier
     */

  }, {
    key: 'getBrushByIdentifier',
    value: function getBrushByIdentifier(identifier) {
      return this._brushesById[identifier];
    }

    /**
     * Returns all brushes
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Brush[]}
     */

  }, {
    key: 'getBrushes',
    value: function getBrushes() {
      return this._brushes;
    }

    /**
     * Returns the first available brush
     * @return {PhotoEditorSDK.Operations.SpriteOperation.BrushSprite.Brush}
     */

  }, {
    key: 'getFirstBrush',
    value: function getFirstBrush() {
      return this._brushes[0];
    }
  }]);

  return BrushManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (BrushManager);

/***/ }),
/* 493 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__base_font_loader__ = __webpack_require__(203);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FONT_STYLES = {
  italic: 'i'
};

var GoogleFontLoader = function (_BaseFontLoader) {
  _inherits(GoogleFontLoader, _BaseFontLoader);

  function GoogleFontLoader() {
    _classCallCheck(this, GoogleFontLoader);

    return _possibleConstructorReturn(this, (GoogleFontLoader.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(GoogleFontLoader)).apply(this, arguments));
  }

  _createClass(GoogleFontLoader, [{
    key: 'load',
    value: function load() {
      if (this._fonts.length) {
        this._addStylesheetTag();
      }
      return _get(GoogleFontLoader.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(GoogleFontLoader.prototype), 'load', this).call(this);
    }

    /**
     * Appends the <link> tag to the head
     * @private
     */

  }, {
    key: '_addStylesheetTag',
    value: function _addStylesheetTag() {
      var families = this._getFamiliesString();
      var link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = 'https://fonts.googleapis.com/css?family=' + families;

      var head = document.getElementsByTagName('head')[0];
      head.appendChild(link);
    }

    /**
     * Returns the string representation of all Google Fonts families that
     * should be loaded
     * @return {String}
     * @private
     */

  }, {
    key: '_getFamiliesString',
    value: function _getFamiliesString() {
      var families = {};
      this._fonts.forEach(function (font) {
        var fontFamily = font.getFontFamily();
        var fontStyle = font.getFontStyle();
        var fontWeight = font.getFontWeight();
        families[fontFamily] = families[fontFamily] || [];
        if (typeof fontWeight !== 'undefined') {
          families[fontFamily].push('' + fontWeight + (FONT_STYLES[fontStyle] || ''));
        } else {
          families[fontFamily].push(400); // default weight
        }
      });

      var familyStrings = [];
      for (var name in families) {
        var variants = families[name];
        var variantsString = variants.length ? ':' + variants.join(',') : '';
        var nameString = name.replace(' ', '+') + variantsString;
        familyStrings.push(nameString);
      }

      return familyStrings.join('|');
    }
  }]);

  return GoogleFontLoader;
}(__WEBPACK_IMPORTED_MODULE_5__base_font_loader__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (GoogleFontLoader);

/***/ }),
/* 494 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__font_ruler__ = __webpack_require__(495);



var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var now = typeof window !== 'undefined' && window.performance && window.performance.now ? window.performance.now.bind(window.performance) : __webpack_require__(86);

var OBSERVE_INTERVAL = 50;
var OBSERVE_TIMEOUT = 5000;

var FontObserver = function () {
  function FontObserver(fontVariation) {
    _classCallCheck(this, FontObserver);

    this._fontVariation = fontVariation;

    this._defaultFontRuler = new __WEBPACK_IMPORTED_MODULE_2__font_ruler__["a" /* default */]();
    this._customFontRuler = new __WEBPACK_IMPORTED_MODULE_2__font_ruler__["a" /* default */](this._fontVariation);
  }

  _createClass(FontObserver, [{
    key: 'observe',
    value: function observe() {
      var _this = this;

      var startedAt = now();

      return new __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a(function (resolve, reject) {
        var interval = window.setInterval(function () {
          var changed = _this._defaultFontRuler.getWidth() !== _this._customFontRuler.getWidth();
          if (changed) {
            window.clearInterval(interval);
            return resolve();
          } else {
            if (now() - startedAt >= OBSERVE_TIMEOUT) {
              var error = new Error('Failed to load font ' + _this._fontVariation.getFontFamily() + '.');
              error.font = _this._fontVariation;
              return reject(error);
            }
          }
        }, OBSERVE_INTERVAL);
      });
    }
  }, {
    key: 'dispose',
    value: function dispose() {
      this._defaultFontRuler.dispose();
      this._customFontRuler.dispose();
    }
  }]);

  return FontObserver;
}();

/* harmony default export */ __webpack_exports__["a"] = (FontObserver);

/***/ }),
/* 495 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_shared_assets_font_variation__ = __webpack_require__(199);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FONT_SIZE = 30;
var CHARACTERS = 'abcdefghijklmnopqrstuvwxzy';

var FontRuler = function () {
  function FontRuler(fontVariation) {
    _classCallCheck(this, FontRuler);

    this._fontVariation = fontVariation || new __WEBPACK_IMPORTED_MODULE_1_shared_assets_font_variation__["a" /* default */]({
      fontFamily: 'Times New Roman',
      fontWeight: 'normal',
      fontStyle: 'normal'
    });

    this._createRuler();
  }

  /**
   * Creates the ruler and attaches it to the DOM
   * @private
   */


  _createClass(FontRuler, [{
    key: '_createRuler',
    value: function _createRuler() {
      this._ruler = document.createElement('div');
      this._ruler.innerText = CHARACTERS;
      document.body.appendChild(this._ruler);
      this._setRulerStyle();
    }

    /**
     * Styles the ruler
     * @private
     */

  }, {
    key: '_setRulerStyle',
    value: function _setRulerStyle() {
      this._ruler.style.cssText = '\n      position: absolute;\n      top: -9999px;\n      left: -9999px;\n      opacity: 0;\n      display: inline-block;\n      font: ' + this._fontVariation.getFontStyle() + ' ' + this._fontVariation.getFontWeight() + ' ' + FONT_SIZE + 'px ' + this._fontVariation.getFontFamily() + ';\n    ';
    }

    /**
     * Sets the font variation to the given one
     * @param {PhotoEditorSDK.UI.ReactUI.FontVariation} fontVariation
     */

  }, {
    key: 'setFontVariation',
    value: function setFontVariation(fontVariation) {
      this._fontVariation = fontVariation;
      this._setRulerStyle();
    }

    /**
     * Returns the width of this ruler
     * @return {Number}
     */

  }, {
    key: 'getWidth',
    value: function getWidth() {
      return !this._ruler ? -1 : this._ruler.offsetWidth;
    }

    /**
     * Removes this ruler from the DOM
     */

  }, {
    key: 'dispose',
    value: function dispose() {
      if (this._ruler) {
        this._ruler.parentNode.removeChild(this._ruler);
        this._ruler = null;
      }
    }
  }]);

  return FontRuler;
}();

/* harmony default export */ __webpack_exports__["a"] = (FontRuler);

/***/ }),
/* 496 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__base_font_loader__ = __webpack_require__(203);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

// import { adonis } from 'globals'


var FileFontLoader = function (_BaseFontLoader) {
  _inherits(FileFontLoader, _BaseFontLoader);

  function FileFontLoader() {
    _classCallCheck(this, FileFontLoader);

    return _possibleConstructorReturn(this, (FileFontLoader.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(FileFontLoader)).apply(this, arguments));
  }

  _createClass(FileFontLoader, [{
    key: 'load',
    value: function load() {
      // Ignore Font loading for now
      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve();

      // const fontFacesCSS = []

      // this._fonts.forEach(variation => {
      //   const fontPath = this._ui.getAssetPath(variation.getFilePath(), false, true)
      //   console.log(fontPath)
      //   fontFacesCSS.push(`@font-face {
      //     font-family: "${variation.getFontFamily()}";
      //     src: url('${fontPath}') format('woff');
      //     font-weight: ${variation.getFontWeight()};
      //     font-style: ${variation.getFontStyle()};
      //   }`)
      // })
      // // adonis.global(fontFacesCSS.join('\n'), true)
      // return super.load()
    }
  }]);

  return FileFontLoader;
}(__WEBPACK_IMPORTED_MODULE_5__base_font_loader__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (FileFontLoader);

/***/ }),
/* 497 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__serializer__ = __webpack_require__(204);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deserializer__ = __webpack_require__(205);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '1.0.1';

/***/ }),
/* 498 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__serializer__ = __webpack_require__(206);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deserializer__ = __webpack_require__(207);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '2.0.0';

/***/ }),
/* 499 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var FrameManager = function () {
  function FrameManager(ui, options) {
    _classCallCheck(this, FrameManager);

    this._ui = ui;
    this._options = options;

    this._categoriesById = {};
    this._categories = [];
    this._framesById = {};

    this._addCategories(__WEBPACK_IMPORTED_MODULE_1_globals__["l" /* SharedConstants */].DEFAULTS.FRAME_CATEGORIES);

    this._customAssetsAllowed = ui.getEditor().getSDK()._l.areCustomAssetsAllowed();

    var _options = this._options,
        categories = _options.categories,
        replaceCategories = _options.replaceCategories;

    if (this._customAssetsAllowed && this._options.categories) {
      this._addCategories(categories, replaceCategories);
    } else {
      this._updateAllCategory();
    }
  }

  /**
   * Initializes the categories
   * @param {Object[]} categories
   * @param {Boolean} replace = false
   * @private
   */


  _createClass(FrameManager, [{
    key: '_addCategories',
    value: function _addCategories(categories) {
      var _this = this;

      var replace = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      if (replace) {
        this._categories = categories.slice(0);
      } else {
        this._categories = __WEBPACK_IMPORTED_MODULE_1_globals__["m" /* Utils */].mergeCategories(this._categories, categories, 'frames');
      }

      // Build cat id => category hash
      this._categoriesById = {};
      this._categories.forEach(function (c) {
        _this._categoriesById[c.identifier] = c;
      });

      // Filter frames
      var availableFrames = this._options.availableFrames;

      if (this._customAssetsAllowed && availableFrames) {
        this._categories.forEach(function (c) {
          c.frames = c.frames.filter(function (f) {
            return availableFrames.indexOf(f.identifier) !== -1;
          });
        });
      }

      // Build frame id => frame hash
      this._categories.forEach(function (c) {
        c.frames.forEach(function (s) {
          _this._framesById[s.identifier] = s;
        });
      });

      this._updateAllCategory();
    }

    /**
     * Updates the `all` category which contains all frames
     * @private
     */

  }, {
    key: '_updateAllCategory',
    value: function _updateAllCategory() {
      this._allCategory = {
        identifier: 'all',
        defaultName: 'All',
        frames: this._categories.map(function (c) {
          return c.frames;
        }).reduce(function (a, b) {
          return a.concat(b);
        }, [])
      };
      this._categoriesById.all = this._allCategory;
    }

    /**
     * Returns the frames for the category with the given name
     * @param  {String} categoryName
     * @return {Object[]}
     */

  }, {
    key: 'getFramesForCategory',
    value: function getFramesForCategory(categoryName) {
      if (!this._categoriesById[categoryName]) {
        throw new Error('Unknown frame category \'' + categoryName + '\'');
      }
      return this._categoriesById[categoryName].frames;
    }

    /**
     * Returns the frame with the given identifier
     * @param  {String} identifier
     */

  }, {
    key: 'getFrameByIdentifier',
    value: function getFrameByIdentifier(identifier) {
      return this._framesById[identifier];
    }

    /**
     * Returns the categories
     * @return {Object[]}
     */

  }, {
    key: 'getCategories',
    value: function getCategories() {
      return this._categories;
    }

    /**
     * Returns the category object for the given id
     * @param  {String} id
     * @return {Object}
     */

  }, {
    key: 'getCategory',
    value: function getCategory(id) {
      return this._categoriesById[id];
    }
  }]);

  return FrameManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (FrameManager);

/***/ }),
/* 500 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_globals__ = __webpack_require__(9);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var OverlayManager = function () {
  function OverlayManager(ui, options) {
    var _this = this;

    _classCallCheck(this, OverlayManager);

    this._ui = ui;
    this._options = options;
    this._overlays = __WEBPACK_IMPORTED_MODULE_1_globals__["l" /* SharedConstants */].DEFAULTS.OVERLAYS.slice(0);
    this._overlaysByIdentifier = {};

    var customAssetsAllowed = ui.getEditor().getSDK()._l.areCustomAssetsAllowed();

    if (customAssetsAllowed && options.overlays) {
      if (options.replaceOverlays) {
        this._overlays = options.overlays;
      } else {
        this._overlays = this._overlays.concat(options.overlays);
      }
    }

    // Filter available
    if (customAssetsAllowed && options.availableOverlays) {
      this._overlays = this._overlays.filter(function (o) {
        return options.availableOverlays.indexOf(o.identifier) !== -1;
      });
    }

    this._overlays.forEach(function (overlay) {
      _this._overlaysByIdentifier[overlay.identifier] = overlay;
    });
  }

  /**
   * Returns the overlays
   * @return {Object[]}
   */


  _createClass(OverlayManager, [{
    key: 'getOverlays',
    value: function getOverlays() {
      return this._overlays;
    }

    /**
     * Returns the overlay with the given identifier
     * @param  {String} identifier
     * @return {Object}
     */

  }, {
    key: 'getOverlayByIdentifier',
    value: function getOverlayByIdentifier(identifier) {
      return this._overlaysByIdentifier[identifier];
    }
  }]);

  return OverlayManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (OverlayManager);

/***/ }),
/* 501 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__globals__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_shared_loaders_image_loader__ = __webpack_require__(72);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var OptionType = __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* SDK */].OptionType;

var Frame = function (_SDK$Configurable) {
  _inherits(Frame, _SDK$Configurable);

  function Frame(ui) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    _classCallCheck(this, Frame);

    var _this = _possibleConstructorReturn(this, (Frame.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(Frame)).call(this, options));

    _this._loaded = false;
    _this._loading = false;
    _this._ui = ui;
    _this._frame = __WEBPACK_IMPORTED_MODULE_5__globals__["j" /* SDK */].Utils.deepClone(_this._options);
    return _this;
  }

  /**
   * Loads the images of this frame
   * @return {Promise}
   */


  _createClass(Frame, [{
    key: 'load',
    value: function load() {
      var _this2 = this;

      if (this._loaded) return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.resolve();
      if (this._loading) return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.reject(new Error('Called Frame#load while it\'s already loading'));

      this._loading = true;
      var imageGroups = this._frame.imageGroups;


      var promises = [];
      ['top', 'left', 'right', 'bottom'].forEach(function (groupName) {
        if (!(groupName in imageGroups)) return;

        var group = imageGroups[groupName];
        ['start', 'mid', 'end'].forEach(function (partName) {
          if (!(partName in group)) return;

          promises.push(_this2._loadPart(groupName, partName));
        });
      });

      return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a.all(promises).then(function () {
        _this2._loaded = true;
        _this2._loading = false;
      }).catch(function (e) {
        _this2._loaded = false;
        _this2._loading = false;
      });
    }

    /**
     * Loads the given part of the given group
     * @param  {String} groupName
     * @param  {String} partName
     * @return {Promise}
     * @private
     */

  }, {
    key: '_loadPart',
    value: function _loadPart(groupName, partName) {
      var _this3 = this;

      var imageGroups = this._frame.imageGroups;


      var part = imageGroups[groupName][partName];
      var imageUrl = part;
      // `part` can also be an object containing `mode` and `image`
      if (typeof part !== 'string' && 'image' in part) {
        imageUrl = part.image;
      }

      return __WEBPACK_IMPORTED_MODULE_6_shared_loaders_image_loader__["a" /* default */].load(this._ui.getAssetPath(imageUrl)).then(function (image) {
        if (typeof part !== 'string') {
          _this3._frame.imageGroups[groupName][partName].image = image;
        } else {
          _this3._frame.imageGroups[groupName][partName] = image;
        }
        return image;
      });
    }

    /**
     * Returns the frame
     * @return {Object}
     */

  }, {
    key: 'getFrame',
    value: function getFrame() {
      return this._frame;
    }
  }]);

  return Frame;
}(__WEBPACK_IMPORTED_MODULE_5__globals__["j" /* SDK */].Configurable);

/**
 * Specifies the available options for the Frame class
 * @type {Object}
 * @ignore
 */


/* harmony default export */ __webpack_exports__["a"] = (Frame);
Frame.prototype.availableOptions = {
  identifier: { type: OptionType.STRING, required: true },
  defaultName: { type: OptionType.STRING },
  thumbnail: { type: OptionType.STRING },
  tintable: { type: OptionType.BOOLEAN, default: false },
  layoutMode: {
    type: OptionType.STRING,
    default: 'horizontal-inside',
    available: ['horizontal-inside', 'vertical-inside']
  },
  imageGroups: { type: OptionType.OBJECT, required: true }
};

/***/ }),
/* 502 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__serializer__ = __webpack_require__(208);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deserializer__ = __webpack_require__(209);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '3.0.0';

/***/ }),
/* 503 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__ = __webpack_require__(31);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var TransformRatio = function (_Configurable) {
  _inherits(TransformRatio, _Configurable);

  function TransformRatio() {
    _classCallCheck(this, TransformRatio);

    return _possibleConstructorReturn(this, (TransformRatio.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(TransformRatio)).apply(this, arguments));
  }

  return TransformRatio;
}(__WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["Configurable"]);

/* harmony default export */ __webpack_exports__["a"] = (TransformRatio);


TransformRatio.prototype.availableOptions = {
  identifier: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["OptionType"].STRING, required: true },
  defaultName: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["OptionType"].STRING, required: true },
  ratio: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["OptionType"].ALL, required: false, default: null }, // FIXME should be defaulted to dimension based ratio
  selected: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["OptionType"].BOOLEAN, required: false },
  dimensions: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["OptionType"].VECTOR2, required: false },
  lockDimensions: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["OptionType"].BOOLEAN, required: false, default: null },
  forceDimensions: { type: __WEBPACK_IMPORTED_MODULE_3_photoeditorsdk__["OptionType"].BOOLEAN, required: false, default: null // //
    // lockAspectRatio: { type: OptionType.BOOLEAN, required: false, default: false } //
  } };

/***/ }),
/* 504 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(505), __esModule: true };

/***/ }),
/* 505 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(506);
module.exports = __webpack_require__(11).Object.values;


/***/ }),
/* 506 */
/***/ (function(module, exports, __webpack_require__) {

// https://github.com/tc39/proposal-object-values-entries
var $export = __webpack_require__(14);
var $values = __webpack_require__(507)(false);

$export($export.S, 'Object', {
  values: function values(it) {
    return $values(it);
  }
});


/***/ }),
/* 507 */
/***/ (function(module, exports, __webpack_require__) {

var DESCRIPTORS = __webpack_require__(19);
var getKeys = __webpack_require__(49);
var toIObject = __webpack_require__(35);
var isEnum = __webpack_require__(58).f;
module.exports = function (isEntries) {
  return function (it) {
    var O = toIObject(it);
    var keys = getKeys(O);
    var length = keys.length;
    var i = 0;
    var result = [];
    var key;
    while (length > i) {
      key = keys[i++];
      if (!DESCRIPTORS || isEnum.call(O, key)) {
        result.push(isEntries ? [key, O[key]] : O[key]);
      }
    }
    return result;
  };
};


/***/ }),
/* 508 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__serializer__ = __webpack_require__(210);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deserializer__ = __webpack_require__(211);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '3.1.0';

/***/ }),
/* 509 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__serializer__ = __webpack_require__(212);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deserializer__ = __webpack_require__(213);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '3.2.0';

/***/ }),
/* 510 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__3_4_0_serializer__ = __webpack_require__(214);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__3_4_0_deserializer__ = __webpack_require__(215);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__3_4_0_serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__3_4_0_deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '3.4.0';

/***/ }),
/* 511 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_globals__ = __webpack_require__(9);




var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_array_from___default()(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */

/* Loads STYLES (not models), manages 'Assets'
/ style descriptions, not actual style objects
Use Style loader to instantiate styles from assets & stuff

*/



var ArtFilterManager = function () {
  function ArtFilterManager(ui, options) {
    _classCallCheck(this, ArtFilterManager);

    this._ui = ui;
    this._options = options;
    this._categoriesByIdentifier = {};
    this._categories = [];
    this._artFiltersByIdentifier = {};

    this._initCategories();
  }

  /**
   * Initializes the categories
   * @private
   */


  _createClass(ArtFilterManager, [{
    key: '_initCategories',
    value: function _initCategories() {
      var _this = this;

      var artFilters = __WEBPACK_IMPORTED_MODULE_3_globals__["l" /* SharedConstants */].DEFAULTS.ART_FILTERS || [];
      var standardCategory = {
        identifier: 'standard',
        defaultName: 'Standard',
        artFilters: artFilters
      };
      this._categories = [standardCategory];

      if (this._options.categories) {
        if (this._options.replaceCategories) {
          this._categories = this._options.categories;
        } else {
          this._categories = __WEBPACK_IMPORTED_MODULE_3_globals__["m" /* Utils */].mergeCategories(this._categories, this._options.categories, 'artFilters');
        }
      }

      if (this._options.availableArtFilters) {
        var newCategories = [];
        this._categories.forEach(function (category) {
          var artFilters = category.artFilters.filter(function (s) {
            return _this._options.availableArtFilters.indexOf(s.identifier) !== -1;
          });
          if (artFilters.length > 0) {
            newCategories.push({
              identifier: category.identifier,
              defaultName: category.defaultName,
              artFilters: artFilters
            });
          }
        });
        this._categories = newCategories;
      }

      var allCategory = {
        identifier: 'all',
        defaultName: 'All',
        artFilters: this._categories.length <= 0 ? [] : this._categories.map(function (c) {
          return c.artFilters;
        }).reduce(function (a, b) {
          return a.concat(b);
        })
      };
      this._categories.unshift(allCategory);
      this._categoriesByIdentifier.all = allCategory;
      this._categories.forEach(function (c) {
        _this._categoriesByIdentifier[c.identifier] = c;
      });
      allCategory.artFilters.forEach(function (artFilter) {
        _this._artFiltersByIdentifier[artFilter.identifier] = artFilter;
      });
    }

    /**
     * Instantiates a new style transfer model, defined by the given identifier.
     * @param {String} identifier
     * @returns {Promise<PhotoEditorSDK.Operations.ArtFilterOperation.StyleTransferModel>}
     */

  }, {
    key: 'instantiateStyleTransferModelForArtFilterWithIdentifier',
    value: function instantiateStyleTransferModelForArtFilterWithIdentifier(identifier) {
      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      var artFilter = this.getArtFilterByIdentifier(identifier);
      if (!artFilter) {
        return __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a.reject(new Error('Unknown style with identifier `' + identifier + '`!'));
      }

      var rootPath = artFilter.rootPath;

      var sdk = this._ui.getEditor().getSDK();
      var renderer = sdk.getRenderer();

      options.weightURL = this._ui.getAssetPath(rootPath + '/weights.json');
      var inputDimensions = sdk.getInputTexture().getDimensions();
      var exifOperation = sdk.getOperationsStack().getByIdentifier('exif-orientation');
      if (exifOperation) {
        inputDimensions = exifOperation.getNewDimensions(inputDimensions);
      }

      return __WEBPACK_IMPORTED_MODULE_3_globals__["j" /* SDK */].Operations.ArtFilterOperation.StyleTransferModel.createWithOptions(options, inputDimensions, renderer);
    }

    /**
     *
     * @param {PhotoEditorSDK.Operations.ArtFilterOperation.StyleTransferModel} loadedModel
     * @param {String} identifier
     * @returns {Promise<PhotoEditorSDK.Operations.ArtFilterOperation.StyleTransferModel>}
     */

  }, {
    key: 'updateLoadedModelWithWeightsForIdentifier',
    value: function updateLoadedModelWithWeightsForIdentifier(loadedModel, identifier) {
      var Filter = this.getArtFilterByIdentifier(identifier);
      if (!Filter) {
        return __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_promise___default.a.reject(new Error('Unknown style with identifier `' + identifier + '`!'));
      }

      var rootPath = Filter.rootPath;

      var weightURL = this._ui.getAssetPath(rootPath + '/weights.json');

      return loadedModel.updateWithWeightsFromURL(weightURL);
    }

    /**
     * Returns the styles for the category with the given name
     * @param  {String} categoryIdentifier
     * @return {Object[]}
     */

  }, {
    key: 'getArtFiltersForCategory',
    value: function getArtFiltersForCategory(categoryIdentifier) {
      if (!this._categoriesByIdentifier[categoryIdentifier]) {
        throw new Error('Unknown art filter category \'' + categoryIdentifier + '\'');
      }
      return this._categoriesByIdentifier[categoryIdentifier].artFilters;
    }

    /**
     * Returns the style with the given identifier
     * @param  {String} identifier
     * @return {PhotoEditorSDK.Style}
     */

  }, {
    key: 'getArtFilterByIdentifier',
    value: function getArtFilterByIdentifier(identifier) {
      return this._artFiltersByIdentifier[identifier];
    }

    /**
     * Returns the categories
     * @return {Object[]}
     */

  }, {
    key: 'getCategories',
    value: function getCategories() {
      return this._categories;
    }

    /**
     * Returns all styles across all categories
     * @return {PhotoEditorSDK.Style[]}
     */

  }, {
    key: 'getArtFilters',
    value: function getArtFilters() {
      var _this2 = this;

      var allFilters = [];
      this._categories.map(function (category) {
        allFilters.push.apply(allFilters, _toConsumableArray(_this2.getArtFiltersForCategory(category.identifier)));
      });

      return allFilters;
    }

    /**
     * Returns the category with the given identifier
     * @param  {String} identifier
     * @return {Object}
     */

  }, {
    key: 'getCategoryByIdentifier',
    value: function getCategoryByIdentifier(identifier) {
      return this._categoriesByIdentifier[identifier];
    }
  }]);

  return ArtFilterManager;
}();

/* harmony default export */ __webpack_exports__["a"] = (ArtFilterManager);

/***/ }),
/* 512 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__3_5_0_serializer__ = __webpack_require__(216);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__3_5_0_deserializer__ = __webpack_require__(217);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__3_5_0_serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__3_5_0_deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '3.5.0';

/***/ }),
/* 513 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__3_6_0_serializer__ = __webpack_require__(218);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__3_6_0_deserializer__ = __webpack_require__(219);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__3_6_0_serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__3_6_0_deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '3.6.0';

/***/ }),
/* 514 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__3_7_0_serializer__ = __webpack_require__(220);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__3_7_0_deserializer__ = __webpack_require__(221);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__3_7_0_serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__3_7_0_deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '3.7.0';

/***/ }),
/* 515 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__serializer__ = __webpack_require__(516);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__deserializer__ = __webpack_require__(517);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */




var Serialization = function () {
  function Serialization(editor) {
    _classCallCheck(this, Serialization);

    this._editor = editor;
  }

  /**
   * Serializes the editor state
   * @return {Promise}
   */


  _createClass(Serialization, [{
    key: 'serialize',
    value: function serialize() {
      var serializer = new __WEBPACK_IMPORTED_MODULE_1__serializer__["a" /* default */](this._editor);
      return serializer.serialize.apply(serializer, arguments);
    }

    /**
     * Deserializes the given data
     * @param  {Object} data
     * @return {Promise}
     */

  }, {
    key: 'deserialize',
    value: function deserialize(data) {
      var deserializer = new __WEBPACK_IMPORTED_MODULE_2__deserializer__["a" /* default */](this._editor, data);
      return deserializer.deserialize();
    }
  }]);

  return Serialization;
}();

/* harmony default export */ __webpack_exports__["default"] = (Serialization);


Serialization.version = '3.8.0';

/***/ }),
/* 516 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__3_7_0_serializer__ = __webpack_require__(220);






var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_own_property_descriptor___default()(object, property); if (desc === undefined) { var parent = __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var v380Serializer = function (_PreviousSerializer) {
  _inherits(v380Serializer, _PreviousSerializer);

  function v380Serializer() {
    _classCallCheck(this, v380Serializer);

    return _possibleConstructorReturn(this, (v380Serializer.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v380Serializer)).apply(this, arguments));
  }

  _createClass(v380Serializer, [{
    key: '_serializeSticker',

    /**
     * Serializes the given sticker
     * @param  {PhotoEditorSDK.Operation} operation
     * @param  {PhotoEditorSDK.Operations.SpriteOperation.StickerSprite} sprite
     * @return {Object}
     * @private
     */
    value: function _serializeSticker(operation, sprite) {
      var response = _get(v380Serializer.prototype.__proto__ || __WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_object_get_prototype_of___default()(v380Serializer.prototype), '_serializeSticker', this).call(this, operation, sprite);
      response.options.tintMode = sprite.getTintMode();

      return response;
    }
  }]);

  return v380Serializer;
}(__WEBPACK_IMPORTED_MODULE_5__3_7_0_serializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v380Serializer);


v380Serializer.version = '3.8.0';

/***/ }),
/* 517 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__3_7_0_deserializer__ = __webpack_require__(221);




function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_create___default()(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default.a ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_set_prototype_of___default()(subClass, superClass) : subClass.__proto__ = superClass; }

/* @module */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */



var v380Deserializer = function (_PreviousDeserializer) {
  _inherits(v380Deserializer, _PreviousDeserializer);

  function v380Deserializer() {
    _classCallCheck(this, v380Deserializer);

    return _possibleConstructorReturn(this, (v380Deserializer.__proto__ || __WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default()(v380Deserializer)).apply(this, arguments));
  }

  return v380Deserializer;
}(__WEBPACK_IMPORTED_MODULE_3__3_7_0_deserializer__["a" /* default */]);

/* harmony default export */ __webpack_exports__["a"] = (v380Deserializer);


v380Deserializer.version = '3.8.0';

/***/ })
/******/ ]);
});

});

unwrapExports(PhotoEditorSDK_Engine);
var PhotoEditorSDK_Engine_1 = PhotoEditorSDK_Engine.PhotoEditorSDK;
var PhotoEditorSDK_Engine_2 = PhotoEditorSDK_Engine.EngineWrapper;

// TODO: Implement and use to improve efficiency of other
// conversion functions
// function findLowestCommonAncestor(
//   containerA: Container<any>,
//   containerB: Container<any>
// ) {
// }
// TODO: Document all functions
function isFloat2(vec) {
    return vec.x !== undefined;
}
function rectTransformToAffineTransform(rectTransform) {
    return AffineTransform.fromTRS(rectTransform.position.x, rectTransform.position.y, rectTransform.rotation, rectTransform.scale.x, rectTransform.scale.y);
}
function getBaseLocalToParentMatrix(space) {
    if (space.getBaseLocalToParentMatrix) {
        return space.getBaseLocalToParentMatrix();
    }
    return rectTransformToAffineTransform(space.getTransform());
}
function getBaseLocalToWorldMatrix(space) {
    var parent = space.getParent();
    var localToParent = getBaseLocalToParentMatrix(space);
    if (parent === undefined) {
        return localToParent;
    }
    var parentLocalToWorld = getBaseLocalToWorldMatrix(parent);
    return AffineTransform.multiply(parentLocalToWorld, localToParent);
}
function getLocalToParentMatrix(space) {
    if (space.getLocalToParentMatrix) {
        return space.getLocalToParentMatrix();
    }
    return rectTransformToAffineTransform(space.getTransform());
}
function getLocalToWorldMatrix(space) {
    var parent = space.getParent();
    var localToParent = getLocalToParentMatrix(space);
    if (parent === undefined) {
        return localToParent;
    }
    var parentLocalToWorld = getLocalToWorldMatrix(parent);
    return AffineTransform.multiply(parentLocalToWorld, localToParent);
}
/**
 * Converts the given point from the `fromSpace`
 * into the `toSpace` coordinate system.
 * @param point
 * @param fromContainer
 * @param toContainer
 */
function pointFromSpaceToSpace(point, fromSpace, toSpace, useOutputWithoutFlip) {
    if (useOutputWithoutFlip === void 0) { useOutputWithoutFlip = false; }
    var localToWorldFrom = (fromSpace.type === 'output' && useOutputWithoutFlip)
        ? getBaseLocalToWorldMatrix(fromSpace)
        : getLocalToWorldMatrix(fromSpace);
    var localToWorldTo = (toSpace.type === 'output' && useOutputWithoutFlip)
        ? getBaseLocalToWorldMatrix(toSpace)
        : getLocalToWorldMatrix(toSpace);
    var worldToLocalTo = AffineTransform.getInverted(localToWorldTo);
    return AffineTransform.transformPoint(worldToLocalTo, AffineTransform.transformPoint(localToWorldFrom, point));
}
function scalarFromSpaceToSpace(scalar, fromSpace, toSpace) {
    var inVec = new Vector2(scalar, 0);
    var outVec = new Vector2(pointFromSpaceToSpace(inVec, fromSpace, toSpace));
    var outOrigin = new Vector2(pointFromSpaceToSpace(Vector2.ZERO, fromSpace, toSpace));
    return Vector2.distance(outOrigin, outVec);
}
/**
 * Converts the given size from the `fromSpace` into the `toSpace`
 * coordinate system.
 * @param size
 * @param fromSpace
 * @param toSpace
 */
function sizeFromSpaceToSpace(size, fromSpace, toSpace) {
    var inWidth = isFloat2(size) ? size.x : size.width;
    var inHeight = isFloat2(size) ? size.y : size.height;
    var width = scalarFromSpaceToSpace(inWidth, fromSpace, toSpace);
    var height = scalarFromSpaceToSpace(inHeight, fromSpace, toSpace);
    return { width: width, height: height };
}
function getPointInWorldSpace(point, fromSpace) {
    var localToWorld = getLocalToWorldMatrix(fromSpace);
    return AffineTransform.transformPoint(localToWorld, point);
}
function getScalarInWorldSpace(scalar, fromSpace) {
    var inVec = new Vector2(scalar, 0);
    var outVec = new Vector2(getPointInWorldSpace(inVec, fromSpace));
    var outOrigin = new Vector2(getPointInWorldSpace(Vector2.ZERO, fromSpace));
    return Vector2.distance(outVec, outOrigin);
}
function getSizeInWorldSpace(container) {
    var localToWorld = getLocalToWorldMatrix(container);
    var localBounds = container.getBounds();
    var localSizeX = { x: localBounds.width, y: 0 };
    var localSizeY = { x: 0, y: localBounds.height };
    var originInWorld = new Vector2(AffineTransform.transformPoint(localToWorld, Vector2.ZERO));
    var worldSizeX = new Vector2(AffineTransform.transformPoint(localToWorld, localSizeX));
    var worldSizeY = new Vector2(AffineTransform.transformPoint(localToWorld, localSizeY));
    var worldWidth = Vector2.distance(originInWorld, worldSizeX);
    var worldHeight = Vector2.distance(originInWorld, worldSizeY);
    return { width: worldWidth, height: worldHeight };
}
function getSizeInOutputSpace(container, outputContainer) {
    var sizeInWorldSpace = getSizeInWorldSpace(container);
    var outputToWorldScale = outputContainer.getTransform().scale;
    var worldToOutputScale = {
        x: 1 / outputToWorldScale.x,
        y: 1 / outputToWorldScale.y,
    };
    var sizeInOuputSpace = {
        width: sizeInWorldSpace.width * worldToOutputScale.x,
        height: sizeInWorldSpace.height * worldToOutputScale.y,
    };
    return sizeInOuputSpace;
}
function relativeToAbsoluteSize(size, space) {
    var bounds = space.getBounds();
    return {
        width: size.width * bounds.width,
        height: size.height * bounds.height,
    };
}
function absoluteToRelativeSize(size, space) {
    var bounds = space.getBounds();
    return {
        width: size.width / bounds.width,
        height: size.height / bounds.height,
    };
}
function relativeToAbsolutePoint(point, space, ignorePivot) {
    if (ignorePivot === void 0) { ignorePivot = true; }
    var bounds = space.getBounds();
    return {
        x: (point.x - (ignorePivot ? 0 : bounds.minX)) * bounds.width,
        y: (point.y - (ignorePivot ? 0 : bounds.minY)) * bounds.height,
    };
}
function absoluteToRelativePoint(point, space, ignorePivot) {
    if (ignorePivot === void 0) { ignorePivot = true; }
    var bounds = space.getBounds();
    return {
        x: (point.x - (ignorePivot ? 0 : bounds.minX)) / bounds.width,
        y: (point.y - (ignorePivot ? 0 : bounds.minY)) / bounds.height,
    };
}
// / Returns the rotation of the destination coordinate system
// / relative to the source coordinate system
function getRotationBetweenCoordinateSpaces(source, destination) {
    var unitInSrc = { x: 1, y: 0 };
    var unitInDst = pointFromSpaceToSpace(unitInSrc, source, destination, true);
    var originInDst = pointFromSpaceToSpace(Vector2.ZERO, source, destination, true);
    return Math.atan2(unitInDst.y - originInDst.y, unitInDst.x - originInDst.x);
}

var conversionUtils = /*#__PURE__*/Object.freeze({
    __proto__: null,
    getScalarInWorldSpace: getScalarInWorldSpace,
    getPointInWorldSpace: getPointInWorldSpace,
    getSizeInWorldSpace: getSizeInWorldSpace,
    getSizeInOutputSpace: getSizeInOutputSpace,
    pointFromSpaceToSpace: pointFromSpaceToSpace,
    sizeFromSpaceToSpace: sizeFromSpaceToSpace,
    scalarFromSpaceToSpace: scalarFromSpaceToSpace,
    relativeToAbsolutePoint: relativeToAbsolutePoint,
    absoluteToRelativePoint: absoluteToRelativePoint,
    relativeToAbsoluteSize: relativeToAbsoluteSize,
    absoluteToRelativeSize: absoluteToRelativeSize,
    rectTransformToAffineTransform: rectTransformToAffineTransform,
    getLocalToParentMatrix: getLocalToParentMatrix,
    getLocalToWorldMatrix: getLocalToWorldMatrix,
    getBaseLocalToWorldMatrix: getBaseLocalToWorldMatrix,
    getRotationBetweenCoordinateSpaces: getRotationBetweenCoordinateSpaces
});

function isRGBObject(color) {
    return typeof color !== 'string' && !Array.isArray(color) && color.a === undefined;
}
function isRGBArray(color) {
    return typeof color !== 'string' && Array.isArray(color) && color.length === 3;
}
function isRGBAObject(color) {
    return typeof color !== 'string' && !Array.isArray(color) && color.a !== undefined;
}
function isRGBAArray(color) {
    return typeof color !== 'string' && Array.isArray(color) && color.length === 4;
}
function isHex(color) {
    return typeof color === 'string';
}

var EngineEvent;
(function (EngineEvent) {
    /**
     * Emitted when the engine begins downscaling an image due to configured or
     * hardware-given dimension constraints.
     */
    EngineEvent["BEGAN_IMAGE_DOWNSCALING"] = "beganImageDownscaling";
    /**
     * Emitted when the engine has finished downscaling an image due to configured or
     * hardware-given dimension constraints.
     */
    EngineEvent["IMAGE_DOWNSCALED"] = "imageDownscaled";
})(EngineEvent || (EngineEvent = {}));

/**
 * A preview instance encapsulates the necessary data for the engine to render
 * a preview of its output into a separate canvas at an optionally lower quality.
 */
var Preview = /** @class */ (function () {
    function Preview(canvas, engine) {
        this.engine = engine;
        /**
         * The transform that positions the OutputContainer in the bounds of the preview canvas.
         */
        this.transform = RectTransform.IDENTITY;
        this.canvasPivot = { x: 0, y: 0 };
        this.previewQuality = 1;
        this.canvas = canvas;
    }
    Object.defineProperty(Preview.prototype, "quality", {
        /**
         * The quality (between 0 and 1) at which the preview should be rendered.
         * A lower quality value makes the engine use lower resolution textures internally, which
         * increases the rendering efficiency in terms of both speed and memory usage.
         */
        get: function () {
            return this.previewQuality;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Set the quality of this preview. (@see quality)
     * @param quality The new preview quality between 0.01 and 1
     */
    Preview.prototype.setQuality = function (quality) {
        this.previewQuality = Math.min(Math.max(quality, 0.01), 1);
    };
    /**
     * @returns The transform that positions the OutputContainer in the bounds of the preview canvas.
     */
    Preview.prototype.getTransform = function () {
        return this.transform;
    };
    /**
     * Sets the transform that positions the OutputContainer in the bounds of the preview canvas.
     * @param transform The local to parent space transformation.
     */
    Preview.prototype.setTransform = function (transform) {
        this.transform = transform;
    };
    // More granular transform getters and setters
    /**
     * @returns The container's local position in pixel coordinates.
     */
    Preview.prototype.getPosition = function () {
        return this.transform.position;
    };
    Preview.prototype.setPosition = function (x, y) {
        var position;
        if (typeof x === 'number') {
            position = { x: x, y: y === undefined ? x : y };
        }
        else {
            position = x;
        }
        var scale = this.transform.scale;
        var rotation = this.transform.rotation;
        this.setTransform(new RectTransform(position, scale, rotation));
    };
    /**
     * @returns The local scale of the container.
     */
    Preview.prototype.getScale = function () {
        return this.transform.scale;
    };
    Preview.prototype.setScale = function (x, y) {
        var scale;
        if (typeof x !== 'number') {
            scale = x;
        }
        else {
            scale = { x: x, y: y === undefined ? x : y };
        }
        var position = this.transform.position;
        var rotation = this.transform.rotation;
        this.setTransform(new RectTransform(position, scale, rotation));
    };
    /**
     * @returns The local rotation of the container in radians.
     */
    Preview.prototype.getRotation = function () {
        return this.transform.rotation;
    };
    /**
     * Sets the local rotation of the container.
     * @param rotation The new local rotation in radians.
     */
    Preview.prototype.setRotation = function (rotation) {
        var position = this.transform.position;
        var scale = this.transform.scale;
        this.setTransform(new RectTransform(position, scale, rotation));
    };
    /**
     * Returns the origin of the preview canvas' local coordinate system relative to its bounds size.
     * This is the same as the pivot of the OutputContainer.
     */
    Preview.prototype.getCanvasPivot = function () {
        return this.canvasPivot;
    };
    Preview.prototype.setCanvasPivot = function (x, y) {
        if (typeof x === 'number') {
            this.canvasPivot = { x: x, y: typeof y === undefined ? x : y };
        }
        else {
            this.canvasPivot = x;
        }
    };
    /**
     * @returns The bounds of the preview canvas.
     */
    Preview.prototype.getCanvasBounds = function () {
        var pivot = this.canvasPivot;
        var _a = this.canvas, width = _a.width, height = _a.height;
        return new Rect(-pivot.x * width, -pivot.y * height, width, height);
    };
    return Preview;
}());

function isContainer(element) {
    return element.getTransform !== undefined;
}
function isEffect(element) {
    return element.getContainer !== undefined;
}

/**
 * A rendering and image editing engine.
 *
 * An engine provides preview rendering functionality, keeps track of all containers and
 * effects in a world and provides functions to create and destroy such containers and effects.
 *
 * Containers and effects can only be created by an engine instance. Since the data of all
 * container and effect types is always required to be fully loaded, there are synchronous
 * functions for creating each type of container and effect (e.g. {@link addSticker}).
 *
 * For container and effect types which can be defined as assets there are additional, asynchronous
 * functions that take an asset identifier, which is used to load the asset data and create
 * the respective container/effect from that data.
 *
 * When composing containers to construct the final image edit, there are different coordinate
 * spaces to be aware of - world coordinates, local container coordinates, output coordinates
 * and preview coordinates. All coordinate systems are pixel-based, have their origin in the top-left
 * corner, their x-axis going right and their y-axis going down.
 *
 * Each container has its own local coordinate system defined by its bounds (@see {@link Container}
 * for further details on container hierarchy).
 *
 * All of the root containers including the output
 * container are positioned in world-space. The world coordinate system is defined once the
 * first container has been created. It will be the same as the initial, untransformed coordinate
 * system of that first container. However, unlike the container coordinate system, you cannot
 * change the world coordinate system afterwards.
 *
 * The output coordinate system is the local coordinate system of the output container. It is
 * effectively the pixel-based coordinate system of the image output that is generated
 * by a call to export.
 *
 * If you don't need the preview rendering functionality, then these are all of the coordinate
 * systems that you need to care about. When rendering a preview of the current image edit state
 * an additional coordinate system is given by the canvas, which the preview should be rendered
 * into. An additional RectTransform describes how the engine output (which has the resolution
 * of the OutputContainer) should be rendered into the preview canvas. This transformation is
 * also needed when converting between the preview space and the world or container spaces.
 *
 * An engine offers coordinate space conversion helper functions which can be used to
 * conveniently convert points between preview, output and world space.
 *
 * The hit-testing helper functions allow you to query all containers that a given point falls
 * within.
 */
var Engine = /** @class */ (function (_super) {
    __extends(Engine, _super);
    /**
     * Creates a new Engine instance.
     * @param config The configuration options of the engine.
     */
    function Engine(config) {
        var _this = _super.call(this) || this;
        _this.config = config;
        return _this;
    }
    /**
     * @returns Returns the dimensions of the OutputContainer or a zero size if an
     * OutputContainer doesn't exist yet.
     */
    Engine.prototype.getOutputDimensions = function () {
        var outputContainer = this.getOutputContainer();
        if (!outputContainer) {
            return { width: 0, height: 0 };
        }
        return outputContainer.getResolution();
    };
    // Coordinate space conversion helpers
    /**
     * Converts the given point from preview space into output space.
     * @param point The point in preview coordinates.
     * @param previewTransform The preview rendering transformation.
     */
    // eslint-disable-next-line class-methods-use-this
    Engine.prototype.convertPointFromPreviewIntoOutputSpace = function (point, previewTransform) {
        var affineTransform = AffineTransform.getInverted(rectTransformToAffineTransform(previewTransform));
        return AffineTransform.transformPoint(affineTransform, point);
    };
    /**
     * Converts the given point from preview space into world space.
     * @param point The point in preview coordinates.
     * @param previewTransform The preview rendering transformation.
     */
    // eslint-disable-next-line class-methods-use-this
    Engine.prototype.convertPointFromPreviewIntoWorldSpace = function (point, previewTransform, useOutputWithoutFlip) {
        var previewToOutputTransform = AffineTransform.getInverted(rectTransformToAffineTransform(previewTransform));
        var outputToWorldTransform = useOutputWithoutFlip
            ? this.getOutputContainer().getBaseLocalToParentMatrix()
            : this.getOutputContainer().getLocalToParentMatrix();
        var previewToWorldTransform = AffineTransform.multiply(outputToWorldTransform, previewToOutputTransform);
        return AffineTransform.transformPoint(previewToWorldTransform, point);
    };
    /**
     * Converts the given point from preview space into preview space with flip.
     * @param point The point in preview coordinates.
     */
    Engine.prototype.convertPointFromPreviewIntoFlippedPreviewSpace = function (point) {
        var flipTransform = this.getOutputContainer().getFlipTransformMatrix();
        return AffineTransform.transformPoint(flipTransform, point);
    };
    /**
     * Converts the given point from world space into preview space.
     * @param point The point in preview coordinates.
     * @param previewTransform The preview rendering transformation.
     */
    Engine.prototype.convertPointFromWorldIntoPreviewSpace = function (point, previewTransform) {
        var outputToPreviewTransform = rectTransformToAffineTransform(previewTransform);
        var worldToOutputTransform = AffineTransform.getInverted(this.getOutputContainer().getLocalToParentMatrix());
        var worldToPreviewTransform = AffineTransform.multiply(outputToPreviewTransform, worldToOutputTransform);
        return AffineTransform.transformPoint(worldToPreviewTransform, point);
    };
    /**
     * Converts the given point from output space into preview space.
     * @param point The point in preview coordinates.
     * @param previewTransform The preview rendering transformation.
     */
    // eslint-disable-next-line class-methods-use-this
    Engine.prototype.convertPointFromOutputIntoPreviewSpace = function (point, previewTransform) {
        var outputToPreviewTransform = rectTransformToAffineTransform(previewTransform);
        return AffineTransform.transformPoint(outputToPreviewTransform, point);
    };
    // Hit testing helpers
    /**
     * Returns which containers in the hierarchy the given preview-space point lies within.
     * @param point - The point in preview space.
     * @param previewTransform - The current preview transform.
     * @returns - A list of containers ordered from lowest to highest which contain the given point.
     */
    Engine.prototype.getContainersAtPreviewPoint = function (point, previewTransform) {
        var e_1, _a;
        var results = new Array();
        var worldPoint = this.convertPointFromPreviewIntoWorldSpace(point, previewTransform);
        var rootContainers = this.getRootContainers();
        try {
            // eslint-disable-next-line no-restricted-syntax
            for (var rootContainers_1 = __values(rootContainers), rootContainers_1_1 = rootContainers_1.next(); !rootContainers_1_1.done; rootContainers_1_1 = rootContainers_1.next()) {
                var container = rootContainers_1_1.value;
                this.accumulateContainersAtWorldPointInHierarchy(worldPoint, container, results);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (rootContainers_1_1 && !rootContainers_1_1.done && (_a = rootContainers_1.return)) _a.call(rootContainers_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return results;
    };
    /**
     * Returns whether or not the given preview-space point falls within the specified container bounds.
     * @param point - The point in preview space.
     * @param container - The container.
     * @param previewTransform - The current preview transform.
     * @returns - True if `point` lies within `container` in preview-space.
     */
    Engine.prototype.isPreviewPointInContainer = function (point, container, previewTransform) {
        var worldPoint = this.convertPointFromPreviewIntoWorldSpace(point, previewTransform);
        return this.isWorldPointInContainer(worldPoint, container);
    };
    /**
     * Returns whether or not the given world-space point falls within the specified container bounds.
     * @param point - The point in world-space.
     * @param container - The container.
     * @returns - True if `point` lies within `container` in world-space.
     */
    // eslint-disable-next-line class-methods-use-this
    Engine.prototype.isWorldPointInContainer = function (point, container) {
        var containerToWorld = getLocalToWorldMatrix(container);
        var worldToContainer = AffineTransform.getInverted(containerToWorld);
        var pointInContainerSpace = AffineTransform.transformPoint(worldToContainer, point);
        return Rect.contains(container.getBounds(), pointInContainerSpace);
    };
    /**
     * Returns which containers of the given container hierarchy point lies within.
     * @param point - The point in world space.
     * @param container - The container.
     * @returns - A list of containers ordered from lowest to highest which contain the given point.
     */
    Engine.prototype.accumulateContainersAtWorldPointInHierarchy = function (point, container, result) {
        var e_2, _a;
        if (this.isWorldPointInContainer(point, container)) {
            result.push(container);
        }
        var children = container.getChildren();
        try {
            // eslint-disable-next-line no-restricted-syntax
            for (var children_1 = __values(children), children_1_1 = children_1.next(); !children_1_1.done; children_1_1 = children_1.next()) {
                var child = children_1_1.value;
                if (isContainer(child)) {
                    this.accumulateContainersAtWorldPointInHierarchy(point, child, result);
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (children_1_1 && !children_1_1.done && (_a = children_1.return)) _a.call(children_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    return Engine;
}(EventEmitter));

/* @module */
/* eslint-disable */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */
/**
 * Represents a 2-dimensional vector while providing math functions to
 * modify / clone the vector. Fully chainable.
 * @class
 * @memberof PhotoEditorSDK.Math
 */
var Vector2$1 = /** @class */ (function () {
    /**
     * Creates a Vector2
     * @param  {number} x
     * @param  {number} y
     */
    function Vector2(x, y) {
        if (x === void 0) { x = 0; }
        if (y === void 0) { y = 0; }
        this._x = x;
        this._y = y;
    }
    Object.defineProperty(Vector2.prototype, "x", {
        get: function () {
            return this._x;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Vector2.prototype, "y", {
        get: function () {
            return this._y;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Sets the given values
     * @param {number} x
     * @param {number} y
     * @return {Vector2}
     */
    Vector2.prototype.set = function (x, y) {
        this._x = x;
        this._y = y;
        return this;
    };
    /**
     * Creates a clone of this vector
     * @return {Vector2}
     */
    Vector2.prototype.clone = function () {
        return new Vector2(this._x, this._y);
    };
    /**
     * Copies the values of the given vector
     * @param  {Vector2} other
     * @return {Vector2}
     */
    Vector2.prototype.copy = function (other) {
        this._x = other.x;
        this._y = other.y;
        return this;
    };
    /**
     * Clamps this vector with the given Vector2 / Number
     * @param  {(number|Vector2)} minimum
     * @param  {(number|Vector2)} maximum
     * @return {Vector2}
     */
    Vector2.prototype.clamped = function (minimum, maximum) {
        if (minimum === void 0) { minimum = this; }
        if (maximum === void 0) { maximum = this; }
        var min = typeof minimum === 'number' ? { x: minimum, y: minimum } : minimum;
        var max = typeof maximum === 'number' ? { x: maximum, y: maximum } : maximum;
        this._x = Math.max(min.x, this._x);
        this._y = Math.max(min.y, this._y);
        this._x = Math.min(max.x, this._x);
        this._y = Math.min(max.y, this._y);
        return this;
    };
    /**
     * Divides this vector by the given Vector2 / Number
     * @param  {(number|Vector2)} divisor
     * @param  {number} [y]
     * @return {Vector2}
     */
    Vector2.prototype.divide = function (divisor, y) {
        if (typeof divisor === 'number' || divisor === null) {
            // @ts-ignore TS2363
            this._x /= divisor;
            // @ts-ignore TS2363
            this._y /= (typeof y === 'undefined' ? divisor : y);
        }
        else {
            this._x /= divisor.x;
            this._y /= divisor.y;
        }
        return this;
    };
    /**
     * Subtracts the given Vector2 / Number from this vector
     * @param  {(number|Vector2)} subtrahend
     * @param  {number} [y]
     * @return {Vector2}
     */
    Vector2.prototype.subtract = function (subtrahend, y) {
        if (typeof subtrahend === 'number' || subtrahend === null) {
            // @ts-ignore TS2363
            this._x -= subtrahend;
            // @ts-ignore TS2363
            this._y -= (typeof y === 'undefined' ? subtrahend : y);
        }
        else {
            this._x -= subtrahend.x;
            this._y -= subtrahend.y;
        }
        return this;
    };
    /**
     * Multiplies the given Vector2 / Number with this vector
     * @param  {(number|Vector2)} subtrahend
     * @param  {number} [y]
     * @return {Vector2}
     */
    Vector2.prototype.multiply = function (factor, y) {
        if (typeof factor === 'number' || factor === null) {
            // @ts-ignore TS2363
            this._x *= factor;
            // @ts-ignore TS2363
            this._y *= (typeof y === 'undefined' ? factor : y);
        }
        else {
            this._x *= factor.x;
            this._y *= factor.y;
        }
        return this;
    };
    /**
     * Adds the given Vector2 / Numbers to this vector
     * @param {(number|Vector2)} addend
     * @param {number} [y]
     * @return {Vector2}
     */
    Vector2.prototype.add = function (addend, y) {
        if (typeof addend === 'number' || addend === null) {
            // @ts-ignore TS2363
            this._x += addend;
            // @ts-ignore TS2363
            this._y += (typeof y === 'undefined' ? addend : y);
        }
        else {
            this._x += addend.x;
            this._y += addend.y;
        }
        return this;
    };
    /**
     * Computes the dot product of this vector and the
     * given Vector2 / Numbers
     * @param {(Number|PhotoEditorSDK.Math.Vector2)} vec
     * @param {Number} [y]
     * @returns {Number}
     */
    Vector2.prototype.dot = function (vec, y) {
        if (typeof vec === 'number' || vec === null) {
            // @ts-ignore TS2363
            return this._x * vec + this._y * (typeof y === 'undefined' ? vec : y);
        }
        else {
            return this._x * vec.x + this._y * vec.y;
        }
    };
    /**
     * Checks whether the x and y value are the same as the given ones
     * @param  {(Number|PhotoEditorSDK.Math.Vector2)} vec
     * @param  {Number} y
     * @return {Boolean}
     */
    Vector2.prototype.equals = function (vec, y) {
        if (typeof vec === 'number' || vec === null) {
            return vec === this._x && y === this._y;
        }
        else {
            return vec.x === this._x && vec.y === this._y;
        }
    };
    /**
     * Flips the x and y values of this vector
     * @return {Vector2}
     */
    Vector2.prototype.flip = function () {
        var tempX = this._x;
        this._x = this._y;
        this._y = tempX;
        return this;
    };
    /**
     * Rounds the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector2}
     */
    Vector2.prototype.round = function () {
        this._x = Math.round(this._x);
        this._y = Math.round(this._y);
        return this;
    };
    /**
     * Rounds up the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector2}
     */
    Vector2.prototype.ceil = function () {
        this._x = Math.ceil(this._x);
        this._y = Math.ceil(this._y);
        return this;
    };
    /**
     * Rounds down the values of this vector
     * @returns {PhotoEditorSDK.Math.Vector2}
     */
    Vector2.prototype.floor = function () {
        this._x = this._x | 0;
        this._y = this._y | 0;
        return this;
    };
    /**
     * Makes both numbers of this vector positive
     * @returns {PhotoEditorSDK.Math.Vector2}
     */
    Vector2.prototype.abs = function () {
        this._x = Math.abs(this._x);
        this._y = Math.abs(this._y);
        return this;
    };
    /**
     * Returns the euclidean length of this vector
     * @return {Number}
     */
    Vector2.prototype.len = function () {
        return Math.sqrt(this._x * this._x + this._y * this._y);
    };
    /**
     * Returns the smallest number in this vector
     * @return {Number}
     */
    Vector2.prototype.min = function () {
        return Math.min(this._x, this._y);
    };
    /**
     * Returns the largest number in this vector
     * @return {Number}
     */
    Vector2.prototype.max = function () {
        return Math.max(this._x, this._y);
    };
    /**
     * Returns a POJO of this Vector2
     * @return {Object}
     */
    Vector2.prototype.toObject = function () {
        return { x: this._x, y: this._y };
    };
    /**
     * Returns a string representation of this vector
     * @return {String}
     */
    Vector2.prototype.toString = function () {
        return "Vector2({ x: " + this._x + ", y: " + this._y + " })";
    };
    /**
     * Rounds this vector's values to the given number of decimals
     * @param  {Number} decimals
     * @return {Number}
     */
    Vector2.prototype.roundDecimal = function (decimals) {
        this._x = parseFloat(this._x.toFixed(decimals));
        this._y = parseFloat(this._y.toFixed(decimals));
        return this;
    };
    /**
     * Returns the values in an array
     * @param {Bool} reverse
     * @return {Number[]}
     */
    Vector2.prototype.asArray = function (reverse) {
        if (reverse === void 0) { reverse = false; }
        if (reverse) {
            return [this._y, this._x];
        }
        return [this._x, this._y];
    };
    /**
     * Creates a new Vector2 instance from the given Object
     * @param  {Float2} object
     * @return {Vector2}
     */
    Vector2.fromObject = function (object) {
        return new Vector2(object.x, object.y);
    };
    /**
     * Creates a new Vector2 instance from the given size
     * @param {Size} size
     */
    Vector2.fromSize = function (size) {
        return new Vector2(size.width, size.height);
    };
    Object.defineProperty(Vector2, "NULL", {
        /**
         * Returns a null vector
         * @return {PhotoEditorSDK.Math.Vector2}
         */
        get: function () {
            return new Vector2(0, 0);
        },
        enumerable: true,
        configurable: true
    });
    return Vector2;
}());

var ContainerAdapter = /** @class */ (function () {
    function ContainerAdapter(engine) {
        this.engine = engine;
        this.id = uuid();
        this.transform = RectTransform.IDENTITY;
        this.bounds = Rect.ZERO;
    }
    ContainerAdapter.prototype.getID = function () {
        return this.id;
    };
    ContainerAdapter.prototype.getParent = function () {
        // This adapter only supports a single container hierarchy
        // with the initial image container at its root
        var rootContainers = this.engine.getRootContainers();
        if (rootContainers.length === 0 || this.id === rootContainers[0].id) {
            return undefined;
        }
        return rootContainers[0];
    };
    ContainerAdapter.prototype.getIndexInParent = function () {
        var rootOperations = this.engine.rootOperations;
        for (var i = 0; i < rootOperations.length; i += 1) {
            if (rootOperations[i].getID() === this.id) {
                return i;
            }
        }
        return -1;
    };
    ContainerAdapter.prototype.setIndexInParent = function (index) {
        this.engine.moveIndex(this, index);
    };
    ContainerAdapter.prototype.getChildren = function () {
        var rootContainers = this.engine.getRootContainers();
        if (rootContainers.length > 0 &&
            (this.id === rootContainers[0].id || this.id === this.engine.getOutputContainer().id)) {
            return this.engine.rootOperations;
        }
        return [];
    };
    ContainerAdapter.prototype.getBounds = function () {
        return this.bounds;
    };
    ContainerAdapter.prototype.setPivotOnSelfAndSprite = function (sprite, pivot, y) {
        if (typeof pivot === 'number') {
            this.setPivotInternal(pivot, y);
            sprite.setPivot(new Vector2$1(pivot, y));
        }
        else {
            this.setPivotInternal(pivot);
            sprite.setPivot(Vector2$1.fromObject(pivot));
        }
    };
    ContainerAdapter.prototype.setPivot = function (pivot, y) {
        this.setPivotInternal(pivot, y);
    };
    ContainerAdapter.prototype.getPivot = function () {
        var bounds = this.getBounds();
        return { x: -bounds.minX / bounds.width, y: -bounds.minY / bounds.height };
    };
    ContainerAdapter.prototype.getTransform = function () {
        return this.transform;
    };
    ContainerAdapter.prototype.setTransform = function (transform) {
        this.transform = transform;
    };
    ContainerAdapter.prototype.updateTransform = function () {
        this.setTransform(this.transform);
    };
    ContainerAdapter.prototype.getPosition = function () {
        return this.transform.position;
    };
    ContainerAdapter.prototype.setPosition = function (x, y) {
        var position;
        if (typeof x === 'number') {
            position = { x: x, y: y === undefined ? x : y };
        }
        else {
            position = x;
        }
        var scale = this.transform.scale;
        var rotation = this.transform.rotation;
        this.setTransform(new RectTransform(position, scale, rotation));
    };
    ContainerAdapter.prototype.getScale = function () {
        return this.transform.scale;
    };
    ContainerAdapter.prototype.setScale = function (x, y) {
        var scale;
        if (typeof x !== 'number') {
            scale = x;
        }
        else {
            scale = { x: x, y: y === undefined ? x : y };
        }
        var _a = this.transform, position = _a.position, rotation = _a.rotation;
        this.setTransform(new RectTransform(position, scale, rotation));
    };
    ContainerAdapter.prototype.getRotation = function () {
        return this.transform.rotation;
    };
    ContainerAdapter.prototype.setRotation = function (rotation) {
        var _a = this.transform, position = _a.position, scale = _a.scale;
        this.setTransform(new RectTransform(position, scale, rotation));
    };
    ContainerAdapter.prototype.getSizeInWorldSpace = function () {
        return getSizeInWorldSpace(this);
    };
    ContainerAdapter.prototype.getSizeInOutputSpace = function () {
        return getSizeInOutputSpace(this, this.engine.getOutputContainer());
    };
    ContainerAdapter.prototype.isValid = function () {
        return this.getIndexInParent() !== -1;
    };
    ContainerAdapter.prototype.setPivotInternal = function (pivot, y) {
        var bounds = this.getBounds();
        if (typeof pivot === 'number') {
            this.setBoundsFromSize(bounds.width, bounds.height, { x: pivot, y: y });
        }
        else {
            this.setBoundsFromSize(bounds.width, bounds.height, pivot);
        }
    };
    ContainerAdapter.prototype.setBoundsFromSize = function (width, height, pivot) {
        if (pivot === void 0) { pivot = this.getPivot(); }
        this.bounds = new Rect(-pivot.x * width, -pivot.y * height, width, height);
    };
    return ContainerAdapter;
}());

function isCanvas(image) {
    return image.getContext !== undefined;
}
var ImageContainerAdapter = /** @class */ (function (_super) {
    __extends(ImageContainerAdapter, _super);
    function ImageContainerAdapter(data, engine) {
        var _this = _super.call(this, engine) || this;
        _this.data = data;
        _this.type = 'image';
        var configDownscaleOptions = engine.configuration.downscaleOptions;
        if (!configDownscaleOptions) {
            _this.downscaleOptions = {
                maxDimensions: { width: engine.maxTextureDimension, height: engine.maxTextureDimension },
            };
        }
        else {
            var maxDimensions = configDownscaleOptions.maxDimensions;
            _this.downscaleOptions = {
                maxMegaPixels: configDownscaleOptions.maxMegaPixels,
                maxDimensions: {
                    width: Math.min(engine.maxTextureDimension, maxDimensions ? maxDimensions.width : Number.MAX_VALUE),
                    height: Math.min(engine.maxTextureDimension, maxDimensions ? maxDimensions.height : Number.MAX_VALUE),
                },
            };
        }
        _this.setData(data);
        var image = _this.data.image;
        _this.bounds = new Rect(Vector2.ZERO, { width: image.width, height: image.height });
        return _this;
    }
    ImageContainerAdapter.prototype.setData = function (state) {
        var _this = this;
        this.data = __assign({}, this.data, state);
        if (state.image) {
            var image = state.image;
            var exifData 
            // Exif Orientation needs to be corrected before downscaling
            = void 0;
            // Exif Orientation needs to be corrected before downscaling
            if (!isCanvas(image)) {
                exifData = this.engine.pesdk.parseExif(image);
                if (exifData) {
                    var tags = exifData.getTags();
                    if (tags && tags.Orientation) {
                        var rotationNeedsChange = tags.Orientation !== 1 && tags.Orientation !== 2;
                        var flipNeedsChange = [2, 4, 5, 7].indexOf(tags.Orientation) !== -1;
                        if (rotationNeedsChange || flipNeedsChange) {
                            var exifOperation = this.engine.pesdk.createOperation('exif-orientation', {}, false);
                            exifOperation.setTags(tags);
                            image = exifOperation.applyTo(image);
                            exifData.setOrientation(1);
                            tags.Orientation = 1;
                        }
                    }
                }
            }
            var imageResizer = new ImageResizer(image, this.downscaleOptions);
            imageResizer.on(ImageResizerEvent.IMAGE_DOWNSCALED, function () {
                _this.engine.emit(EngineEvent.IMAGE_DOWNSCALED);
            });
            imageResizer.on(ImageResizerEvent.BEGAN_IMAGE_DOWNSCALING, function () {
                _this.engine.emit(EngineEvent.BEGAN_IMAGE_DOWNSCALING);
            });
            image = imageResizer.downscaleIfNecessary();
            this.data.image = image;
            this.engine.pesdk.setImage(image, exifData);
            this.setBoundsFromSize(image.width, image.height);
        }
    };
    ImageContainerAdapter.prototype.getData = function () {
        return this.data;
    };
    // eslint-disable-next-line
    ImageContainerAdapter.prototype.setPivot = function (pivot, y) {
        throw new Error('This container does not support modifying the pivot');
    };
    // eslint-disable-next-line
    ImageContainerAdapter.prototype.getOperation = function () {
        throw new Error('This container has no associated operation');
    };
    return ImageContainerAdapter;
}(ContainerAdapter));

var newToLegacyColor = function (color) {
    if (isRGBAObject(color)) {
        return new PhotoEditorSDK_Engine_1.Color(color.r, color.g, color.b, color.a);
    }
    if (isRGBAArray(color)) {
        return new PhotoEditorSDK_Engine_1.Color(color[0], color[1], color[2], color[3]);
    }
    if (isRGBObject(color)) {
        return new PhotoEditorSDK_Engine_1.Color(color.r, color.g, color.b, 1);
    }
    if (isRGBArray(color)) {
        return new PhotoEditorSDK_Engine_1.Color(color[0], color[1], color[2], 1);
    }
    if (isHex(color)) {
        var _a = __read(color.match(/[0-9A-fa-f]{1,2}/g), 3), r = _a[0], g = _a[1], b = _a[2];
        return new PhotoEditorSDK_Engine_1.Color(parseInt(r, 16) / 255, parseInt(g, 16) / 255, parseInt(b, 16) / 255, 1);
    }
    throw new Error('Invalid color type');
};

var StickerContainerAdapter = /** @class */ (function (_super) {
    __extends(StickerContainerAdapter, _super);
    function StickerContainerAdapter(data, engine) {
        var _this = _super.call(this, engine) || this;
        _this.data = data;
        _this.type = 'sticker';
        // eslint-disable-next-line prefer-destructuring
        var image = data.image;
        // Exif Orientation needs to be corrected before downscaling
        var exifData = _this.engine.pesdk.parseExif(data.image);
        if (exifData) {
            var tags = exifData.getTags();
            if (tags && tags.Orientation) {
                var rotationNeedsChange = tags.Orientation !== 1 && tags.Orientation !== 2;
                var flipNeedsChange = [2, 4, 5, 7].indexOf(tags.Orientation) !== -1;
                if (rotationNeedsChange || flipNeedsChange) {
                    var exifOperation = _this.engine.pesdk.createOperation('exif-orientation', {}, false);
                    exifOperation.setTags(tags);
                    image = exifOperation.applyTo(data.image);
                    exifData.setOrientation(1);
                    tags.Orientation = 1;
                }
            }
        }
        var imageResizer = new ImageResizer(image, {
            maxMegaPixels: {
                desktop: 10,
                mobile: 5,
            },
        });
        image = imageResizer.downscaleImageIfNecessary();
        _this.operation = engine.createSpriteOperation();
        _this.sprite = _this.operation.createSticker({
            identifier: '',
            image: image,
            position: new Vector2$1(0, 0),
            dimensions: new Vector2$1(1, 1),
            rotation: 0,
            smoothDownscaling: false,
        });
        _this.operation.addSprite(_this.sprite);
        _this.bounds = new Rect({ x: 0, y: 0 }, {
            width: image.width,
            height: image.height,
        });
        _this.setTransform(RectTransform.IDENTITY);
        _this.sprite.setPivot(new Vector2$1(0, 0));
        _this.operation.setDirty(true);
        _this.setData(data);
        return _this;
    }
    StickerContainerAdapter.prototype.setData = function (state) {
        this.data = __assign({}, this.data, state);
        if (state.id) {
            this.id = state.id;
        }
        if (state.opacity) {
            this.sprite.setAlpha(state.opacity);
        }
        if (state.tintColor) {
            this.sprite.setTintColor(newToLegacyColor(state.tintColor));
        }
        if (state.tintMode) {
            this.sprite.setTintMode(state.tintMode);
        }
        this.operation.setDirty(true);
    };
    StickerContainerAdapter.prototype.getData = function () {
        return this.data;
    };
    StickerContainerAdapter.prototype.updateData = function () {
        this.setData(this.getData());
    };
    StickerContainerAdapter.prototype.setTransform = function (transform) {
        _super.prototype.setTransform.call(this, transform);
        var outputSpace = this.engine.getOutputContainer();
        var parentSpace = this.getParent();
        // Convert Scale
        var absoluteDimensionsInParentSpace = {
            x: this.bounds.width * transform.scale.x,
            y: this.bounds.height * transform.scale.y,
        };
        var dimensionsInOutputSpace = sizeFromSpaceToSpace(absoluteDimensionsInParentSpace, parentSpace, outputSpace);
        this.sprite.setDimensions(Vector2$1.fromSize(dimensionsInOutputSpace));
        // Convert position
        var absolutePositionInOutputSpace = pointFromSpaceToSpace(transform.position, parentSpace, outputSpace, true);
        var relativePositionInOutputSpace = absoluteToRelativePoint(absolutePositionInOutputSpace, outputSpace, false);
        this.sprite.setPosition(new Vector2$1(relativePositionInOutputSpace.x, relativePositionInOutputSpace.y));
        // Convert rotation
        var relativeOutputRotation = getRotationBetweenCoordinateSpaces(parentSpace, outputSpace);
        var spriteRotation = transform.rotation + relativeOutputRotation;
        this.sprite.setRotation(spriteRotation);
        this.operation.setDirty(true);
    };
    StickerContainerAdapter.prototype.setPivot = function (pivot, y) {
        this.setPivotOnSelfAndSprite(this.sprite, pivot, y);
    };
    StickerContainerAdapter.prototype.getOperation = function () {
        return this.operation;
    };
    StickerContainerAdapter.prototype.setFlipHorizontally = function (scale) {
        this.sprite.setFlipHorizontally(scale);
    };
    StickerContainerAdapter.prototype.setFlipVertically = function (scale) {
        this.sprite.setFlipVertically(scale);
    };
    StickerContainerAdapter.prototype.getFlipHorizontally = function () {
        return this.sprite.getFlipHorizontally();
    };
    StickerContainerAdapter.prototype.getFlipVertically = function () {
        return this.sprite.getFlipVertically();
    };
    return StickerContainerAdapter;
}(ContainerAdapter));

function calculateTextHeight(fontSize, metrics) {
    var scale = 1 / metrics.unitsPerEm * fontSize;
    var ascent = metrics.ascender * scale;
    var descent = metrics.descender * scale;
    return ascent + Math.abs(descent);
}
var TextSplitter = /** @class */ (function () {
    // eslint-disable-next-line no-useless-constructor
    function TextSplitter(context) {
        this.context = context;
        this.sourceLines = [];
        this.maxWidth = 100;
    }
    /**
     * Builds an array of words from the given line
     * @param  {String} line
     * @return {Array.<String>}
     * @private
     */
    TextSplitter.buildWords = function (line) {
        var words = [];
        var word = '';
        var len = line.length;
        for (var i = 0; i < len; i += 1) {
            var char = line[i];
            word += char;
            if (char === ' ' || char === '-' || i === len - 1) {
                words.push(word);
                word = '';
            }
        }
        return words;
    };
    /**
     * Returns the lines that fit the maxWidth
     * @return {Array.<String>}
     */
    TextSplitter.prototype.getLines = function () {
        var lines = [];
        var newLineWords = [];
        // Iterate over lines
        var linesCount = this.sourceLines.length;
        for (var l = 0; l < linesCount; l += 1) {
            var line = this.sourceLines[l];
            // Iterate over words
            var words = TextSplitter.buildWords(line);
            var wordsCount = words.length;
            for (var w = 0; w < wordsCount; w += 1) {
                var word = words[w];
                // Check if line is too wide for the maxwidth
                var currentLine = newLineWords.concat(word).join('')
                    .replace(/\s+$/i, '');
                var width = this.getWidth(currentLine);
                if (width > this.maxWidth) {
                    // If there have been words before this one, start
                    // a new line
                    if (newLineWords.length > 0) {
                        // Line too long -> line ended
                        lines.push(newLineWords.join(''));
                        // Start a new line with the word
                        newLineWords = [word];
                    }
                    // If the next word is too long (without trailing spaces), split it up
                    var wordWithoutTrailingSpaces = word.replace(/\s+$/i, '');
                    if (this.getWidth(wordWithoutTrailingSpaces) > this.maxWidth) {
                        var splitWord = this.splitWord(word);
                        lines = lines.concat(splitWord.lines);
                        if (splitWord.rest) {
                            newLineWords = [splitWord.rest];
                        }
                    }
                }
                else {
                    newLineWords.push(word);
                }
            }
            lines.push(newLineWords.join(''));
            newLineWords = [];
        }
        return lines;
    };
    /**
     * Splits up the given word to fit the max width
     * @param  {String} word
     * @return {Object}
     * @private
     */
    TextSplitter.prototype.splitWord = function (word) {
        var response = {
            lines: [],
            rest: null,
        };
        var wordLength = word.length;
        var chars = [];
        for (var c = 0; c < wordLength; c += 1) {
            var char = word[c];
            if (this.getWidth(chars.concat(char).join('')) > this.maxWidth) {
                if (chars.length > 0) {
                    response.lines.push(chars.join(''));
                }
                chars = [char];
            }
            else {
                chars.push(char);
            }
            if (c === wordLength - 1 && chars.length > 0) {
                response.rest = chars.join('');
            }
        }
        return response;
    };
    /**
     * Returns the measured width for the given string
     * @param  {String} text
     * @return {Number}
     * @private
     */
    TextSplitter.prototype.getWidth = function (text) {
        return this.context.measureText(text).width;
    };
    /**
     * Sets the text
     * @param {String} text
     */
    TextSplitter.prototype.setText = function (text) {
        this.sourceLines = text.split('\n');
    };
    /**
     * Sets the max width
     * @param {Number} maxWidth
     */
    TextSplitter.prototype.setMaxWidth = function (maxWidth) {
        this.maxWidth = maxWidth;
    };
    return TextSplitter;
}());
function measureTextDimensions(ctx, text, font, fontSize, relativeLineHeight, maxLineWidth, metrics) {
    ctx.font = (font.fontStyle || 'normal') + " " + (font.fontWeight || 'normal') + " " + fontSize + "px " + ("\"" + font.fontFamily + "\"");
    var splitter = new TextSplitter(ctx);
    splitter.setText(text);
    splitter.setMaxWidth(maxLineWidth);
    var lines = splitter.getLines().map(function (line) {
        // Remove trailing spaces
        return line.replace(/\s+$/i, '');
    });
    var textHeight = calculateTextHeight(fontSize, metrics);
    var lineHeight = textHeight * relativeLineHeight;
    return {
        width: maxLineWidth,
        height: lines.length * lineHeight,
    };
}

var flipRotationHorizontally = function (rotation) {
    return 2 * Math.PI - rotation;
};

var TextContainerAdapter = /** @class */ (function (_super) {
    __extends(TextContainerAdapter, _super);
    function TextContainerAdapter(text, engine) {
        var _this = _super.call(this, engine) || this;
        _this.text = text;
        _this.type = 'text';
        if (!TextContainerAdapter.measureContext) {
            var canvas = document.createElement('canvas');
            TextContainerAdapter.measureContext = canvas.getContext('2d');
        }
        _this.operation = engine.createSpriteOperation();
        var outputSpace = _this.engine.getOutputContainer();
        var parentSpace = _this.getParent();
        var outputBounds = outputSpace.getBounds();
        _this.sprite = _this.operation.createText({
            text: text.text,
            position: new Vector2$1(0, 0),
            rotation: 0,
            fontSize: scalarFromSpaceToSpace(text.fontSize / outputBounds.height, parentSpace, outputSpace),
            lineHeight: text.lineHeight,
            fontIdentifier: text.fontIdentifier,
            alignment: text.alignment,
            color: newToLegacyColor(text.textColor),
            backgroundColor: newToLegacyColor(text.backgroundColor),
            maxWidth: scalarFromSpaceToSpace(text.width / outputBounds.width, parentSpace, outputSpace),
        });
        var font = engine.assetProvider.getFontManager().getFontWithId(text.fontIdentifier);
        _this.sprite.setFontFamily(font.fontFamily);
        _this.sprite.setFontWeight(font.fontWeight || 'normal');
        _this.sprite.setFontStyle(font.fontStyle || 'normal');
        _this.sprite.setFontIdentifier(font.identifier);
        _this.sprite.setTextMetrics(font.textMetrics);
        _this.sprite.setPivot(new Vector2$1(0, 0));
        _this.operation.addSprite(_this.sprite);
        var renderedDimensions = measureTextDimensions(TextContainerAdapter.measureContext, text.text, font, text.fontSize, text.lineHeight, text.width, font.textMetrics);
        _this.bounds = new Rect(0, 0, renderedDimensions.width, renderedDimensions.height);
        _this.setTransform(RectTransform.IDENTITY);
        _this.operation.setDirty(true);
        return _this;
    }
    TextContainerAdapter.prototype.setData = function (state) {
        this.text = __assign({}, this.text, state);
        var font = this.engine.assetProvider.getFontManager().getFontWithId(state.fontIdentifier || this.text.fontIdentifier);
        if (state.fontIdentifier) {
            this.sprite.setFontFamily(font.fontFamily);
            this.sprite.setFontWeight(font.fontWeight || 'normal');
            this.sprite.setFontStyle(font.fontStyle || 'normal');
            this.sprite.setFontIdentifier(font.identifier);
            this.sprite.setTextMetrics(font.textMetrics);
        }
        if (state.id) {
            this.id = state.id;
        }
        if (state.text) {
            this.sprite.setText(state.text);
        }
        if (state.fontSize) {
            var outputSpace = this.engine.getOutputContainer();
            var parentSpace = this.getParent();
            var fontSize = scalarFromSpaceToSpace(state.fontSize, parentSpace, outputSpace);
            var outputBounds = outputSpace.getBounds();
            this.sprite.setFontSize(fontSize / outputBounds.height);
        }
        if (state.alignment) {
            this.sprite.setAlignment(state.alignment);
        }
        if (state.lineHeight) {
            this.sprite.setLineHeight(state.lineHeight);
        }
        if (state.textColor) {
            this.sprite.setColor(newToLegacyColor(state.textColor));
        }
        if (state.backgroundColor) {
            this.sprite.setBackgroundColor(newToLegacyColor(state.backgroundColor));
        }
        if (state.width) {
            var outputSpace = this.engine.getOutputContainer();
            var parentSpace = this.getParent();
            var width = scalarFromSpaceToSpace(state.width, parentSpace, outputSpace);
            var outputBounds = outputSpace.getBounds();
            this.sprite.setMaxWidth(width / outputBounds.width);
        }
        var renderedDimensions = measureTextDimensions(TextContainerAdapter.measureContext, this.text.text, font, this.text.fontSize, this.text.lineHeight, this.text.width, font.textMetrics);
        this.setBoundsFromSize(renderedDimensions.width, renderedDimensions.height);
        this.operation.setDirty(true);
    };
    TextContainerAdapter.prototype.getData = function () {
        return this.text;
    };
    TextContainerAdapter.prototype.updateData = function () {
        this.setData(this.getData());
    };
    TextContainerAdapter.prototype.setTransform = function (transform) {
        _super.prototype.setTransform.call(this, transform);
        var outputSpace = this.engine.getOutputContainer();
        var parentSpace = this.getParent();
        // Convert position
        var absolutePositionInOutputSpace = pointFromSpaceToSpace(transform.position, parentSpace, outputSpace, true);
        var relativePositionInOutputSpace = absoluteToRelativePoint(absolutePositionInOutputSpace, outputSpace, false);
        this.sprite.setPosition(new Vector2$1(relativePositionInOutputSpace.x, relativePositionInOutputSpace.y));
        // Convert rotation
        var relativeOutputRotation = getRotationBetweenCoordinateSpaces(parentSpace, outputSpace);
        this.sprite.setRotation(transform.rotation + relativeOutputRotation);
        this.operation.setDirty(true);
    };
    TextContainerAdapter.prototype.setPivot = function (pivot, y) {
        this.setPivotOnSelfAndSprite(this.sprite, pivot, y);
    };
    TextContainerAdapter.prototype.getOperation = function () {
        return this.operation;
    };
    TextContainerAdapter.prototype.setFlipHorizontally = function (isFlipped) {
        this.sprite.setRotation(this.getFlippedRotation({ flipHorizontally: isFlipped }));
        this.sprite.setFlipHorizontally(isFlipped);
    };
    TextContainerAdapter.prototype.setFlipVertically = function (isFlipped) {
        this.sprite.setRotation(this.getFlippedRotation({ flipVertically: isFlipped }));
        this.sprite.setFlipVertically(isFlipped);
    };
    TextContainerAdapter.prototype.getFlipHorizontally = function () {
        return this.sprite.getFlipHorizontally();
    };
    TextContainerAdapter.prototype.getFlipVertically = function () {
        return this.sprite.getFlipVertically();
    };
    TextContainerAdapter.prototype.getFlippedRotation = function (_a) {
        var flipVertically = _a.flipVertically, flipHorizontally = _a.flipHorizontally;
        var vertical = flipVertically || this.getFlipVertically();
        var horizontal = flipHorizontally || this.getFlipHorizontally();
        var flippedRotation = this.getRotation();
        if (vertical || horizontal) {
            flippedRotation = flipRotationHorizontally(flippedRotation);
        }
        return flippedRotation;
    };
    return TextContainerAdapter;
}(ContainerAdapter));

var TextDesignContainerAdapter = /** @class */ (function (_super) {
    __extends(TextDesignContainerAdapter, _super);
    function TextDesignContainerAdapter(textDesign, layout, engine) {
        var _this = _super.call(this, engine) || this;
        _this.textDesign = textDesign;
        _this.layout = layout;
        _this.type = 'text-design';
        _this.layoutID = layout.identifier;
        _this.operation = engine.createSpriteOperation();
        var outputSpace = _this.engine.getOutputContainer();
        var parentSpace = _this.getParent();
        var outputBounds = outputSpace.getBounds();
        var minOutputDimension = Math.min(outputBounds.width, outputBounds.height);
        layout.seed(textDesign.seed);
        _this.bounds = TextDesignContainerAdapter.calculateBounds(_this.textDesign, _this.layout);
        var spriteWidth = _this.getBoundsWidthWithoutPadding(_this.bounds);
        _this.sprite = _this.operation.createTextDesign({
            text: textDesign.text,
            layout: layout,
            inverted: textDesign.inverted,
            color: newToLegacyColor(textDesign.color),
            width: scalarFromSpaceToSpace(textDesign.width / minOutputDimension, parentSpace, outputSpace),
            // Padding is specified relative to the sprite width
            padding: textDesign.padding / spriteWidth,
            seed: textDesign.seed,
        });
        _this.updatePivot();
        _this.operation.addSprite(_this.sprite);
        _this.setTransform(RectTransform.IDENTITY);
        _this.operation.setDirty(true);
        return _this;
    }
    TextDesignContainerAdapter.calculateBounds = function (textDesign, layout) {
        var padding = textDesign.inverted ? Math.max(0, 2 * textDesign.padding) : 0;
        var layoutData = layout.generateLayoutData(textDesign.text, textDesign.width);
        var layoutSize = layoutData.getSize();
        return new Rect(0, 0, layoutSize.width + padding, layoutSize.height + padding);
    };
    TextDesignContainerAdapter.prototype.setData = function (data) {
        var oldPadding = this.textDesign.padding;
        var oldBounds = this.bounds;
        this.textDesign = __assign({}, this.textDesign, data);
        if (data.id) {
            this.id = data.id;
        }
        if (data.padding !== undefined) {
            var spriteWidth = this.getBoundsWidthWithoutPadding(oldBounds, oldPadding);
            this.sprite.setPadding(data.padding / spriteWidth);
        }
        if (data.seed !== undefined) {
            this.sprite.setSeed(data.seed);
            this.layout.seed(data.seed);
            this.sprite.setLayout(this.layout);
        }
        if (data.color) {
            this.sprite.setColor(newToLegacyColor(data.color));
        }
        if (data.inverted !== undefined) {
            this.sprite.setInverted(data.inverted);
        }
        if (data.text) {
            this.sprite.setText(data.text);
        }
        if (data.width) {
            var outputSpace = this.engine.getOutputContainer();
            var parentSpace = this.getParent();
            var outputBounds = outputSpace.getBounds();
            var smallerDimension = Math.min(outputBounds.width, outputBounds.height);
            var width = scalarFromSpaceToSpace(data.width / smallerDimension, parentSpace, outputSpace);
            this.sprite.setWidth(width);
        }
        if (data.padding !== undefined || data.seed !== undefined ||
            data.inverted !== undefined || data.text || data.width) {
            // Update the bounds
            var sizedRect = TextDesignContainerAdapter.calculateBounds(this.textDesign, this.layout);
            this.setBoundsFromSize(sizedRect.width, sizedRect.height);
            this.updatePivot();
        }
        this.operation.setDirty(true);
    };
    TextDesignContainerAdapter.prototype.getData = function () {
        return this.textDesign;
    };
    TextDesignContainerAdapter.prototype.updateData = function () {
        this.setData(this.getData());
    };
    TextDesignContainerAdapter.prototype.setTransform = function (transform) {
        _super.prototype.setTransform.call(this, transform);
        var outputSpace = this.engine.getOutputContainer();
        var parentSpace = this.getParent();
        if (transform.scale.x !== 1 || transform.scale.y !== 1) {
            throw new Error("This engine doesn't support scaling TextDesign containers! " +
                'You can change the bounds using the width property of the TextDesign data.');
        }
        // Convert position
        var absolutePositionInOutputSpace = pointFromSpaceToSpace(transform.position, parentSpace, outputSpace, true);
        var relativePositionInOutputSpace = absoluteToRelativePoint(absolutePositionInOutputSpace, outputSpace, false);
        this.sprite.setPosition(new Vector2$1(relativePositionInOutputSpace.x, relativePositionInOutputSpace.y));
        // Convert rotation
        var relativeOutputRotation = getRotationBetweenCoordinateSpaces(parentSpace, outputSpace);
        this.sprite.setRotation(transform.rotation + relativeOutputRotation);
        this.operation.setDirty(true);
    };
    TextDesignContainerAdapter.prototype.setPivot = function (pivot, y) {
        if (typeof pivot === 'number') {
            _super.prototype.setPivot.call(this, pivot, y);
        }
        else {
            _super.prototype.setPivot.call(this, pivot);
        }
        this.updatePivot();
    };
    TextDesignContainerAdapter.prototype.getOperation = function () {
        return this.operation;
    };
    TextDesignContainerAdapter.prototype.getLayoutID = function () {
        return this.layoutID;
    };
    TextDesignContainerAdapter.prototype.setFlipHorizontally = function (scale) {
        this.sprite.setFlipHorizontally(scale);
    };
    TextDesignContainerAdapter.prototype.setFlipVertically = function (scale) {
        this.sprite.setFlipVertically(scale);
    };
    TextDesignContainerAdapter.prototype.getFlipHorizontally = function () {
        return this.sprite.getFlipHorizontally();
    };
    TextDesignContainerAdapter.prototype.getFlipVertically = function () {
        return this.sprite.getFlipVertically();
    };
    TextDesignContainerAdapter.prototype.getBoundsWidthWithoutPadding = function (bounds, padding) {
        if (padding === void 0) { padding = this.textDesign.padding; }
        return this.textDesign.inverted ? bounds.width - 2 * padding : bounds.width;
    };
    TextDesignContainerAdapter.prototype.updatePivot = function () {
        var padding = this.textDesign.inverted ? Math.max(0, this.textDesign.padding) : 0;
        var sizeWithoutPadding = new Vector2(this.bounds.width - 2 * padding, this.bounds.height - 2 * padding);
        // Convert the container pivot into the sprite coordinate system
        // which starts at the top left corner of the TextDesign content.
        // (not including the padding)
        var containerPivot = this.getPivot();
        var pixelContainerPivot = new Vector2(containerPivot.x * this.bounds.width, containerPivot.y * this.bounds.height);
        var spritePixelOrigin = new Vector2(padding, padding);
        var pivotInSpritePXCoords = pixelContainerPivot.subtract(spritePixelOrigin);
        var pivotInSpriteRelCoords = pivotInSpritePXCoords.divide(sizeWithoutPadding);
        this.sprite.setPivot(new Vector2$1(pivotInSpriteRelCoords.x, pivotInSpriteRelCoords.y));
    };
    return TextDesignContainerAdapter;
}(ContainerAdapter));

var DrawingContainerAdapter = /** @class */ (function (_super) {
    __extends(DrawingContainerAdapter, _super);
    function DrawingContainerAdapter(drawing, engine) {
        var _this = _super.call(this, engine) || this;
        _this.type = 'drawing';
        _this.drawing = drawing;
        _this.operation = engine.createSpriteOperation();
        _this.sprite = _this.operation.createBrush({});
        _this.operation.addSprite(_this.sprite);
        _this.radialBrush = _this.sprite._createRadialBrush();
        var rootImage = engine.getRootContainers()[0];
        var rootBounds = rootImage.getBounds();
        _this.bounds = new Rect(0, 0, rootBounds.width, rootBounds.height);
        _this.setTransform(RectTransform.IDENTITY);
        _this.operation.setDirty(true);
        _this.setData(drawing);
        return _this;
    }
    DrawingContainerAdapter.prototype.beginStroke = function (brush) {
        if (this.currentStroke) {
            throw new Error('A brush stroke has already been started but not finished.');
        }
        if (brush.id !== 'imgly_brush_radial') {
            throw new Error('This adapter does not support any brush faces other than the radial img.ly brush.');
        }
        this.currentBrush = brush;
        this.currentStroke = {
            brush: brush,
            path: { controlPoints: [] },
        };
        var outputBounds = this.engine.getOutputContainer().getBounds();
        var smallerDimension = Math.min(outputBounds.width, outputBounds.height);
        this.radialBrush.setColor(newToLegacyColor(brush.color));
        this.radialBrush.setHardness(brush.hardness);
        this.radialBrush.setSize(brush.size / smallerDimension);
        this.currentPath = this.sprite.createPath(this.radialBrush.clone());
    };
    DrawingContainerAdapter.prototype.addPointToCurrentStroke = function (point, render) {
        if (render === void 0) { render = true; }
        if (!this.currentStroke || !this.currentBrush || !this.currentPath) {
            throw new Error('A brush stroke has to first be started with a call to "beginStroke(brush:Brush)"');
        }
        if (this.currentStroke.path.controlPoints.length) {
            var points = this.currentStroke.path.controlPoints;
            var lastPoint = points[points.length - 1];
            var threshold = this.currentBrush.size / 10;
            var distance = Math.sqrt((point.x - Math.pow(lastPoint.x, 2)) + (point.y - Math.pow(lastPoint.y, 2)));
            if (distance < threshold) {
                return;
            }
        }
        var outputContainer = this.engine.getOutputContainer();
        var imageContainer = this.engine.getRootContainers()[0];
        var outputPoint = pointFromSpaceToSpace(point, imageContainer, outputContainer, true);
        var relativePoint = absoluteToRelativePoint(outputPoint, outputContainer, false);
        var outputBounds = outputContainer.getBounds();
        this.currentPath.addControlPoint(Vector2$1.fromObject(relativePoint));
        this.currentStroke.path.controlPoints.push(point);
        if (render) {
            this.sprite.render(Vector2$1.fromObject({ x: outputBounds.width, y: outputBounds.height }));
        }
    };
    DrawingContainerAdapter.prototype.endStroke = function () {
        if (!this.currentStroke || !this.currentPath || !this.currentBrush) {
            return;
        }
        if (this.currentStroke.path.controlPoints.length) {
            this.drawing.strokes.push(this.currentStroke);
        }
        this.currentStroke = undefined;
        this.currentBrush = undefined;
        this.currentPath.setClosed(true);
        var outputBounds = this.engine.getOutputContainer().getBounds();
        this.sprite.render(Vector2$1.fromObject({ x: outputBounds.width, y: outputBounds.height }));
        this.currentPath = undefined;
    };
    DrawingContainerAdapter.prototype.setData = function (drawing) {
        this.drawing = __assign({}, this.drawing, drawing);
        if (this.drawing.strokes) {
            this.drawing.strokes = [];
        }
        this.sprite.clearPersistCanvas();
        this.sprite.clearCanvas();
        this.sprite.setPaths([]);
        this.drawStrokes(drawing.strokes);
    };
    DrawingContainerAdapter.prototype.getData = function () {
        return this.drawing;
    };
    DrawingContainerAdapter.prototype.updateData = function () {
        this.setData(this.getData());
    };
    DrawingContainerAdapter.prototype.getOperation = function () {
        return this.operation;
    };
    DrawingContainerAdapter.prototype.drawStrokes = function (strokes) {
        var e_1, _a, e_2, _b;
        try {
            for (var strokes_1 = __values(strokes), strokes_1_1 = strokes_1.next(); !strokes_1_1.done; strokes_1_1 = strokes_1.next()) {
                var stroke = strokes_1_1.value;
                this.beginStroke(stroke.brush);
                try {
                    for (var _c = __values(stroke.path.controlPoints), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var point = _d.value;
                        // Setting the 'render' parameter to false is more efficient, but leads
                        // to inaccurate undo and redo behaviour due to the brush implementation
                        // in the old engine. That implementation yield different results depending
                        // on whether the stroke is rendered piecewise or all at once.
                        this.addPointToCurrentStroke(point, true);
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
                this.endStroke();
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (strokes_1_1 && !strokes_1_1.done && (_a = strokes_1.return)) _a.call(strokes_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
    };
    return DrawingContainerAdapter;
}(ContainerAdapter));

var OutputContainerAdapter = /** @class */ (function (_super) {
    __extends(OutputContainerAdapter, _super);
    function OutputContainerAdapter(settings, operation, flipOperation, engine) {
        var _this = _super.call(this, engine) || this;
        _this.settings = settings;
        _this.operation = operation;
        _this.flipOperation = flipOperation;
        _this.type = 'output';
        _this.flipTransform = AffineTransform.IDENTITY;
        _this.bounds = new Rect({ x: 0, y: 0 }, _this.settings.resolution);
        _this.setData(settings);
        return _this;
    }
    OutputContainerAdapter.prototype.setData = function (settings) {
        this.settings = __assign({}, this.settings, settings);
        if (settings.resolution) {
            this.setBoundsFromSize(settings.resolution.width, settings.resolution.height);
            this.setTransform(this.transform);
            this.operation.set({
                outputResolution: new Vector2$1(settings.resolution.width, settings.resolution.height),
            });
        }
        if (settings.flipHorizontally !== undefined) {
            var flip = settings.flipHorizontally;
            this.updateFlipTransform();
            this.flipOperation.set({
                flipHorizontally: flip,
            });
        }
        if (settings.flipVertically !== undefined) {
            var flip = settings.flipVertically;
            this.updateFlipTransform();
            this.flipOperation.set({
                flipVertically: flip,
            });
        }
        this.operation.setDirty(true);
        this.flipOperation.setDirty(true);
    };
    OutputContainerAdapter.prototype.getData = function () {
        return this.settings;
    };
    OutputContainerAdapter.prototype.setResolution = function (resolution) {
        this.setData({ resolution: resolution });
    };
    OutputContainerAdapter.prototype.getResolution = function () {
        return this.getData().resolution;
    };
    OutputContainerAdapter.prototype.setTransform = function (transform) {
        this.transform = transform;
        var oldFlipTransform = this.flipTransform;
        this.flipTransform = AffineTransform.IDENTITY;
        var imageContainer = this.engine.getRootContainers()[0];
        var imagePosition = pointFromSpaceToSpace({ x: 0, y: 0 }, imageContainer, this);
        var rotation = -transform.rotation;
        var position = Vector2$1.fromObject(imagePosition).clone().subtract(Vector2$1.fromObject(this.getBounds().origin));
        this.operation.set({
            pivot: new Vector2$1(0, 0),
            position: position,
            scale: new Vector2$1(1 / transform.scale.x, 1 / transform.scale.y),
            rotation: rotation,
        });
        this.flipTransform = oldFlipTransform;
        this.operation.setDirty(true);
        this.updateChildrenContainers();
    };
    OutputContainerAdapter.prototype.rotate90 = function (negative) {
        if (negative === void 0) { negative = false; }
        var outputRotation = negative ? -Math.PI * 0.5 : Math.PI * 0.5;
        var currentResolution = this.getResolution();
        var oldPivot = this.getPivot();
        var bounds = this.getBounds();
        var localCenterPosition = { x: bounds.midX, y: bounds.midY };
        var centerPosition = getPointInWorldSpace(localCenterPosition, this);
        this.setPivot(0.5, 0.5);
        this.setPosition(centerPosition);
        this.setRotation(this.getRotation() - outputRotation);
        var newResolution = { width: currentResolution.height, height: currentResolution.width };
        this.setResolution(newResolution);
        var localOldPivotPosition = {
            x: -newResolution.width * (0.5 - oldPivot.x),
            y: -newResolution.height * (0.5 - oldPivot.y),
        };
        var oldPivotWorldPos = getPointInWorldSpace(localOldPivotPosition, this);
        this.setPivot(oldPivot);
        this.setPosition(oldPivotWorldPos);
        this.updateChildrenContainers();
    };
    OutputContainerAdapter.prototype.setPivot = function (pivot, y) {
        _super.prototype.setPivotInternal.call(this, pivot, y);
        this.setTransform(this.transform);
    };
    OutputContainerAdapter.prototype.getTransform = function () {
        return this.transform;
    };
    OutputContainerAdapter.prototype.getBaseLocalToParentMatrix = function () {
        return rectTransformToAffineTransform(this.getTransform());
    };
    OutputContainerAdapter.prototype.getLocalToParentMatrix = function () {
        var baseLocalToParent = rectTransformToAffineTransform(this.getTransform());
        return AffineTransform.multiply(baseLocalToParent, this.flipTransform);
    };
    OutputContainerAdapter.prototype.getFlipTransformMatrix = function () {
        return this.flipTransform;
    };
    // eslint-disable-next-line class-methods-use-this
    OutputContainerAdapter.prototype.isValid = function () {
        return true;
    };
    OutputContainerAdapter.prototype.getOperation = function () {
        return this.operation;
    };
    OutputContainerAdapter.prototype.updateFlipTransform = function () {
        var _a = this.settings, flipHorizontally = _a.flipHorizontally, flipVertically = _a.flipVertically;
        if (!flipHorizontally && !flipVertically) {
            this.flipTransform = AffineTransform.IDENTITY;
        }
        else {
            var pivot = this.getPivot();
            var bounds = this.getBounds();
            var a = flipHorizontally ? -1 : 1;
            var tx = flipHorizontally ? -2 * (pivot.x - 0.5) * bounds.width : 0;
            var d = flipVertically ? -1 : 1;
            var ty = flipVertically ? -2 * (pivot.y - 0.5) * bounds.height : 0;
            this.flipTransform = new AffineTransform(a, 0, 0, d, tx, ty);
        }
    };
    OutputContainerAdapter.prototype.updateChildrenContainers = function () {
        this.engine.rootOperations.forEach(function (operation) {
            if (isContainer(operation)) {
                operation.updateTransform();
                if ('updateData' in operation) {
                    operation.updateData();
                }
            }
            else if ('updateProperties' in operation) {
                operation.updateProperties();
            }
        });
    };
    return OutputContainerAdapter;
}(ContainerAdapter));

var EffectAdapter = /** @class */ (function () {
    function EffectAdapter(engine) {
        this.engine = engine;
        this.id = uuid();
    }
    EffectAdapter.prototype.getID = function () {
        return this.id;
    };
    EffectAdapter.prototype.getContainer = function () {
        // This adapter only supports effects on the root image container
        return this.engine.getRootContainers()[0];
    };
    EffectAdapter.prototype.getIndexInParent = function () {
        // This adapter only supports effects on the root image container
        var rootOperations = this.engine.rootOperations;
        for (var i = 0; i < rootOperations.length; i += 1) {
            if (rootOperations[i].getID() === this.id) {
                return i;
            }
        }
        return -1;
    };
    EffectAdapter.prototype.setIndexInParent = function (index) {
        this.engine.moveIndex(this, index);
    };
    EffectAdapter.prototype.isValid = function () {
        return this.getIndexInParent() !== -1;
    };
    return EffectAdapter;
}());

var GaussianBlurEffectAdapter = /** @class */ (function (_super) {
    __extends(GaussianBlurEffectAdapter, _super);
    function GaussianBlurEffectAdapter(props, engine, blurOperation) {
        var _this = _super.call(this, engine) || this;
        _this.blurOperation = blurOperation;
        _this.type = 'gaussian-blur';
        _this.setProperties(props);
        return _this;
    }
    GaussianBlurEffectAdapter.prototype.getProperties = function () {
        // The blur radius of the blur operation in the old SDK
        // is specified relative to the smaller inputdimension
        var outputSpace = this.engine.getOutputContainer();
        var outputBounds = outputSpace.getBounds();
        var smallerOutputDimension = Math.min(outputBounds.size.width, outputBounds.size.height);
        var blurInLocalSpace = scalarFromSpaceToSpace(this.blurOperation.getOptions().blurRadius * smallerOutputDimension, outputSpace, this.getContainer());
        return {
            blurRadius: blurInLocalSpace,
        };
    };
    GaussianBlurEffectAdapter.prototype.setProperties = function (props) {
        if (props.blurRadius !== undefined) {
            var inDimensions = this.engine.pesdk.getOutputDimensions();
            var smallerDimension = Math.min(inDimensions.x, inDimensions.y);
            var container = this.getContainer();
            var outputContainer = this.engine.getOutputContainer();
            var blurRadiusInOutputSpace = scalarFromSpaceToSpace(props.blurRadius, container, outputContainer);
            var relativeBlurRadius = blurRadiusInOutputSpace / smallerDimension;
            this.blurOperation.set({ blurRadius: relativeBlurRadius });
        }
    };
    GaussianBlurEffectAdapter.prototype.getOperation = function () {
        return this.blurOperation;
    };
    // eslint-disable-next-line
    GaussianBlurEffectAdapter.prototype.getTypeIdentifier = function () {
        return 'blur';
    };
    return GaussianBlurEffectAdapter;
}(EffectAdapter));

var RadialBlurEffectAdapter = /** @class */ (function (_super) {
    __extends(RadialBlurEffectAdapter, _super);
    function RadialBlurEffectAdapter(props, engine, blurOperation) {
        var _this = _super.call(this, engine) || this;
        _this.props = props;
        _this.blurOperation = blurOperation;
        _this.type = 'radial-blur';
        _this.setProperties(props);
        return _this;
    }
    RadialBlurEffectAdapter.prototype.getProperties = function () {
        return this.props;
    };
    RadialBlurEffectAdapter.prototype.setProperties = function (props) {
        this.props = __assign({}, this.props, props);
        var blurOptions = this.blurOperation.getOptions();
        var outputSpace = this.engine.getOutputContainer();
        var outputBounds = outputSpace.getBounds();
        var container = this.getContainer();
        var outputToWorld = outputSpace.getBaseLocalToParentMatrix();
        var containerToWorld = getBaseLocalToWorldMatrix(container);
        var containerToOutput = AffineTransform.multiply(AffineTransform.getInverted(outputToWorld), containerToWorld);
        var smallerOutputDimension = Math.min(outputBounds.size.width, outputBounds.size.height);
        if (props.blurRadius !== undefined) {
            var blurRadiusInOutputSpace = scalarFromSpaceToSpace(props.blurRadius, container, outputSpace);
            blurOptions.blurRadius = blurRadiusInOutputSpace / smallerOutputDimension;
        }
        if (props.center !== undefined) {
            var absoluteCenterInOutputSpace = AffineTransform.transformPoint(containerToOutput, props.center);
            var relativeCenter = absoluteToRelativePoint(absoluteCenterInOutputSpace, outputSpace, false);
            blurOptions.position = relativeCenter;
        }
        if (props.radius !== undefined) {
            var radiusInOutputSpace = scalarFromSpaceToSpace(props.radius, container, outputSpace);
            var relativeRadius = radiusInOutputSpace / smallerOutputDimension;
            blurOptions.radius = relativeRadius;
        }
        if (props.gradientSize !== undefined) {
            var gradientSizeInOutputSpace = scalarFromSpaceToSpace(props.gradientSize, container, outputSpace);
            var relativeGradient = gradientSizeInOutputSpace / smallerOutputDimension;
            blurOptions.gradientRadius = relativeGradient;
        }
        this.blurOperation.set(blurOptions);
    };
    RadialBlurEffectAdapter.prototype.updateProperties = function () {
        var properties = this.getProperties();
        this.setProperties(properties);
    };
    RadialBlurEffectAdapter.prototype.getOperation = function () {
        return this.blurOperation;
    };
    // eslint-disable-next-line class-methods-use-this
    RadialBlurEffectAdapter.prototype.getTypeIdentifier = function () {
        return 'radial-focus';
    };
    return RadialBlurEffectAdapter;
}(EffectAdapter));

var MirroredBlurEffectAdapter = /** @class */ (function (_super) {
    __extends(MirroredBlurEffectAdapter, _super);
    function MirroredBlurEffectAdapter(props, engine, blurOperation) {
        var _this = _super.call(this, engine) || this;
        _this.props = props;
        _this.blurOperation = blurOperation;
        _this.type = 'mirrored-blur';
        _this.setProperties(props);
        return _this;
    }
    MirroredBlurEffectAdapter.prototype.getProperties = function () {
        return this.props;
    };
    MirroredBlurEffectAdapter.prototype.setProperties = function (props) {
        this.props = __assign({}, this.props, props);
        var blurOptions = this.blurOperation.getOptions();
        var outputSpace = this.engine.getOutputContainer();
        var outputBounds = outputSpace.getBounds();
        var container = this.getContainer();
        var outputToWorld = outputSpace.getBaseLocalToParentMatrix();
        var containerToWorld = getBaseLocalToWorldMatrix(container);
        var containerToOutput = AffineTransform.multiply(AffineTransform.getInverted(outputToWorld), containerToWorld);
        var smallerOutputDimension = Math.min(outputBounds.size.width, outputBounds.size.height);
        if (props.blurRadius !== undefined) {
            var blurRadiusInOutputSpace = scalarFromSpaceToSpace(props.blurRadius, container, outputSpace);
            blurOptions.blurRadius = blurRadiusInOutputSpace / smallerOutputDimension;
        }
        if (props.gradientSize !== undefined) {
            var gradientSizeInOutputSpace = scalarFromSpaceToSpace(props.gradientSize, container, outputSpace);
            var relativeGradient = gradientSizeInOutputSpace / smallerOutputDimension;
            blurOptions.gradientSize = relativeGradient;
        }
        if (props.clearAreaWidth !== undefined) {
            var clearAreaWidthInOutputSpace = scalarFromSpaceToSpace(props.clearAreaWidth, container, outputSpace);
            var relativeClearArea = clearAreaWidthInOutputSpace / smallerOutputDimension;
            blurOptions.size = relativeClearArea * 0.5;
        }
        if (props.mirrorAxisOrigin !== undefined) {
            var absoluteOriginInOutputSpace = AffineTransform.transformPoint(containerToOutput, props.mirrorAxisOrigin);
            var relativeOrigin = absoluteToRelativePoint(absoluteOriginInOutputSpace, outputSpace, false);
            blurOptions.start = relativeOrigin;
        }
        if (props.mirrorAxisDirection !== undefined) {
            var absoluteDirectionInOutputSpace = AffineTransform.transformPoint(containerToOutput, props.mirrorAxisDirection);
            var relativeDirection = absoluteToRelativePoint(absoluteDirectionInOutputSpace, outputSpace, false);
            blurOptions.end = relativeDirection;
        }
        this.blurOperation.set(blurOptions);
    };
    MirroredBlurEffectAdapter.prototype.updateProperties = function () {
        var properties = this.getProperties();
        this.setProperties(properties);
    };
    MirroredBlurEffectAdapter.prototype.getOperation = function () {
        return this.blurOperation;
    };
    // eslint-disable-next-line class-methods-use-this
    MirroredBlurEffectAdapter.prototype.getTypeIdentifier = function () {
        return 'mirrored-focus';
    };
    return MirroredBlurEffectAdapter;
}(EffectAdapter));

var LinearBlurEffectAdapter = /** @class */ (function (_super) {
    __extends(LinearBlurEffectAdapter, _super);
    function LinearBlurEffectAdapter(props, engine, blurOperation) {
        var _this = _super.call(this, engine) || this;
        _this.props = props;
        _this.blurOperation = blurOperation;
        _this.type = 'linear-blur';
        _this.setProperties(props);
        return _this;
    }
    LinearBlurEffectAdapter.prototype.getProperties = function () {
        return this.props;
    };
    LinearBlurEffectAdapter.prototype.setProperties = function (props) {
        this.props = __assign({}, this.props, props);
        var blurOptions = this.blurOperation.getOptions();
        var outputSpace = this.engine.getOutputContainer();
        var outputBounds = outputSpace.getBounds();
        var container = this.getContainer();
        var outputToWorld = outputSpace.getBaseLocalToParentMatrix();
        var containerToWorld = getBaseLocalToWorldMatrix(container);
        var containerToOutput = AffineTransform.multiply(AffineTransform.getInverted(outputToWorld), containerToWorld);
        var smallerOutputDimension = Math.min(outputBounds.size.width, outputBounds.size.height);
        if (props.blurRadius !== undefined) {
            var blurRadiusInOutputSpace = scalarFromSpaceToSpace(props.blurRadius, container, outputSpace);
            blurOptions.blurRadius = blurRadiusInOutputSpace / smallerOutputDimension;
        }
        if (props.start !== undefined) {
            var absoluteStartInOutputSpace = AffineTransform.transformPoint(containerToOutput, props.start);
            var relativeStart = absoluteToRelativePoint(absoluteStartInOutputSpace, outputSpace, false);
            blurOptions.controlPoint1 = relativeStart;
        }
        if (props.end !== undefined) {
            var absoluteEndInOutputSpace = AffineTransform.transformPoint(containerToOutput, props.end);
            var relativeEnd = absoluteToRelativePoint(absoluteEndInOutputSpace, outputSpace, false);
            blurOptions.controlPoint2 = relativeEnd;
        }
        this.blurOperation.set(blurOptions);
    };
    LinearBlurEffectAdapter.prototype.updateProperties = function () {
        var properties = this.getProperties();
        this.setProperties(properties);
    };
    LinearBlurEffectAdapter.prototype.getOperation = function () {
        return this.blurOperation;
    };
    // eslint-disable-next-line class-methods-use-this
    LinearBlurEffectAdapter.prototype.getTypeIdentifier = function () {
        return 'linear-focus';
    };
    return LinearBlurEffectAdapter;
}(EffectAdapter));

var DuoToneFilterEffectAdapter = /** @class */ (function (_super) {
    __extends(DuoToneFilterEffectAdapter, _super);
    function DuoToneFilterEffectAdapter(filter, filterOperation, props, engine) {
        var _this = _super.call(this, engine) || this;
        _this.filterOperation = filterOperation;
        _this.type = 'duotone-filter';
        filterOperation.set({
            intensity: (props.colorIntensity + 1) * 0.5,
        });
        filterOperation.set({ filter: filter });
        engine.pesdk.setAllOperationsToDirty();
        return _this;
    }
    DuoToneFilterEffectAdapter.prototype.getProperties = function () {
        var filterOptions = this.filterOperation.getOptions();
        // NOTE: This engine doesn't currently support reading back the DuoTone color
        // values
        return {
            colorIntensity: filterOptions.intensity * 2 - 1,
        };
    };
    DuoToneFilterEffectAdapter.prototype.setProperties = function (props) {
        // NOTE: This engine doesn't currently support changing the DuoTone colors
        // after initializing the effect
        var options = this.filterOperation.getOptions();
        var newIntensity = options.intensity;
        if (props.colorIntensity !== undefined) {
            newIntensity = (Math.min(Math.max(props.colorIntensity, -1), 1) + 1) * 0.5;
        }
        this.filterOperation.set({
            intensity: newIntensity,
        });
    };
    DuoToneFilterEffectAdapter.prototype.getOperation = function () {
        return this.filterOperation;
    };
    // eslint-disable-next-line
    DuoToneFilterEffectAdapter.prototype.getTypeIdentifier = function () {
        return 'filter';
    };
    return DuoToneFilterEffectAdapter;
}(EffectAdapter));

var LUTFilterEffectAdapter = /** @class */ (function (_super) {
    __extends(LUTFilterEffectAdapter, _super);
    function LUTFilterEffectAdapter(filter, filterOperation, props, engine) {
        var _this = _super.call(this, engine) || this;
        _this.filter = filter;
        _this.filterOperation = filterOperation;
        _this.props = props;
        _this.type = 'lut-filter';
        filterOperation.set({
            intensity: props.intensity,
        });
        filterOperation.set({ filter: filter });
        engine.pesdk.setAllOperationsToDirty();
        return _this;
    }
    LUTFilterEffectAdapter.prototype.getProperties = function () {
        var filterOptions = this.filterOperation.getOptions();
        return {
            intensity: filterOptions.intensity,
            lutImage: this.props.lutImage,
            horizontalTileCount: this.props.horizontalTileCount,
            verticalTileCount: this.props.verticalTileCount,
        };
    };
    LUTFilterEffectAdapter.prototype.setProperties = function (props) {
        var options = this.filterOperation.getOptions();
        var intensity = typeof props.intensity === 'number' ? props.intensity : options.intensity;
        this.filterOperation.set({
            intensity: intensity,
        });
    };
    LUTFilterEffectAdapter.prototype.getOperation = function () {
        return this.filterOperation;
    };
    // eslint-disable-next-line class-methods-use-this
    LUTFilterEffectAdapter.prototype.getTypeIdentifier = function () {
        return 'filter';
    };
    return LUTFilterEffectAdapter;
}(EffectAdapter));

var AdjustmentsEffectAdapter = /** @class */ (function (_super) {
    __extends(AdjustmentsEffectAdapter, _super);
    function AdjustmentsEffectAdapter(props, engine, operation) {
        var _this = _super.call(this, engine) || this;
        _this.operation = operation;
        _this.type = 'adjustments';
        _this.setProperties(props);
        return _this;
    }
    AdjustmentsEffectAdapter.prototype.getProperties = function () {
        var options = this.operation.getOptions();
        return {
            brightness: options.brightness || 0,
            saturation: options.saturation || 0,
            contrast: options.contrast || 0,
            gamma: Math.log2(options.gamma) || 0,
            clarity: options.clarity || 0,
            exposure: options.exposure || 0,
            shadows: options.shadows * 0.5 || 0,
            highlights: options.highlights || 0,
            whites: options.whites || 0,
            blacks: options.blacks || 0,
            temperature: options.temperature || 0,
            sharpness: options.sharpness || 0,
        };
    };
    AdjustmentsEffectAdapter.prototype.setProperties = function (props) {
        // Map gamma and shadows into the correct ranges that are expected
        // by the old SDK
        if (props.gamma !== undefined) {
            props.gamma = Math.pow(2, props.gamma);
        }
        if (props.shadows) {
            props.shadows = props.shadows * 2;
        }
        this.operation.set(props);
    };
    AdjustmentsEffectAdapter.prototype.getOperation = function () {
        return this.operation;
    };
    AdjustmentsEffectAdapter.prototype.getTypeIdentifier = function () {
        return 'adjustments';
    };
    return AdjustmentsEffectAdapter;
}(EffectAdapter));

var OverlayEffectAdapter = /** @class */ (function (_super) {
    __extends(OverlayEffectAdapter, _super);
    function OverlayEffectAdapter(overlayOperation, props, engine) {
        var _this = _super.call(this, engine) || this;
        _this.overlayOperation = overlayOperation;
        _this.type = 'overlay';
        var blendMode = props.blendMode || engine.mapBlendMode(overlayOperation.getBlendMode());
        overlayOperation.set({ blendMode: engine.reverseMapBlendMode(blendMode) });
        overlayOperation.set({ image: props.image });
        engine.pesdk.setAllOperationsToDirty();
        return _this;
    }
    OverlayEffectAdapter.prototype.getProperties = function () {
        var options = this.overlayOperation.getOptions();
        return {
            image: options.image,
            blendMode: this.engine.mapBlendMode(options.blendMode),
            opacity: options.alpha,
        };
    };
    OverlayEffectAdapter.prototype.setProperties = function (props) {
        var options = this.overlayOperation.getOptions();
        if (typeof props.opacity === 'number') {
            options.alpha = props.opacity;
        }
        if (props.blendMode !== undefined) {
            options.blendMode = this.engine.reverseMapBlendMode(props.blendMode);
        }
        this.overlayOperation.set(options);
        this.overlayOperation.setDirty(true);
    };
    OverlayEffectAdapter.prototype.getOperation = function () {
        return this.overlayOperation;
    };
    // eslint-disable-next-line class-methods-use-this
    OverlayEffectAdapter.prototype.getTypeIdentifier = function () {
        return 'overlay';
    };
    return OverlayEffectAdapter;
}(EffectAdapter));

var FrameEffectAdapter = /** @class */ (function (_super) {
    __extends(FrameEffectAdapter, _super);
    function FrameEffectAdapter(frameOperation, props, engine) {
        var _this = _super.call(this, engine) || this;
        _this.frameOperation = frameOperation;
        _this.type = 'frame';
        _this.setProperties(props);
        engine.pesdk.setAllOperationsToDirty();
        return _this;
    }
    FrameEffectAdapter.prototype.setProperties = function (props) {
        this.props = __assign({}, this.props, props);
        if (props.opacity) {
            this.frameOperation.set({
                alpha: props.opacity,
            });
        }
        if (props.tintColor) {
            this.frameOperation.set({
                tintColor: newToLegacyColor(props.tintColor),
            });
        }
        if (props.width) {
            var outputBounds = this.engine.getOutputContainer().getBounds();
            var smallerDimension = Math.min(outputBounds.width, outputBounds.height);
            var relativeWidth = props.width / smallerDimension;
            this.frameOperation.set({
                scale: relativeWidth,
            });
        }
        this.frameOperation.setDirty(true);
    };
    FrameEffectAdapter.prototype.getProperties = function () {
        return this.props;
    };
    FrameEffectAdapter.prototype.getOperation = function () {
        return this.frameOperation;
    };
    FrameEffectAdapter.prototype.getTypeIdentifier = function () {
        return 'frame';
    };
    return FrameEffectAdapter;
}(EffectAdapter));

var FrameAdapter = /** @class */ (function () {
    function FrameAdapter(asset, engine) {
        this.engine = engine;
        this.loaded = false;
        this.loading = false;
        this.asset = __assign({}, asset);
    }
    /**
     * Loads the images of this frame
     */
    FrameAdapter.prototype.load = function () {
        return __awaiter(this, void 0, void 0, function () {
            var imageGroups, promises;
            var _this = this;
            return __generator(this, function (_a) {
                if (this.loaded) {
                    return [2 /*return*/, Promise.resolve()];
                }
                if (this.loading) {
                    return [2 /*return*/, Promise.reject(new Error('Called Frame#load while it\'s already loading'))];
                }
                this.loading = true;
                imageGroups = this.asset.imageGroups;
                promises = [];
                ['top', 'left', 'right', 'bottom'].forEach(function (groupName) {
                    if (!imageGroups[groupName]) {
                        return;
                    }
                    var group = imageGroups[groupName];
                    ['start', 'mid', 'end'].forEach(function (partName) {
                        if (!(partName in group)) {
                            return;
                        }
                        promises.push(_this.loadPart(groupName, partName));
                    });
                });
                return [2 /*return*/, Promise.all(promises)
                        .then(function () {
                        _this.loaded = true;
                        _this.loading = false;
                    })
                        .catch(function () {
                        _this.loaded = false;
                        _this.loading = false;
                    })];
            });
        });
    };
    FrameAdapter.prototype.getFrame = function () {
        return __assign({}, this.asset, { defaultName: this.asset.name, thumbnail: this.asset.thumbnailURI });
    };
    FrameAdapter.prototype.getIdentifier = function () {
        return this.asset.identifier;
    };
    FrameAdapter.prototype.getDefaultName = function () {
        return this.asset.name;
    };
    FrameAdapter.prototype.getThumbnail = function () {
        return this.asset.thumbnailURI;
    };
    FrameAdapter.prototype.getTintable = function () {
        return this.asset.tintable || false;
    };
    FrameAdapter.prototype.getLayoutMode = function () {
        return this.asset.layoutMode;
    };
    FrameAdapter.prototype.getImageGroups = function () {
        return this.asset.imageGroups;
    };
    /**
     * Loads a given part of the given image group
     */
    FrameAdapter.prototype.loadPart = function (groupName, partName) {
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                return [2 /*return*/, new Promise(function (resolve, reject) {
                        var imageGroups = _this.asset.imageGroups;
                        var part = imageGroups[groupName][partName];
                        var imageUrl = part;
                        // `part` can also be an object containing `mode` and `image`
                        if (typeof part !== 'string' && 'image' in part) {
                            imageUrl = part.image;
                        }
                        var image = new Image();
                        image.addEventListener('load', function () {
                            if (typeof part !== 'string') {
                                _this.asset.imageGroups[groupName][partName].image = image;
                            }
                            else {
                                _this.asset.imageGroups[groupName][partName] = image;
                            }
                            resolve(image);
                        });
                        image.addEventListener('error', function () {
                            reject(new Error("Failed to load image at " + image.src));
                        });
                        image.crossOrigin = _this.engine.configuration.crossOrigin || 'anonymus';
                        image.src = _this.engine.assetProvider.getAssetSource('frame', imageUrl);
                    })];
            });
        });
    };
    return FrameAdapter;
}());

var DuoToneFilter = PhotoEditorSDK_Engine_1.Operations.FilterOperation.Filters.DuoToneFilter;
var ThreeDLUTFilter = PhotoEditorSDK_Engine_1.Operations.FilterOperation.Filters.ThreeDLUTFilter;
var defaultFontID = 'imgly_font_open_sans_bold';
var LegacyEngineAdapter = /** @class */ (function (_super) {
    __extends(LegacyEngineAdapter, _super);
    function LegacyEngineAdapter(config) {
        var _this = _super.call(this, config) || this;
        _this.previews = Array();
        _this.rootOperationStack = [];
        _this.deferredRenderQueue = [];
        /**
         * The number of operations at the beginning of the SDK operations-stack
         * which are always needed (e.g. Transform & Orientation operation)
         */
        _this.operationStackOffset = 1;
        _this.assetProvider = config.assetProvider || new AssetManager();
        _this.wrapper = new PhotoEditorSDK_Engine_2({
            license: config.license,
            crossOrigin: config.crossOrigin,
            assets: {
                resolver: function (category, assetInfo) {
                    return _this.resolveAssetForSDK(category, assetInfo);
                },
            },
            editor: {
                preferredRenderer: 'webgl',
                pixelRatio: 1,
            },
        });
        _this.editor = _this.wrapper.getEditor();
        _this.sdk = _this.editor.getSDK();
        _this.sdk.setRenderMode('adapter');
        _this.tempCanvas = document.createElement('canvas');
        _this.sdk.setCanvas(_this.tempCanvas);
        // Check the maximum WebGL texture dimensions
        var glCanvas = document.createElement('canvas');
        var gl = (glCanvas.getContext('webgl') || glCanvas.getContext('experimental-webgl'));
        _this.maxTextureDimension = gl.getParameter(gl.MAX_TEXTURE_SIZE);
        return _this;
    }
    Object.defineProperty(LegacyEngineAdapter.prototype, "configuration", {
        get: function () {
            return this.config;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LegacyEngineAdapter.prototype, "pesdk", {
        get: function () {
            return this.sdk;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LegacyEngineAdapter.prototype, "rootOperations", {
        get: function () {
            return this.rootOperationStack;
        },
        enumerable: true,
        configurable: true
    });
    LegacyEngineAdapter.prototype.dispose = function () {
        this.pesdk.dispose();
        this.wrapper.dispose();
    };
    // Render
    LegacyEngineAdapter.prototype.render = function (preview) {
        var _this = this;
        // eslint-disable-next-line promise/param-names
        return new Promise(function (resolveMain) {
            var createRenderCall = function () {
                return new Promise(function (resolve) {
                    var canvas = preview.canvas;
                    var transform = preview.getTransform();
                    var outputPivot = _this.outputContainer.getPivot();
                    var canvasBounds = preview.getCanvasBounds();
                    var previewQuality = preview.quality;
                    var tempCanvas = _this.tempCanvas;
                    _this.sdk.setTextureQuality(previewQuality);
                    var outputDimensions = _this.sdk.getOutputDimensions();
                    tempCanvas.width = outputDimensions.x;
                    tempCanvas.height = outputDimensions.y;
                    _this.sdk.getRenderer().resizeTo(new Vector2$1(tempCanvas.width, tempCanvas.height));
                    return _this.sdk.render(true).then(function () {
                        var context = canvas.getContext('2d');
                        context.clearRect(0, 0, canvas.width, canvas.height);
                        context.save();
                        context.translate(-canvasBounds.minX, -canvasBounds.minY);
                        context.translate(transform.position.x, transform.position.y);
                        context.rotate(transform.rotation);
                        context.scale(transform.scale.x, transform.scale.y);
                        context.translate(-outputPivot.x * tempCanvas.width, -outputPivot.y * tempCanvas.height);
                        context.scale(1 / preview.quality, 1 / preview.quality);
                        context.drawImage(tempCanvas, 0, 0);
                        context.restore();
                        resolveMain();
                        // check if more needs to be rendered
                        _this.deferredRenderQueue.shift();
                        if (_this.deferredRenderQueue.length) {
                            // Create new render call promise
                            _this.sdk.setAllOperationsToDirty();
                            Promise.resolve(_this.deferredRenderQueue[0]().then(resolve));
                        }
                        else {
                            resolve();
                        }
                    });
                });
            };
            _this.deferredRenderQueue.push(createRenderCall);
            if (_this.deferredRenderQueue.length === 1) {
                // Render immediately
                createRenderCall();
            }
        });
    };
    LegacyEngineAdapter.prototype.createPreview = function (canvas) {
        var preview = new Preview(canvas, this);
        this.previews.push(preview);
        return preview;
    };
    LegacyEngineAdapter.prototype.export = function (exportFormat, imageFormat, quality) {
        if (exportFormat === void 0) { exportFormat = ExportFormat.IMAGE; }
        if (imageFormat === void 0) { imageFormat = ImageFormat.PNG; }
        if (quality === void 0) { quality = 1.0; }
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                // These calls need to be buffered with the preview render calls to make
                // sure that they don't interfere with each other.
                // Bad things happen if export and render are called at the same time.
                // eslint-disable-next-line promise/param-names
                return [2 /*return*/, new Promise(function (resolveMain) {
                        var createRenderCall = function () {
                            return new Promise(function (resolve) {
                                return _this.sdk.export(_this.mapToRenderType(exportFormat), _this.mapToImageFormat(imageFormat), quality).then(function (result) {
                                    resolveMain(result);
                                    // Check if more needs to be rendered
                                    _this.deferredRenderQueue.shift();
                                    if (_this.deferredRenderQueue.length) {
                                        // Create new render call promise
                                        Promise.resolve(_this.deferredRenderQueue[0]().then(resolve));
                                    }
                                    else {
                                        resolve();
                                    }
                                });
                            });
                        };
                        _this.deferredRenderQueue.push(createRenderCall);
                        if (_this.deferredRenderQueue.length === 1) {
                            // Export immediately
                            createRenderCall();
                        }
                    })];
            });
        });
    };
    // Building the image editing graph
    LegacyEngineAdapter.prototype.getRootContainers = function () {
        return [this.rootContainer];
    };
    LegacyEngineAdapter.prototype.getOutputContainer = function () {
        return this.outputContainer;
    };
    LegacyEngineAdapter.prototype.findContainerByID = function (id) {
        var e_1, _a;
        if (id === this.rootContainer.getID()) {
            return this.rootContainer;
        }
        try {
            for (var _b = __values(this.rootOperationStack), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                if (item.getID() === id) {
                    return item;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return undefined;
    };
    LegacyEngineAdapter.prototype.findEffectByID = function (id) {
        var e_2, _a;
        try {
            for (var _b = __values(this.rootOperationStack), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                if (item.getID() === id) {
                    return item;
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return undefined;
    };
    // Adding containers
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    LegacyEngineAdapter.prototype.addImage = function (props, container, index) {
        if (this.rootContainer) {
            throw new Error('A background image already exists - did you mean to use addSticker?');
        }
        var imageContainer = new ImageContainerAdapter(props, this);
        this.rootContainer = imageContainer;
        if (!this.outputContainer) {
            var _a = imageContainer.getBounds(), width = _a.width, height = _a.height;
            var outputSettings = {
                resolution: { width: width, height: height },
                flipHorizontally: false,
                flipVertically: false,
            };
            var outputOperation = this.sdk.createOperation('output', {}, false);
            var flipOperation = this.sdk.createOperation('flip', {}, false);
            this.insertIntoOperationsStack(outputOperation, this.operationStackOffset - 1);
            this.insertIntoOperationsStack(flipOperation, this.operationStackOffset);
            this.outputContainer = new OutputContainerAdapter(outputSettings, outputOperation, flipOperation, this);
        }
        return imageContainer;
    };
    LegacyEngineAdapter.prototype.addSticker = function (props, container, index) {
        if (!container) {
            throw new Error('This engine does not support adding stickers as root elements.');
        }
        this.ensureContainerIsRoot(container);
        var stickerContainer = new StickerContainerAdapter(props, this);
        this.addToStackAtIndex(stickerContainer, index);
        return stickerContainer;
    };
    LegacyEngineAdapter.prototype.addStickerFromAssets = function (assetIdentifier, container, index) {
        var _this = this;
        if (!container) {
            throw new Error('This engine does not support adding stickers as root elements.');
        }
        this.ensureContainerIsRoot(container);
        return new Promise(function (resolve, reject) {
            var image = new Image();
            image.onload = function () {
                var stickerData = {
                    image: image,
                    opacity: 1,
                };
                var sticker = new StickerContainerAdapter(stickerData, _this);
                _this.addToStackAtIndex(sticker, index);
                resolve(sticker);
            };
            image.onerror = function (error) {
                reject(error);
            };
            image.crossOrigin = _this.config.crossOrigin || null;
            image.src = _this.assetProvider.getAssetSource('sticker', assetIdentifier);
        });
    };
    LegacyEngineAdapter.prototype.addText = function (props, container, index) {
        if (!container) {
            throw new Error('This engine does not support adding text as root elements.');
        }
        // Make sure that the font is loaded
        var fontManager = this.assetProvider.getFontManager();
        if (!fontManager.isFontLoaded(props.fontIdentifier || defaultFontID)) {
            throw new Error('Adding text synchronously only works if the required font is already loded!' +
                ' Consider using the asynchronous addTextWithFontLoading function instead!');
        }
        this.ensureContainerIsRoot(container);
        var text = __assign({ text: '', fontIdentifier: defaultFontID, fontSize: 20, lineHeight: 1, alignment: 'center', textColor: [1, 1, 1], backgroundColor: [0, 0, 0, 0], width: 100 }, props);
        var textContainer = new TextContainerAdapter(text, this);
        this.addToStackAtIndex(textContainer, index);
        return textContainer;
    };
    LegacyEngineAdapter.prototype.addTextWithFontLoading = function (props, container, index) {
        var _this = this;
        if (!container) {
            throw new Error('This engine does not support adding text as root elements.');
        }
        var fontManager = this.assetProvider.getFontManager();
        var fontID = props.fontIdentifier || defaultFontID;
        return new Promise(function (resolve, reject) {
            fontManager.loadFontWithIdentifier(fontID).then(function () {
                _this.ensureContainerIsRoot(container);
                var text = __assign({ text: '', fontIdentifier: defaultFontID, fontSize: 20, lineHeight: 1, alignment: 'center', textColor: [1, 1, 1], backgroundColor: [0, 0, 0, 0], width: 100 }, props);
                var textContainer = new TextContainerAdapter(text, _this);
                _this.addToStackAtIndex(textContainer, index);
                resolve(textContainer);
            }).catch(reject);
        });
    };
    LegacyEngineAdapter.prototype.addTextDesignAsync = function (layoutID, props, container, index) {
        if (layoutID === void 0) { layoutID = 'imgly_text_design_blocks'; }
        return __awaiter(this, void 0, void 0, function () {
            var textDesign, layout, images, assetManager, legacyFontManager, variations, variationIds, key, fontManager;
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!container) {
                            throw new Error('This engine does not support adding TextDesign as a root element.');
                        }
                        textDesign = __assign({ seed: Math.floor(Math.random() * 1000), padding: 0, text: '', color: [0, 0, 0], inverted: false, width: 100 }, props);
                        layout = this.wrapper.getTextDesignLayoutByID(layoutID);
                        if (!layout) {
                            throw new Error("The layout could not be loaded for the given id: " + layoutID);
                        }
                        images = layout.getImagePaths().map(function (path) {
                            var id = path.split('/').pop() || '';
                            return { path: path, fullPath: _this.assetProvider.getAssetSource('textdesign', id) };
                        });
                        assetManager = this.wrapper.getTextDesignAssetManager();
                        legacyFontManager = this.wrapper.getTextDesignFontManager();
                        variations = legacyFontManager.getVariationsByIdentifier();
                        assetManager.setFonts(variations);
                        return [4 /*yield*/, assetManager.loadImages(images)];
                    case 1:
                        _a.sent();
                        layout.onImagesLoaded();
                        variationIds = [];
                        for (key in variations) {
                            if (variations.hasOwnProperty(key)) {
                                variationIds.push(key);
                            }
                        }
                        fontManager = this.assetProvider.getFontManager();
                        return [2 /*return*/, fontManager.loadFontsWithIdentifiers(variationIds).then(function () {
                                _this.ensureContainerIsRoot(container);
                                var textDesignContainer = new TextDesignContainerAdapter(textDesign, layout, _this);
                                _this.addToStackAtIndex(textDesignContainer, index);
                                return Promise.resolve(textDesignContainer);
                            })];
                }
            });
        });
    };
    LegacyEngineAdapter.prototype.addDrawing = function (props, container, index) {
        if (!container) {
            throw new Error('This engine does not support DrawingContainers as root elements.');
        }
        this.ensureContainerIsRoot(container);
        var drawingContainer = new DrawingContainerAdapter(props, this);
        this.addToStackAtIndex(drawingContainer, index);
        return drawingContainer;
    };
    // Add effects
    LegacyEngineAdapter.prototype.addGaussianBlur = function (props, container, index) {
        this.ensureContainerIsRoot(container);
        var blurEffect = new GaussianBlurEffectAdapter(props, this, this.sdk.createOperation('blur', {}, false));
        this.addToStackAtIndex(blurEffect, index);
        return blurEffect;
    };
    LegacyEngineAdapter.prototype.addRadialBlur = function (props, container, index) {
        this.ensureContainerIsRoot(container);
        var blurEffect = new RadialBlurEffectAdapter(props, this, this.sdk.createOperation('radial-focus', {}, false));
        this.addToStackAtIndex(blurEffect, index);
        return blurEffect;
    };
    LegacyEngineAdapter.prototype.addMirroredBlur = function (props, container, index) {
        this.ensureContainerIsRoot(container);
        var blurEffect = new MirroredBlurEffectAdapter(props, this, this.sdk.createOperation('mirrored-focus', {}, false));
        this.addToStackAtIndex(blurEffect, index);
        return blurEffect;
    };
    LegacyEngineAdapter.prototype.addLinearBlur = function (props, container, index) {
        this.ensureContainerIsRoot(container);
        var blurEffect = new LinearBlurEffectAdapter(props, this, this.sdk.createOperation('linear-focus', {}, false));
        this.addToStackAtIndex(blurEffect, index);
        return blurEffect;
    };
    // eslint-disable-next-line class-methods-use-this
    LegacyEngineAdapter.prototype.addDuoToneFilter = function (props, container, index) {
        throw new Error('Not supported! Use addDuoToneFilterFromAssets instead');
    };
    LegacyEngineAdapter.prototype.addDuoToneFilterFromAssets = function (assetIdentifier, container, index) {
        var _this = this;
        this.ensureContainerIsRoot(container);
        var operationsStack = this.sdk.getOperationsStack();
        var existing = operationsStack.getByIdentifier('filter');
        if (existing && existing.getIdentifier() !== assetIdentifier) {
            throw new Error("This engine doesn't support multiple types of filter operations at once!");
        }
        var operation = existing || this.sdk.createOperation('filter', {}, false);
        return new Promise(function (resolve, reject) {
            try {
                var asset = _this.assetProvider.getDuotoneFilterAsset(assetIdentifier);
                var props = {
                    colorIntensity: asset.defaultIntensity || 0,
                };
                var filter = new DuoToneFilter({
                    intensity: props.colorIntensity,
                    // @ts-ignore
                    lightColor: PhotoEditorSDK_Engine_1.Color.fromHex(asset.lightColor),
                    // @ts-ignore
                    darkColor: PhotoEditorSDK_Engine_1.Color.fromHex(asset.darkColor),
                });
                var duoToneEffect = new DuoToneFilterEffectAdapter(filter, operation, props, _this);
                _this.addToStackAtIndex(duoToneEffect, index);
                resolve(duoToneEffect);
            }
            catch (error) {
                if (error) {
                    reject(error);
                }
            }
        });
    };
    LegacyEngineAdapter.prototype.addLUTFilter = function (props, container, index) {
        throw new Error('Not supported! Use addLUTFilterFromAssets instead');
    };
    LegacyEngineAdapter.prototype.addLUTFilterFromAssets = function (assetIdentifier, container, index) {
        var _this = this;
        this.ensureContainerIsRoot(container);
        var operationStack = this.sdk.getOperationsStack();
        var existing = operationStack.getByIdentifier('filter');
        if (existing && existing.getIdentifier() !== assetIdentifier) {
            throw new Error("This engine doesn't support multiple types filter operations at once!");
        }
        var operation = existing || this.sdk.createOperation('filter', {}, false);
        return new Promise(function (resolve, reject) {
            var image = new Image();
            image.addEventListener('load', function () {
                var asset = _this.assetProvider.getLUTFilterAsset(assetIdentifier);
                var commonProps = {
                    horizontalTileCount: asset.horizontalTileCount || 5,
                    verticalTileCount: asset.verticalTileCount || 5,
                    intensity: asset.defaultIntensity || 1,
                };
                var filter = new ThreeDLUTFilter(__assign({}, commonProps, { image: image }));
                var props = __assign({}, commonProps, { lutImage: new Image() });
                var lutEffect = new LUTFilterEffectAdapter(filter, operation, props, _this);
                _this.addToStackAtIndex(lutEffect, index);
                resolve(lutEffect);
            });
            image.addEventListener('error', function (error) {
                reject(error);
            });
            image.crossOrigin = _this.config.crossOrigin || null;
            image.src = _this.assetProvider.getAssetSource('filter', assetIdentifier);
        });
    };
    LegacyEngineAdapter.prototype.addAdjustments = function (props, container, index) {
        this.ensureContainerIsRoot(container);
        var adjustmentsEffect = new AdjustmentsEffectAdapter(props, this, this.sdk.createOperation('adjustments', {}, false));
        this.addToStackAtIndex(adjustmentsEffect, index);
        return adjustmentsEffect;
    };
    LegacyEngineAdapter.prototype.addOverlay = function (props, container, index) {
        this.ensureContainerIsRoot(container);
        var overlayEffect = new OverlayEffectAdapter(this.sdk.createOperation('overlay', {}, false), props, this);
        this.addToStackAtIndex(overlayEffect, index);
        return overlayEffect;
    };
    LegacyEngineAdapter.prototype.addOverlayFromAssets = function (assetIdentifier, container, index) {
        var _this = this;
        this.ensureContainerIsRoot(container);
        return new Promise(function (resolve, reject) {
            var operationStack = _this.sdk.getOperationsStack();
            var existing = operationStack.getByIdentifier('overlay');
            if (existing && existing.getIdentifier() !== assetIdentifier) {
                throw new Error("This engine doesn't support multiple types overlay operations at once!");
            }
            var operation = existing || _this.sdk.createOperation('overlay', {}, false);
            var image = new Image();
            image.onload = function () {
                var props = {
                    image: image,
                    opacity: 1,
                    blendMode: BlendMode.NORMAL,
                };
                var effect = new OverlayEffectAdapter(operation, props, _this);
                _this.addToStackAtIndex(effect, index);
                resolve(effect);
            };
            image.onerror = function (error) {
                reject(error);
            };
            image.crossOrigin = _this.config.crossOrigin || null;
            image.src = _this.assetProvider.getAssetSource('overlay', assetIdentifier);
        });
    };
    LegacyEngineAdapter.prototype.addFrame = function (props, container, index) {
        throw new Error('Not supported!');
    };
    LegacyEngineAdapter.prototype.addFrameFromAssets = function (assetIdentifier, container, index) {
        return __awaiter(this, void 0, void 0, function () {
            var asset, frameAdapter, outputBounds, smallerDimension, operation, props, effectAdapter;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.ensureContainerIsRoot(container);
                        asset = this.assetProvider.getFrameAsset(assetIdentifier);
                        if (!asset) {
                            throw new Error("The requested asset does not exist! " + assetIdentifier);
                        }
                        frameAdapter = new FrameAdapter(asset, this);
                        return [4 /*yield*/, frameAdapter.load()];
                    case 1:
                        _a.sent();
                        outputBounds = this.getOutputContainer().getBounds();
                        smallerDimension = Math.min(outputBounds.width, outputBounds.height);
                        operation = this.sdk.createOperation('frame', {}, false);
                        operation.setFrame(frameAdapter.getFrame());
                        props = {
                            opacity: 1,
                            tintColor: [1, 1, 1],
                            tintable: false,
                            width: Math.max(1, 0.1 * smallerDimension),
                            imageGroups: frameAdapter.getFrame().imageGroups,
                        };
                        effectAdapter = new FrameEffectAdapter(operation, props, this);
                        this.addToStackAtIndex(effectAdapter, index);
                        return [2 /*return*/, Promise.resolve(effectAdapter)];
                }
            });
        });
    };
    // Reset / Clear state
    LegacyEngineAdapter.prototype.removeEffect = function (effect) {
        if (!effect.isValid()) {
            return;
        }
        var effectAdapter = effect;
        var operation = effectAdapter.getOperation();
        this.sdk.removeOperation(operation);
        this.sdk.setAllOperationsToDirty();
        this.rootOperationStack.splice(effect.getIndexInParent(), 1);
    };
    LegacyEngineAdapter.prototype.removeContainer = function (container) {
        if (!container.isValid() || container.type === 'output') {
            return;
        }
        var containerAdapter = container;
        var operation = containerAdapter.getOperation();
        this.sdk.removeOperation(operation);
        this.sdk.setAllOperationsToDirty();
        this.rootOperationStack.splice(container.getIndexInParent(), 1);
    };
    // Helpers
    LegacyEngineAdapter.prototype.refreshOutputIndex = function () {
        var indexInOperationStack = this.sdk.getOperationsStack().getIndexByIdentifier('output');
        this.moveInOperationsStack(indexInOperationStack, this.operationStackOffset - 1);
    };
    LegacyEngineAdapter.prototype.refreshFlipIndex = function () {
        var indexInOperationStack = this.sdk.getOperationsStack().getIndexByIdentifier('flip');
        var lastIndex = this.sdk.getOperationsStack().getStack().length - 1;
        if (indexInOperationStack !== lastIndex) {
            this.moveInOperationsStack(indexInOperationStack, lastIndex);
        }
    };
    LegacyEngineAdapter.prototype.mapToRenderType = function (exportFormat) {
        switch (exportFormat) {
            case ExportFormat.IMAGE: return "image" /* IMAGE */;
            case ExportFormat.DATA_URL: return "data-url" /* DATAURL */;
            case ExportFormat.BLOB: return "blob" /* BLOB */;
            case ExportFormat.MSBLOB: return "ms-blob" /* MSBLOB */;
        }
    };
    LegacyEngineAdapter.prototype.mapToImageFormat = function (imageFormat) {
        switch (imageFormat) {
            case ImageFormat.PNG: return "image/png" /* PNG */;
            case ImageFormat.JPEG: return "image/jpeg" /* JPEG */;
            default: return null;
        }
    };
    LegacyEngineAdapter.prototype.mapBlendMode = function (blendMode) {
        switch (blendMode) {
            case 0 /* NORMAL */: return BlendMode.NORMAL;
            case 1 /* OVERLAY */: return BlendMode.OVERLAY;
            case 2 /* HARD_LIGHT */: return BlendMode.HARD_LIGHT;
            case 3 /* SOFT_LIGHT */: return BlendMode.SOFT_LIGHT;
            case 4 /* MULTIPLY */: return BlendMode.MULTIPLY;
            case 5 /* DARKEN */: return BlendMode.DARKEN;
            case 6 /* LIGHTEN */: return BlendMode.LIGHTEN;
            case 7 /* SCREEN */: return BlendMode.SCREEN;
            case 8 /* COLOR_BURN */: return BlendMode.COLOR_BURN;
            default: return BlendMode.NORMAL;
        }
    };
    LegacyEngineAdapter.prototype.reverseMapBlendMode = function (blendMode) {
        switch (blendMode) {
            case BlendMode.NORMAL: return 0 /* NORMAL */;
            case BlendMode.OVERLAY: return 1 /* OVERLAY */;
            case BlendMode.HARD_LIGHT: return 2 /* HARD_LIGHT */;
            case BlendMode.SOFT_LIGHT: return 3 /* SOFT_LIGHT */;
            case BlendMode.MULTIPLY: return 4 /* MULTIPLY */;
            case BlendMode.DARKEN: return 5 /* DARKEN */;
            case BlendMode.LIGHTEN: return 6 /* LIGHTEN */;
            case BlendMode.SCREEN: return 7 /* SCREEN */;
            case BlendMode.COLOR_BURN: return 8 /* COLOR_BURN */;
            default: return 0 /* NORMAL */;
        }
    };
    LegacyEngineAdapter.prototype.createSpriteOperation = function () {
        return this.sdk.createOperation('sprite', {}, false);
    };
    LegacyEngineAdapter.prototype.moveIndex = function (item, index) {
        var fromIndex = this.getSiblingIndex(item);
        if (fromIndex === -1) {
            throw new Error('The item to be moved is not part of any stack.');
        }
        this.moveInStack(this.rootOperationStack, fromIndex, index);
        var offset = this.operationStackOffset;
        this.moveInOperationsStack(fromIndex + offset, index + offset);
        this.refreshFlipIndex();
    };
    LegacyEngineAdapter.prototype.ensureContainerIsRoot = function (container) {
        var id = container.getID();
        if (id !== this.rootContainer.getID()) {
            throw new Error("This engine doesn't support adding this effect/container to anything other than the root image container");
        }
    };
    LegacyEngineAdapter.prototype.addToStackAtIndex = function (item, index) {
        if (index && index < 0) {
            throw new Error("The given index may not be negative: " + index);
        }
        if (index === undefined) {
            this.rootOperationStack.push(item);
        }
        else {
            this.rootOperationStack.splice(index, 0, item);
        }
        var lastIndex = this.rootOperationStack.length - 1;
        var insertIdx = index !== undefined ? index : lastIndex;
        insertIdx += this.operationStackOffset;
        if (isEffect(item)) {
            this.insertIntoOperationsStack(item.getOperation(), insertIdx);
        }
        else {
            this.insertIntoOperationsStack(item.getOperation(), insertIdx);
        }
        this.sdk.setAllOperationsToDirty();
    };
    LegacyEngineAdapter.prototype.insertIntoOperationsStack = function (item, idx) {
        var stack = this.sdk.getOperationsStack().getStack();
        // stack.remove(item)
        var stackLength = stack.length;
        var index = Math.max(Math.min(idx, stackLength), 0);
        // Push operations after index back by one
        for (var i = stackLength - 1; i >= index; i--) {
            var operation = stack[i];
            stack[i + 1] = operation;
        }
        stack[index] = item;
        this.sdk.setAllOperationsToDirty();
        this.refreshFlipIndex();
    };
    LegacyEngineAdapter.prototype.moveInStack = function (stack, fromIdx, toIdx) {
        var stackLength = stack.length;
        var fromIndex = Math.max(Math.min(fromIdx, stackLength - 1), 0);
        var toIndex = Math.max(Math.min(toIdx, stackLength - 1), 0);
        if (fromIndex === toIndex) {
            return;
        }
        var fromOp = stack[fromIndex];
        if (fromIndex < toIndex) {
            // Shift next operations left
            for (var i = fromIndex + 1; i <= toIndex; i += 1) {
                stack[i - 1] = stack[i];
            }
        }
        else {
            // Shift previous operations right
            for (var i = fromIndex - 1; i >= toIndex; i--) {
                stack[i + 1] = stack[i];
            }
        }
        stack[toIndex] = fromOp;
    };
    LegacyEngineAdapter.prototype.moveInOperationsStack = function (fromIdx, toIdx) {
        var stack = this.sdk.getOperationsStack().getStack();
        var stackLength = stack.length;
        var fromIndex = Math.min(Math.max(0, fromIdx), stackLength - 1);
        var toIndex = Math.min(Math.max(0, toIdx), stackLength - 1);
        if (fromIndex === toIndex) {
            return;
        }
        var fromOp = stack[fromIndex];
        if (fromIndex < toIndex) {
            // Shift next operations left
            for (var i = fromIndex + 1; i <= toIndex; i += 1) {
                stack[i - 1] = stack[i];
            }
        }
        else {
            // Shift previous operations right
            for (var i = fromIndex - 1; i >= toIndex; i -= 1) {
                stack[i + 1] = stack[i];
            }
        }
        stack[toIndex] = fromOp;
        this.sdk.getOperationsStack().setAllToDirty();
    };
    LegacyEngineAdapter.prototype.getSiblingIndex = function (item) {
        return item.getIndexInParent();
    };
    // MARK: - Asset Management and resolution
    /**
     * Returns a path to the requested asset (or a base64 encoded version of the asset)
     * @param {string} suggestedPath
     */
    LegacyEngineAdapter.prototype.resolveAssetForSDK = function (category, assetInfo) {
        assetInfo = assetInfo;
        switch (category) {
            case 'filter':
                return this.assetProvider.getAssetSource('filter', assetInfo.identifier);
            case 'overlay':
                return this.assetProvider.getAssetSource('overlay', assetInfo.identifier);
            case 'font':
                return this.assetProvider.getAssetSource('font', assetInfo.identifier);
        }
        return '';
    };
    return LegacyEngineAdapter;
}(Engine));

export { conversionUtils as ConversionUtils, Engine, EngineEvent, ExportFormat, ImageFormat, LegacyEngineAdapter, Preview, isContainer, isEffect, isHex, isRGBAArray, isRGBAObject, isRGBArray, isRGBObject };
